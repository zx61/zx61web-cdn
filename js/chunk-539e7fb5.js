import{e as W,u as be,D as h,C as y,G as J,r as fe,o as g,c as H,b as _,t as i,g as s,i as o,w as n,l as m,H as ve,I as he,k as _e,F as S,h as F,s as R,J as ge,E as ke,_ as Te}from"./chunk-f1eab420.js";import{E as ye,q as we,a as Ne,t as Ve,g as Ee,b as xe,c as Ce,d as Be}from"./chunk-e2a560cb.js";/* empty css              */import{f as De,o as Qe,e as He,g as Ue,h as Ie,c as U,r as x,s as C,d as B,i as Le,j as $e,k as Ae,l as Se,p as Fe,q as Re}from"./chunk-6dff8a79.js";const qe={class:"batchQueryBalance"},Me={class:"text"},Oe={class:"dialog-footer"},Ye={class:"dialog-footer"},je={class:"buttons"},ze={class:"text",style:{display:"flex"}},Pe={class:"text"},Ge={class:"table"},Je={class:"dialog-footer"},We={class:"el-upload__text"},Ke=W({name:"batchQueryBalance"}),Xe=W({...Ke,setup(Ze){const{t:a}=be(),I=h(!1),L=h(!1),$=h(!1),p=h(!1),b=h(!0),k=h(""),V=h(""),w=h(""),q=h(0),M=h(1),A=y([]),d=y([]),O=y([]),E=y([{label:U.ETH,value:U.ETH}]),D=y([{label:x.ETH,value:x.ETH}]),N=y({ETH:U.ETH}),z=y({}),t=y({chainName:U.ETH,tokens:[U.ETH],network:x.ETH,threadCount:1});J(()=>t.chainName,()=>{E.length=0,E.push({label:C[t.chainName],value:C[t.chainName]}),D.length=0,D.push({label:x[t.chainName],value:x[t.chainName]}),t.network=x[t.chainName],t.tokens=[C[t.chainName]],N[C[t.chainName]]=C[t.chainName]}),J(()=>({...d}),()=>{P.value=Math.ceil(d.length/100),G()});const P=h(1),Y=h(1),G=()=>{O.length=0,O.push(...d.slice((Y.value-1)*100,Y.value*100))},K=u=>{Y.value=u,G()},X=()=>{A.length=0,t.tokens.forEach(u=>{A.push({label:N[u],prop:N[u]+"Balance"})})},Z=async()=>{p.value=!0;try{D.forEach(u=>{if(u.value==V.value)throw B.warning(a("chainTools.networkReuse")),p.value=!1,new Error(a("chainTools.networkReuse"))})}catch(u){return u}await Ve(V.value)?(L.value=!1,D.push({label:V.value,value:V.value})):B.error(a("chainTools.networkError")),p.value=!1},ee=async()=>{p.value=!0;try{E.forEach(e=>{if(e.value==k.value)throw B.warning(a("chainTools.tokenReuse")),p.value=!1,new Error(a("chainTools.tokenReuse"))})}catch(e){return e}let u=await Ee(t.chainName,t.network,k.value);u?(I.value=!1,E.forEach(e=>{e.label==u&&(u=u+"1")}),E.push({label:u,value:k.value}),N[k.value]=u,z[k.value]=await xe(t.chainName,t.network,k.value)):B.error(a("chainTools.tokenError")),p.value=!1},le=()=>{if(p.value=!0,w.value=w.value.trim(),w.value==""){B.warning(a("chainTools.noAddressTip")),p.value=!1;return}d.length=0,w.value.split(`
`).forEach((e,r)=>{e.trim()!=""&&d.push({serialNumber:(r+1).toString(),address:e.split("----")[0],status:a("chainTools.waitQuery")})}),$.value=!1,p.value=!1},ae=async()=>{if(d.length==0||t.tokens.length==0)return;q.value=0,b.value=!1,X(),d.splice(0,M.value-1);let u=0;const e=async()=>{if(b.value)return;const r=u++;if(r<d.length){const f=d[r];d[r].status=a("chainTools.inQuery");for(let v=0;v<t.tokens.length;v++){const c=t.tokens[v];let T;c==C[t.chainName]?T=await we(t.chainName,t.network,f.address):T=await Ne(t.chainName,t.network,c,f.address,z[c]),d[r][N[c]+"Balance"]=T,v+1==A.length&&(d[r].status=a("chainTools.finishQuery"),q.value++,r+1==d.length&&(B.success(a("chainTools.finishQuery")),b.value=!0))}e()}};for(let r=0;r<t.threadCount;r++)setTimeout(e,100)},te=()=>{const u=ve(he(),"YYYYMMDDHHmmss"),e=d.map(r=>{let f=r.address;return t.tokens.forEach(v=>{f+="----"+N[v]+":"+r[N[v]+"Balance"]}),f}).join(`\r
`);try{De.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),a("chainTools.fileName1")+t.chainName+a("chainTools.fileName3")+u.value+".txt")}catch{}return e},oe=u=>{d.splice(u,1)},ne=u=>{const e=new FileReader;e.readAsText(u.raw,"UTF-8"),e.onload=function(r){var f;(f=r.target)!=null&&f.result&&(w.value=r.target.result.toString())}};return(u,e)=>{const r=$e,f=Ae,v=Se,c=_e,T=Qe,j=ye,se=Ce,ue=He,re=Fe,ie=Ue,Q=Re,de=Ie,ce=fe("upload-filled"),me=ke,pe=Be;return g(),H("div",qe,[_("h1",null,i(s(a)("chainTools.bathQueryWallet")),1),_("div",Me,i(s(a)("chainTools.queryTip")),1),o(ue,{inline:!0,model:t,class:"batchQueryBalanceForm"},{default:n(()=>[o(v,{label:s(a)("chainTools.chainNameLabel")},{default:n(()=>[o(f,{modelValue:t.chainName,"onUpdate:modelValue":e[0]||(e[0]=l=>t.chainName=l),class:"shortSelect",disabled:!b.value},{default:n(()=>[(g(!0),H(S,null,F(s(Le),l=>(g(),R(r,{value:l.value,label:l.label,disabled:l.balanceDisable||l.disabled},null,8,["value","label","disabled"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),o(v,{label:s(a)("chainTools.networkLabel")},{default:n(()=>[o(f,{disabled:!b.value,modelValue:t.network,"onUpdate:modelValue":e[1]||(e[1]=l=>t.network=l)},{default:n(()=>[(g(!0),H(S,null,F(D,l=>(g(),R(r,{value:l.value,label:l.label,disabled:l.disabled},null,8,["value","label","disabled"]))),256))]),_:1},8,["disabled","modelValue"]),o(c,{disabled:!b.value,type:"primary",onClick:e[2]||(e[2]=l=>L.value=!0)},{default:n(()=>[m(i(s(a)("chainTools.selfDefinedNetwork")),1)]),_:1},8,["disabled"]),o(j,{"destroy-on-close":"",title:s(a)("chainTools.addNetworkLabel"),"align-center":"",modelValue:L.value,"onUpdate:modelValue":e[5]||(e[5]=l=>L.value=l)},{footer:n(()=>[_("span",Oe,[o(c,{type:"primary",onClick:e[4]||(e[4]=l=>Z()),disabled:p.value},{default:n(()=>[m(i(s(a)("utils.confirm")),1)]),_:1},8,["disabled"])])]),default:n(()=>[o(T,{class:"longInput",modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=l=>V.value=l)},null,8,["modelValue"])]),_:1},8,["title","modelValue"])]),_:1},8,["label"]),o(v,{label:s(a)("chainTools.tokenLabel")},{default:n(()=>[o(f,{disabled:!b.value,multiple:"",modelValue:t.tokens,"onUpdate:modelValue":e[6]||(e[6]=l=>t.tokens=l)},{default:n(()=>[(g(!0),H(S,null,F(E,l=>(g(),R(r,{value:l.value,label:l.label,disabled:l.disabled},null,8,["value","label","disabled"]))),256))]),_:1},8,["disabled","modelValue"]),o(c,{disabled:!b.value,type:"primary",onClick:e[7]||(e[7]=l=>I.value=!0)},{default:n(()=>[m(i(s(a)("chainTools.selfDefinedToken")),1)]),_:1},8,["disabled"]),o(j,{"destroy-on-close":"",title:s(a)("chainTools.addTokenLabel"),"align-center":"",modelValue:I.value,"onUpdate:modelValue":e[10]||(e[10]=l=>I.value=l)},{footer:n(()=>[_("span",Ye,[o(c,{type:"primary",onClick:e[9]||(e[9]=l=>ee()),disabled:p.value},{default:n(()=>[m(i(s(a)("utils.confirm")),1)]),_:1},8,["disabled"])])]),default:n(()=>[o(T,{class:"longInput",modelValue:k.value,"onUpdate:modelValue":e[8]||(e[8]=l=>k.value=l)},null,8,["modelValue"])]),_:1},8,["title","modelValue"])]),_:1},8,["label"]),o(v,{label:s(a)("utils.threadLabel")},{default:n(()=>[o(se,{disabled:!b.value,modelValue:t.threadCount,"onUpdate:modelValue":e[11]||(e[11]=l=>t.threadCount=l),min:1},null,8,["disabled","modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),_("div",je,[o(c,{disabled:!b.value,type:"info",onClick:e[12]||(e[12]=l=>$.value=!0)},{default:n(()=>[m(i(s(a)("chainTools.importAddress")),1)]),_:1},8,["disabled"]),o(c,{type:"primary",onClick:e[13]||(e[13]=l=>ae())},{default:n(()=>[m(i(s(a)("chainTools.startQuery")),1)]),_:1}),o(c,{type:"warning",onClick:e[14]||(e[14]=l=>b.value=!0)},{default:n(()=>[m(i(s(a)("chainTools.stopQuery")),1)]),_:1}),o(c,{type:"primary",onClick:e[15]||(e[15]=l=>te())},{default:n(()=>[m(i(s(a)("chainTools.dowmLoadTable")),1)]),_:1}),_("div",ze,[m(i(s(a)("utils.startSerialNumber"))+" ",1),o(T,{modelValue:M.value,"onUpdate:modelValue":e[16]||(e[16]=l=>M.value=l),disabled:!b.value},null,8,["modelValue","disabled"])]),_("div",Pe,i(s(a)("chainTools.finishQueryCountLabbel"))+" "+i(q.value),1)]),_("div",Ge,[o(ie,{target:".batchQueryBalance",offset:80},{default:n(()=>[o(re,{layout:"->,prev, pager, next","page-count":P.value,background:"",onCurrentChange:K,"hide-on-single-page":!0},null,8,["page-count"])]),_:1}),o(de,{data:O,size:"small","max-height":"500"},{default:n(()=>[o(Q,{prop:"serialNumber",label:s(a)("utils.serialNumber"),width:"60"},null,8,["label"]),o(Q,{prop:"address",label:s(a)("chainTools.address")},null,8,["label"]),(g(!0),H(S,null,F(A,l=>(g(),R(Q,{prop:l.prop,sortable:"",label:l.label},null,8,["prop","label"]))),256)),o(Q,{prop:"status",label:s(a)("utils.status"),width:"100"},null,8,["label"]),o(Q,{label:s(a)("utils.operation"),fixed:"right",width:"100"},{default:n(l=>[o(c,{link:"",type:"primary",size:"small",onClick:ge(el=>oe(l.$index),["prevent"])},{default:n(()=>[m(i(s(a)("utils.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),o(j,{"destroy-on-close":"",title:s(a)("chainTools.importAddressLabel"),"align-center":"",modelValue:$.value,"onUpdate:modelValue":e[19]||(e[19]=l=>$.value=l)},{footer:n(()=>[_("span",Je,[o(pe,{drag:"",limit:1,"auto-upload":!1,"on-change":ne},{default:n(()=>[o(me,{class:"el-icon--upload"},{default:n(()=>[o(ce)]),_:1}),_("div",We,[m(i(s(a)("utils.dragToHere"))+" or ",1),_("em",null,i(s(a)("utils.clickToUpload")),1),m("Â eg: address---- or address ")])]),_:1}),o(c,{type:"primary",onClick:e[18]||(e[18]=l=>le()),disabled:p.value},{default:n(()=>[m(i(s(a)("utils.confirm")),1)]),_:1},8,["disabled"])])]),default:n(()=>[o(T,{class:"longInput",type:"textarea",rows:10,modelValue:w.value,"onUpdate:modelValue":e[17]||(e[17]=l=>w.value=l),placeholder:"eg: address---- or address"},null,8,["modelValue"])]),_:1},8,["title","modelValue"])])}}});const nl=Te(Xe,[["__scopeId","data-v-7c32916f"]]);export{nl as default};
