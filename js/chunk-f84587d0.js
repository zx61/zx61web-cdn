import{aZ as vr,a_ as k_,a$ as G_,b2 as W_}from"./chunk-8aace738.js";import{t as $r,e as cr}from"./chunk-b270d6a2.js";import{c as Y_,b as wl}from"./chunk-49d50282.js";import{r as J_}from"./chunk-76e02f40.js";var eu={},Do={},De={},rd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(d,v){var E=d>>>16&65535,A=d&65535,N=v>>>16&65535,H=v&65535;return A*H+(E*H+A*N<<16>>>0)|0}n.mul=Math.imul||t;function r(d,v){return d+v|0}n.add=r;function s(d,v){return d-v|0}n.sub=s;function a(d,v){return d<<v|d>>>32-v}n.rotl=a;function l(d,v){return d<<32-v|d>>>v}n.rotr=l;function p(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(d){return n.isInteger(d)&&d>=-n.MAX_SAFE_INTEGER&&d<=n.MAX_SAFE_INTEGER}})(rd);Object.defineProperty(De,"__esModule",{value:!0});var id=rd;function X_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}De.readInt16BE=X_;function Z_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}De.readUint16BE=Z_;function Q_(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}De.readInt16LE=Q_;function em(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}De.readUint16LE=em;function nd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}De.writeUint16BE=nd;De.writeInt16BE=nd;function sd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}De.writeUint16LE=sd;De.writeInt16LE=sd;function Dc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}De.readInt32BE=Dc;function $c(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}De.readUint32BE=$c;function Mc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}De.readInt32LE=Mc;function jc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}De.readUint32LE=jc;function Po(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}De.writeUint32BE=Po;De.writeInt32BE=Po;function To(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}De.writeUint32LE=To;De.writeInt32LE=To;function tm(n,t){t===void 0&&(t=0);var r=Dc(n,t),s=Dc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}De.readInt64BE=tm;function rm(n,t){t===void 0&&(t=0);var r=$c(n,t),s=$c(n,t+4);return r*4294967296+s}De.readUint64BE=rm;function im(n,t){t===void 0&&(t=0);var r=Mc(n,t),s=Mc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}De.readInt64LE=im;function nm(n,t){t===void 0&&(t=0);var r=jc(n,t),s=jc(n,t+4);return s*4294967296+r}De.readUint64LE=nm;function od(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Po(n/4294967296>>>0,t,r),Po(n>>>0,t,r+4),t}De.writeUint64BE=od;De.writeInt64BE=od;function ad(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),To(n>>>0,t,r),To(n/4294967296>>>0,t,r+4),t}De.writeUint64LE=ad;De.writeInt64LE=ad;function sm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=t[l]*a,a*=256;return s}De.readUintBE=sm;function om(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=t[l]*a,a*=256;return s}De.readUintLE=om;function am(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!id.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=t/a&255,a*=256;return r}De.writeUintBE=am;function cm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!id.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=t/a&255,a*=256;return r}De.writeUintLE=cm;function um(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}De.readFloat32BE=um;function hm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}De.readFloat32LE=hm;function lm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}De.readFloat64BE=lm;function fm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}De.readFloat64LE=fm;function dm(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}De.writeFloat32BE=dm;function pm(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}De.writeFloat32LE=pm;function gm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}De.writeFloat64BE=gm;function vm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}De.writeFloat64LE=vm;var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function ym(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Ir.wipe=ym;Object.defineProperty(Do,"__esModule",{value:!0});var Xt=De,qc=Ir,_m=20;function mm(n,t,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,d=r[3]<<24|r[2]<<16|r[1]<<8|r[0],v=r[7]<<24|r[6]<<16|r[5]<<8|r[4],E=r[11]<<24|r[10]<<16|r[9]<<8|r[8],A=r[15]<<24|r[14]<<16|r[13]<<8|r[12],N=r[19]<<24|r[18]<<16|r[17]<<8|r[16],H=r[23]<<24|r[22]<<16|r[21]<<8|r[20],F=r[27]<<24|r[26]<<16|r[25]<<8|r[24],M=r[31]<<24|r[30]<<16|r[29]<<8|r[28],K=t[3]<<24|t[2]<<16|t[1]<<8|t[0],V=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ae=t[11]<<24|t[10]<<16|t[9]<<8|t[8],R=t[15]<<24|t[14]<<16|t[13]<<8|t[12],$=s,x=a,P=l,b=p,c=d,m=v,Y=E,G=A,ne=N,ce=H,de=F,_=M,I=K,ee=V,X=ae,z=R,k=0;k<_m;k+=2)$=$+c|0,I^=$,I=I>>>32-16|I<<16,ne=ne+I|0,c^=ne,c=c>>>32-12|c<<12,x=x+m|0,ee^=x,ee=ee>>>32-16|ee<<16,ce=ce+ee|0,m^=ce,m=m>>>32-12|m<<12,P=P+Y|0,X^=P,X=X>>>32-16|X<<16,de=de+X|0,Y^=de,Y=Y>>>32-12|Y<<12,b=b+G|0,z^=b,z=z>>>32-16|z<<16,_=_+z|0,G^=_,G=G>>>32-12|G<<12,P=P+Y|0,X^=P,X=X>>>32-8|X<<8,de=de+X|0,Y^=de,Y=Y>>>32-7|Y<<7,b=b+G|0,z^=b,z=z>>>32-8|z<<8,_=_+z|0,G^=_,G=G>>>32-7|G<<7,x=x+m|0,ee^=x,ee=ee>>>32-8|ee<<8,ce=ce+ee|0,m^=ce,m=m>>>32-7|m<<7,$=$+c|0,I^=$,I=I>>>32-8|I<<8,ne=ne+I|0,c^=ne,c=c>>>32-7|c<<7,$=$+m|0,z^=$,z=z>>>32-16|z<<16,de=de+z|0,m^=de,m=m>>>32-12|m<<12,x=x+Y|0,I^=x,I=I>>>32-16|I<<16,_=_+I|0,Y^=_,Y=Y>>>32-12|Y<<12,P=P+G|0,ee^=P,ee=ee>>>32-16|ee<<16,ne=ne+ee|0,G^=ne,G=G>>>32-12|G<<12,b=b+c|0,X^=b,X=X>>>32-16|X<<16,ce=ce+X|0,c^=ce,c=c>>>32-12|c<<12,P=P+G|0,ee^=P,ee=ee>>>32-8|ee<<8,ne=ne+ee|0,G^=ne,G=G>>>32-7|G<<7,b=b+c|0,X^=b,X=X>>>32-8|X<<8,ce=ce+X|0,c^=ce,c=c>>>32-7|c<<7,x=x+Y|0,I^=x,I=I>>>32-8|I<<8,_=_+I|0,Y^=_,Y=Y>>>32-7|Y<<7,$=$+m|0,z^=$,z=z>>>32-8|z<<8,de=de+z|0,m^=de,m=m>>>32-7|m<<7;Xt.writeUint32LE($+s|0,n,0),Xt.writeUint32LE(x+a|0,n,4),Xt.writeUint32LE(P+l|0,n,8),Xt.writeUint32LE(b+p|0,n,12),Xt.writeUint32LE(c+d|0,n,16),Xt.writeUint32LE(m+v|0,n,20),Xt.writeUint32LE(Y+E|0,n,24),Xt.writeUint32LE(G+A|0,n,28),Xt.writeUint32LE(ne+N|0,n,32),Xt.writeUint32LE(ce+H|0,n,36),Xt.writeUint32LE(de+F|0,n,40),Xt.writeUint32LE(_+M|0,n,44),Xt.writeUint32LE(I+K|0,n,48),Xt.writeUint32LE(ee+V|0,n,52),Xt.writeUint32LE(X+ae|0,n,56),Xt.writeUint32LE(z+R|0,n,60)}function cd(n,t,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-t.length,l.set(t,p)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,p=a}for(var d=new Uint8Array(64),v=0;v<r.length;v+=64){mm(d,l,n);for(var E=v;E<v+64&&E<r.length;E++)s[E]=r[E]^d[E-v];wm(l,0,p)}return qc.wipe(d),a===0&&qc.wipe(l),s}Do.streamXOR=cd;function bm(n,t,r,s){return s===void 0&&(s=0),qc.wipe(r),cd(n,t,r,r,s)}Do.stream=bm;function wm(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var ud={},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});function Em(n,t,r){return~(n-1)&t|n-1&r}Ci.select=Em;function Sm(n,t){return(n|0)-(t|0)-1>>>31&1}Ci.lessOrEqual=Sm;function hd(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ci.compare=hd;function Im(n,t){return n.length===0||t.length===0?!1:hd(n,t)!==0}Ci.equal=Im;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ci,r=Ir;n.DIGEST_LENGTH=16;var s=function(){function p(d){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=d[0]|d[1]<<8;this._r[0]=v&8191;var E=d[2]|d[3]<<8;this._r[1]=(v>>>13|E<<3)&8191;var A=d[4]|d[5]<<8;this._r[2]=(E>>>10|A<<6)&7939;var N=d[6]|d[7]<<8;this._r[3]=(A>>>7|N<<9)&8191;var H=d[8]|d[9]<<8;this._r[4]=(N>>>4|H<<12)&255,this._r[5]=H>>>1&8190;var F=d[10]|d[11]<<8;this._r[6]=(H>>>14|F<<2)&8191;var M=d[12]|d[13]<<8;this._r[7]=(F>>>11|M<<5)&8065;var K=d[14]|d[15]<<8;this._r[8]=(M>>>8|K<<8)&8191,this._r[9]=K>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return p.prototype._blocks=function(d,v,E){for(var A=this._fin?0:2048,N=this._h[0],H=this._h[1],F=this._h[2],M=this._h[3],K=this._h[4],V=this._h[5],ae=this._h[6],R=this._h[7],$=this._h[8],x=this._h[9],P=this._r[0],b=this._r[1],c=this._r[2],m=this._r[3],Y=this._r[4],G=this._r[5],ne=this._r[6],ce=this._r[7],de=this._r[8],_=this._r[9];E>=16;){var I=d[v+0]|d[v+1]<<8;N+=I&8191;var ee=d[v+2]|d[v+3]<<8;H+=(I>>>13|ee<<3)&8191;var X=d[v+4]|d[v+5]<<8;F+=(ee>>>10|X<<6)&8191;var z=d[v+6]|d[v+7]<<8;M+=(X>>>7|z<<9)&8191;var k=d[v+8]|d[v+9]<<8;K+=(z>>>4|k<<12)&8191,V+=k>>>1&8191;var J=d[v+10]|d[v+11]<<8;ae+=(k>>>14|J<<2)&8191;var re=d[v+12]|d[v+13]<<8;R+=(J>>>11|re<<5)&8191;var me=d[v+14]|d[v+15]<<8;$+=(re>>>8|me<<8)&8191,x+=me>>>5|A;var se=0,be=se;be+=N*P,be+=H*(5*_),be+=F*(5*de),be+=M*(5*ce),be+=K*(5*ne),se=be>>>13,be&=8191,be+=V*(5*G),be+=ae*(5*Y),be+=R*(5*m),be+=$*(5*c),be+=x*(5*b),se+=be>>>13,be&=8191;var he=se;he+=N*b,he+=H*P,he+=F*(5*_),he+=M*(5*de),he+=K*(5*ce),se=he>>>13,he&=8191,he+=V*(5*ne),he+=ae*(5*G),he+=R*(5*Y),he+=$*(5*m),he+=x*(5*c),se+=he>>>13,he&=8191;var ye=se;ye+=N*c,ye+=H*b,ye+=F*P,ye+=M*(5*_),ye+=K*(5*de),se=ye>>>13,ye&=8191,ye+=V*(5*ce),ye+=ae*(5*ne),ye+=R*(5*G),ye+=$*(5*Y),ye+=x*(5*m),se+=ye>>>13,ye&=8191;var q=se;q+=N*m,q+=H*c,q+=F*b,q+=M*P,q+=K*(5*_),se=q>>>13,q&=8191,q+=V*(5*de),q+=ae*(5*ce),q+=R*(5*ne),q+=$*(5*G),q+=x*(5*Y),se+=q>>>13,q&=8191;var j=se;j+=N*Y,j+=H*m,j+=F*c,j+=M*b,j+=K*P,se=j>>>13,j&=8191,j+=V*(5*_),j+=ae*(5*de),j+=R*(5*ce),j+=$*(5*ne),j+=x*(5*G),se+=j>>>13,j&=8191;var C=se;C+=N*G,C+=H*Y,C+=F*m,C+=M*c,C+=K*b,se=C>>>13,C&=8191,C+=V*P,C+=ae*(5*_),C+=R*(5*de),C+=$*(5*ce),C+=x*(5*ne),se+=C>>>13,C&=8191;var h=se;h+=N*ne,h+=H*G,h+=F*Y,h+=M*m,h+=K*c,se=h>>>13,h&=8191,h+=V*b,h+=ae*P,h+=R*(5*_),h+=$*(5*de),h+=x*(5*ce),se+=h>>>13,h&=8191;var O=se;O+=N*ce,O+=H*ne,O+=F*G,O+=M*Y,O+=K*m,se=O>>>13,O&=8191,O+=V*c,O+=ae*b,O+=R*P,O+=$*(5*_),O+=x*(5*de),se+=O>>>13,O&=8191;var oe=se;oe+=N*de,oe+=H*ce,oe+=F*ne,oe+=M*G,oe+=K*Y,se=oe>>>13,oe&=8191,oe+=V*m,oe+=ae*c,oe+=R*b,oe+=$*P,oe+=x*(5*_),se+=oe>>>13,oe&=8191;var fe=se;fe+=N*_,fe+=H*de,fe+=F*ce,fe+=M*ne,fe+=K*G,se=fe>>>13,fe&=8191,fe+=V*Y,fe+=ae*m,fe+=R*c,fe+=$*b,fe+=x*P,se+=fe>>>13,fe&=8191,se=(se<<2)+se|0,se=se+be|0,be=se&8191,se=se>>>13,he+=se,N=be,H=he,F=ye,M=q,K=j,V=C,ae=h,R=O,$=oe,x=fe,v+=16,E-=16}this._h[0]=N,this._h[1]=H,this._h[2]=F,this._h[3]=M,this._h[4]=K,this._h[5]=V,this._h[6]=ae,this._h[7]=R,this._h[8]=$,this._h[9]=x},p.prototype.finish=function(d,v){v===void 0&&(v=0);var E=new Uint16Array(10),A,N,H,F;if(this._leftover){for(F=this._leftover,this._buffer[F++]=1;F<16;F++)this._buffer[F]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(A=this._h[1]>>>13,this._h[1]&=8191,F=2;F<10;F++)this._h[F]+=A,A=this._h[F]>>>13,this._h[F]&=8191;for(this._h[0]+=A*5,A=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=A,A=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=A,E[0]=this._h[0]+5,A=E[0]>>>13,E[0]&=8191,F=1;F<10;F++)E[F]=this._h[F]+A,A=E[F]>>>13,E[F]&=8191;for(E[9]-=1<<13,N=(A^1)-1,F=0;F<10;F++)E[F]&=N;for(N=~N,F=0;F<10;F++)this._h[F]=this._h[F]&N|E[F];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,H=this._h[0]+this._pad[0],this._h[0]=H&65535,F=1;F<8;F++)H=(this._h[F]+this._pad[F]|0)+(H>>>16)|0,this._h[F]=H&65535;return d[v+0]=this._h[0]>>>0,d[v+1]=this._h[0]>>>8,d[v+2]=this._h[1]>>>0,d[v+3]=this._h[1]>>>8,d[v+4]=this._h[2]>>>0,d[v+5]=this._h[2]>>>8,d[v+6]=this._h[3]>>>0,d[v+7]=this._h[3]>>>8,d[v+8]=this._h[4]>>>0,d[v+9]=this._h[4]>>>8,d[v+10]=this._h[5]>>>0,d[v+11]=this._h[5]>>>8,d[v+12]=this._h[6]>>>0,d[v+13]=this._h[6]>>>8,d[v+14]=this._h[7]>>>0,d[v+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(d){var v=0,E=d.length,A;if(this._leftover){A=16-this._leftover,A>E&&(A=E);for(var N=0;N<A;N++)this._buffer[this._leftover+N]=d[v+N];if(E-=A,v+=A,this._leftover+=A,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(E>=16&&(A=E-E%16,this._blocks(d,v,A),v+=A,E-=A),E){for(var N=0;N<E;N++)this._buffer[this._leftover+N]=d[v+N];this._leftover+=E}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,d){var v=new s(p);v.update(d);var E=v.digest();return v.clean(),E}n.oneTimeAuth=a;function l(p,d){return p.length!==n.DIGEST_LENGTH||d.length!==n.DIGEST_LENGTH?!1:t.equal(p,d)}n.equal=l})(ud);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Do,r=ud,s=Ir,a=De,l=Ci;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),d=function(){function v(E){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,E.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(E)}return v.prototype.seal=function(E,A,N,H){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var F=new Uint8Array(16);F.set(E,F.length-E.length);var M=new Uint8Array(32);t.stream(this._key,F,M,4);var K=A.length+this.tagLength,V;if(H){if(H.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");V=H}else V=new Uint8Array(K);return t.streamXOR(this._key,F,A,V,4),this._authenticate(V.subarray(V.length-this.tagLength,V.length),M,V.subarray(0,V.length-this.tagLength),N),s.wipe(F),V},v.prototype.open=function(E,A,N,H){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(A.length<this.tagLength)return null;var F=new Uint8Array(16);F.set(E,F.length-E.length);var M=new Uint8Array(32);t.stream(this._key,F,M,4);var K=new Uint8Array(this.tagLength);if(this._authenticate(K,M,A.subarray(0,A.length-this.tagLength),N),!l.equal(K,A.subarray(A.length-this.tagLength,A.length)))return null;var V=A.length-this.tagLength,ae;if(H){if(H.length!==V)throw new Error("ChaCha20Poly1305: incorrect destination length");ae=H}else ae=new Uint8Array(V);return t.streamXOR(this._key,F,A.subarray(0,A.length-this.tagLength),ae,4),s.wipe(F),ae},v.prototype.clean=function(){return s.wipe(this._key),this},v.prototype._authenticate=function(E,A,N,H){var F=new r.Poly1305(A);H&&(F.update(H),H.length%16>0&&F.update(p.subarray(H.length%16))),F.update(N),N.length%16>0&&F.update(p.subarray(N.length%16));var M=new Uint8Array(8);H&&a.writeUint64LE(H.length,M),F.update(M),a.writeUint64LE(N.length,M),F.update(M);for(var K=F.digest(),V=0;V<K.length;V++)E[V]=K[V];F.clean(),s.wipe(K),s.wipe(M)},v}();n.ChaCha20Poly1305=d})(eu);var ld={},fs={},tu={};Object.defineProperty(tu,"__esModule",{value:!0});function xm(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}tu.isSerializableHash=xm;Object.defineProperty(fs,"__esModule",{value:!0});var Zr=tu,Om=Ci,Am=Ir,fd=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),Zr.isSerializableHash(this._inner)&&Zr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Am.wipe(s)}return n.prototype.reset=function(){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Zr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();fs.HMAC=fd;function Pm(n,t,r){var s=new fd(n,t);s.update(r);var a=s.digest();return s.clean(),a}fs.hmac=Pm;fs.equal=Om.equal;Object.defineProperty(ld,"__esModule",{value:!0});var El=fs,Sl=Ir,Tm=function(){function n(t,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=a;var l=El.hmac(this._hash,s,r);this._hmac=new El.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Sl.wipe(this._buffer),Sl.wipe(this._counter),this._bufpos=0},n}(),Cm=ld.HKDF=Tm,Cn={},$o={},Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.BrowserRandomSource=void 0;const Il=65536;class Nm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Il)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Il)));return r}}Mo.BrowserRandomSource=Nm;var jo={};Object.defineProperty(jo,"__esModule",{value:!0});jo.NodeRandomSource=void 0;const Rm=Ir;class Um{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Y_<"u"){const t=J_;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,Rm.wipe)(r),s}}jo.NodeRandomSource=Um;Object.defineProperty($o,"__esModule",{value:!0});$o.SystemRandomSource=void 0;const Lm=Mo,Fm=jo;class Dm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Lm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Fm.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}$o.SystemRandomSource=Dm;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=$o,r=De,s=Ir;n.defaultRandomSource=new t.SystemRandomSource;function a(E,A=n.defaultRandomSource){return A.randomBytes(E)}n.randomBytes=a;function l(E=n.defaultRandomSource){const A=a(4,E),N=(0,r.readUint32LE)(A);return(0,s.wipe)(A),N}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(E,A=p,N=n.defaultRandomSource){if(A.length<2)throw new Error("randomString charset is too short");if(A.length>256)throw new Error("randomString charset is too long");let H="";const F=A.length,M=256-256%F;for(;E>0;){const K=a(Math.ceil(E*256/M),N);for(let V=0;V<K.length&&E>0;V++){const ae=K[V];ae<M&&(H+=A.charAt(ae%F),E--)}(0,s.wipe)(K)}return H}n.randomString=d;function v(E,A=p,N=n.defaultRandomSource){const H=Math.ceil(E/(Math.log(A.length)/Math.LN2));return d(H,A,N)}n.randomStringForEntropy=v})(Cn);var qo={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=De,r=Ir;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},d.prototype.update=function(v,E){if(E===void 0&&(E=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var A=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&E>0;)this._buffer[this._bufferLength++]=v[A++],E--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(A=l(this._temp,this._state,v,A,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=v[A++],E--;return this},d.prototype.finish=function(v){if(!this._finished){var E=this._bytesHashed,A=this._bufferLength,N=E/536870912|0,H=E<<3,F=E%64<56?64:128;this._buffer[A]=128;for(var M=A+1;M<F-8;M++)this._buffer[M]=0;t.writeUint32BE(N,this._buffer,F-8),t.writeUint32BE(H,this._buffer,F-4),l(this._temp,this._state,this._buffer,0,F),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)t.writeUint32BE(this._state[M],v,M*4);return this},d.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(v){r.wipe(v.state),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},d}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(d,v,E,A,N){for(;N>=64;){for(var H=v[0],F=v[1],M=v[2],K=v[3],V=v[4],ae=v[5],R=v[6],$=v[7],x=0;x<16;x++){var P=A+x*4;d[x]=t.readUint32BE(E,P)}for(var x=16;x<64;x++){var b=d[x-2],c=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=d[x-15];var m=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;d[x]=(c+d[x-7]|0)+(m+d[x-16]|0)}for(var x=0;x<64;x++){var c=(((V>>>6|V<<26)^(V>>>11|V<<21)^(V>>>25|V<<7))+(V&ae^~V&R)|0)+($+(a[x]+d[x]|0)|0)|0,m=((H>>>2|H<<32-2)^(H>>>13|H<<32-13)^(H>>>22|H<<32-22))+(H&F^H&M^F&M)|0;$=R,R=ae,ae=V,V=K+c|0,K=M,M=F,F=H,H=c+m|0}v[0]+=H,v[1]+=F,v[2]+=M,v[3]+=K,v[4]+=V,v[5]+=ae,v[6]+=R,v[7]+=$,A+=64,N-=64}return A}function p(d){var v=new s;v.update(d);var E=v.digest();return v.clean(),E}n.hash=p})(qo);var ru={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Cn,r=Ir;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(x){const P=new Float64Array(16);if(x)for(let b=0;b<x.length;b++)P[b]=x[b];return P}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(x){let P=1;for(let b=0;b<16;b++){let c=x[b]+P+65535;P=Math.floor(c/65536),x[b]=c-P*65536}x[0]+=P-1+37*(P-1)}function d(x,P,b){const c=~(b-1);for(let m=0;m<16;m++){const Y=c&(x[m]^P[m]);x[m]^=Y,P[m]^=Y}}function v(x,P){const b=s(),c=s();for(let m=0;m<16;m++)c[m]=P[m];p(c),p(c),p(c);for(let m=0;m<2;m++){b[0]=c[0]-65517;for(let G=1;G<15;G++)b[G]=c[G]-65535-(b[G-1]>>16&1),b[G-1]&=65535;b[15]=c[15]-32767-(b[14]>>16&1);const Y=b[15]>>16&1;b[14]&=65535,d(c,b,1-Y)}for(let m=0;m<16;m++)x[2*m]=c[m]&255,x[2*m+1]=c[m]>>8}function E(x,P){for(let b=0;b<16;b++)x[b]=P[2*b]+(P[2*b+1]<<8);x[15]&=32767}function A(x,P,b){for(let c=0;c<16;c++)x[c]=P[c]+b[c]}function N(x,P,b){for(let c=0;c<16;c++)x[c]=P[c]-b[c]}function H(x,P,b){let c,m,Y=0,G=0,ne=0,ce=0,de=0,_=0,I=0,ee=0,X=0,z=0,k=0,J=0,re=0,me=0,se=0,be=0,he=0,ye=0,q=0,j=0,C=0,h=0,O=0,oe=0,fe=0,xe=0,Be=0,Ve=0,$e=0,pt=0,gt=0,je=b[0],Oe=b[1],Ue=b[2],Le=b[3],qe=b[4],Pe=b[5],Fe=b[6],Ie=b[7],Te=b[8],ze=b[9],Ae=b[10],ke=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];c=P[0],Y+=c*je,G+=c*Oe,ne+=c*Ue,ce+=c*Le,de+=c*qe,_+=c*Pe,I+=c*Fe,ee+=c*Ie,X+=c*Te,z+=c*ze,k+=c*Ae,J+=c*ke,re+=c*We,me+=c*et,se+=c*tt,be+=c*Je,c=P[1],G+=c*je,ne+=c*Oe,ce+=c*Ue,de+=c*Le,_+=c*qe,I+=c*Pe,ee+=c*Fe,X+=c*Ie,z+=c*Te,k+=c*ze,J+=c*Ae,re+=c*ke,me+=c*We,se+=c*et,be+=c*tt,he+=c*Je,c=P[2],ne+=c*je,ce+=c*Oe,de+=c*Ue,_+=c*Le,I+=c*qe,ee+=c*Pe,X+=c*Fe,z+=c*Ie,k+=c*Te,J+=c*ze,re+=c*Ae,me+=c*ke,se+=c*We,be+=c*et,he+=c*tt,ye+=c*Je,c=P[3],ce+=c*je,de+=c*Oe,_+=c*Ue,I+=c*Le,ee+=c*qe,X+=c*Pe,z+=c*Fe,k+=c*Ie,J+=c*Te,re+=c*ze,me+=c*Ae,se+=c*ke,be+=c*We,he+=c*et,ye+=c*tt,q+=c*Je,c=P[4],de+=c*je,_+=c*Oe,I+=c*Ue,ee+=c*Le,X+=c*qe,z+=c*Pe,k+=c*Fe,J+=c*Ie,re+=c*Te,me+=c*ze,se+=c*Ae,be+=c*ke,he+=c*We,ye+=c*et,q+=c*tt,j+=c*Je,c=P[5],_+=c*je,I+=c*Oe,ee+=c*Ue,X+=c*Le,z+=c*qe,k+=c*Pe,J+=c*Fe,re+=c*Ie,me+=c*Te,se+=c*ze,be+=c*Ae,he+=c*ke,ye+=c*We,q+=c*et,j+=c*tt,C+=c*Je,c=P[6],I+=c*je,ee+=c*Oe,X+=c*Ue,z+=c*Le,k+=c*qe,J+=c*Pe,re+=c*Fe,me+=c*Ie,se+=c*Te,be+=c*ze,he+=c*Ae,ye+=c*ke,q+=c*We,j+=c*et,C+=c*tt,h+=c*Je,c=P[7],ee+=c*je,X+=c*Oe,z+=c*Ue,k+=c*Le,J+=c*qe,re+=c*Pe,me+=c*Fe,se+=c*Ie,be+=c*Te,he+=c*ze,ye+=c*Ae,q+=c*ke,j+=c*We,C+=c*et,h+=c*tt,O+=c*Je,c=P[8],X+=c*je,z+=c*Oe,k+=c*Ue,J+=c*Le,re+=c*qe,me+=c*Pe,se+=c*Fe,be+=c*Ie,he+=c*Te,ye+=c*ze,q+=c*Ae,j+=c*ke,C+=c*We,h+=c*et,O+=c*tt,oe+=c*Je,c=P[9],z+=c*je,k+=c*Oe,J+=c*Ue,re+=c*Le,me+=c*qe,se+=c*Pe,be+=c*Fe,he+=c*Ie,ye+=c*Te,q+=c*ze,j+=c*Ae,C+=c*ke,h+=c*We,O+=c*et,oe+=c*tt,fe+=c*Je,c=P[10],k+=c*je,J+=c*Oe,re+=c*Ue,me+=c*Le,se+=c*qe,be+=c*Pe,he+=c*Fe,ye+=c*Ie,q+=c*Te,j+=c*ze,C+=c*Ae,h+=c*ke,O+=c*We,oe+=c*et,fe+=c*tt,xe+=c*Je,c=P[11],J+=c*je,re+=c*Oe,me+=c*Ue,se+=c*Le,be+=c*qe,he+=c*Pe,ye+=c*Fe,q+=c*Ie,j+=c*Te,C+=c*ze,h+=c*Ae,O+=c*ke,oe+=c*We,fe+=c*et,xe+=c*tt,Be+=c*Je,c=P[12],re+=c*je,me+=c*Oe,se+=c*Ue,be+=c*Le,he+=c*qe,ye+=c*Pe,q+=c*Fe,j+=c*Ie,C+=c*Te,h+=c*ze,O+=c*Ae,oe+=c*ke,fe+=c*We,xe+=c*et,Be+=c*tt,Ve+=c*Je,c=P[13],me+=c*je,se+=c*Oe,be+=c*Ue,he+=c*Le,ye+=c*qe,q+=c*Pe,j+=c*Fe,C+=c*Ie,h+=c*Te,O+=c*ze,oe+=c*Ae,fe+=c*ke,xe+=c*We,Be+=c*et,Ve+=c*tt,$e+=c*Je,c=P[14],se+=c*je,be+=c*Oe,he+=c*Ue,ye+=c*Le,q+=c*qe,j+=c*Pe,C+=c*Fe,h+=c*Ie,O+=c*Te,oe+=c*ze,fe+=c*Ae,xe+=c*ke,Be+=c*We,Ve+=c*et,$e+=c*tt,pt+=c*Je,c=P[15],be+=c*je,he+=c*Oe,ye+=c*Ue,q+=c*Le,j+=c*qe,C+=c*Pe,h+=c*Fe,O+=c*Ie,oe+=c*Te,fe+=c*ze,xe+=c*Ae,Be+=c*ke,Ve+=c*We,$e+=c*et,pt+=c*tt,gt+=c*Je,Y+=38*he,G+=38*ye,ne+=38*q,ce+=38*j,de+=38*C,_+=38*h,I+=38*O,ee+=38*oe,X+=38*fe,z+=38*xe,k+=38*Be,J+=38*Ve,re+=38*$e,me+=38*pt,se+=38*gt,m=1,c=Y+m+65535,m=Math.floor(c/65536),Y=c-m*65536,c=G+m+65535,m=Math.floor(c/65536),G=c-m*65536,c=ne+m+65535,m=Math.floor(c/65536),ne=c-m*65536,c=ce+m+65535,m=Math.floor(c/65536),ce=c-m*65536,c=de+m+65535,m=Math.floor(c/65536),de=c-m*65536,c=_+m+65535,m=Math.floor(c/65536),_=c-m*65536,c=I+m+65535,m=Math.floor(c/65536),I=c-m*65536,c=ee+m+65535,m=Math.floor(c/65536),ee=c-m*65536,c=X+m+65535,m=Math.floor(c/65536),X=c-m*65536,c=z+m+65535,m=Math.floor(c/65536),z=c-m*65536,c=k+m+65535,m=Math.floor(c/65536),k=c-m*65536,c=J+m+65535,m=Math.floor(c/65536),J=c-m*65536,c=re+m+65535,m=Math.floor(c/65536),re=c-m*65536,c=me+m+65535,m=Math.floor(c/65536),me=c-m*65536,c=se+m+65535,m=Math.floor(c/65536),se=c-m*65536,c=be+m+65535,m=Math.floor(c/65536),be=c-m*65536,Y+=m-1+37*(m-1),m=1,c=Y+m+65535,m=Math.floor(c/65536),Y=c-m*65536,c=G+m+65535,m=Math.floor(c/65536),G=c-m*65536,c=ne+m+65535,m=Math.floor(c/65536),ne=c-m*65536,c=ce+m+65535,m=Math.floor(c/65536),ce=c-m*65536,c=de+m+65535,m=Math.floor(c/65536),de=c-m*65536,c=_+m+65535,m=Math.floor(c/65536),_=c-m*65536,c=I+m+65535,m=Math.floor(c/65536),I=c-m*65536,c=ee+m+65535,m=Math.floor(c/65536),ee=c-m*65536,c=X+m+65535,m=Math.floor(c/65536),X=c-m*65536,c=z+m+65535,m=Math.floor(c/65536),z=c-m*65536,c=k+m+65535,m=Math.floor(c/65536),k=c-m*65536,c=J+m+65535,m=Math.floor(c/65536),J=c-m*65536,c=re+m+65535,m=Math.floor(c/65536),re=c-m*65536,c=me+m+65535,m=Math.floor(c/65536),me=c-m*65536,c=se+m+65535,m=Math.floor(c/65536),se=c-m*65536,c=be+m+65535,m=Math.floor(c/65536),be=c-m*65536,Y+=m-1+37*(m-1),x[0]=Y,x[1]=G,x[2]=ne,x[3]=ce,x[4]=de,x[5]=_,x[6]=I,x[7]=ee,x[8]=X,x[9]=z,x[10]=k,x[11]=J,x[12]=re,x[13]=me,x[14]=se,x[15]=be}function F(x,P){H(x,P,P)}function M(x,P){const b=s();for(let c=0;c<16;c++)b[c]=P[c];for(let c=253;c>=0;c--)F(b,b),c!==2&&c!==4&&H(b,b,P);for(let c=0;c<16;c++)x[c]=b[c]}function K(x,P){const b=new Uint8Array(32),c=new Float64Array(80),m=s(),Y=s(),G=s(),ne=s(),ce=s(),de=s();for(let X=0;X<31;X++)b[X]=x[X];b[31]=x[31]&127|64,b[0]&=248,E(c,P);for(let X=0;X<16;X++)Y[X]=c[X];m[0]=ne[0]=1;for(let X=254;X>=0;--X){const z=b[X>>>3]>>>(X&7)&1;d(m,Y,z),d(G,ne,z),A(ce,m,G),N(m,m,G),A(G,Y,ne),N(Y,Y,ne),F(ne,ce),F(de,m),H(m,G,m),H(G,Y,ce),A(ce,m,G),N(m,m,G),F(Y,m),N(G,ne,de),H(m,G,l),A(m,m,ne),H(G,G,m),H(m,ne,de),H(ne,Y,c),F(Y,ce),d(m,Y,z),d(G,ne,z)}for(let X=0;X<16;X++)c[X+16]=m[X],c[X+32]=G[X],c[X+48]=Y[X],c[X+64]=ne[X];const _=c.subarray(32),I=c.subarray(16);M(_,_),H(I,I,_);const ee=new Uint8Array(32);return v(ee,I),ee}n.scalarMult=K;function V(x){return K(x,a)}n.scalarMultBase=V;function ae(x){if(x.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const P=new Uint8Array(x);return{publicKey:V(P),secretKey:P}}n.generateKeyPairFromSeed=ae;function R(x){const P=(0,t.randomBytes)(32,x),b=ae(P);return(0,r.wipe)(P),b}n.generateKeyPair=R;function $(x,P,b=!1){if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(P.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=K(x,P);if(b){let m=0;for(let Y=0;Y<c.length;Y++)m|=c[Y];if(m===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=$})(ru);function iu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function dd(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?iu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Hc(n,t){t||(t=n.reduce((a,l)=>a+l.length,0));const r=dd(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return iu(r)}function pd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const xl=pd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),vc=pd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=dd(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),gd={utf8:xl,"utf-8":xl,hex:wl.base16,latin1:vc,ascii:vc,binary:vc,...wl};function yr(n,t="utf8"){const r=gd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?iu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function ar(n,t="utf8"){const r=gd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Ol=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return n.concat(l||Array.prototype.slice.call(t))},$m=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Mm=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),jm=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),qm=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Hm=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Bm=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,zm=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Al=3,Km=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Bm]],Pl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Vm(n){return n?Tl(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Hm:typeof navigator<"u"?Tl(navigator.userAgent):Wm()}function km(n){return n!==""&&Km.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var l=a.exec(n);return!!l&&[s,l]},!1)}function Tl(n){var t=km(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new qm;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<Al&&(a=Ol(Ol([],a,!0),Ym(Al-a.length),!0)):a=[];var l=a.join("."),p=Gm(n),d=zm.exec(n);return d&&d[1]?new jm(r,l,p,d[1]):new $m(r,l,p)}function Gm(n){for(var t=0,r=Pl.length;t<r;t++){var s=Pl[t],a=s[0],l=s[1],p=l.exec(n);if(p)return a}return null}function Wm(){var n=typeof process<"u"&&process.version;return n?new Mm(process.version.slice(1)):null}function Ym(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var Se={},yc={},Zn={},Cl;function Jm(){if(Cl)return Zn;Cl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Zn.delay=n,Zn}var Gi={},_c={},Wi={},Nl;function Xm(){return Nl||(Nl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ONE_THOUSAND=Wi.ONE_HUNDRED=void 0,Wi.ONE_HUNDRED=100,Wi.ONE_THOUSAND=1e3),Wi}var mc={},Rl;function Zm(){return Rl||(Rl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(mc)),mc}var Ul;function vd(){return Ul||(Ul=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(Xm(),n),t.__exportStar(Zm(),n)}(_c)),_c}var Ll;function Qm(){if(Ll)return Gi;Ll=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.fromMiliseconds=Gi.toMiliseconds=void 0;const n=vd();function t(s){return s*n.ONE_THOUSAND}Gi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Gi.fromMiliseconds=r,Gi}var Fl;function eb(){return Fl||(Fl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(Jm(),n),t.__exportStar(Qm(),n)}(yc)),yc}var On={},Dl;function tb(){if(Dl)return On;Dl=1,Object.defineProperty(On,"__esModule",{value:!0}),On.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return On.Watch=n,On.default=n,On}var bc={},Qn={},$l;function rb(){if($l)return Qn;$l=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.IWatch=void 0;class n{}return Qn.IWatch=n,Qn}var Ml;function ib(){return Ml||(Ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),$r.__exportStar(rb(),n)}(bc)),bc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(eb(),n),t.__exportStar(tb(),n),t.__exportStar(ib(),n),t.__exportStar(vd(),n)})(Se);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=_d=lt.getLocation=lt.getLocationOrThrow=nu=lt.getNavigator=lt.getNavigatorOrThrow=yd=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function en(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}lt.getFromWindow=en;function Nn(n){const t=en(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}lt.getFromWindowOrThrow=Nn;function nb(){return Nn("document")}lt.getDocumentOrThrow=nb;function sb(){return en("document")}var yd=lt.getDocument=sb;function ob(){return Nn("navigator")}lt.getNavigatorOrThrow=ob;function ab(){return en("navigator")}var nu=lt.getNavigator=ab;function cb(){return Nn("location")}lt.getLocationOrThrow=cb;function ub(){return en("location")}var _d=lt.getLocation=ub;function hb(){return Nn("crypto")}lt.getCryptoOrThrow=hb;function lb(){return en("crypto")}lt.getCrypto=lb;function fb(){return Nn("localStorage")}lt.getLocalStorageOrThrow=fb;function db(){return en("localStorage")}lt.getLocalStorage=db;var su={};Object.defineProperty(su,"__esModule",{value:!0});var md=su.getWindowMetadata=void 0;const jl=lt;function pb(){let n,t;try{n=jl.getDocumentOrThrow(),t=jl.getLocationOrThrow()}catch{return null}function r(){const N=n.getElementsByTagName("link"),H=[];for(let F=0;F<N.length;F++){const M=N[F],K=M.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const V=M.getAttribute("href");if(V)if(V.toLowerCase().indexOf("https:")===-1&&V.toLowerCase().indexOf("http:")===-1&&V.indexOf("//")!==0){let ae=t.protocol+"//"+t.host;if(V.indexOf("/")===0)ae+=V;else{const R=t.pathname.split("/");R.pop();const $=R.join("/");ae+=$+"/"+V}H.push(ae)}else if(V.indexOf("//")===0){const ae=t.protocol+V;H.push(ae)}else H.push(V)}}return H}function s(...N){const H=n.getElementsByTagName("meta");for(let F=0;F<H.length;F++){const M=H[F],K=["itemprop","property","name"].map(V=>M.getAttribute(V)).filter(V=>V?N.includes(V):!1);if(K.length&&K){const V=M.getAttribute("content");if(V)return V}}return""}function a(){let N=s("name","og:site_name","og:title","twitter:title");return N||(N=n.title),N}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),d=l(),v=t.origin,E=r();return{description:d,url:v,icons:E,name:p}}md=su.getWindowMetadata=pb;var hs={},gb=n=>encodeURIComponent(n).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),bd="%[a-f0-9]{2}",ql=new RegExp("("+bd+")|([^%]+?)","gi"),Hl=new RegExp("("+bd+")+","gi");function Bc(n,t){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;t=t||1;var r=n.slice(0,t),s=n.slice(t);return Array.prototype.concat.call([],Bc(r),Bc(s))}function vb(n){try{return decodeURIComponent(n)}catch{for(var t=n.match(ql)||[],r=1;r<t.length;r++)n=Bc(t,r).join(""),t=n.match(ql)||[];return n}}function yb(n){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=Hl.exec(n);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var s=vb(r[0]);s!==r[0]&&(t[r[0]]=s)}r=Hl.exec(n)}t["%C2"]="�";for(var a=Object.keys(t),l=0;l<a.length;l++){var p=a[l];n=n.replace(new RegExp(p,"g"),t[p])}return n}var _b=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return yb(n)}},mb=(n,t)=>{if(!(typeof n=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[n];const r=n.indexOf(t);return r===-1?[n]:[n.slice(0,r),n.slice(r+t.length)]},bb=function(n,t){for(var r={},s=Object.keys(n),a=Array.isArray(t),l=0;l<s.length;l++){var p=s[l],d=n[p];(a?t.indexOf(p)!==-1:t(p,d,n))&&(r[p]=d)}return r};(function(n){const t=gb,r=_b,s=mb,a=bb,l=R=>R==null,p=Symbol("encodeFragmentIdentifier");function d(R){switch(R.arrayFormat){case"index":return $=>(x,P)=>{const b=x.length;return P===void 0||R.skipNull&&P===null||R.skipEmptyString&&P===""?x:P===null?[...x,[A($,R),"[",b,"]"].join("")]:[...x,[A($,R),"[",A(b,R),"]=",A(P,R)].join("")]};case"bracket":return $=>(x,P)=>P===void 0||R.skipNull&&P===null||R.skipEmptyString&&P===""?x:P===null?[...x,[A($,R),"[]"].join("")]:[...x,[A($,R),"[]=",A(P,R)].join("")];case"colon-list-separator":return $=>(x,P)=>P===void 0||R.skipNull&&P===null||R.skipEmptyString&&P===""?x:P===null?[...x,[A($,R),":list="].join("")]:[...x,[A($,R),":list=",A(P,R)].join("")];case"comma":case"separator":case"bracket-separator":{const $=R.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(P,b)=>b===void 0||R.skipNull&&b===null||R.skipEmptyString&&b===""?P:(b=b===null?"":b,P.length===0?[[A(x,R),$,A(b,R)].join("")]:[[P,A(b,R)].join(R.arrayFormatSeparator)])}default:return $=>(x,P)=>P===void 0||R.skipNull&&P===null||R.skipEmptyString&&P===""?x:P===null?[...x,A($,R)]:[...x,[A($,R),"=",A(P,R)].join("")]}}function v(R){let $;switch(R.arrayFormat){case"index":return(x,P,b)=>{if($=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!$){b[x]=P;return}b[x]===void 0&&(b[x]={}),b[x][$[1]]=P};case"bracket":return(x,P,b)=>{if($=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!$){b[x]=P;return}if(b[x]===void 0){b[x]=[P];return}b[x]=[].concat(b[x],P)};case"colon-list-separator":return(x,P,b)=>{if($=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!$){b[x]=P;return}if(b[x]===void 0){b[x]=[P];return}b[x]=[].concat(b[x],P)};case"comma":case"separator":return(x,P,b)=>{const c=typeof P=="string"&&P.includes(R.arrayFormatSeparator),m=typeof P=="string"&&!c&&N(P,R).includes(R.arrayFormatSeparator);P=m?N(P,R):P;const Y=c||m?P.split(R.arrayFormatSeparator).map(G=>N(G,R)):P===null?P:N(P,R);b[x]=Y};case"bracket-separator":return(x,P,b)=>{const c=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!c){b[x]=P&&N(P,R);return}const m=P===null?[]:P.split(R.arrayFormatSeparator).map(Y=>N(Y,R));if(b[x]===void 0){b[x]=m;return}b[x]=[].concat(b[x],m)};default:return(x,P,b)=>{if(b[x]===void 0){b[x]=P;return}b[x]=[].concat(b[x],P)}}}function E(R){if(typeof R!="string"||R.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function A(R,$){return $.encode?$.strict?t(R):encodeURIComponent(R):R}function N(R,$){return $.decode?r(R):R}function H(R){return Array.isArray(R)?R.sort():typeof R=="object"?H(Object.keys(R)).sort(($,x)=>Number($)-Number(x)).map($=>R[$]):R}function F(R){const $=R.indexOf("#");return $!==-1&&(R=R.slice(0,$)),R}function M(R){let $="";const x=R.indexOf("#");return x!==-1&&($=R.slice(x)),$}function K(R){R=F(R);const $=R.indexOf("?");return $===-1?"":R.slice($+1)}function V(R,$){return $.parseNumbers&&!Number.isNaN(Number(R))&&typeof R=="string"&&R.trim()!==""?R=Number(R):$.parseBooleans&&R!==null&&(R.toLowerCase()==="true"||R.toLowerCase()==="false")&&(R=R.toLowerCase()==="true"),R}function ae(R,$){$=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},$),E($.arrayFormatSeparator);const x=v($),P=Object.create(null);if(typeof R!="string"||(R=R.trim().replace(/^[?#&]/,""),!R))return P;for(const b of R.split("&")){if(b==="")continue;let[c,m]=s($.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes($.arrayFormat)?m:N(m,$),x(N(c,$),m,P)}for(const b of Object.keys(P)){const c=P[b];if(typeof c=="object"&&c!==null)for(const m of Object.keys(c))c[m]=V(c[m],$);else P[b]=V(c,$)}return $.sort===!1?P:($.sort===!0?Object.keys(P).sort():Object.keys(P).sort($.sort)).reduce((b,c)=>{const m=P[c];return Boolean(m)&&typeof m=="object"&&!Array.isArray(m)?b[c]=H(m):b[c]=m,b},Object.create(null))}n.extract=K,n.parse=ae,n.stringify=(R,$)=>{if(!R)return"";$=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},$),E($.arrayFormatSeparator);const x=m=>$.skipNull&&l(R[m])||$.skipEmptyString&&R[m]==="",P=d($),b={};for(const m of Object.keys(R))x(m)||(b[m]=R[m]);const c=Object.keys(b);return $.sort!==!1&&c.sort($.sort),c.map(m=>{const Y=R[m];return Y===void 0?"":Y===null?A(m,$):Array.isArray(Y)?Y.length===0&&$.arrayFormat==="bracket-separator"?A(m,$)+"[]":Y.reduce(P(m),[]).join("&"):A(m,$)+"="+A(Y,$)}).filter(m=>m.length>0).join("&")},n.parseUrl=(R,$)=>{$=Object.assign({decode:!0},$);const[x,P]=s(R,"#");return Object.assign({url:x.split("?")[0]||"",query:ae(K(R),$)},$&&$.parseFragmentIdentifier&&P?{fragmentIdentifier:N(P,$)}:{})},n.stringifyUrl=(R,$)=>{$=Object.assign({encode:!0,strict:!0,[p]:!0},$);const x=F(R.url).split("?")[0]||"",P=n.extract(R.url),b=n.parse(P,{sort:!1}),c=Object.assign(b,R.query);let m=n.stringify(c,$);m&&(m=`?${m}`);let Y=M(R.url);return R.fragmentIdentifier&&(Y=`#${$[p]?A(R.fragmentIdentifier,$):R.fragmentIdentifier}`),`${x}${m}${Y}`},n.pick=(R,$,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[p]:!1},x);const{url:P,query:b,fragmentIdentifier:c}=n.parseUrl(R,x);return n.stringifyUrl({url:P,query:a(b,$),fragmentIdentifier:c},x)},n.exclude=(R,$,x)=>{const P=Array.isArray($)?b=>!$.includes(b):(b,c)=>!$(b,c);return n.pick(R,P,x)}})(hs);const wb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Eb(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function wd(n,t){return n.includes(":")?[n]:t.chains||[]}const Ed="base10",or="base16",zc="base64pad",ou="utf8",Sd=0,tn=1,Sb=0,Bl=1,Kc=12,au=32;function Ib(){const n=ru.generateKeyPair();return{privateKey:ar(n.secretKey,or),publicKey:ar(n.publicKey,or)}}function Vc(){const n=Cn.randomBytes(au);return ar(n,or)}function xb(n,t){const r=ru.sharedKey(yr(n,or),yr(t,or)),s=new Cm(qo.SHA256,r).expand(au);return ar(s,or)}function Ob(n){const t=qo.hash(yr(n,or));return ar(t,or)}function Qi(n){const t=qo.hash(yr(n,ou));return ar(t,or)}function Ab(n){return yr(`${n}`,Ed)}function ds(n){return Number(ar(n,Ed))}function Pb(n){const t=Ab(typeof n.type<"u"?n.type:Sd);if(ds(t)===tn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?yr(n.senderPublicKey,or):void 0,s=typeof n.iv<"u"?yr(n.iv,or):Cn.randomBytes(Kc),a=new eu.ChaCha20Poly1305(yr(n.symKey,or)).seal(s,yr(n.message,ou));return Cb({type:t,sealed:a,iv:s,senderPublicKey:r})}function Tb(n){const t=new eu.ChaCha20Poly1305(yr(n.symKey,or)),{sealed:r,iv:s}=Co(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return ar(a,ou)}function Cb(n){if(ds(n.type)===tn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ar(Hc([n.type,n.senderPublicKey,n.iv,n.sealed]),zc)}return ar(Hc([n.type,n.iv,n.sealed]),zc)}function Co(n){const t=yr(n,zc),r=t.slice(Sb,Bl),s=Bl;if(ds(r)===tn){const d=s+au,v=d+Kc,E=t.slice(s,d),A=t.slice(d,v),N=t.slice(v);return{type:r,sealed:N,iv:A,senderPublicKey:E}}const a=s+Kc,l=t.slice(s,a),p=t.slice(a);return{type:r,sealed:p,iv:l}}function Nb(n,t){const r=Co(n);return Id({type:ds(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ar(r.senderPublicKey,or):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Id(n){const t=(n==null?void 0:n.type)||Sd;if(t===tn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function zl(n){return n.type===tn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Rb=Object.defineProperty,Kl=Object.getOwnPropertySymbols,Ub=Object.prototype.hasOwnProperty,Lb=Object.prototype.propertyIsEnumerable,Vl=(n,t,r)=>t in n?Rb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,kl=(n,t)=>{for(var r in t||(t={}))Ub.call(t,r)&&Vl(n,r,t[r]);if(Kl)for(var r of Kl(t))Lb.call(t,r)&&Vl(n,r,t[r]);return n};const Fb="ReactNative",Xi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Db="js";function cu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function xd(){return!yd()&&!!nu()&&navigator.product===Fb}function uu(){return!cu()&&!!nu()}function Od(){return xd()?Xi.reactNative:cu()?Xi.node:uu()?Xi.browser:Xi.unknown}function $b(n,t){let r=hs.parse(n);return r=kl(kl({},r),t),n=hs.stringify(r),n}function Mb(){return md()||{name:"",description:"",url:"",icons:[""]}}function jb(){const n=Vm();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function qb(){var n;const t=Od();return t===Xi.browser?[t,((n=_d())==null?void 0:n.host)||"unknown"].join(":"):t}function Hb(n,t,r){const s=jb(),a=qb();return[[n,t].join("-"),[Db,r].join("-"),s,a].join("/")}function Bb({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p}){const d=r.split("?"),v=Hb(n,t,s),E={auth:a,ua:v,projectId:l,useOnCloseEvent:p||void 0},A=$b(d[1]||"",E);return d[0]+"?"+A}function Zi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Ad(n){return Object.fromEntries(n.entries())}function Pd(n){return new Map(Object.entries(n))}function An(n=Se.FIVE_MINUTES,t){const r=Se.toMiliseconds(n||Se.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,d)=>{l=setTimeout(()=>{d(new Error(t))},r),s=p,a=d})}}function No(n,t,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),t);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function Td(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function zb(n){return Td("topic",n)}function Kb(n){return Td("id",n)}function Cd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Kr(n,t){return Se.fromMiliseconds((t||Date.now())+Se.toMiliseconds(n))}function Pi(n){return Date.now()>=Se.toMiliseconds(n)}function qt(n,t){return`${n}${t?`:${t}`:""}`}function wc(n=[],t=[]){return[...new Set([...n,...t])]}const Vb="irn";function kc(n){return(n==null?void 0:n.relay)||{protocol:Vb}}function xo(n){const t=wb[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var kb=Object.defineProperty,Gl=Object.getOwnPropertySymbols,Gb=Object.prototype.hasOwnProperty,Wb=Object.prototype.propertyIsEnumerable,Wl=(n,t,r)=>t in n?kb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Yb=(n,t)=>{for(var r in t||(t={}))Gb.call(t,r)&&Wl(n,r,t[r]);if(Gl)for(var r of Gl(t))Wb.call(t,r)&&Wl(n,r,t[r]);return n};function Jb(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function Xb(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=hs.parse(l);return{protocol:s,topic:a[0],version:parseInt(a[1],10),symKey:p.symKey,relay:Jb(p)}}function Zb(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+t+a;n[a]&&(s[l]=n[a])}),s}function Qb(n){return`${n.protocol}:${n.topic}@${n.version}?`+hs.stringify(Yb({symKey:n.symKey},Zb(n.relay)))}function Rn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function ew(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Rn(r.accounts))}),t}function tw(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function rw(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.events)}),r}function iw(n,t){const r=Ao(n,t);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function Nd(n){return n.includes(":")}function Oo(n){return Nd(n)?n.split(":")[0]:n}const nw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},sw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function le(n,t){const{message:r,code:s}=sw[n];return{message:t?`${r} ${t}`:r,code:s}}function Rt(n,t){const{message:r,code:s}=nw[n];return{message:t?`${r} ${t}`:r,code:s}}function vi(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Tn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function sr(n){return typeof n>"u"}function kt(n,t){return t&&sr(n)?!0:typeof n=="string"&&Boolean(n.trim().length)}function hu(n,t){return t&&sr(n)?!0:typeof n=="number"&&!isNaN(n)}function ow(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return Zi(a,s)?(s.forEach(p=>{const{accounts:d,methods:v,events:E}=n.namespaces[p],A=Rn(d),N=r[p];(!Zi(wd(p,N),A)||!Zi(N.methods,v)||!Zi(N.events,E))&&(l=!1)}),l):!1}function lu(n){return kt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function aw(n){if(kt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&lu(r)}}return!1}function cw(n){if(kt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function uw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function hw(n){return n==null?void 0:n.topic}function lw(n,t){let r=null;return kt(n==null?void 0:n.publicKey,!1)||(r=le("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Yl(n){let t=!0;return vi(n)?n.length&&(t=n.every(r=>kt(r,!1))):t=!1,t}function fw(n,t,r){let s=null;return vi(t)?t.forEach(a=>{s||(!lu(a)||!a.includes(n))&&(s=Rt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):s=Rt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function dw(n,t){let r=null;return Object.entries(n).forEach(([s,a])=>{if(r)return;const l=fw(s,wd(s,a),`${t} requiredNamespace`);l&&(r=l)}),r}function pw(n,t){let r=null;return vi(n)?n.forEach(s=>{r||aw(s)||(r=Rt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Rt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function gw(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=pw(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function vw(n,t){let r=null;return Yl(n==null?void 0:n.methods)?Yl(n==null?void 0:n.events)||(r=Rt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Rt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Rd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=vw(s,`${t}, namespace`);a&&(r=a)}),r}function yw(n,t,r){let s=null;if(n&&Tn(n)){const a=Rd(n,t);a&&(s=a);const l=dw(n,t);l&&(s=l)}else s=le("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ao(n,t){let r=null;if(n&&Tn(n)){const s=Rd(n,t);s&&(r=s);const a=gw(n,t);a&&(r=a)}else r=le("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Ud(n){return kt(n.protocol,!0)}function _w(n,t){let r=!1;return t&&!n?r=!0:n&&vi(n)&&n.length&&n.forEach(s=>{r=Ud(s)}),r}function mw(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function bw(n){return!(!n||typeof n!="object"||!n.code||!hu(n.code,!1)||!n.message||!kt(n.message,!1))}function ww(n){return!(sr(n)||!kt(n.method,!1))}function Ew(n){return!(sr(n)||sr(n.result)&&sr(n.error)||!hu(n.id,!1)||!kt(n.jsonrpc,!1))}function Sw(n){return!(sr(n)||!kt(n.name,!1))}function Jl(n,t){return!(!lu(t)||!ew(n).includes(t))}function Iw(n,t,r){return kt(r,!1)?tw(n,t).includes(r):!1}function xw(n,t,r){return kt(r,!1)?rw(n,t).includes(r):!1}function Xl(n,t,r){let s=null;const a=Ow(n),l=Aw(t),p=Object.keys(a),d=Object.keys(l),v=Zl(Object.keys(n)),E=Zl(Object.keys(t)),A=v.filter(N=>!E.includes(N));return A.length&&(s=le("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${A.toString()}
      Received: ${Object.keys(t).toString()}`)),Zi(p,d)||(s=le("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${d.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const H=Rn(t[N].accounts);H.includes(N)||(s=le("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${H.toString()}`))}),p.forEach(N=>{s||(Zi(a[N].methods,l[N].methods)?Zi(a[N].events,l[N].events)||(s=le("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${N}`)):s=le("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function Ow(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Zl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function Aw(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Rn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function Pw(n,t){return hu(n,!1)&&n<=t.max&&n>=t.min}var Ho={},ps={};Object.defineProperty(ps,"__esModule",{value:!0});function Tw(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}ps.safeJsonParse=Tw;function Cw(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}ps.safeJsonStringify=Cw;var Ro={},Ec={get exports(){return Ro},set exports(n){Ro=n}},Ql;function Nw(){return Ql||(Ql=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof vr<"u"&&vr.localStorage?Ec.exports=vr.localStorage:typeof window<"u"&&window.localStorage?Ec.exports=window.localStorage:Ec.exports=new t}()),Ro}var Sc={},es={},ef;function Rw(){if(ef)return es;ef=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IKeyValueStorage=void 0;class n{}return es.IKeyValueStorage=n,es}var ts={},tf;function Uw(){if(tf)return ts;tf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.parseEntry=void 0;const n=ps;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ts.parseEntry=t,ts}var rf;function Lw(){return rf||(rf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(Rw(),n),t.__exportStar(Uw(),n)}(Sc)),Sc}Object.defineProperty(Ho,"__esModule",{value:!0});Ho.KeyValueStorage=void 0;const Pn=$r,nf=ps,Fw=Pn.__importDefault(Nw()),Dw=Lw();class Ld{constructor(){this.localStorage=Fw.default}getKeys(){return Pn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Pn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Dw.parseEntry)})}getItem(t){return Pn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return nf.safeJsonParse(r)})}setItem(t,r){return Pn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,nf.safeJsonStringify(r))})}removeItem(t){return Pn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Ho.KeyValueStorage=Ld;var $w=Ho.default=Ld,gs={},rs={},Ic={},is={};let rn=class{};const Mw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:rn},Symbol.toStringTag,{value:"Module"})),jw=k_(Mw);var sf;function qw(){if(sf)return is;sf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IHeartBeat=void 0;const n=jw;class t extends n.IEvents{constructor(s){super()}}return is.IHeartBeat=t,is}var of;function Fd(){return of||(of=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),$r.__exportStar(qw(),n)}(Ic)),Ic}var xc={},Yi={},af;function Hw(){if(af)return Yi;af=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HEARTBEAT_EVENTS=Yi.HEARTBEAT_INTERVAL=void 0;const n=Se;return Yi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Yi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yi}var cf;function Dd(){return cf||(cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),$r.__exportStar(Hw(),n)}(xc)),xc}var uf;function Bw(){if(uf)return rs;uf=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.HeartBeat=void 0;const n=$r,t=cr,r=Se,s=Fd(),a=Dd();class l extends s.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||a.HEARTBEAT_INTERVAL}static init(d){return n.__awaiter(this,void 0,void 0,function*(){const v=new l(d);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,v){this.events.on(d,v)}once(d,v){this.events.once(d,v)}off(d,v){this.events.off(d,v)}removeListener(d,v){this.events.removeListener(d,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return rs.HeartBeat=l,rs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(Bw(),n),t.__exportStar(Fd(),n),t.__exportStar(Dd(),n)})(gs);var Qe={},Oc,hf;function zw(){if(hf)return Oc;hf=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Oc=t;function t(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var d=s.length+p;if(d===1)return r;var v=new Array(d);v[0]=l(r);for(var E=1;E<d;E++)v[E]=l(s[E]);return v.join(" ")}if(typeof r!="string")return r;var A=s.length;if(A===0)return r;for(var N="",H=1-p,F=-1,M=r&&r.length||0,K=0;K<M;){if(r.charCodeAt(K)===37&&K+1<M){switch(F=F>-1?F:0,r.charCodeAt(K+1)){case 100:case 102:if(H>=A||s[H]==null)break;F<K&&(N+=r.slice(F,K)),N+=Number(s[H]),F=K+2,K++;break;case 105:if(H>=A||s[H]==null)break;F<K&&(N+=r.slice(F,K)),N+=Math.floor(Number(s[H])),F=K+2,K++;break;case 79:case 111:case 106:if(H>=A||s[H]===void 0)break;F<K&&(N+=r.slice(F,K));var V=typeof s[H];if(V==="string"){N+="'"+s[H]+"'",F=K+2,K++;break}if(V==="function"){N+=s[H].name||"<anonymous>",F=K+2,K++;break}N+=l(s[H]),F=K+2,K++;break;case 115:if(H>=A)break;F<K&&(N+=r.slice(F,K)),N+=String(s[H]),F=K+2,K++;break;case 37:F<K&&(N+=r.slice(F,K)),N+="%",F=K+2,K++,H--;break}++H}++K}return F===-1?r:(F<M&&(N+=r.slice(F)),N)}return Oc}var Ac,lf;function Kw(){if(lf)return Ac;lf=1;const n=zw();Ac=a;const t=P().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:M,res:M,err:H};function s(b,c){return Array.isArray(b)?b.filter(function(Y){return Y!=="!stdSerializers.err"}):b===!0?Object.keys(c):!1}function a(b){b=b||{},b.browser=b.browser||{};const c=b.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const m=b.browser.write||t;b.browser.write&&(b.browser.asObject=!0);const Y=b.serializers||{},G=s(b.browser.serialize,Y);let ne=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ne=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),b.enabled===!1&&(b.level="silent");const de=b.level||"info",_=Object.create(m);_.log||(_.log=V),Object.defineProperty(_,"levelVal",{get:ee}),Object.defineProperty(_,"level",{get:X,set:z});const I={transmit:c,serialize:G,asObject:b.browser.asObject,levels:ce,timestamp:F(b)};_.levels=a.levels,_.level=de,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=V,_.serializers=Y,_._serialize=G,_._stdErrSerialize=ne,_.child=k,c&&(_._logEvent=N());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function z(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,l(I,_,"error","log"),l(I,_,"fatal","error"),l(I,_,"warn","error"),l(I,_,"info","log"),l(I,_,"debug","log"),l(I,_,"trace","log")}function k(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},G&&J.serializers&&(re.serializers=J.serializers);const me=re.serializers;if(G&&me){var se=Object.assign({},Y,me),be=b.browser.serialize===!0?Object.keys(se):G;delete J.serializers,v([J],be,se,this._stdErrSerialize)}function he(ye){this._childLevel=(ye._childLevel|0)+1,this.error=E(ye,J,"error"),this.fatal=E(ye,J,"fatal"),this.warn=E(ye,J,"warn"),this.info=E(ye,J,"info"),this.debug=E(ye,J,"debug"),this.trace=E(ye,J,"trace"),se&&(this.serializers=se,this._serialize=be),c&&(this._logEvent=N([].concat(ye._logEvent.bindings,J)))}return he.prototype=this,new he(this)}return _}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ae,epochTime:R,unixTime:$,isoTime:x});function l(b,c,m,Y){const G=Object.getPrototypeOf(c);c[m]=c.levelVal>c.levels.values[m]?V:G[m]?G[m]:t[m]||t[Y]||V,p(b,c,m)}function p(b,c,m){!b.transmit&&c[m]===V||(c[m]=function(Y){return function(){const ne=b.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var _=0;_<ce.length;_++)ce[_]=arguments[_];if(b.serialize&&!b.asObject&&v(ce,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?Y.call(de,d(this,m,ce,ne)):Y.apply(de,ce),b.transmit){const I=b.transmit.level||c.level,ee=a.levels.values[I],X=a.levels.values[m];if(X<ee)return;A(this,{ts:ne,methodLevel:m,methodValue:X,transmitLevel:I,transmitValue:a.levels.values[b.transmit.level||c.level],send:b.transmit.send,val:c.levelVal},ce)}}}(c[m]))}function d(b,c,m,Y){b._serialize&&v(m,b._serialize,b.serializers,b._stdErrSerialize);const G=m.slice();let ne=G[0];const ce={};Y&&(ce.time=Y),ce.level=a.levels.values[c];let de=(b._childLevel|0)+1;if(de<1&&(de=1),ne!==null&&typeof ne=="object"){for(;de--&&typeof G[0]=="object";)Object.assign(ce,G.shift());ne=G.length?n(G.shift(),G):void 0}else typeof ne=="string"&&(ne=n(G.shift(),G));return ne!==void 0&&(ce.msg=ne),ce}function v(b,c,m,Y){for(const G in b)if(Y&&b[G]instanceof Error)b[G]=a.stdSerializers.err(b[G]);else if(typeof b[G]=="object"&&!Array.isArray(b[G]))for(const ne in b[G])c&&c.indexOf(ne)>-1&&ne in m&&(b[G][ne]=m[ne](b[G][ne]))}function E(b,c,m){return function(){const Y=new Array(1+arguments.length);Y[0]=c;for(var G=1;G<Y.length;G++)Y[G]=arguments[G-1];return b[m].apply(this,Y)}}function A(b,c,m){const Y=c.send,G=c.ts,ne=c.methodLevel,ce=c.methodValue,de=c.val,_=b._logEvent.bindings;v(m,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=G,b._logEvent.messages=m.filter(function(I){return _.indexOf(I)===-1}),b._logEvent.level.label=ne,b._logEvent.level.value=ce,Y(ne,b._logEvent,de),b._logEvent=N(_)}function N(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function H(b){const c={type:b.constructor.name,msg:b.message,stack:b.stack};for(const m in b)c[m]===void 0&&(c[m]=b[m]);return c}function F(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?ae:R}function M(){return{}}function K(b){return b}function V(){}function ae(){return!1}function R(){return Date.now()}function $(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function P(){function b(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Ac}var Ji={},ff;function $d(){return ff||(ff=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.PINO_CUSTOM_CONTEXT_KEY=Ji.PINO_LOGGER_DEFAULTS=void 0,Ji.PINO_LOGGER_DEFAULTS={level:"info"},Ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ji}var nr={},df;function Vw(){if(df)return nr;df=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const n=$d();function t(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||n.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=t;function r(d,v=n.PINO_CUSTOM_CONTEXT_KEY){return d[v]||""}nr.getBrowserLoggerContext=r;function s(d,v,E=n.PINO_CUSTOM_CONTEXT_KEY){return d[E]=v,d}nr.setBrowserLoggerContext=s;function a(d,v=n.PINO_CUSTOM_CONTEXT_KEY){let E="";return typeof d.bindings>"u"?E=r(d,v):E=d.bindings().context||"",E}nr.getLoggerContext=a;function l(d,v,E=n.PINO_CUSTOM_CONTEXT_KEY){const A=a(d,E);return A.trim()?`${A}/${v}`:v}nr.formatChildLoggerContext=l;function p(d,v,E=n.PINO_CUSTOM_CONTEXT_KEY){const A=l(d,v,E),N=d.child({context:A});return s(N,A,E)}return nr.generateChildLogger=p,nr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=$r,r=t.__importDefault(Kw());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar($d(),n),t.__exportStar(Vw(),n)})(Qe);class kw extends rn{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Gw extends rn{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Ww{constructor(t,r){this.logger=t,this.core=r}}let Yw=class extends rn{constructor(t,r){super(),this.relayer=t,this.logger=r}};class Jw extends rn{constructor(t){super()}}let Xw=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class Zw extends rn{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Qw=class extends rn{constructor(t,r){super(),this.core=t,this.logger=r}},eE=class{constructor(t,r){this.projectId=t,this.logger=r}},tE=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}};class rE{constructor(t){this.client=t}}const iE=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),nE=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function fu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return nE(n)}catch{return n}}function ls(n){return typeof n=="string"?n:iE(n)||""}var du={},Md={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=De,r=Ir;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(v,E){if(E===void 0&&(E=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var A=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&E>0;)this._buffer[this._bufferLength++]=v[A++],E--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(A=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,A,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=v[A++],E--;return this},d.prototype.finish=function(v){if(!this._finished){var E=this._bytesHashed,A=this._bufferLength,N=E/536870912|0,H=E<<3,F=E%128<112?128:256;this._buffer[A]=128;for(var M=A+1;M<F-8;M++)this._buffer[M]=0;t.writeUint32BE(N,this._buffer,F-8),t.writeUint32BE(H,this._buffer,F-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,F),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)t.writeUint32BE(this._stateHi[M],v,M*8),t.writeUint32BE(this._stateLo[M],v,M*8+4);return this},d.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},d}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(d,v,E,A,N,H,F){for(var M=E[0],K=E[1],V=E[2],ae=E[3],R=E[4],$=E[5],x=E[6],P=E[7],b=A[0],c=A[1],m=A[2],Y=A[3],G=A[4],ne=A[5],ce=A[6],de=A[7],_,I,ee,X,z,k,J,re;F>=128;){for(var me=0;me<16;me++){var se=8*me+H;d[me]=t.readUint32BE(N,se),v[me]=t.readUint32BE(N,se+4)}for(var me=0;me<80;me++){var be=M,he=K,ye=V,q=ae,j=R,C=$,h=x,O=P,oe=b,fe=c,xe=m,Be=Y,Ve=G,$e=ne,pt=ce,gt=de;if(_=P,I=de,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=(R>>>14|G<<32-14)^(R>>>18|G<<32-18)^(G>>>41-32|R<<32-(41-32)),I=(G>>>14|R<<32-14)^(G>>>18|R<<32-18)^(R>>>41-32|G<<32-(41-32)),z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,_=R&$^~R&x,I=G&ne^~G&ce,z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,_=a[me*2],I=a[me*2+1],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,_=d[me%16],I=v[me%16],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,ee=J&65535|re<<16,X=z&65535|k<<16,_=ee,I=X,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=(M>>>28|b<<32-28)^(b>>>34-32|M<<32-(34-32))^(b>>>39-32|M<<32-(39-32)),I=(b>>>28|M<<32-28)^(M>>>34-32|b<<32-(34-32))^(M>>>39-32|b<<32-(39-32)),z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,_=M&K^M&V^K&V,I=b&c^b&m^c&m,z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,O=J&65535|re<<16,gt=z&65535|k<<16,_=q,I=Be,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=ee,I=X,z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,q=J&65535|re<<16,Be=z&65535|k<<16,K=be,V=he,ae=ye,R=q,$=j,x=C,P=h,M=O,c=oe,m=fe,Y=xe,G=Be,ne=Ve,ce=$e,de=pt,b=gt,me%16===15)for(var se=0;se<16;se++)_=d[se],I=v[se],z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=d[(se+9)%16],I=v[(se+9)%16],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,ee=d[(se+1)%16],X=v[(se+1)%16],_=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,I=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,ee=d[(se+14)%16],X=v[(se+14)%16],_=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,I=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,d[se]=J&65535|re<<16,v[se]=z&65535|k<<16}_=M,I=b,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[0],I=A[0],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[0]=M=J&65535|re<<16,A[0]=b=z&65535|k<<16,_=K,I=c,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[1],I=A[1],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[1]=K=J&65535|re<<16,A[1]=c=z&65535|k<<16,_=V,I=m,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[2],I=A[2],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[2]=V=J&65535|re<<16,A[2]=m=z&65535|k<<16,_=ae,I=Y,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[3],I=A[3],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[3]=ae=J&65535|re<<16,A[3]=Y=z&65535|k<<16,_=R,I=G,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[4],I=A[4],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[4]=R=J&65535|re<<16,A[4]=G=z&65535|k<<16,_=$,I=ne,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[5],I=A[5],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[5]=$=J&65535|re<<16,A[5]=ne=z&65535|k<<16,_=x,I=ce,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[6],I=A[6],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[6]=x=J&65535|re<<16,A[6]=ce=z&65535|k<<16,_=P,I=de,z=I&65535,k=I>>>16,J=_&65535,re=_>>>16,_=E[7],I=A[7],z+=I&65535,k+=I>>>16,J+=_&65535,re+=_>>>16,k+=z>>>16,J+=k>>>16,re+=J>>>16,E[7]=P=J&65535|re<<16,A[7]=de=z&65535|k<<16,H+=128,F-=128}return H}function p(d){var v=new s;v.update(d);var E=v.digest();return v.clean(),E}n.hash=p})(Md);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Cn,r=Md,s=Ir;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const j=new Float64Array(16);if(q)for(let C=0;C<q.length;C++)j[C]=q[C];return j}const l=new Uint8Array(32);l[0]=9;const p=a(),d=a([1]),v=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),A=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),H=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function F(q,j){for(let C=0;C<16;C++)q[C]=j[C]|0}function M(q){let j=1;for(let C=0;C<16;C++){let h=q[C]+j+65535;j=Math.floor(h/65536),q[C]=h-j*65536}q[0]+=j-1+37*(j-1)}function K(q,j,C){const h=~(C-1);for(let O=0;O<16;O++){const oe=h&(q[O]^j[O]);q[O]^=oe,j[O]^=oe}}function V(q,j){const C=a(),h=a();for(let O=0;O<16;O++)h[O]=j[O];M(h),M(h),M(h);for(let O=0;O<2;O++){C[0]=h[0]-65517;for(let fe=1;fe<15;fe++)C[fe]=h[fe]-65535-(C[fe-1]>>16&1),C[fe-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const oe=C[15]>>16&1;C[14]&=65535,K(h,C,1-oe)}for(let O=0;O<16;O++)q[2*O]=h[O]&255,q[2*O+1]=h[O]>>8}function ae(q,j){let C=0;for(let h=0;h<32;h++)C|=q[h]^j[h];return(1&C-1>>>8)-1}function R(q,j){const C=new Uint8Array(32),h=new Uint8Array(32);return V(C,q),V(h,j),ae(C,h)}function $(q){const j=new Uint8Array(32);return V(j,q),j[0]&1}function x(q,j){for(let C=0;C<16;C++)q[C]=j[2*C]+(j[2*C+1]<<8);q[15]&=32767}function P(q,j,C){for(let h=0;h<16;h++)q[h]=j[h]+C[h]}function b(q,j,C){for(let h=0;h<16;h++)q[h]=j[h]-C[h]}function c(q,j,C){let h,O,oe=0,fe=0,xe=0,Be=0,Ve=0,$e=0,pt=0,gt=0,je=0,Oe=0,Ue=0,Le=0,qe=0,Pe=0,Fe=0,Ie=0,Te=0,ze=0,Ae=0,ke=0,We=0,et=0,tt=0,Je=0,Zt=0,ur=0,kr=0,Qt=0,ti=0,yi=0,Ui=0,wt=C[0],vt=C[1],Et=C[2],St=C[3],mt=C[4],yt=C[5],Ut=C[6],Lt=C[7],It=C[8],Ft=C[9],xt=C[10],Pt=C[11],Ot=C[12],ht=C[13],Dt=C[14],$t=C[15];h=j[0],oe+=h*wt,fe+=h*vt,xe+=h*Et,Be+=h*St,Ve+=h*mt,$e+=h*yt,pt+=h*Ut,gt+=h*Lt,je+=h*It,Oe+=h*Ft,Ue+=h*xt,Le+=h*Pt,qe+=h*Ot,Pe+=h*ht,Fe+=h*Dt,Ie+=h*$t,h=j[1],fe+=h*wt,xe+=h*vt,Be+=h*Et,Ve+=h*St,$e+=h*mt,pt+=h*yt,gt+=h*Ut,je+=h*Lt,Oe+=h*It,Ue+=h*Ft,Le+=h*xt,qe+=h*Pt,Pe+=h*Ot,Fe+=h*ht,Ie+=h*Dt,Te+=h*$t,h=j[2],xe+=h*wt,Be+=h*vt,Ve+=h*Et,$e+=h*St,pt+=h*mt,gt+=h*yt,je+=h*Ut,Oe+=h*Lt,Ue+=h*It,Le+=h*Ft,qe+=h*xt,Pe+=h*Pt,Fe+=h*Ot,Ie+=h*ht,Te+=h*Dt,ze+=h*$t,h=j[3],Be+=h*wt,Ve+=h*vt,$e+=h*Et,pt+=h*St,gt+=h*mt,je+=h*yt,Oe+=h*Ut,Ue+=h*Lt,Le+=h*It,qe+=h*Ft,Pe+=h*xt,Fe+=h*Pt,Ie+=h*Ot,Te+=h*ht,ze+=h*Dt,Ae+=h*$t,h=j[4],Ve+=h*wt,$e+=h*vt,pt+=h*Et,gt+=h*St,je+=h*mt,Oe+=h*yt,Ue+=h*Ut,Le+=h*Lt,qe+=h*It,Pe+=h*Ft,Fe+=h*xt,Ie+=h*Pt,Te+=h*Ot,ze+=h*ht,Ae+=h*Dt,ke+=h*$t,h=j[5],$e+=h*wt,pt+=h*vt,gt+=h*Et,je+=h*St,Oe+=h*mt,Ue+=h*yt,Le+=h*Ut,qe+=h*Lt,Pe+=h*It,Fe+=h*Ft,Ie+=h*xt,Te+=h*Pt,ze+=h*Ot,Ae+=h*ht,ke+=h*Dt,We+=h*$t,h=j[6],pt+=h*wt,gt+=h*vt,je+=h*Et,Oe+=h*St,Ue+=h*mt,Le+=h*yt,qe+=h*Ut,Pe+=h*Lt,Fe+=h*It,Ie+=h*Ft,Te+=h*xt,ze+=h*Pt,Ae+=h*Ot,ke+=h*ht,We+=h*Dt,et+=h*$t,h=j[7],gt+=h*wt,je+=h*vt,Oe+=h*Et,Ue+=h*St,Le+=h*mt,qe+=h*yt,Pe+=h*Ut,Fe+=h*Lt,Ie+=h*It,Te+=h*Ft,ze+=h*xt,Ae+=h*Pt,ke+=h*Ot,We+=h*ht,et+=h*Dt,tt+=h*$t,h=j[8],je+=h*wt,Oe+=h*vt,Ue+=h*Et,Le+=h*St,qe+=h*mt,Pe+=h*yt,Fe+=h*Ut,Ie+=h*Lt,Te+=h*It,ze+=h*Ft,Ae+=h*xt,ke+=h*Pt,We+=h*Ot,et+=h*ht,tt+=h*Dt,Je+=h*$t,h=j[9],Oe+=h*wt,Ue+=h*vt,Le+=h*Et,qe+=h*St,Pe+=h*mt,Fe+=h*yt,Ie+=h*Ut,Te+=h*Lt,ze+=h*It,Ae+=h*Ft,ke+=h*xt,We+=h*Pt,et+=h*Ot,tt+=h*ht,Je+=h*Dt,Zt+=h*$t,h=j[10],Ue+=h*wt,Le+=h*vt,qe+=h*Et,Pe+=h*St,Fe+=h*mt,Ie+=h*yt,Te+=h*Ut,ze+=h*Lt,Ae+=h*It,ke+=h*Ft,We+=h*xt,et+=h*Pt,tt+=h*Ot,Je+=h*ht,Zt+=h*Dt,ur+=h*$t,h=j[11],Le+=h*wt,qe+=h*vt,Pe+=h*Et,Fe+=h*St,Ie+=h*mt,Te+=h*yt,ze+=h*Ut,Ae+=h*Lt,ke+=h*It,We+=h*Ft,et+=h*xt,tt+=h*Pt,Je+=h*Ot,Zt+=h*ht,ur+=h*Dt,kr+=h*$t,h=j[12],qe+=h*wt,Pe+=h*vt,Fe+=h*Et,Ie+=h*St,Te+=h*mt,ze+=h*yt,Ae+=h*Ut,ke+=h*Lt,We+=h*It,et+=h*Ft,tt+=h*xt,Je+=h*Pt,Zt+=h*Ot,ur+=h*ht,kr+=h*Dt,Qt+=h*$t,h=j[13],Pe+=h*wt,Fe+=h*vt,Ie+=h*Et,Te+=h*St,ze+=h*mt,Ae+=h*yt,ke+=h*Ut,We+=h*Lt,et+=h*It,tt+=h*Ft,Je+=h*xt,Zt+=h*Pt,ur+=h*Ot,kr+=h*ht,Qt+=h*Dt,ti+=h*$t,h=j[14],Fe+=h*wt,Ie+=h*vt,Te+=h*Et,ze+=h*St,Ae+=h*mt,ke+=h*yt,We+=h*Ut,et+=h*Lt,tt+=h*It,Je+=h*Ft,Zt+=h*xt,ur+=h*Pt,kr+=h*Ot,Qt+=h*ht,ti+=h*Dt,yi+=h*$t,h=j[15],Ie+=h*wt,Te+=h*vt,ze+=h*Et,Ae+=h*St,ke+=h*mt,We+=h*yt,et+=h*Ut,tt+=h*Lt,Je+=h*It,Zt+=h*Ft,ur+=h*xt,kr+=h*Pt,Qt+=h*Ot,ti+=h*ht,yi+=h*Dt,Ui+=h*$t,oe+=38*Te,fe+=38*ze,xe+=38*Ae,Be+=38*ke,Ve+=38*We,$e+=38*et,pt+=38*tt,gt+=38*Je,je+=38*Zt,Oe+=38*ur,Ue+=38*kr,Le+=38*Qt,qe+=38*ti,Pe+=38*yi,Fe+=38*Ui,O=1,h=oe+O+65535,O=Math.floor(h/65536),oe=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Be+O+65535,O=Math.floor(h/65536),Be=h-O*65536,h=Ve+O+65535,O=Math.floor(h/65536),Ve=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=pt+O+65535,O=Math.floor(h/65536),pt=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=Oe+O+65535,O=Math.floor(h/65536),Oe=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,h=qe+O+65535,O=Math.floor(h/65536),qe=h-O*65536,h=Pe+O+65535,O=Math.floor(h/65536),Pe=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,oe+=O-1+37*(O-1),O=1,h=oe+O+65535,O=Math.floor(h/65536),oe=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Be+O+65535,O=Math.floor(h/65536),Be=h-O*65536,h=Ve+O+65535,O=Math.floor(h/65536),Ve=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=pt+O+65535,O=Math.floor(h/65536),pt=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=Oe+O+65535,O=Math.floor(h/65536),Oe=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,h=qe+O+65535,O=Math.floor(h/65536),qe=h-O*65536,h=Pe+O+65535,O=Math.floor(h/65536),Pe=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,oe+=O-1+37*(O-1),q[0]=oe,q[1]=fe,q[2]=xe,q[3]=Be,q[4]=Ve,q[5]=$e,q[6]=pt,q[7]=gt,q[8]=je,q[9]=Oe,q[10]=Ue,q[11]=Le,q[12]=qe,q[13]=Pe,q[14]=Fe,q[15]=Ie}function m(q,j){c(q,j,j)}function Y(q,j){const C=a();let h;for(h=0;h<16;h++)C[h]=j[h];for(h=253;h>=0;h--)m(C,C),h!==2&&h!==4&&c(C,C,j);for(h=0;h<16;h++)q[h]=C[h]}function G(q,j){const C=a();let h;for(h=0;h<16;h++)C[h]=j[h];for(h=250;h>=0;h--)m(C,C),h!==1&&c(C,C,j);for(h=0;h<16;h++)q[h]=C[h]}function ne(q,j){const C=a(),h=a(),O=a(),oe=a(),fe=a(),xe=a(),Be=a(),Ve=a(),$e=a();b(C,q[1],q[0]),b($e,j[1],j[0]),c(C,C,$e),P(h,q[0],q[1]),P($e,j[0],j[1]),c(h,h,$e),c(O,q[3],j[3]),c(O,O,E),c(oe,q[2],j[2]),P(oe,oe,oe),b(fe,h,C),b(xe,oe,O),P(Be,oe,O),P(Ve,h,C),c(q[0],fe,xe),c(q[1],Ve,Be),c(q[2],Be,xe),c(q[3],fe,Ve)}function ce(q,j,C){for(let h=0;h<4;h++)K(q[h],j[h],C)}function de(q,j){const C=a(),h=a(),O=a();Y(O,j[2]),c(C,j[0],O),c(h,j[1],O),V(q,h),q[31]^=$(C)<<7}function _(q,j,C){F(q[0],p),F(q[1],d),F(q[2],d),F(q[3],p);for(let h=255;h>=0;--h){const O=C[h/8|0]>>(h&7)&1;ce(q,j,O),ne(j,q),ne(q,q),ce(q,j,O)}}function I(q,j){const C=[a(),a(),a(),a()];F(C[0],A),F(C[1],N),F(C[2],d),c(C[3],A,N),_(q,C,j)}function ee(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const j=(0,r.hash)(q);j[0]&=248,j[31]&=127,j[31]|=64;const C=new Uint8Array(32),h=[a(),a(),a(),a()];I(h,j),de(C,h);const O=new Uint8Array(64);return O.set(q),O.set(C,32),{publicKey:C,secretKey:O}}n.generateKeyPairFromSeed=ee;function X(q){const j=(0,t.randomBytes)(32,q),C=ee(j);return(0,s.wipe)(j),C}n.generateKeyPair=X;function z(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=z;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(q,j){let C,h,O,oe;for(h=63;h>=32;--h){for(C=0,O=h-32,oe=h-12;O<oe;++O)j[O]+=C-16*j[h]*k[O-(h-32)],C=Math.floor((j[O]+128)/256),j[O]-=C*256;j[O]+=C,j[h]=0}for(C=0,O=0;O<32;O++)j[O]+=C-(j[31]>>4)*k[O],C=j[O]>>8,j[O]&=255;for(O=0;O<32;O++)j[O]-=C*k[O];for(h=0;h<32;h++)j[h+1]+=j[h]>>8,q[h]=j[h]&255}function re(q){const j=new Float64Array(64);for(let C=0;C<64;C++)j[C]=q[C];for(let C=0;C<64;C++)q[C]=0;J(q,j)}function me(q,j){const C=new Float64Array(64),h=[a(),a(),a(),a()],O=(0,r.hash)(q.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const oe=new Uint8Array(64);oe.set(O.subarray(32),32);const fe=new r.SHA512;fe.update(oe.subarray(32)),fe.update(j);const xe=fe.digest();fe.clean(),re(xe),I(h,xe),de(oe,h),fe.reset(),fe.update(oe.subarray(0,32)),fe.update(q.subarray(32)),fe.update(j);const Be=fe.digest();re(Be);for(let Ve=0;Ve<32;Ve++)C[Ve]=xe[Ve];for(let Ve=0;Ve<32;Ve++)for(let $e=0;$e<32;$e++)C[Ve+$e]+=Be[Ve]*O[$e];return J(oe.subarray(32),C),oe}n.sign=me;function se(q,j){const C=a(),h=a(),O=a(),oe=a(),fe=a(),xe=a(),Be=a();return F(q[2],d),x(q[1],j),m(O,q[1]),c(oe,O,v),b(O,O,q[2]),P(oe,q[2],oe),m(fe,oe),m(xe,fe),c(Be,xe,fe),c(C,Be,O),c(C,C,oe),G(C,C),c(C,C,O),c(C,C,oe),c(C,C,oe),c(q[0],C,oe),m(h,q[0]),c(h,h,oe),R(h,O)&&c(q[0],q[0],H),m(h,q[0]),c(h,h,oe),R(h,O)?-1:($(q[0])===j[31]>>7&&b(q[0],p,q[0]),c(q[3],q[0],q[1]),0)}function be(q,j,C){const h=new Uint8Array(32),O=[a(),a(),a(),a()],oe=[a(),a(),a(),a()];if(C.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(se(oe,q))return!1;const fe=new r.SHA512;fe.update(C.subarray(0,32)),fe.update(q),fe.update(j);const xe=fe.digest();return re(xe),_(O,oe,xe),I(oe,C.subarray(32)),ne(O,oe),de(h,O),!ae(C,h)}n.verify=be;function he(q){let j=[a(),a(),a(),a()];if(se(j,q))throw new Error("Ed25519: invalid public key");let C=a(),h=a(),O=j[1];P(C,d,O),b(h,d,O),Y(h,h),c(C,C,h);let oe=new Uint8Array(32);return V(oe,C),oe}n.convertPublicKeyToX25519=he;function ye(q){const j=(0,r.hash)(q.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const C=new Uint8Array(j.subarray(0,32));return(0,s.wipe)(j),C}n.convertSecretKeyToX25519=ye})(du);const sE="EdDSA",oE="JWT",jd=".",qd="base64url",aE="utf8",cE="utf8",uE=":",hE="did",lE="key",pf="base58btc",fE="z",dE="K36",pE=32;function Uo(n){return ar(yr(ls(n),aE),qd)}function Hd(n){const t=yr(dE,pf),r=fE+ar(Hc([t,n]),pf);return[hE,lE,r].join(uE)}function gE(n){return ar(n,qd)}function vE(n){return yr([Uo(n.header),Uo(n.payload)].join(jd),cE)}function yE(n){return[Uo(n.header),Uo(n.payload),gE(n.signature)].join(jd)}function gf(n=Cn.randomBytes(pE)){return du.generateKeyPairFromSeed(n)}async function _E(n,t,r,s,a=Se.fromMiliseconds(Date.now())){const l={alg:sE,typ:oE},p=Hd(s.publicKey),d=a+r,v={iss:p,sub:n,aud:t,iat:a,exp:d},E=vE({header:l,payload:v}),A=du.sign(s.secretKey,E);return yE({header:l,payload:v,signature:A})}const mE="PARSE_ERROR",bE="INVALID_REQUEST",wE="METHOD_NOT_FOUND",EE="INVALID_PARAMS",Bd="INTERNAL_ERROR",pu="SERVER_ERROR",SE=[-32700,-32600,-32601,-32602,-32603],us={[mE]:{code:-32700,message:"Parse error"},[bE]:{code:-32600,message:"Invalid Request"},[wE]:{code:-32601,message:"Method not found"},[EE]:{code:-32602,message:"Invalid params"},[Bd]:{code:-32603,message:"Internal error"},[pu]:{code:-32e3,message:"Server error"}},zd=pu;function IE(n){return SE.includes(n)}function vf(n){return Object.keys(us).includes(n)?us[n]:us[zd]}function xE(n){const t=Object.values(us).find(r=>r.code===n);return t||us[zd]}function Kd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Vd={},di={},yf;function OE(){if(yf)return di;yf=1,Object.defineProperty(di,"__esModule",{value:!0}),di.isBrowserCryptoAvailable=di.getSubtleCrypto=di.getBrowerCrypto=void 0;function n(){return(vr===null||vr===void 0?void 0:vr.crypto)||(vr===null||vr===void 0?void 0:vr.msCrypto)||{}}di.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}di.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return di.isBrowserCryptoAvailable=r,di}var pi={},_f;function AE(){if(_f)return pi;_f=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isBrowser=pi.isNode=pi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}pi.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}pi.isNode=t;function r(){return!n()&&!t()}return pi.isBrowser=r,pi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=$r;t.__exportStar(OE(),n),t.__exportStar(AE(),n)})(Vd);function kd(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function PE(n=6){return BigInt(kd(n))}function Bo(n,t,r){return{id:r||kd(),jsonrpc:"2.0",method:n,params:t}}function gu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function zo(n,t,r){return{id:n,jsonrpc:"2.0",error:TE(t,r)}}function TE(n,t){return typeof n>"u"?vf(Bd):(typeof n=="string"&&(n=Object.assign(Object.assign({},vf(pu)),{message:n})),typeof t<"u"&&(n.data=t),IE(n.code)&&(n=xE(n.code)),n)}class CE{}class NE extends CE{constructor(){super()}}class RE extends NE{constructor(t){super()}}const UE="^https?:",LE="^wss?:";function FE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Gd(n,t){const r=FE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function mf(n){return Gd(n,UE)}function bf(n){return Gd(n,LE)}function DE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Wd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function vu(n){return Wd(n)&&"method"in n}function yu(n){return Wd(n)&&(gi(n)||Vr(n))}function gi(n){return"result"in n}function Vr(n){return"error"in n}class Ni extends RE{constructor(t){super(t),this.events=new cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Bo(t.method,t.params||[],PE().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(l){a(l)}this.events.on(`${t.id}`,l=>{Vr(l)?a(l.error):s(l.result)});try{await this.connection.send(t,r)}catch(l){a(l)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),yu(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const wf=10,$E=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),ME=()=>typeof window<"u",jE=$E();class qE{constructor(t){if(this.url=t,this.events=new cr.EventEmitter,this.registering=!1,!bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ls(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=Vd.isReactNative()?void 0:{rejectUnauthorized:!DE(t)},l=new jE(t,[],a);ME()?l.onerror=p=>{const d=p;s(this.emitError(d.error))}:l.on("error",p=>{s(this.emitError(p))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?fu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=zo(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return Kd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>wf&&this.events.setMaxListeners(wf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Lo={},HE={get exports(){return Lo},set exports(n){Lo=n}};(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,l=2,p=9007199254740991,d="[object Arguments]",v="[object Array]",E="[object AsyncFunction]",A="[object Boolean]",N="[object Date]",H="[object Error]",F="[object Function]",M="[object GeneratorFunction]",K="[object Map]",V="[object Number]",ae="[object Null]",R="[object Object]",$="[object Promise]",x="[object Proxy]",P="[object RegExp]",b="[object Set]",c="[object String]",m="[object Symbol]",Y="[object Undefined]",G="[object WeakMap]",ne="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",_="[object Float64Array]",I="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",z="[object Uint8Array]",k="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",me=/[\\^$.*+?()[\]{}|]/g,se=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[de]=he[_]=he[I]=he[ee]=he[X]=he[z]=he[k]=he[J]=he[re]=!0,he[d]=he[v]=he[ne]=he[A]=he[ce]=he[N]=he[H]=he[F]=he[K]=he[V]=he[R]=he[P]=he[b]=he[c]=he[G]=!1;var ye=typeof vr=="object"&&vr&&vr.Object===Object&&vr,q=typeof self=="object"&&self&&self.Object===Object&&self,j=ye||q||Function("return this")(),C=t&&!t.nodeType&&t,h=C&&!0&&n&&!n.nodeType&&n,O=h&&h.exports===C,oe=O&&ye.process,fe=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),xe=fe&&fe.isTypedArray;function Be(w,U){for(var te=-1,pe=w==null?0:w.length,at=0,Ne=[];++te<pe;){var ft=w[te];U(ft,te,w)&&(Ne[at++]=ft)}return Ne}function Ve(w,U){for(var te=-1,pe=U.length,at=w.length;++te<pe;)w[at+te]=U[te];return w}function $e(w,U){for(var te=-1,pe=w==null?0:w.length;++te<pe;)if(U(w[te],te,w))return!0;return!1}function pt(w,U){for(var te=-1,pe=Array(w);++te<w;)pe[te]=U(te);return pe}function gt(w){return function(U){return w(U)}}function je(w,U){return w.has(U)}function Oe(w,U){return w==null?void 0:w[U]}function Ue(w){var U=-1,te=Array(w.size);return w.forEach(function(pe,at){te[++U]=[at,pe]}),te}function Le(w,U){return function(te){return w(U(te))}}function qe(w){var U=-1,te=Array(w.size);return w.forEach(function(pe){te[++U]=pe}),te}var Pe=Array.prototype,Fe=Function.prototype,Ie=Object.prototype,Te=j["__core-js_shared__"],ze=Fe.toString,Ae=Ie.hasOwnProperty,ke=function(){var w=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),We=Ie.toString,et=RegExp("^"+ze.call(Ae).replace(me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=O?j.Buffer:void 0,Je=j.Symbol,Zt=j.Uint8Array,ur=Ie.propertyIsEnumerable,kr=Pe.splice,Qt=Je?Je.toStringTag:void 0,ti=Object.getOwnPropertySymbols,yi=tt?tt.isBuffer:void 0,Ui=Le(Object.keys,Object),wt=_r(j,"DataView"),vt=_r(j,"Map"),Et=_r(j,"Promise"),St=_r(j,"Set"),mt=_r(j,"WeakMap"),yt=_r(Object,"create"),Ut=ii(wt),Lt=ii(vt),It=ii(Et),Ft=ii(St),xt=ii(mt),Pt=Je?Je.prototype:void 0,Ot=Pt?Pt.valueOf:void 0;function ht(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function Dt(){this.__data__=yt?yt(null):{},this.size=0}function $t(w){var U=this.has(w)&&delete this.__data__[w];return this.size-=U?1:0,U}function ko(w){var U=this.__data__;if(yt){var te=U[w];return te===s?void 0:te}return Ae.call(U,w)?U[w]:void 0}function Go(w){var U=this.__data__;return yt?U[w]!==void 0:Ae.call(U,w)}function Wo(w,U){var te=this.__data__;return this.size+=this.has(w)?0:1,te[w]=yt&&U===void 0?s:U,this}ht.prototype.clear=Dt,ht.prototype.delete=$t,ht.prototype.get=ko,ht.prototype.has=Go,ht.prototype.set=Wo;function xr(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function Yo(){this.__data__=[],this.size=0}function Jo(w){var U=this.__data__,te=Li(U,w);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():kr.call(U,te,1),--this.size,!0}function Xo(w){var U=this.__data__,te=Li(U,w);return te<0?void 0:U[te][1]}function Zo(w){return Li(this.__data__,w)>-1}function Qo(w,U){var te=this.__data__,pe=Li(te,w);return pe<0?(++this.size,te.push([w,U])):te[pe][1]=U,this}xr.prototype.clear=Yo,xr.prototype.delete=Jo,xr.prototype.get=Xo,xr.prototype.has=Zo,xr.prototype.set=Qo;function ri(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function on(){this.size=0,this.__data__={hash:new ht,map:new(vt||xr),string:new ht}}function ea(w){var U=_i(this,w).delete(w);return this.size-=U?1:0,U}function an(w){return _i(this,w).get(w)}function ta(w){return _i(this,w).has(w)}function ra(w,U){var te=_i(this,w),pe=te.size;return te.set(w,U),this.size+=te.size==pe?0:1,this}ri.prototype.clear=on,ri.prototype.delete=ea,ri.prototype.get=an,ri.prototype.has=ta,ri.prototype.set=ra;function cn(w){var U=-1,te=w==null?0:w.length;for(this.__data__=new ri;++U<te;)this.add(w[U])}function ys(w){return this.__data__.set(w,s),this}function _s(w){return this.__data__.has(w)}cn.prototype.add=cn.prototype.push=ys,cn.prototype.has=_s;function Mr(w){var U=this.__data__=new xr(w);this.size=U.size}function ia(){this.__data__=new xr,this.size=0}function na(w){var U=this.__data__,te=U.delete(w);return this.size=U.size,te}function sa(w){return this.__data__.get(w)}function oa(w){return this.__data__.has(w)}function ms(w,U){var te=this.__data__;if(te instanceof xr){var pe=te.__data__;if(!vt||pe.length<r-1)return pe.push([w,U]),this.size=++te.size,this;te=this.__data__=new ri(pe)}return te.set(w,U),this.size=te.size,this}Mr.prototype.clear=ia,Mr.prototype.delete=na,Mr.prototype.get=sa,Mr.prototype.has=oa,Mr.prototype.set=ms;function bs(w,U){var te=ln(w),pe=!te&&Rs(w),at=!te&&!pe&&Fn(w),Ne=!te&&!pe&&!at&&Fs(w),ft=te||pe||at||Ne,Mt=ft?pt(w.length,String):[],Xe=Mt.length;for(var ct in w)(U||Ae.call(w,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||As(ct,Xe)))&&Mt.push(ct);return Mt}function Li(w,U){for(var te=w.length;te--;)if(Ns(w[te][0],U))return te;return-1}function Un(w,U,te){var pe=U(w);return ln(w)?pe:Ve(pe,te(w))}function Fi(w){return w==null?w===void 0?Y:ae:Qt&&Qt in Object(w)?xs(w):ua(w)}function Ln(w){return $i(w)&&Fi(w)==d}function Di(w,U,te,pe,at){return w===U?!0:w==null||U==null||!$i(w)&&!$i(U)?w!==w&&U!==U:ws(w,U,te,pe,Di,at)}function ws(w,U,te,pe,at,Ne){var ft=ln(w),Mt=ln(U),Xe=ft?v:Gr(w),ct=Mt?v:Gr(U);Xe=Xe==d?R:Xe,ct=ct==d?R:ct;var Tt=Xe==R,hr=ct==R,jt=Xe==ct;if(jt&&Fn(w)){if(!Fn(U))return!1;ft=!0,Tt=!1}if(jt&&!Tt)return Ne||(Ne=new Mr),ft||Fs(w)?un(w,U,te,pe,at,Ne):ca(w,U,Xe,te,pe,at,Ne);if(!(te&a)){var dt=Tt&&Ae.call(w,"__wrapped__"),er=hr&&Ae.call(U,"__wrapped__");if(dt||er){var jr=dt?w.value():w,Or=er?U.value():U;return Ne||(Ne=new Mr),at(jr,Or,te,pe,Ne)}}return jt?(Ne||(Ne=new Mr),Is(w,U,te,pe,at,Ne)):!1}function aa(w){if(!Ls(w)||Ts(w))return!1;var U=fn(w)?et:se;return U.test(ii(w))}function Es(w){return $i(w)&&Us(w.length)&&!!he[Fi(w)]}function Ss(w){if(!Cs(w))return Ui(w);var U=[];for(var te in Object(w))Ae.call(w,te)&&te!="constructor"&&U.push(te);return U}function un(w,U,te,pe,at,Ne){var ft=te&a,Mt=w.length,Xe=U.length;if(Mt!=Xe&&!(ft&&Xe>Mt))return!1;var ct=Ne.get(w);if(ct&&Ne.get(U))return ct==U;var Tt=-1,hr=!0,jt=te&l?new cn:void 0;for(Ne.set(w,U),Ne.set(U,w);++Tt<Mt;){var dt=w[Tt],er=U[Tt];if(pe)var jr=ft?pe(er,dt,Tt,U,w,Ne):pe(dt,er,Tt,w,U,Ne);if(jr!==void 0){if(jr)continue;hr=!1;break}if(jt){if(!$e(U,function(Or,Wr){if(!je(jt,Wr)&&(dt===Or||at(dt,Or,te,pe,Ne)))return jt.push(Wr)})){hr=!1;break}}else if(!(dt===er||at(dt,er,te,pe,Ne))){hr=!1;break}}return Ne.delete(w),Ne.delete(U),hr}function ca(w,U,te,pe,at,Ne,ft){switch(te){case ce:if(w.byteLength!=U.byteLength||w.byteOffset!=U.byteOffset)return!1;w=w.buffer,U=U.buffer;case ne:return!(w.byteLength!=U.byteLength||!Ne(new Zt(w),new Zt(U)));case A:case N:case V:return Ns(+w,+U);case H:return w.name==U.name&&w.message==U.message;case P:case c:return w==U+"";case K:var Mt=Ue;case b:var Xe=pe&a;if(Mt||(Mt=qe),w.size!=U.size&&!Xe)return!1;var ct=ft.get(w);if(ct)return ct==U;pe|=l,ft.set(w,U);var Tt=un(Mt(w),Mt(U),pe,at,Ne,ft);return ft.delete(w),Tt;case m:if(Ot)return Ot.call(w)==Ot.call(U)}return!1}function Is(w,U,te,pe,at,Ne){var ft=te&a,Mt=hn(w),Xe=Mt.length,ct=hn(U),Tt=ct.length;if(Xe!=Tt&&!ft)return!1;for(var hr=Xe;hr--;){var jt=Mt[hr];if(!(ft?jt in U:Ae.call(U,jt)))return!1}var dt=Ne.get(w);if(dt&&Ne.get(U))return dt==U;var er=!0;Ne.set(w,U),Ne.set(U,w);for(var jr=ft;++hr<Xe;){jt=Mt[hr];var Or=w[jt],Wr=U[jt];if(pe)var Dn=ft?pe(Wr,Or,jt,U,w,Ne):pe(Or,Wr,jt,w,U,Ne);if(!(Dn===void 0?Or===Wr||at(Or,Wr,te,pe,Ne):Dn)){er=!1;break}jr||(jr=jt=="constructor")}if(er&&!jr){var Mi=w.constructor,zt=U.constructor;Mi!=zt&&"constructor"in w&&"constructor"in U&&!(typeof Mi=="function"&&Mi instanceof Mi&&typeof zt=="function"&&zt instanceof zt)&&(er=!1)}return Ne.delete(w),Ne.delete(U),er}function hn(w){return Un(w,fa,Os)}function _i(w,U){var te=w.__data__;return Ps(U)?te[typeof U=="string"?"string":"hash"]:te.map}function _r(w,U){var te=Oe(w,U);return aa(te)?te:void 0}function xs(w){var U=Ae.call(w,Qt),te=w[Qt];try{w[Qt]=void 0;var pe=!0}catch{}var at=We.call(w);return pe&&(U?w[Qt]=te:delete w[Qt]),at}var Os=ti?function(w){return w==null?[]:(w=Object(w),Be(ti(w),function(U){return ur.call(w,U)}))}:ot,Gr=Fi;(wt&&Gr(new wt(new ArrayBuffer(1)))!=ce||vt&&Gr(new vt)!=K||Et&&Gr(Et.resolve())!=$||St&&Gr(new St)!=b||mt&&Gr(new mt)!=G)&&(Gr=function(w){var U=Fi(w),te=U==R?w.constructor:void 0,pe=te?ii(te):"";if(pe)switch(pe){case Ut:return ce;case Lt:return K;case It:return $;case Ft:return b;case xt:return G}return U});function As(w,U){return U=U??p,!!U&&(typeof w=="number"||be.test(w))&&w>-1&&w%1==0&&w<U}function Ps(w){var U=typeof w;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?w!=="__proto__":w===null}function Ts(w){return!!ke&&ke in w}function Cs(w){var U=w&&w.constructor,te=typeof U=="function"&&U.prototype||Ie;return w===te}function ua(w){return We.call(w)}function ii(w){if(w!=null){try{return ze.call(w)}catch{}try{return w+""}catch{}}return""}function Ns(w,U){return w===U||w!==w&&U!==U}var Rs=Ln(function(){return arguments}())?Ln:function(w){return $i(w)&&Ae.call(w,"callee")&&!ur.call(w,"callee")},ln=Array.isArray;function ha(w){return w!=null&&Us(w.length)&&!fn(w)}var Fn=yi||st;function la(w,U){return Di(w,U)}function fn(w){if(!Ls(w))return!1;var U=Fi(w);return U==F||U==M||U==E||U==x}function Us(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=p}function Ls(w){var U=typeof w;return w!=null&&(U=="object"||U=="function")}function $i(w){return w!=null&&typeof w=="object"}var Fs=xe?gt(xe):Es;function fa(w){return ha(w)?bs(w):Ss(w)}function ot(){return[]}function st(){return!1}n.exports=la})(HE,Lo);function BE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var d=n.length,v=n.charAt(0),E=Math.log(d)/Math.log(256),A=Math.log(256)/Math.log(d);function N(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var K=0,V=0,ae=0,R=M.length;ae!==R&&M[ae]===0;)ae++,K++;for(var $=(R-ae)*A+1>>>0,x=new Uint8Array($);ae!==R;){for(var P=M[ae],b=0,c=$-1;(P!==0||b<V)&&c!==-1;c--,b++)P+=256*x[c]>>>0,x[c]=P%d>>>0,P=P/d>>>0;if(P!==0)throw new Error("Non-zero carry");V=b,ae++}for(var m=$-V;m!==$&&x[m]===0;)m++;for(var Y=v.repeat(K);m<$;++m)Y+=n.charAt(x[m]);return Y}function H(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var K=0;if(M[K]!==" "){for(var V=0,ae=0;M[K]===v;)V++,K++;for(var R=(M.length-K)*E+1>>>0,$=new Uint8Array(R);M[K];){var x=r[M.charCodeAt(K)];if(x===255)return;for(var P=0,b=R-1;(x!==0||P<ae)&&b!==-1;b--,P++)x+=d*$[b]>>>0,$[b]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");ae=P,K++}if(M[K]!==" "){for(var c=R-ae;c!==R&&$[c]===0;)c++;for(var m=new Uint8Array(V+(R-c)),Y=V;c!==R;)m[Y++]=$[c++];return m}}}function F(M){var K=H(M);if(K)return K;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:H,decode:F}}var zE=BE,KE=zE;const Yd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},VE=n=>new TextEncoder().encode(n),kE=n=>new TextDecoder().decode(n);class GE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}let WE=class{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Jd(this,t)}};class YE{constructor(t){this.decoders=t}or(t){return Jd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jd=(n,t)=>new YE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class JE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new GE(t,r,s),this.decoder=new WE(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ko=({name:n,prefix:t,encode:r,decode:s})=>new JE(n,t,r,s),vs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=KE(r,t);return Ko({prefix:n,name:t,encode:s,decode:l=>Yd(a(l))})},XE=(n,t,r,s)=>{const a={};for(let A=0;A<t.length;++A)a[t[A]]=A;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let d=0,v=0,E=0;for(let A=0;A<l;++A){const N=a[n[A]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|N,d+=r,d>=8&&(d-=8,p[E++]=255&v>>d)}if(d>=r||255&v<<8-d)throw new SyntaxError("Unexpected end of data");return p},ZE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,d=0;for(let v=0;v<n.length;++v)for(d=d<<8|n[v],p+=8;p>r;)p-=r,l+=t[a&d>>p];if(p&&(l+=t[a&d<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Wt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ko({prefix:t,name:n,encode(a){return ZE(a,s,r)},decode(a){return XE(a,s,r,n)}}),QE=Ko({prefix:"\0",name:"identity",encode:n=>kE(n),decode:n=>VE(n)});var e6=Object.freeze({__proto__:null,identity:QE});const t6=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var r6=Object.freeze({__proto__:null,base2:t6});const i6=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var n6=Object.freeze({__proto__:null,base8:i6});const s6=vs({prefix:"9",name:"base10",alphabet:"0123456789"});var o6=Object.freeze({__proto__:null,base10:s6});const a6=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),c6=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var u6=Object.freeze({__proto__:null,base16:a6,base16upper:c6});const h6=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),l6=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),f6=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d6=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p6=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g6=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),v6=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),y6=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_6=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var m6=Object.freeze({__proto__:null,base32:h6,base32upper:l6,base32pad:f6,base32padupper:d6,base32hex:p6,base32hexupper:g6,base32hexpad:v6,base32hexpadupper:y6,base32z:_6});const b6=vs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),w6=vs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var E6=Object.freeze({__proto__:null,base36:b6,base36upper:w6});const S6=vs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),I6=vs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var x6=Object.freeze({__proto__:null,base58btc:S6,base58flickr:I6});const O6=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),A6=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),P6=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),T6=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var C6=Object.freeze({__proto__:null,base64:O6,base64pad:A6,base64url:P6,base64urlpad:T6});const Xd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),N6=Xd.reduce((n,t,r)=>(n[r]=t,n),[]),R6=Xd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function U6(n){return n.reduce((t,r)=>(t+=N6[r],t),"")}function L6(n){const t=[];for(const r of n){const s=R6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const F6=Ko({prefix:"🚀",name:"base256emoji",encode:U6,decode:L6});var D6=Object.freeze({__proto__:null,base256emoji:F6}),$6=Zd,Ef=128,M6=127,j6=~M6,q6=Math.pow(2,31);function Zd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=q6;)t[r++]=n&255|Ef,n/=128;for(;n&j6;)t[r++]=n&255|Ef,n>>>=7;return t[r]=n|0,Zd.bytes=r-s+1,t}var H6=Gc,B6=128,Sf=127;function Gc(n,s){var r=0,s=s||0,a=0,l=s,p,d=n.length;do{if(l>=d)throw Gc.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Sf)<<a:(p&Sf)*Math.pow(2,a),a+=7}while(p>=B6);return Gc.bytes=l-s,r}var z6=Math.pow(2,7),K6=Math.pow(2,14),V6=Math.pow(2,21),k6=Math.pow(2,28),G6=Math.pow(2,35),W6=Math.pow(2,42),Y6=Math.pow(2,49),J6=Math.pow(2,56),X6=Math.pow(2,63),Z6=function(n){return n<z6?1:n<K6?2:n<V6?3:n<k6?4:n<G6?5:n<W6?6:n<Y6?7:n<J6?8:n<X6?9:10},Q6={encode:$6,decode:H6,encodingLength:Z6},Qd=Q6;const If=(n,t,r=0)=>(Qd.encode(n,t,r),t),xf=n=>Qd.encodingLength(n),Wc=(n,t)=>{const r=t.byteLength,s=xf(n),a=s+xf(r),l=new Uint8Array(a+r);return If(n,l,0),If(r,l,s),l.set(t,a),new e2(n,r,t,l)};class e2{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const ep=({name:n,code:t,encode:r})=>new t2(n,t,r);class t2{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Wc(this.code,r):r.then(s=>Wc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const tp=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),r2=ep({name:"sha2-256",code:18,encode:tp("SHA-256")}),i2=ep({name:"sha2-512",code:19,encode:tp("SHA-512")});var n2=Object.freeze({__proto__:null,sha256:r2,sha512:i2});const rp=0,s2="identity",ip=Yd,o2=n=>Wc(rp,ip(n)),a2={code:rp,name:s2,encode:ip,digest:o2};var c2=Object.freeze({__proto__:null,identity:a2});new TextEncoder,new TextDecoder;const Of={...e6,...r6,...n6,...o6,...u6,...m6,...E6,...x6,...C6,...D6};({...n2,...c2});function np(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function u2(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?np(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function sp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Af=sp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Pc=sp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=u2(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),h2={utf8:Af,"utf-8":Af,hex:Of.base16,latin1:Pc,ascii:Pc,binary:Pc,...Of};function l2(n,t="utf8"){const r=h2[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?np(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const op="wc",f2=2,_u="core",Ti=`${op}@${2}:${_u}:`,d2={name:_u,logger:"error"},p2={database:":memory:"},g2="crypto",Pf="client_ed25519_seed",v2=Se.ONE_DAY,y2="keychain",_2="0.3",m2="messages",b2="0.3",w2=Se.SIX_HOURS,E2="publisher",ap="irn",S2="error",cp="wss://relay.walletconnect.com",I2="relayer",Vt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},x2="_subscription",ns={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},O2=Se.ONE_SECOND/2,A2="2.7.2",P2="0.3",ei={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},T2="subscription",C2="0.3",N2=Se.FIVE_SECONDS*1e3,R2="pairing",U2="0.3",ss={wc_pairingDelete:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:0},res:{ttl:Se.ONE_DAY,prompt:!1,tag:0}}},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},L2="history",F2="0.3",D2="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},$2="0.3",Tf="verify-api",Cf="https://verify.walletconnect.com";class M2{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=y2,this.version=_2,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=le("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Ad(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Pd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class j2{constructor(t,r,s){this.core=t,this.logger=r,this.name=g2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=gf(a);return Hd(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Ib();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=gf(l),d=Vc();return await _E(d,a,v2,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const d=this.getPrivateKey(a),v=xb(d,l);return this.setSymKey(v,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||Ob(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const d=Id(p),v=ls(l);if(zl(d)){const H=d.senderPublicKey,F=d.receiverPublicKey;a=await this.generateSharedKey(H,F)}const E=this.getSymKey(a),{type:A,senderPublicKey:N}=d;return Pb({type:A,symKey:E,message:v,senderPublicKey:N})},this.decode=async(a,l,p)=>{this.isInitialized();const d=Nb(l,p);if(zl(d)){const A=d.receiverPublicKey,N=d.senderPublicKey;a=await this.generateSharedKey(A,N)}const v=this.getSymKey(a),E=Tb({symKey:v,encoded:l});return fu(E)},this.getPayloadType=a=>{const l=Co(a);return ds(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Co(a);return l.senderPublicKey?ar(l.senderPublicKey,or):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new M2(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Pf)}catch{t=Vc(),await this.keychain.set(Pf,t)}return l2(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class q2 extends Ww{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=m2,this.version=b2,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=Qi(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=Qi(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Ad(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Pd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class H2 extends Yw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new cr.EventEmitter,this.name=E2,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,a,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const p=(l==null?void 0:l.ttl)||w2,d=kc(l),v=(l==null?void 0:l.prompt)||!1,E=(l==null?void 0:l.tag)||0,A={topic:s,message:a,opts:{ttl:p,relay:d,prompt:v,tag:E}},N=Qi(a);this.queue.set(N,A);try{await await No(this.rpcPublish(s,a,p,d,v,E),this.publishTimeout),this.relayer.events.emit(Vt.publish,A)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Vt.connection_stalled);return}this.onPublish(N,A),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,l,p){var d,v,E,A;const N={method:xo(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:p}};return sr((d=N.params)==null?void 0:d.prompt)&&((v=N.params)==null||delete v.prompt),sr((E=N.params)==null?void 0:E.tag)&&((A=N.params)==null||delete A.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:N}),this.relayer.request(N)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}let B2=class{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}};var z2=Object.defineProperty,K2=Object.defineProperties,V2=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,k2=Object.prototype.hasOwnProperty,G2=Object.prototype.propertyIsEnumerable,Rf=(n,t,r)=>t in n?z2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,os=(n,t)=>{for(var r in t||(t={}))k2.call(t,r)&&Rf(n,r,t[r]);if(Nf)for(var r of Nf(t))G2.call(t,r)&&Rf(n,r,t[r]);return n},Tc=(n,t)=>K2(n,V2(t));class W2 extends Zw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new B2,this.events=new cr.EventEmitter,this.name=T2,this.version=C2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ti,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=kc(a),p={topic:s,relay:l};this.pending.set(s,p);const d=await this.rpcSubscribe(s,l);return this.onSubscribe(d,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),d}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new Se.Watch;p.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=N2&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),l(!1))},this.pollingInterval)}),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=kc(s);await this.rpcUnsubscribe(t,r,a);const l=Rt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:xo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await No(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}return Qi(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:xo(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await No(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:xo(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Tc(os({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,os({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,os({},r)),this.topicMap.set(r.topic,t),this.events.emit(ei.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ei.deleted,Tc(os({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ei.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ei.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);vi(r)&&this.onBatchSubscribe(r.map((s,a)=>Tc(os({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Vt.connect,async()=>{await this.onConnect()}),this.relayer.on(Vt.disconnect,()=>{this.onDisconnect()}),this.events.on(ei.created,async t=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ei.deleted,async t=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var Y2=Object.defineProperty,Uf=Object.getOwnPropertySymbols,J2=Object.prototype.hasOwnProperty,X2=Object.prototype.propertyIsEnumerable,Lf=(n,t,r)=>t in n?Y2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Z2=(n,t)=>{for(var r in t||(t={}))J2.call(t,r)&&Lf(n,r,t[r]);if(Uf)for(var r of Uf(t))X2.call(t,r)&&Lf(n,r,t[r]);return n};class Q2 extends Jw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new cr.EventEmitter,this.name=I2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||S2})),this.messages=new q2(this.logger,t.core),this.subscriber=new W2(this,this.logger),this.publisher=new H2(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||cp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){this.isInitialized();let s="";return await Promise.all([new Promise(a=>{this.subscriber.once(ei.created,l=>{l.topic===t&&a()})}),new Promise(async a=>{s=await this.subscriber.subscribe(t,r),a()})]),s}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Vt.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ei.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await No(this.provider.connect(),5e3,"socket stalled").catch(a=>s(a)).then(()=>r()).finally(()=>this.removeListener(Vt.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Vt.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Vt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(ns.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ni(new qE(Bb({sdkVersion:A2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),vu(t)){if(!t.method.endsWith(x2))return;const r=t.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Z2({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Vt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=gu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(ns.payload,t=>this.onProviderPayload(t)),this.provider.on(ns.connect,()=>{this.events.emit(Vt.connect)}),this.provider.on(ns.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ns.error,t=>{this.logger.error(t),this.events.emit(Vt.error,t)})}registerEventListeners(){this.events.on(Vt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Se.toMiliseconds(O2))}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var eS=Object.defineProperty,Ff=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,Df=(n,t,r)=>t in n?eS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,$f=(n,t)=>{for(var r in t||(t={}))tS.call(t,r)&&Df(n,r,t[r]);if(Ff)for(var r of Ff(t))rS.call(t,r)&&Df(n,r,t[r]);return n};class Vo extends Xw{constructor(t,r,s,a=Ti,l=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=P2,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!sr(p)?this.map.set(this.getKey(p),p):uw(p)?this.map.set(p.id,p):hw(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,d)=>{this.isInitialized(),this.map.has(p)?await this.update(p,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:d}),this.map.set(p,d),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(d=>Object.keys(p).every(v=>Lo(d[v],p[v]))):this.values),this.update=async(p,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:d});const v=$f($f({},this.getData(p)),d);this.map.set(p,v),await this.persist()},this.delete=async(p,d)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:d}),this.map.delete(p),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class iS{constructor(t,r){this.core=t,this.logger=r,this.name=R2,this.version=U2,this.events=new cr,this.initialized=!1,this.storagePrefix=Ti,this.ignoredPayloadTypes=[tn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Vc(),a=await this.core.crypto.setSymKey(s),l=Kr(Se.FIVE_MINUTES),p={protocol:ap},d={topic:a,expiry:l,relay:p,active:!1},v=Qb({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,d),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=Xb(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const d=Kr(Se.FIVE_MINUTES),v={topic:a,relay:p,expiry:d,active:!1};return await this.pairings.set(a,v),await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,d),s.activatePairing&&await this.activate({topic:a}),v},this.activate=async({topic:s})=>{this.isInitialized();const a=Kr(Se.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:d,reject:v}=An();this.events.once(qt("pairing_ping",l),({error:E})=>{E?v(E):d()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Rt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=Bo(a,l),d=await this.core.crypto.encode(s,p),v=ss[a].req;return this.core.history.set(s,p),await this.core.relayer.publish(s,d,v),p.id},this.sendResult=async(s,a,l)=>{const p=gu(s,l),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),E=ss[v.request.method].res;await this.core.relayer.publish(a,d,E),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=zo(s,l),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),E=ss[v.request.method]?ss[v.request.method].res:ss.unregistered_method.res;await this.core.relayer.publish(a,d,E),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Rt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Pi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s,p=l.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{gi(a)?this.events.emit(qt("pairing_ping",l),{}):Vr(a)&&this.events.emit(qt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const d=Rt("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,d),this.logger.error(d)}catch(d){await this.sendError(l,s,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Rt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:a}=le("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!cw(s.uri)){const{message:a}=le("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!gr(s)){const{message:l}=le("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:l}=le("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:a}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Pi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=le("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new Vo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Vt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);vu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):yu(a)&&(await this.core.history.resolve(a),this.onRelayEventResponse({topic:r,payload:a}))})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async t=>{const{topic:r}=Cd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class nS extends Gw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new cr.EventEmitter,this.name=L2,this.version=F2,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l};this.records.set(p.id,p),this.events.emit(Qr.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Vr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Qr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(Qr.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Bo(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}}let sS=class extends Qw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new cr.EventEmitter,this.name=D2,this.version=$2,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(Fr.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Fr.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return zb(t);if(typeof t=="number")return Kb(t);const{message:r}=le("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;Se.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Fr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.expired,t=>{const r=Fr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}};class oS extends eE{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Tf,this.initialized=!1,this.init=async s=>{xd()||!uu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Cf,await this.createIframe())},this.register=async s=>{var a;this.initialized||await this.init(),this.iframe&&((a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const l=this.startAbortTimer(Se.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),p.status===200?(a=await p.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{const s=this.startAbortTimer(Se.FIVE_SECONDS);await Promise.race([new Promise((a,l)=>{const p=document.createElement("iframe");p.setAttribute("id",Tf),p.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),p.style.display="none",p.addEventListener("load",()=>{this.initialized=!0,clearTimeout(s),a()}),p.addEventListener("error",d=>{l(d)}),document.body.append(p),this.iframe=p}),new Promise(a=>{this.abortController.signal.addEventListener("abort",()=>{a("iframe load timeout")})})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=Cf,this.abortController=new AbortController,this.isDevEnv=cu()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),Kr(t))}}var aS=Object.defineProperty,Mf=Object.getOwnPropertySymbols,cS=Object.prototype.hasOwnProperty,uS=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?aS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,qf=(n,t)=>{for(var r in t||(t={}))cS.call(t,r)&&jf(n,r,t[r]);if(Mf)for(var r of Mf(t))uS.call(t,r)&&jf(n,r,t[r]);return n};let hS=class up extends kw{constructor(t){super(t),this.protocol=op,this.version=f2,this.name=_u,this.events=new cr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||cp;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||d2.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new gs.HeartBeat,this.crypto=new j2(this,this.logger,t==null?void 0:t.keychain),this.history=new nS(this,this.logger),this.expirer=new sS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new $w(qf(qf({},p2),t==null?void 0:t.storageOptions)),this.relayer=new Q2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new iS(this,this.logger),this.verify=new oS(this.projectId||"",this.logger)}static async init(t){const r=new up(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const lS=hS,hp="wc",lp=2,fp="client",mu=`${hp}@${lp}:${fp}:`,Cc={name:fp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},fS="proposal",dp="Proposal expired",dS="session",Eo=Se.SEVEN_DAYS,pS="engine",as={wc_sessionPropose:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1115}}},Nc={min:Se.FIVE_MINUTES,max:Se.SEVEN_DAYS},gS="request",vS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var yS=Object.defineProperty,_S=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,Hf=Object.getOwnPropertySymbols,bS=Object.prototype.hasOwnProperty,wS=Object.prototype.propertyIsEnumerable,Bf=(n,t,r)=>t in n?yS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lr=(n,t)=>{for(var r in t||(t={}))bS.call(t,r)&&Bf(n,r,t[r]);if(Hf)for(var r of Hf(t))wS.call(t,r)&&Bf(n,r,t[r]);return n},Rc=(n,t)=>_S(n,mS(t));class ES extends rE{constructor(t){super(t),this.name=pS,this.events=new cr,this.initialized=!1,this.ignoredPayloadTypes=[tn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(as)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Rc(Lr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:d,relays:v}=s;let E=a,A,N=!1;if(E&&(N=this.client.core.pairing.pairings.get(E).active),!E||!N){const{topic:$,uri:x}=await this.client.core.pairing.create();E=$,A=x}const H=await this.client.core.crypto.generateKeyPair(),F=Lr({requiredNamespaces:l,optionalNamespaces:p,relays:v??[{protocol:ap}],proposer:{publicKey:H,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:M,resolve:K,done:V}=An(Se.FIVE_MINUTES,dp);if(this.events.once(qt("session_connect"),async({error:$,session:x})=>{if($)M($);else if(x){x.self.publicKey=H;const P=Rc(Lr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,P),await this.setExpiry(x.topic,x.expiry),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:x.peer.metadata}),K(P)}}),!E){const{message:$}=le("NO_MATCHING_KEY",`connect() pairing topic: ${E}`);throw new Error($)}const ae=await this.sendRequest(E,"wc_sessionPropose",F),R=Kr(Se.FIVE_MINUTES);return await this.setProposal(ae,Lr({id:ae,expiry:R},F)),{uri:A,approval:V}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,d=this.client.proposal.get(s);let{pairingTopic:v,proposer:E,requiredNamespaces:A,optionalNamespaces:N}=d;v=v||"",Tn(A)||(A=iw(l,"approve()"));const H=await this.client.core.crypto.generateKeyPair(),F=E.publicKey,M=await this.client.core.crypto.generateSharedKey(H,F);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:E.metadata}),await this.sendResult(s,v,{relay:{protocol:a??"irn"},responderPublicKey:H}),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const K=Lr({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:A,optionalNamespaces:N,pairingTopic:v,controller:{publicKey:H,metadata:this.client.metadata},expiry:Kr(Eo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(M),await this.sendRequest(M,"wc_sessionSettle",K);const V=Rc(Lr({},K),{topic:M,pairingTopic:v,acknowledged:!1,self:K.controller,peer:{publicKey:E.publicKey,metadata:E.metadata},controller:H});return await this.client.session.set(M,V),await this.setExpiry(M,Kr(Eo)),{topic:M,acknowledged:()=>new Promise(ae=>ae(this.client.session.get(M)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:p,resolve:d,reject:v}=An();return this.events.once(qt("session_update",l),({error:E})=>{E?v(E):d()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:l,resolve:p,reject:d}=An();return this.events.once(qt("session_extend",a),({error:v})=>{v?d(v):p()}),await this.setExpiry(s,Kr(Eo)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,d=await this.sendRequest(l,"wc_sessionRequest",{request:a,chainId:s},p),{done:v,resolve:E,reject:A}=An(p);return this.events.once(qt("session_request",d),({error:N,result:H})=>{N?A(N):E(H)}),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:d}),await v()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;gi(a)?await this.sendResult(l,s,a.result):Vr(a)&&await this.sendError(l,s,a.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:l,resolve:p,reject:d}=An();this.events.once(qt("session_ping",a),({error:v})=>{v?d(v):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest(s,"wc_sessionDelete",Rt("USER_DISCONNECTED")),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>ow(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.deleteSymKey(r),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Rt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=as.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p}),s&&this.client.core.expirer.set(a,Kr(s))},this.sendRequest=async(r,s,a,l)=>{const p=Bo(s,a);if(uu()&&vS.includes(s)){const E=Qi(JSON.stringify(p));await this.client.core.verify.register({attestationId:E})}const d=await this.client.core.crypto.encode(r,p),v=as[s].req;return l&&(v.ttl=l),this.client.core.history.set(r,p),this.client.core.relayer.publish(r,d,v),p.id},this.sendResult=async(r,s,a)=>{const l=gu(r,a),p=await this.client.core.crypto.encode(s,l),d=await this.client.core.history.get(s,r),v=as[d.request.method].res;this.client.core.relayer.publish(s,p,v),await this.client.core.history.resolve(l)},this.sendError=async(r,s,a)=>{const l=zo(r,a),p=await this.client.core.crypto.encode(s,l),d=await this.client.core.history.get(s,r),v=as[d.request.method].res;this.client.core.relayer.publish(s,p,v),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Pi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Pi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(Lr({},s.params));const p=Kr(Se.FIVE_MINUTES),d=Lr({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,d);const v=Qi(JSON.stringify(s)),E=await this.getVerifyContext(v,d.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:d,context:E})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(gi(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const d=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const v=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const E=await this.client.core.crypto.generateSharedKey(d,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:E});const A=await this.client.core.relayer.subscribe(E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:A}),await this.client.core.pairing.activate({topic:r})}else Vr(s)&&(await this.client.proposal.delete(a,Rt("USER_DISCONNECTED")),this.events.emit(qt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:d,expiry:v,namespaces:E,requiredNamespaces:A,optionalNamespaces:N,sessionProperties:H,pairingTopic:F}=s.params,M=Lr({topic:r,relay:p,expiry:v,namespaces:E,acknowledged:!0,pairingTopic:F,requiredNamespaces:A,optionalNamespaces:N,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},H&&{sessionProperties:H});await this.sendResult(s.id,r,!0),this.events.emit(qt("session_connect"),{session:M})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;gi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(qt("session_approve",a),{})):Vr(s)&&(await this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.events.emit(qt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidUpdate(Lr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:a})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(qt("session_update",a),{}):Vr(s)&&this.events.emit(qt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Kr(Eo)),await this.sendResult(a,r,!0),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(qt("session_extend",a),{}):Vr(s)&&this.events.emit(qt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult(a,r,!0),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{gi(s)?this.events.emit(qt("session_ping",a),{}):Vr(s)&&this.events.emit(qt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Vt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(a,r,!0)]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(Lr({topic:r},l)),await this.setPendingSessionRequest({id:a,topic:r,params:l});const p=Qi(JSON.stringify(s)),d=this.client.session.get(r),v=await this.getVerifyContext(p,d.peer.metadata);this.client.events.emit("session_request",{id:a,topic:r,params:l,context:v})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(qt("session_request",a),{result:s.result}):Vr(s)&&this.events.emit(qt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidEmit(Lr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.isValidConnect=async r=>{if(!gr(r)){const{message:v}=le("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:d}=r;if(sr(s)||await this.isValidPairingTopic(s),!_w(d,!0)){const{message:v}=le("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(v)}!sr(a)&&Tn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!sr(l)&&Tn(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),sr(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=yw(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!gr(r))throw new Error(le("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const d=this.client.proposal.get(s),v=Ao(a,"approve()");if(v)throw new Error(v.message);const E=Xl(d.requiredNamespaces,a,"approve()");if(E)throw new Error(E.message);if(!kt(l,!0)){const{message:A}=le("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(A)}sr(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!gr(r)){const{message:l}=le("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!bw(a)){const{message:l}=le("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!gr(r)){const{message:E}=le("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(E)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!Ud(s)){const{message:E}=le("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(E)}const d=lw(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);const v=Ao(l,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Pi(p)){const{message:E}=le("EXPIRED","onSessionSettleRequest()");throw new Error(E)}},this.isValidUpdate=async r=>{if(!gr(r)){const{message:v}=le("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=Ao(a,"update()");if(p)throw new Error(p.message);const d=Xl(l.requiredNamespaces,a,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!gr(r)){const{message:a}=le("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!gr(r)){const{message:v}=le("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Jl(d,l)){const{message:v}=le("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(v)}if(!ww(a)){const{message:v}=le("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!Iw(d,l,a.method)){const{message:v}=le("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(p&&!Pw(p,Nc)){const{message:v}=le("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Nc.min} and ${Nc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!gr(r)){const{message:l}=le("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!Ew(a)){const{message:l}=le("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!gr(r)){const{message:a}=le("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!gr(r)){const{message:d}=le("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!Jl(p,l)){const{message:d}=le("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(d)}if(!Sw(a)){const{message:d}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}if(!xw(p,l,a.name)){const{message:d}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!gr(r)){const{message:a}=le("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l,a.verified.validation=l===s.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!kt(a,!1)){const{message:l}=le("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Vt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);vu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):yu(a)&&(await this.client.core.history.resolve(a),this.onRelayEventResponse({topic:r,payload:a}))})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async t=>{const{topic:r,id:s}=Cd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,le("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!kt(t,!1)){const{message:r}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=le("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!kt(t,!1)){const{message:r}=le("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=le("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(kt(t,!1)){const{message:r}=le("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=le("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!mw(t)){const{message:r}=le("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=le("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class SS extends Vo{constructor(t,r){super(t,r,fS,mu),this.core=t,this.logger=r}}class IS extends Vo{constructor(t,r){super(t,r,dS,mu),this.core=t,this.logger=r}}class xS extends Vo{constructor(t,r){super(t,r,gS,mu,s=>s.id),this.core=t,this.logger=r}}let OS=class pp extends tE{constructor(t){super(t),this.protocol=hp,this.version=lp,this.name=Cc.name,this.events=new cr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Cc.name,this.metadata=(t==null?void 0:t.metadata)||Mb();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Cc.logger}));this.core=(t==null?void 0:t.core)||new lS(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new IS(this.core,this.logger),this.proposal=new SS(this.core,this.logger),this.pendingRequest=new xS(this.core,this.logger),this.engine=new ES(this)}static async init(t){const r=new pp(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Fo={},AS={get exports(){return Fo},set exports(n){Fo=n}};(function(n,t){var r=typeof self<"u"?self:vr,s=function(){function l(){this.fetch=!1,this.DOMException=r.DOMException}return l.prototype=r,new l}();(function(l){(function(p){var d={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function v(_){return _&&DataView.prototype.isPrototypeOf(_)}if(d.arrayBuffer)var E=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],A=ArrayBuffer.isView||function(_){return _&&E.indexOf(Object.prototype.toString.call(_))>-1};function N(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function H(_){return typeof _!="string"&&(_=String(_)),_}function F(_){var I={next:function(){var ee=_.shift();return{done:ee===void 0,value:ee}}};return d.iterable&&(I[Symbol.iterator]=function(){return I}),I}function M(_){this.map={},_ instanceof M?_.forEach(function(I,ee){this.append(ee,I)},this):Array.isArray(_)?_.forEach(function(I){this.append(I[0],I[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(I){this.append(I,_[I])},this)}M.prototype.append=function(_,I){_=N(_),I=H(I);var ee=this.map[_];this.map[_]=ee?ee+", "+I:I},M.prototype.delete=function(_){delete this.map[N(_)]},M.prototype.get=function(_){return _=N(_),this.has(_)?this.map[_]:null},M.prototype.has=function(_){return this.map.hasOwnProperty(N(_))},M.prototype.set=function(_,I){this.map[N(_)]=H(I)},M.prototype.forEach=function(_,I){for(var ee in this.map)this.map.hasOwnProperty(ee)&&_.call(I,this.map[ee],ee,this)},M.prototype.keys=function(){var _=[];return this.forEach(function(I,ee){_.push(ee)}),F(_)},M.prototype.values=function(){var _=[];return this.forEach(function(I){_.push(I)}),F(_)},M.prototype.entries=function(){var _=[];return this.forEach(function(I,ee){_.push([ee,I])}),F(_)},d.iterable&&(M.prototype[Symbol.iterator]=M.prototype.entries);function K(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function V(_){return new Promise(function(I,ee){_.onload=function(){I(_.result)},_.onerror=function(){ee(_.error)}})}function ae(_){var I=new FileReader,ee=V(I);return I.readAsArrayBuffer(_),ee}function R(_){var I=new FileReader,ee=V(I);return I.readAsText(_),ee}function $(_){for(var I=new Uint8Array(_),ee=new Array(I.length),X=0;X<I.length;X++)ee[X]=String.fromCharCode(I[X]);return ee.join("")}function x(_){if(_.slice)return _.slice(0);var I=new Uint8Array(_.byteLength);return I.set(new Uint8Array(_)),I.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:d.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:d.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():d.arrayBuffer&&d.blob&&v(_)?(this._bodyArrayBuffer=x(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||A(_))?this._bodyArrayBuffer=x(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ae)}),this.text=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return R(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve($(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(Y)}),this.json=function(){return this.text().then(JSON.parse)},this}var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(_){var I=_.toUpperCase();return b.indexOf(I)>-1?I:_}function m(_,I){I=I||{};var ee=I.body;if(_ instanceof m){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,I.headers||(this.headers=new M(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!ee&&_._bodyInit!=null&&(ee=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new M(I.headers)),this.method=c(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function Y(_){var I=new FormData;return _.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),z=X.shift().replace(/\+/g," "),k=X.join("=").replace(/\+/g," ");I.append(decodeURIComponent(z),decodeURIComponent(k))}}),I}function G(_){var I=new M,ee=_.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var z=X.split(":"),k=z.shift().trim();if(k){var J=z.join(":").trim();I.append(k,J)}}),I}P.call(m.prototype);function ne(_,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new M(I.headers),this.url=I.url||"",this._initBody(_)}P.call(ne.prototype),ne.prototype.clone=function(){return new ne(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new M(this.headers),url:this.url})},ne.error=function(){var _=new ne(null,{status:0,statusText:""});return _.type="error",_};var ce=[301,302,303,307,308];ne.redirect=function(_,I){if(ce.indexOf(I)===-1)throw new RangeError("Invalid status code");return new ne(null,{status:I,headers:{location:_}})},p.DOMException=l.DOMException;try{new p.DOMException}catch{p.DOMException=function(I,ee){this.message=I,this.name=ee;var X=Error(I);this.stack=X.stack},p.DOMException.prototype=Object.create(Error.prototype),p.DOMException.prototype.constructor=p.DOMException}function de(_,I){return new Promise(function(ee,X){var z=new m(_,I);if(z.signal&&z.signal.aborted)return X(new p.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function J(){k.abort()}k.onload=function(){var re={status:k.status,statusText:k.statusText,headers:G(k.getAllResponseHeaders()||"")};re.url="responseURL"in k?k.responseURL:re.headers.get("X-Request-URL");var me="response"in k?k.response:k.responseText;ee(new ne(me,re))},k.onerror=function(){X(new TypeError("Network request failed"))},k.ontimeout=function(){X(new TypeError("Network request failed"))},k.onabort=function(){X(new p.DOMException("Aborted","AbortError"))},k.open(z.method,z.url,!0),z.credentials==="include"?k.withCredentials=!0:z.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&d.blob&&(k.responseType="blob"),z.headers.forEach(function(re,me){k.setRequestHeader(me,re)}),z.signal&&(z.signal.addEventListener("abort",J),k.onreadystatechange=function(){k.readyState===4&&z.signal.removeEventListener("abort",J)}),k.send(typeof z._bodyInit>"u"?null:z._bodyInit)})}return de.polyfill=!0,l.fetch||(l.fetch=de,l.Headers=M,l.Request=m,l.Response=ne),p.Headers=M,p.Request=m,p.Response=ne,p.fetch=de,Object.defineProperty(p,"__esModule",{value:!0}),p})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(AS,Fo);const zf=G_(Fo),PS={Accept:"application/json","Content-Type":"application/json"},TS="POST",Kf={headers:PS,method:TS},Vf=10;class nn{constructor(t){if(this.url=t,this.events=new cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!mf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=ls(t),l=await(await zf(this.url,Object.assign(Object.assign({},Kf),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!mf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{const r=ls({id:1,jsonrpc:"2.0",method:"test",params:[]});await zf(t,Object.assign(Object.assign({},Kf),{body:r})),this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?fu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=zo(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return Kd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Vf&&this.events.setMaxListeners(Vf)}}const kf="error",CS="wss://relay.walletconnect.com",NS="wc",RS="universal_provider",Gf=`${NS}@${2}:${RS}:`,US="https://rpc.walletconnect.com/v1",Ri={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",d="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",E=500,A="__lodash_placeholder__",N=1,H=2,F=4,M=1,K=2,V=1,ae=2,R=4,$=8,x=16,P=32,b=64,c=128,m=256,Y=512,G=30,ne="...",ce=800,de=16,_=1,I=2,ee=3,X=1/0,z=9007199254740991,k=17976931348623157e292,J=0/0,re=4294967295,me=re-1,se=re>>>1,be=[["ary",c],["bind",V],["bindKey",ae],["curry",$],["curryRight",x],["flip",Y],["partial",P],["partialRight",b],["rearg",m]],he="[object Arguments]",ye="[object Array]",q="[object AsyncFunction]",j="[object Boolean]",C="[object Date]",h="[object DOMException]",O="[object Error]",oe="[object Function]",fe="[object GeneratorFunction]",xe="[object Map]",Be="[object Number]",Ve="[object Null]",$e="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",Oe="[object Set]",Ue="[object String]",Le="[object Symbol]",qe="[object Undefined]",Pe="[object WeakMap]",Fe="[object WeakSet]",Ie="[object ArrayBuffer]",Te="[object DataView]",ze="[object Float32Array]",Ae="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",ur="[object Uint32Array]",kr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,ti=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yi=/&(?:amp|lt|gt|quot|#39);/g,Ui=/[&<>"']/g,wt=RegExp(yi.source),vt=RegExp(Ui.source),Et=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,Ft=RegExp(It.source),xt=/^\s+/,Pt=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Dt=/,? & /,$t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ko=/[()=,{}\[\]\/\s]/,Go=/\\(\\)?/g,Wo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Yo=/^[-+]0x[0-9a-f]+$/i,Jo=/^0b[01]+$/i,Xo=/^\[object .+?Constructor\]$/,Zo=/^0o[0-7]+$/i,Qo=/^(?:0|[1-9]\d*)$/,ri=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,on=/($^)/,ea=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",ta="\\u0300-\\u036f",ra="\\ufe20-\\ufe2f",cn="\\u20d0-\\u20ff",ys=ta+ra+cn,_s="\\u2700-\\u27bf",Mr="a-z\\xdf-\\xf6\\xf8-\\xff",ia="\\xac\\xb1\\xd7\\xf7",na="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",sa="\\u2000-\\u206f",oa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ms="A-Z\\xc0-\\xd6\\xd8-\\xde",bs="\\ufe0e\\ufe0f",Li=ia+na+sa+oa,Un="['’]",Fi="["+an+"]",Ln="["+Li+"]",Di="["+ys+"]",ws="\\d+",aa="["+_s+"]",Es="["+Mr+"]",Ss="[^"+an+Li+ws+_s+Mr+ms+"]",un="\\ud83c[\\udffb-\\udfff]",ca="(?:"+Di+"|"+un+")",Is="[^"+an+"]",hn="(?:\\ud83c[\\udde6-\\uddff]){2}",_i="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+ms+"]",xs="\\u200d",Os="(?:"+Es+"|"+Ss+")",Gr="(?:"+_r+"|"+Ss+")",As="(?:"+Un+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Un+"(?:D|LL|M|RE|S|T|VE))?",Ts=ca+"?",Cs="["+bs+"]?",ua="(?:"+xs+"(?:"+[Is,hn,_i].join("|")+")"+Cs+Ts+")*",ii="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ns="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rs=Cs+Ts+ua,ln="(?:"+[aa,hn,_i].join("|")+")"+Rs,ha="(?:"+[Is+Di+"?",Di,hn,_i,Fi].join("|")+")",Fn=RegExp(Un,"g"),la=RegExp(Di,"g"),fn=RegExp(un+"(?="+un+")|"+ha+Rs,"g"),Us=RegExp([_r+"?"+Es+"+"+As+"(?="+[Ln,_r,"$"].join("|")+")",Gr+"+"+Ps+"(?="+[Ln,_r+Os,"$"].join("|")+")",_r+"?"+Os+"+"+As,_r+"+"+Ps,Ns,ii,ws,ln].join("|"),"g"),Ls=RegExp("["+xs+an+ys+bs+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fa=-1,ot={};ot[ze]=ot[Ae]=ot[ke]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[Zt]=ot[ur]=!0,ot[he]=ot[ye]=ot[Ie]=ot[j]=ot[Te]=ot[C]=ot[O]=ot[oe]=ot[xe]=ot[Be]=ot[$e]=ot[je]=ot[Oe]=ot[Ue]=ot[Pe]=!1;var st={};st[he]=st[ye]=st[Ie]=st[Te]=st[j]=st[C]=st[ze]=st[Ae]=st[ke]=st[We]=st[et]=st[xe]=st[Be]=st[$e]=st[je]=st[Oe]=st[Ue]=st[Le]=st[tt]=st[Je]=st[Zt]=st[ur]=!0,st[O]=st[oe]=st[Pe]=!1;var w={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ne=parseInt,ft=typeof cs=="object"&&cs&&cs.Object===Object&&cs,Mt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||Mt||Function("return this")(),ct=t&&!t.nodeType&&t,Tt=ct&&!0&&n&&!n.nodeType&&n,hr=Tt&&Tt.exports===ct,jt=hr&&ft.process,dt=function(){try{var L=Tt&&Tt.require&&Tt.require("util").types;return L||jt&&jt.binding&&jt.binding("util")}catch{}}(),er=dt&&dt.isArrayBuffer,jr=dt&&dt.isDate,Or=dt&&dt.isMap,Wr=dt&&dt.isRegExp,Dn=dt&&dt.isSet,Mi=dt&&dt.isTypedArray;function zt(L,W,B){switch(B.length){case 0:return L.call(W);case 1:return L.call(W,B[0]);case 2:return L.call(W,B[0],B[1]);case 3:return L.call(W,B[0],B[1],B[2])}return L.apply(W,B)}function gp(L,W,B,ge){for(var Ce=-1,rt=L==null?0:L.length;++Ce<rt;){var Ht=L[Ce];W(ge,Ht,B(Ht),L)}return ge}function Ar(L,W){for(var B=-1,ge=L==null?0:L.length;++B<ge&&W(L[B],B,L)!==!1;);return L}function vp(L,W){for(var B=L==null?0:L.length;B--&&W(L[B],B,L)!==!1;);return L}function Eu(L,W){for(var B=-1,ge=L==null?0:L.length;++B<ge;)if(!W(L[B],B,L))return!1;return!0}function mi(L,W){for(var B=-1,ge=L==null?0:L.length,Ce=0,rt=[];++B<ge;){var Ht=L[B];W(Ht,B,L)&&(rt[Ce++]=Ht)}return rt}function Ds(L,W){var B=L==null?0:L.length;return!!B&&dn(L,W,0)>-1}function da(L,W,B){for(var ge=-1,Ce=L==null?0:L.length;++ge<Ce;)if(B(W,L[ge]))return!0;return!1}function _t(L,W){for(var B=-1,ge=L==null?0:L.length,Ce=Array(ge);++B<ge;)Ce[B]=W(L[B],B,L);return Ce}function bi(L,W){for(var B=-1,ge=W.length,Ce=L.length;++B<ge;)L[Ce+B]=W[B];return L}function pa(L,W,B,ge){var Ce=-1,rt=L==null?0:L.length;for(ge&&rt&&(B=L[++Ce]);++Ce<rt;)B=W(B,L[Ce],Ce,L);return B}function yp(L,W,B,ge){var Ce=L==null?0:L.length;for(ge&&Ce&&(B=L[--Ce]);Ce--;)B=W(B,L[Ce],Ce,L);return B}function ga(L,W){for(var B=-1,ge=L==null?0:L.length;++B<ge;)if(W(L[B],B,L))return!0;return!1}var _p=va("length");function mp(L){return L.split("")}function bp(L){return L.match($t)||[]}function Su(L,W,B){var ge;return B(L,function(Ce,rt,Ht){if(W(Ce,rt,Ht))return ge=rt,!1}),ge}function $s(L,W,B,ge){for(var Ce=L.length,rt=B+(ge?1:-1);ge?rt--:++rt<Ce;)if(W(L[rt],rt,L))return rt;return-1}function dn(L,W,B){return W===W?Rp(L,W,B):$s(L,Iu,B)}function wp(L,W,B,ge){for(var Ce=B-1,rt=L.length;++Ce<rt;)if(ge(L[Ce],W))return Ce;return-1}function Iu(L){return L!==L}function xu(L,W){var B=L==null?0:L.length;return B?_a(L,W)/B:J}function va(L){return function(W){return W==null?r:W[L]}}function ya(L){return function(W){return L==null?r:L[W]}}function Ou(L,W,B,ge,Ce){return Ce(L,function(rt,Ht,ut){B=ge?(ge=!1,rt):W(B,rt,Ht,ut)}),B}function Ep(L,W){var B=L.length;for(L.sort(W);B--;)L[B]=L[B].value;return L}function _a(L,W){for(var B,ge=-1,Ce=L.length;++ge<Ce;){var rt=W(L[ge]);rt!==r&&(B=B===r?rt:B+rt)}return B}function ma(L,W){for(var B=-1,ge=Array(L);++B<L;)ge[B]=W(B);return ge}function Sp(L,W){return _t(W,function(B){return[B,L[B]]})}function Au(L){return L&&L.slice(0,Nu(L)+1).replace(xt,"")}function mr(L){return function(W){return L(W)}}function ba(L,W){return _t(W,function(B){return L[B]})}function $n(L,W){return L.has(W)}function Pu(L,W){for(var B=-1,ge=L.length;++B<ge&&dn(W,L[B],0)>-1;);return B}function Tu(L,W){for(var B=L.length;B--&&dn(W,L[B],0)>-1;);return B}function Ip(L,W){for(var B=L.length,ge=0;B--;)L[B]===W&&++ge;return ge}var xp=ya(w),Op=ya(U);function Ap(L){return"\\"+pe[L]}function Pp(L,W){return L==null?r:L[W]}function pn(L){return Ls.test(L)}function Tp(L){return $i.test(L)}function Cp(L){for(var W,B=[];!(W=L.next()).done;)B.push(W.value);return B}function wa(L){var W=-1,B=Array(L.size);return L.forEach(function(ge,Ce){B[++W]=[Ce,ge]}),B}function Cu(L,W){return function(B){return L(W(B))}}function wi(L,W){for(var B=-1,ge=L.length,Ce=0,rt=[];++B<ge;){var Ht=L[B];(Ht===W||Ht===A)&&(L[B]=A,rt[Ce++]=B)}return rt}function Ms(L){var W=-1,B=Array(L.size);return L.forEach(function(ge){B[++W]=ge}),B}function Np(L){var W=-1,B=Array(L.size);return L.forEach(function(ge){B[++W]=[ge,ge]}),B}function Rp(L,W,B){for(var ge=B-1,Ce=L.length;++ge<Ce;)if(L[ge]===W)return ge;return-1}function Up(L,W,B){for(var ge=B+1;ge--;)if(L[ge]===W)return ge;return ge}function gn(L){return pn(L)?Fp(L):_p(L)}function qr(L){return pn(L)?Dp(L):mp(L)}function Nu(L){for(var W=L.length;W--&&Pt.test(L.charAt(W)););return W}var Lp=ya(te);function Fp(L){for(var W=fn.lastIndex=0;fn.test(L);)++W;return W}function Dp(L){return L.match(fn)||[]}function $p(L){return L.match(Us)||[]}var Mp=function L(W){W=W==null?Xe:vn.defaults(Xe.Object(),W,vn.pick(Xe,Fs));var B=W.Array,ge=W.Date,Ce=W.Error,rt=W.Function,Ht=W.Math,ut=W.Object,Ea=W.RegExp,jp=W.String,Pr=W.TypeError,js=B.prototype,qp=rt.prototype,yn=ut.prototype,qs=W["__core-js_shared__"],Hs=qp.toString,nt=yn.hasOwnProperty,Hp=0,Ru=function(){var e=/[^.]+$/.exec(qs&&qs.keys&&qs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Bs=yn.toString,Bp=Hs.call(ut),zp=Xe._,Kp=Ea("^"+Hs.call(nt).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=hr?W.Buffer:r,Ei=W.Symbol,Ks=W.Uint8Array,Uu=zs?zs.allocUnsafe:r,Vs=Cu(ut.getPrototypeOf,ut),Lu=ut.create,Fu=yn.propertyIsEnumerable,ks=js.splice,Du=Ei?Ei.isConcatSpreadable:r,Mn=Ei?Ei.iterator:r,ji=Ei?Ei.toStringTag:r,Gs=function(){try{var e=Ki(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Vp=W.clearTimeout!==Xe.clearTimeout&&W.clearTimeout,kp=ge&&ge.now!==Xe.Date.now&&ge.now,Gp=W.setTimeout!==Xe.setTimeout&&W.setTimeout,Ws=Ht.ceil,Ys=Ht.floor,Sa=ut.getOwnPropertySymbols,Wp=zs?zs.isBuffer:r,$u=W.isFinite,Yp=js.join,Jp=Cu(ut.keys,ut),Bt=Ht.max,Yt=Ht.min,Xp=ge.now,Zp=W.parseInt,Mu=Ht.random,Qp=js.reverse,Ia=Ki(W,"DataView"),jn=Ki(W,"Map"),xa=Ki(W,"Promise"),_n=Ki(W,"Set"),qn=Ki(W,"WeakMap"),Hn=Ki(ut,"create"),Js=qn&&new qn,mn={},eg=Vi(Ia),tg=Vi(jn),rg=Vi(xa),ig=Vi(_n),ng=Vi(qn),Xs=Ei?Ei.prototype:r,Bn=Xs?Xs.valueOf:r,ju=Xs?Xs.toString:r;function g(e){if(At(e)&&!Re(e)&&!(e instanceof Ye)){if(e instanceof Tr)return e;if(nt.call(e,"__wrapped__"))return qh(e)}return new Tr(e)}var bn=function(){function e(){}return function(i){if(!bt(i))return{};if(Lu)return Lu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Zs(){}function Tr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}g.templateSettings={escape:Et,evaluate:St,interpolate:mt,variable:"",imports:{_:g}},g.prototype=Zs.prototype,g.prototype.constructor=g,Tr.prototype=bn(Zs.prototype),Tr.prototype.constructor=Tr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function sg(){var e=new Ye(this.__wrapped__);return e.__actions__=lr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=lr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=lr(this.__views__),e}function og(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ag(){var e=this.__wrapped__.value(),i=this.__dir__,o=Re(e),u=i<0,f=o?e.length:0,y=m0(0,f,this.__views__),S=y.start,T=y.end,D=T-S,Z=u?T:S-1,Q=this.__iteratees__,ie=Q.length,ue=0,ve=Yt(D,this.__takeCount__);if(!o||!u&&f==D&&ve==D)return uh(e,this.__actions__);var we=[];e:for(;D--&&ue<ve;){Z+=i;for(var He=-1,Ee=e[Z];++He<ie;){var Ge=Q[He],Ze=Ge.iteratee,Er=Ge.type,ir=Ze(Ee);if(Er==I)Ee=ir;else if(!ir){if(Er==_)continue e;break e}}we[ue++]=Ee}return we}Ye.prototype=bn(Zs.prototype),Ye.prototype.constructor=Ye;function qi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function cg(){this.__data__=Hn?Hn(null):{},this.size=0}function ug(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function hg(e){var i=this.__data__;if(Hn){var o=i[e];return o===v?r:o}return nt.call(i,e)?i[e]:r}function lg(e){var i=this.__data__;return Hn?i[e]!==r:nt.call(i,e)}function fg(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Hn&&i===r?v:i,this}qi.prototype.clear=cg,qi.prototype.delete=ug,qi.prototype.get=hg,qi.prototype.has=lg,qi.prototype.set=fg;function ni(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function dg(){this.__data__=[],this.size=0}function pg(e){var i=this.__data__,o=Qs(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():ks.call(i,o,1),--this.size,!0}function gg(e){var i=this.__data__,o=Qs(i,e);return o<0?r:i[o][1]}function vg(e){return Qs(this.__data__,e)>-1}function yg(e,i){var o=this.__data__,u=Qs(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}ni.prototype.clear=dg,ni.prototype.delete=pg,ni.prototype.get=gg,ni.prototype.has=vg,ni.prototype.set=yg;function si(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function _g(){this.size=0,this.__data__={hash:new qi,map:new(jn||ni),string:new qi}}function mg(e){var i=lo(this,e).delete(e);return this.size-=i?1:0,i}function bg(e){return lo(this,e).get(e)}function wg(e){return lo(this,e).has(e)}function Eg(e,i){var o=lo(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}si.prototype.clear=_g,si.prototype.delete=mg,si.prototype.get=bg,si.prototype.has=wg,si.prototype.set=Eg;function Hi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new si;++i<o;)this.add(e[i])}function Sg(e){return this.__data__.set(e,v),this}function Ig(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=Sg,Hi.prototype.has=Ig;function Hr(e){var i=this.__data__=new ni(e);this.size=i.size}function xg(){this.__data__=new ni,this.size=0}function Og(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Ag(e){return this.__data__.get(e)}function Pg(e){return this.__data__.has(e)}function Tg(e,i){var o=this.__data__;if(o instanceof ni){var u=o.__data__;if(!jn||u.length<a-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new si(u)}return o.set(e,i),this.size=o.size,this}Hr.prototype.clear=xg,Hr.prototype.delete=Og,Hr.prototype.get=Ag,Hr.prototype.has=Pg,Hr.prototype.set=Tg;function qu(e,i){var o=Re(e),u=!o&&ki(e),f=!o&&!u&&Ai(e),y=!o&&!u&&!f&&In(e),S=o||u||f||y,T=S?ma(e.length,jp):[],D=T.length;for(var Z in e)(i||nt.call(e,Z))&&!(S&&(Z=="length"||f&&(Z=="offset"||Z=="parent")||y&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||ui(Z,D)))&&T.push(Z);return T}function Hu(e){var i=e.length;return i?e[Da(0,i-1)]:r}function Cg(e,i){return fo(lr(e),Bi(i,0,e.length))}function Ng(e){return fo(lr(e))}function Oa(e,i,o){(o!==r&&!Br(e[i],o)||o===r&&!(i in e))&&oi(e,i,o)}function zn(e,i,o){var u=e[i];(!(nt.call(e,i)&&Br(u,o))||o===r&&!(i in e))&&oi(e,i,o)}function Qs(e,i){for(var o=e.length;o--;)if(Br(e[o][0],i))return o;return-1}function Rg(e,i,o,u){return Si(e,function(f,y,S){i(u,f,o(f),S)}),u}function Bu(e,i){return e&&Jr(i,Kt(i),e)}function Ug(e,i){return e&&Jr(i,dr(i),e)}function oi(e,i,o){i=="__proto__"&&Gs?Gs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Aa(e,i){for(var o=-1,u=i.length,f=B(u),y=e==null;++o<u;)f[o]=y?r:ac(e,i[o]);return f}function Bi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,o,u,f,y){var S,T=i&N,D=i&H,Z=i&F;if(o&&(S=f?o(e,u,f,y):o(e)),S!==r)return S;if(!bt(e))return e;var Q=Re(e);if(Q){if(S=w0(e),!T)return lr(e,S)}else{var ie=Jt(e),ue=ie==oe||ie==fe;if(Ai(e))return fh(e,T);if(ie==$e||ie==he||ue&&!f){if(S=D||ue?{}:Nh(e),!T)return D?h0(e,Ug(S,e)):u0(e,Bu(S,e))}else{if(!st[ie])return f?e:{};S=E0(e,ie,T)}}y||(y=new Hr);var ve=y.get(e);if(ve)return ve;y.set(e,S),ol(e)?e.forEach(function(Ee){S.add(Cr(Ee,i,o,Ee,e,y))}):nl(e)&&e.forEach(function(Ee,Ge){S.set(Ge,Cr(Ee,i,o,Ge,e,y))});var we=Z?D?Ga:ka:D?dr:Kt,He=Q?r:we(e);return Ar(He||e,function(Ee,Ge){He&&(Ge=Ee,Ee=e[Ge]),zn(S,Ge,Cr(Ee,i,o,Ge,e,y))}),S}function Lg(e){var i=Kt(e);return function(o){return zu(o,e,i)}}function zu(e,i,o){var u=o.length;if(e==null)return!u;for(e=ut(e);u--;){var f=o[u],y=i[f],S=e[f];if(S===r&&!(f in e)||!y(S))return!1}return!0}function Ku(e,i,o){if(typeof e!="function")throw new Pr(p);return Jn(function(){e.apply(r,o)},i)}function Kn(e,i,o,u){var f=-1,y=Ds,S=!0,T=e.length,D=[],Z=i.length;if(!T)return D;o&&(i=_t(i,mr(o))),u?(y=da,S=!1):i.length>=a&&(y=$n,S=!1,i=new Hi(i));e:for(;++f<T;){var Q=e[f],ie=o==null?Q:o(Q);if(Q=u||Q!==0?Q:0,S&&ie===ie){for(var ue=Z;ue--;)if(i[ue]===ie)continue e;D.push(Q)}else y(i,ie,u)||D.push(Q)}return D}var Si=yh(Yr),Vu=yh(Ta,!0);function Fg(e,i){var o=!0;return Si(e,function(u,f,y){return o=!!i(u,f,y),o}),o}function eo(e,i,o){for(var u=-1,f=e.length;++u<f;){var y=e[u],S=i(y);if(S!=null&&(T===r?S===S&&!wr(S):o(S,T)))var T=S,D=y}return D}function Dg(e,i,o,u){var f=e.length;for(o=Me(o),o<0&&(o=-o>f?0:f+o),u=u===r||u>f?f:Me(u),u<0&&(u+=f),u=o>u?0:cl(u);o<u;)e[o++]=i;return e}function ku(e,i){var o=[];return Si(e,function(u,f,y){i(u,f,y)&&o.push(u)}),o}function Gt(e,i,o,u,f){var y=-1,S=e.length;for(o||(o=I0),f||(f=[]);++y<S;){var T=e[y];i>0&&o(T)?i>1?Gt(T,i-1,o,u,f):bi(f,T):u||(f[f.length]=T)}return f}var Pa=_h(),Gu=_h(!0);function Yr(e,i){return e&&Pa(e,i,Kt)}function Ta(e,i){return e&&Gu(e,i,Kt)}function to(e,i){return mi(i,function(o){return hi(e[o])})}function zi(e,i){i=xi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Xr(i[o++])];return o&&o==u?e:r}function Wu(e,i,o){var u=i(e);return Re(e)?u:bi(u,o(e))}function tr(e){return e==null?e===r?qe:Ve:ji&&ji in ut(e)?_0(e):N0(e)}function Ca(e,i){return e>i}function $g(e,i){return e!=null&&nt.call(e,i)}function Mg(e,i){return e!=null&&i in ut(e)}function jg(e,i,o){return e>=Yt(i,o)&&e<Bt(i,o)}function Na(e,i,o){for(var u=o?da:Ds,f=e[0].length,y=e.length,S=y,T=B(y),D=1/0,Z=[];S--;){var Q=e[S];S&&i&&(Q=_t(Q,mr(i))),D=Yt(Q.length,D),T[S]=!o&&(i||f>=120&&Q.length>=120)?new Hi(S&&Q):r}Q=e[0];var ie=-1,ue=T[0];e:for(;++ie<f&&Z.length<D;){var ve=Q[ie],we=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(ue?$n(ue,we):u(Z,we,o))){for(S=y;--S;){var He=T[S];if(!(He?$n(He,we):u(e[S],we,o)))continue e}ue&&ue.push(we),Z.push(ve)}}return Z}function qg(e,i,o,u){return Yr(e,function(f,y,S){i(u,o(f),y,S)}),u}function Vn(e,i,o){i=xi(i,e),e=Fh(e,i);var u=e==null?e:e[Xr(Rr(i))];return u==null?r:zt(u,e,o)}function Yu(e){return At(e)&&tr(e)==he}function Hg(e){return At(e)&&tr(e)==Ie}function Bg(e){return At(e)&&tr(e)==C}function kn(e,i,o,u,f){return e===i?!0:e==null||i==null||!At(e)&&!At(i)?e!==e&&i!==i:zg(e,i,o,u,kn,f)}function zg(e,i,o,u,f,y){var S=Re(e),T=Re(i),D=S?ye:Jt(e),Z=T?ye:Jt(i);D=D==he?$e:D,Z=Z==he?$e:Z;var Q=D==$e,ie=Z==$e,ue=D==Z;if(ue&&Ai(e)){if(!Ai(i))return!1;S=!0,Q=!1}if(ue&&!Q)return y||(y=new Hr),S||In(e)?Ph(e,i,o,u,f,y):v0(e,i,D,o,u,f,y);if(!(o&M)){var ve=Q&&nt.call(e,"__wrapped__"),we=ie&&nt.call(i,"__wrapped__");if(ve||we){var He=ve?e.value():e,Ee=we?i.value():i;return y||(y=new Hr),f(He,Ee,o,u,y)}}return ue?(y||(y=new Hr),y0(e,i,o,u,f,y)):!1}function Kg(e){return At(e)&&Jt(e)==xe}function Ra(e,i,o,u){var f=o.length,y=f,S=!u;if(e==null)return!y;for(e=ut(e);f--;){var T=o[f];if(S&&T[2]?T[1]!==e[T[0]]:!(T[0]in e))return!1}for(;++f<y;){T=o[f];var D=T[0],Z=e[D],Q=T[1];if(S&&T[2]){if(Z===r&&!(D in e))return!1}else{var ie=new Hr;if(u)var ue=u(Z,Q,D,e,i,ie);if(!(ue===r?kn(Q,Z,M|K,u,ie):ue))return!1}}return!0}function Ju(e){if(!bt(e)||O0(e))return!1;var i=hi(e)?Kp:Xo;return i.test(Vi(e))}function Vg(e){return At(e)&&tr(e)==je}function kg(e){return At(e)&&Jt(e)==Oe}function Gg(e){return At(e)&&mo(e.length)&&!!ot[tr(e)]}function Xu(e){return typeof e=="function"?e:e==null?pr:typeof e=="object"?Re(e)?eh(e[0],e[1]):Qu(e):ml(e)}function Ua(e){if(!Yn(e))return Jp(e);var i=[];for(var o in ut(e))nt.call(e,o)&&o!="constructor"&&i.push(o);return i}function Wg(e){if(!bt(e))return C0(e);var i=Yn(e),o=[];for(var u in e)u=="constructor"&&(i||!nt.call(e,u))||o.push(u);return o}function La(e,i){return e<i}function Zu(e,i){var o=-1,u=fr(e)?B(e.length):[];return Si(e,function(f,y,S){u[++o]=i(f,y,S)}),u}function Qu(e){var i=Ya(e);return i.length==1&&i[0][2]?Uh(i[0][0],i[0][1]):function(o){return o===e||Ra(o,e,i)}}function eh(e,i){return Xa(e)&&Rh(i)?Uh(Xr(e),i):function(o){var u=ac(o,e);return u===r&&u===i?cc(o,e):kn(i,u,M|K)}}function ro(e,i,o,u,f){e!==i&&Pa(i,function(y,S){if(f||(f=new Hr),bt(y))Yg(e,i,S,o,ro,u,f);else{var T=u?u(Qa(e,S),y,S+"",e,i,f):r;T===r&&(T=y),Oa(e,S,T)}},dr)}function Yg(e,i,o,u,f,y,S){var T=Qa(e,o),D=Qa(i,o),Z=S.get(D);if(Z){Oa(e,o,Z);return}var Q=y?y(T,D,o+"",e,i,S):r,ie=Q===r;if(ie){var ue=Re(D),ve=!ue&&Ai(D),we=!ue&&!ve&&In(D);Q=D,ue||ve||we?Re(T)?Q=T:Ct(T)?Q=lr(T):ve?(ie=!1,Q=fh(D,!0)):we?(ie=!1,Q=dh(D,!0)):Q=[]:Xn(D)||ki(D)?(Q=T,ki(T)?Q=ul(T):(!bt(T)||hi(T))&&(Q=Nh(D))):ie=!1}ie&&(S.set(D,Q),f(Q,D,u,y,S),S.delete(D)),Oa(e,o,Q)}function th(e,i){var o=e.length;if(o)return i+=i<0?o:0,ui(i,o)?e[i]:r}function rh(e,i,o){i.length?i=_t(i,function(y){return Re(y)?function(S){return zi(S,y.length===1?y[0]:y)}:y}):i=[pr];var u=-1;i=_t(i,mr(_e()));var f=Zu(e,function(y,S,T){var D=_t(i,function(Z){return Z(y)});return{criteria:D,index:++u,value:y}});return Ep(f,function(y,S){return c0(y,S,o)})}function Jg(e,i){return ih(e,i,function(o,u){return cc(e,u)})}function ih(e,i,o){for(var u=-1,f=i.length,y={};++u<f;){var S=i[u],T=zi(e,S);o(T,S)&&Gn(y,xi(S,e),T)}return y}function Xg(e){return function(i){return zi(i,e)}}function Fa(e,i,o,u){var f=u?wp:dn,y=-1,S=i.length,T=e;for(e===i&&(i=lr(i)),o&&(T=_t(e,mr(o)));++y<S;)for(var D=0,Z=i[y],Q=o?o(Z):Z;(D=f(T,Q,D,u))>-1;)T!==e&&ks.call(T,D,1),ks.call(e,D,1);return e}function nh(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==y){var y=f;ui(f)?ks.call(e,f,1):ja(e,f)}}return e}function Da(e,i){return e+Ys(Mu()*(i-e+1))}function Zg(e,i,o,u){for(var f=-1,y=Bt(Ws((i-e)/(o||1)),0),S=B(y);y--;)S[u?y:++f]=e,e+=o;return S}function $a(e,i){var o="";if(!e||i<1||i>z)return o;do i%2&&(o+=e),i=Ys(i/2),i&&(e+=e);while(i);return o}function Ke(e,i){return ec(Lh(e,i,pr),e+"")}function Qg(e){return Hu(xn(e))}function e0(e,i){var o=xn(e);return fo(o,Bi(i,0,o.length))}function Gn(e,i,o,u){if(!bt(e))return e;i=xi(i,e);for(var f=-1,y=i.length,S=y-1,T=e;T!=null&&++f<y;){var D=Xr(i[f]),Z=o;if(D==="__proto__"||D==="constructor"||D==="prototype")return e;if(f!=S){var Q=T[D];Z=u?u(Q,D,T):r,Z===r&&(Z=bt(Q)?Q:ui(i[f+1])?[]:{})}zn(T,D,Z),T=T[D]}return e}var sh=Js?function(e,i){return Js.set(e,i),e}:pr,t0=Gs?function(e,i){return Gs(e,"toString",{configurable:!0,enumerable:!1,value:hc(i),writable:!0})}:pr;function r0(e){return fo(xn(e))}function Nr(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var y=B(f);++u<f;)y[u]=e[u+i];return y}function i0(e,i){var o;return Si(e,function(u,f,y){return o=i(u,f,y),!o}),!!o}function io(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=se){for(;u<f;){var y=u+f>>>1,S=e[y];S!==null&&!wr(S)&&(o?S<=i:S<i)?u=y+1:f=y}return f}return Ma(e,i,pr,o)}function Ma(e,i,o,u){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var S=i!==i,T=i===null,D=wr(i),Z=i===r;f<y;){var Q=Ys((f+y)/2),ie=o(e[Q]),ue=ie!==r,ve=ie===null,we=ie===ie,He=wr(ie);if(S)var Ee=u||we;else Z?Ee=we&&(u||ue):T?Ee=we&&ue&&(u||!ve):D?Ee=we&&ue&&!ve&&(u||!He):ve||He?Ee=!1:Ee=u?ie<=i:ie<i;Ee?f=Q+1:y=Q}return Yt(y,me)}function oh(e,i){for(var o=-1,u=e.length,f=0,y=[];++o<u;){var S=e[o],T=i?i(S):S;if(!o||!Br(T,D)){var D=T;y[f++]=S===0?0:S}}return y}function ah(e){return typeof e=="number"?e:wr(e)?J:+e}function br(e){if(typeof e=="string")return e;if(Re(e))return _t(e,br)+"";if(wr(e))return ju?ju.call(e):"";var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Ii(e,i,o){var u=-1,f=Ds,y=e.length,S=!0,T=[],D=T;if(o)S=!1,f=da;else if(y>=a){var Z=i?null:p0(e);if(Z)return Ms(Z);S=!1,f=$n,D=new Hi}else D=i?[]:T;e:for(;++u<y;){var Q=e[u],ie=i?i(Q):Q;if(Q=o||Q!==0?Q:0,S&&ie===ie){for(var ue=D.length;ue--;)if(D[ue]===ie)continue e;i&&D.push(ie),T.push(Q)}else f(D,ie,o)||(D!==T&&D.push(ie),T.push(Q))}return T}function ja(e,i){return i=xi(i,e),e=Fh(e,i),e==null||delete e[Xr(Rr(i))]}function ch(e,i,o,u){return Gn(e,i,o(zi(e,i)),u)}function no(e,i,o,u){for(var f=e.length,y=u?f:-1;(u?y--:++y<f)&&i(e[y],y,e););return o?Nr(e,u?0:y,u?y+1:f):Nr(e,u?y+1:0,u?f:y)}function uh(e,i){var o=e;return o instanceof Ye&&(o=o.value()),pa(i,function(u,f){return f.func.apply(f.thisArg,bi([u],f.args))},o)}function qa(e,i,o){var u=e.length;if(u<2)return u?Ii(e[0]):[];for(var f=-1,y=B(u);++f<u;)for(var S=e[f],T=-1;++T<u;)T!=f&&(y[f]=Kn(y[f]||S,e[T],i,o));return Ii(Gt(y,1),i,o)}function hh(e,i,o){for(var u=-1,f=e.length,y=i.length,S={};++u<f;){var T=u<y?i[u]:r;o(S,e[u],T)}return S}function Ha(e){return Ct(e)?e:[]}function Ba(e){return typeof e=="function"?e:pr}function xi(e,i){return Re(e)?e:Xa(e,i)?[e]:jh(it(e))}var n0=Ke;function Oi(e,i,o){var u=e.length;return o=o===r?u:o,!i&&o>=u?e:Nr(e,i,o)}var lh=Vp||function(e){return Xe.clearTimeout(e)};function fh(e,i){if(i)return e.slice();var o=e.length,u=Uu?Uu(o):new e.constructor(o);return e.copy(u),u}function za(e){var i=new e.constructor(e.byteLength);return new Ks(i).set(new Ks(e)),i}function s0(e,i){var o=i?za(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function o0(e){var i=new e.constructor(e.source,xr.exec(e));return i.lastIndex=e.lastIndex,i}function a0(e){return Bn?ut(Bn.call(e)):{}}function dh(e,i){var o=i?za(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function ph(e,i){if(e!==i){var o=e!==r,u=e===null,f=e===e,y=wr(e),S=i!==r,T=i===null,D=i===i,Z=wr(i);if(!T&&!Z&&!y&&e>i||y&&S&&D&&!T&&!Z||u&&S&&D||!o&&D||!f)return 1;if(!u&&!y&&!Z&&e<i||Z&&o&&f&&!u&&!y||T&&o&&f||!S&&f||!D)return-1}return 0}function c0(e,i,o){for(var u=-1,f=e.criteria,y=i.criteria,S=f.length,T=o.length;++u<S;){var D=ph(f[u],y[u]);if(D){if(u>=T)return D;var Z=o[u];return D*(Z=="desc"?-1:1)}}return e.index-i.index}function gh(e,i,o,u){for(var f=-1,y=e.length,S=o.length,T=-1,D=i.length,Z=Bt(y-S,0),Q=B(D+Z),ie=!u;++T<D;)Q[T]=i[T];for(;++f<S;)(ie||f<y)&&(Q[o[f]]=e[f]);for(;Z--;)Q[T++]=e[f++];return Q}function vh(e,i,o,u){for(var f=-1,y=e.length,S=-1,T=o.length,D=-1,Z=i.length,Q=Bt(y-T,0),ie=B(Q+Z),ue=!u;++f<Q;)ie[f]=e[f];for(var ve=f;++D<Z;)ie[ve+D]=i[D];for(;++S<T;)(ue||f<y)&&(ie[ve+o[S]]=e[f++]);return ie}function lr(e,i){var o=-1,u=e.length;for(i||(i=B(u));++o<u;)i[o]=e[o];return i}function Jr(e,i,o,u){var f=!o;o||(o={});for(var y=-1,S=i.length;++y<S;){var T=i[y],D=u?u(o[T],e[T],T,o,e):r;D===r&&(D=e[T]),f?oi(o,T,D):zn(o,T,D)}return o}function u0(e,i){return Jr(e,Ja(e),i)}function h0(e,i){return Jr(e,Th(e),i)}function so(e,i){return function(o,u){var f=Re(o)?gp:Rg,y=i?i():{};return f(o,e,_e(u,2),y)}}function wn(e){return Ke(function(i,o){var u=-1,f=o.length,y=f>1?o[f-1]:r,S=f>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,S&&rr(o[0],o[1],S)&&(y=f<3?r:y,f=1),i=ut(i);++u<f;){var T=o[u];T&&e(i,T,u,y)}return i})}function yh(e,i){return function(o,u){if(o==null)return o;if(!fr(o))return e(o,u);for(var f=o.length,y=i?f:-1,S=ut(o);(i?y--:++y<f)&&u(S[y],y,S)!==!1;);return o}}function _h(e){return function(i,o,u){for(var f=-1,y=ut(i),S=u(i),T=S.length;T--;){var D=S[e?T:++f];if(o(y[D],D,y)===!1)break}return i}}function l0(e,i,o){var u=i&V,f=Wn(e);function y(){var S=this&&this!==Xe&&this instanceof y?f:e;return S.apply(u?o:this,arguments)}return y}function mh(e){return function(i){i=it(i);var o=pn(i)?qr(i):r,u=o?o[0]:i.charAt(0),f=o?Oi(o,1).join(""):i.slice(1);return u[e]()+f}}function En(e){return function(i){return pa(yl(vl(i).replace(Fn,"")),e,"")}}function Wn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=bn(e.prototype),u=e.apply(o,i);return bt(u)?u:o}}function f0(e,i,o){var u=Wn(e);function f(){for(var y=arguments.length,S=B(y),T=y,D=Sn(f);T--;)S[T]=arguments[T];var Z=y<3&&S[0]!==D&&S[y-1]!==D?[]:wi(S,D);if(y-=Z.length,y<o)return Ih(e,i,oo,f.placeholder,r,S,Z,r,r,o-y);var Q=this&&this!==Xe&&this instanceof f?u:e;return zt(Q,this,S)}return f}function bh(e){return function(i,o,u){var f=ut(i);if(!fr(i)){var y=_e(o,3);i=Kt(i),o=function(T){return y(f[T],T,f)}}var S=e(i,o,u);return S>-1?f[y?i[S]:S]:r}}function wh(e){return ci(function(i){var o=i.length,u=o,f=Tr.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new Pr(p);if(f&&!S&&ho(y)=="wrapper")var S=new Tr([],!0)}for(u=S?u:o;++u<o;){y=i[u];var T=ho(y),D=T=="wrapper"?Wa(y):r;D&&Za(D[0])&&D[1]==(c|$|P|m)&&!D[4].length&&D[9]==1?S=S[ho(D[0])].apply(S,D[3]):S=y.length==1&&Za(y)?S[T]():S.thru(y)}return function(){var Z=arguments,Q=Z[0];if(S&&Z.length==1&&Re(Q))return S.plant(Q).value();for(var ie=0,ue=o?i[ie].apply(this,Z):Q;++ie<o;)ue=i[ie].call(this,ue);return ue}})}function oo(e,i,o,u,f,y,S,T,D,Z){var Q=i&c,ie=i&V,ue=i&ae,ve=i&($|x),we=i&Y,He=ue?r:Wn(e);function Ee(){for(var Ge=arguments.length,Ze=B(Ge),Er=Ge;Er--;)Ze[Er]=arguments[Er];if(ve)var ir=Sn(Ee),Sr=Ip(Ze,ir);if(u&&(Ze=gh(Ze,u,f,ve)),y&&(Ze=vh(Ze,y,S,ve)),Ge-=Sr,ve&&Ge<Z){var Nt=wi(Ze,ir);return Ih(e,i,oo,Ee.placeholder,o,Ze,Nt,T,D,Z-Ge)}var zr=ie?o:this,fi=ue?zr[e]:e;return Ge=Ze.length,T?Ze=R0(Ze,T):we&&Ge>1&&Ze.reverse(),Q&&D<Ge&&(Ze.length=D),this&&this!==Xe&&this instanceof Ee&&(fi=He||Wn(fi)),fi.apply(zr,Ze)}return Ee}function Eh(e,i){return function(o,u){return qg(o,e,i(u),{})}}function ao(e,i){return function(o,u){var f;if(o===r&&u===r)return i;if(o!==r&&(f=o),u!==r){if(f===r)return u;typeof o=="string"||typeof u=="string"?(o=br(o),u=br(u)):(o=ah(o),u=ah(u)),f=e(o,u)}return f}}function Ka(e){return ci(function(i){return i=_t(i,mr(_e())),Ke(function(o){var u=this;return e(i,function(f){return zt(f,u,o)})})})}function co(e,i){i=i===r?" ":br(i);var o=i.length;if(o<2)return o?$a(i,e):i;var u=$a(i,Ws(e/gn(i)));return pn(i)?Oi(qr(u),0,e).join(""):u.slice(0,e)}function d0(e,i,o,u){var f=i&V,y=Wn(e);function S(){for(var T=-1,D=arguments.length,Z=-1,Q=u.length,ie=B(Q+D),ue=this&&this!==Xe&&this instanceof S?y:e;++Z<Q;)ie[Z]=u[Z];for(;D--;)ie[Z++]=arguments[++T];return zt(ue,f?o:this,ie)}return S}function Sh(e){return function(i,o,u){return u&&typeof u!="number"&&rr(i,o,u)&&(o=u=r),i=li(i),o===r?(o=i,i=0):o=li(o),u=u===r?i<o?1:-1:li(u),Zg(i,o,u,e)}}function uo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Ur(i),o=Ur(o)),e(i,o)}}function Ih(e,i,o,u,f,y,S,T,D,Z){var Q=i&$,ie=Q?S:r,ue=Q?r:S,ve=Q?y:r,we=Q?r:y;i|=Q?P:b,i&=~(Q?b:P),i&R||(i&=~(V|ae));var He=[e,i,f,ve,ie,we,ue,T,D,Z],Ee=o.apply(r,He);return Za(e)&&Dh(Ee,He),Ee.placeholder=u,$h(Ee,e,i)}function Va(e){var i=Ht[e];return function(o,u){if(o=Ur(o),u=u==null?0:Yt(Me(u),292),u&&$u(o)){var f=(it(o)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+u));return f=(it(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var p0=_n&&1/Ms(new _n([,-0]))[1]==X?function(e){return new _n(e)}:dc;function xh(e){return function(i){var o=Jt(i);return o==xe?wa(i):o==Oe?Np(i):Sp(i,e(i))}}function ai(e,i,o,u,f,y,S,T){var D=i&ae;if(!D&&typeof e!="function")throw new Pr(p);var Z=u?u.length:0;if(Z||(i&=~(P|b),u=f=r),S=S===r?S:Bt(Me(S),0),T=T===r?T:Me(T),Z-=f?f.length:0,i&b){var Q=u,ie=f;u=f=r}var ue=D?r:Wa(e),ve=[e,i,o,u,f,Q,ie,y,S,T];if(ue&&T0(ve,ue),e=ve[0],i=ve[1],o=ve[2],u=ve[3],f=ve[4],T=ve[9]=ve[9]===r?D?0:e.length:Bt(ve[9]-Z,0),!T&&i&($|x)&&(i&=~($|x)),!i||i==V)var we=l0(e,i,o);else i==$||i==x?we=f0(e,i,T):(i==P||i==(V|P))&&!f.length?we=d0(e,i,o,u):we=oo.apply(r,ve);var He=ue?sh:Dh;return $h(He(we,ve),e,i)}function Oh(e,i,o,u){return e===r||Br(e,yn[o])&&!nt.call(u,o)?i:e}function Ah(e,i,o,u,f,y){return bt(e)&&bt(i)&&(y.set(i,e),ro(e,i,r,Ah,y),y.delete(i)),e}function g0(e){return Xn(e)?r:e}function Ph(e,i,o,u,f,y){var S=o&M,T=e.length,D=i.length;if(T!=D&&!(S&&D>T))return!1;var Z=y.get(e),Q=y.get(i);if(Z&&Q)return Z==i&&Q==e;var ie=-1,ue=!0,ve=o&K?new Hi:r;for(y.set(e,i),y.set(i,e);++ie<T;){var we=e[ie],He=i[ie];if(u)var Ee=S?u(He,we,ie,i,e,y):u(we,He,ie,e,i,y);if(Ee!==r){if(Ee)continue;ue=!1;break}if(ve){if(!ga(i,function(Ge,Ze){if(!$n(ve,Ze)&&(we===Ge||f(we,Ge,o,u,y)))return ve.push(Ze)})){ue=!1;break}}else if(!(we===He||f(we,He,o,u,y))){ue=!1;break}}return y.delete(e),y.delete(i),ue}function v0(e,i,o,u,f,y,S){switch(o){case Te:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ie:return!(e.byteLength!=i.byteLength||!y(new Ks(e),new Ks(i)));case j:case C:case Be:return Br(+e,+i);case O:return e.name==i.name&&e.message==i.message;case je:case Ue:return e==i+"";case xe:var T=wa;case Oe:var D=u&M;if(T||(T=Ms),e.size!=i.size&&!D)return!1;var Z=S.get(e);if(Z)return Z==i;u|=K,S.set(e,i);var Q=Ph(T(e),T(i),u,f,y,S);return S.delete(e),Q;case Le:if(Bn)return Bn.call(e)==Bn.call(i)}return!1}function y0(e,i,o,u,f,y){var S=o&M,T=ka(e),D=T.length,Z=ka(i),Q=Z.length;if(D!=Q&&!S)return!1;for(var ie=D;ie--;){var ue=T[ie];if(!(S?ue in i:nt.call(i,ue)))return!1}var ve=y.get(e),we=y.get(i);if(ve&&we)return ve==i&&we==e;var He=!0;y.set(e,i),y.set(i,e);for(var Ee=S;++ie<D;){ue=T[ie];var Ge=e[ue],Ze=i[ue];if(u)var Er=S?u(Ze,Ge,ue,i,e,y):u(Ge,Ze,ue,e,i,y);if(!(Er===r?Ge===Ze||f(Ge,Ze,o,u,y):Er)){He=!1;break}Ee||(Ee=ue=="constructor")}if(He&&!Ee){var ir=e.constructor,Sr=i.constructor;ir!=Sr&&"constructor"in e&&"constructor"in i&&!(typeof ir=="function"&&ir instanceof ir&&typeof Sr=="function"&&Sr instanceof Sr)&&(He=!1)}return y.delete(e),y.delete(i),He}function ci(e){return ec(Lh(e,r,zh),e+"")}function ka(e){return Wu(e,Kt,Ja)}function Ga(e){return Wu(e,dr,Th)}var Wa=Js?function(e){return Js.get(e)}:dc;function ho(e){for(var i=e.name+"",o=mn[i],u=nt.call(mn,i)?o.length:0;u--;){var f=o[u],y=f.func;if(y==null||y==e)return f.name}return i}function Sn(e){var i=nt.call(g,"placeholder")?g:e;return i.placeholder}function _e(){var e=g.iteratee||lc;return e=e===lc?Xu:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,i){var o=e.__data__;return x0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Ya(e){for(var i=Kt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,Rh(f)]}return i}function Ki(e,i){var o=Pp(e,i);return Ju(o)?o:r}function _0(e){var i=nt.call(e,ji),o=e[ji];try{e[ji]=r;var u=!0}catch{}var f=Bs.call(e);return u&&(i?e[ji]=o:delete e[ji]),f}var Ja=Sa?function(e){return e==null?[]:(e=ut(e),mi(Sa(e),function(i){return Fu.call(e,i)}))}:pc,Th=Sa?function(e){for(var i=[];e;)bi(i,Ja(e)),e=Vs(e);return i}:pc,Jt=tr;(Ia&&Jt(new Ia(new ArrayBuffer(1)))!=Te||jn&&Jt(new jn)!=xe||xa&&Jt(xa.resolve())!=pt||_n&&Jt(new _n)!=Oe||qn&&Jt(new qn)!=Pe)&&(Jt=function(e){var i=tr(e),o=i==$e?e.constructor:r,u=o?Vi(o):"";if(u)switch(u){case eg:return Te;case tg:return xe;case rg:return pt;case ig:return Oe;case ng:return Pe}return i});function m0(e,i,o){for(var u=-1,f=o.length;++u<f;){var y=o[u],S=y.size;switch(y.type){case"drop":e+=S;break;case"dropRight":i-=S;break;case"take":i=Yt(i,e+S);break;case"takeRight":e=Bt(e,i-S);break}}return{start:e,end:i}}function b0(e){var i=e.match(ht);return i?i[1].split(Dt):[]}function Ch(e,i,o){i=xi(i,e);for(var u=-1,f=i.length,y=!1;++u<f;){var S=Xr(i[u]);if(!(y=e!=null&&o(e,S)))break;e=e[S]}return y||++u!=f?y:(f=e==null?0:e.length,!!f&&mo(f)&&ui(S,f)&&(Re(e)||ki(e)))}function w0(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Nh(e){return typeof e.constructor=="function"&&!Yn(e)?bn(Vs(e)):{}}function E0(e,i,o){var u=e.constructor;switch(i){case Ie:return za(e);case j:case C:return new u(+e);case Te:return s0(e,o);case ze:case Ae:case ke:case We:case et:case tt:case Je:case Zt:case ur:return dh(e,o);case xe:return new u;case Be:case Ue:return new u(e);case je:return o0(e);case Oe:return new u;case Le:return a0(e)}}function S0(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(Ot,`{
/* [wrapped with `+i+`] */
`)}function I0(e){return Re(e)||ki(e)||!!(Du&&e&&e[Du])}function ui(e,i){var o=typeof e;return i=i??z,!!i&&(o=="number"||o!="symbol"&&Qo.test(e))&&e>-1&&e%1==0&&e<i}function rr(e,i,o){if(!bt(o))return!1;var u=typeof i;return(u=="number"?fr(o)&&ui(i,o.length):u=="string"&&i in o)?Br(o[i],e):!1}function Xa(e,i){if(Re(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||wr(e)?!0:Ut.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function x0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Za(e){var i=ho(e),o=g[i];if(typeof o!="function"||!(i in Ye.prototype))return!1;if(e===o)return!0;var u=Wa(o);return!!u&&e===u[0]}function O0(e){return!!Ru&&Ru in e}var A0=qs?hi:gc;function Yn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||yn;return e===o}function Rh(e){return e===e&&!bt(e)}function Uh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in ut(o))}}function P0(e){var i=yo(e,function(u){return o.size===E&&o.clear(),u}),o=i.cache;return i}function T0(e,i){var o=e[1],u=i[1],f=o|u,y=f<(V|ae|c),S=u==c&&o==$||u==c&&o==m&&e[7].length<=i[8]||u==(c|m)&&i[7].length<=i[8]&&o==$;if(!(y||S))return e;u&V&&(e[2]=i[2],f|=o&V?0:R);var T=i[3];if(T){var D=e[3];e[3]=D?gh(D,T,i[4]):T,e[4]=D?wi(e[3],A):i[4]}return T=i[5],T&&(D=e[5],e[5]=D?vh(D,T,i[6]):T,e[6]=D?wi(e[5],A):i[6]),T=i[7],T&&(e[7]=T),u&c&&(e[8]=e[8]==null?i[8]:Yt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function C0(e){var i=[];if(e!=null)for(var o in ut(e))i.push(o);return i}function N0(e){return Bs.call(e)}function Lh(e,i,o){return i=Bt(i===r?e.length-1:i,0),function(){for(var u=arguments,f=-1,y=Bt(u.length-i,0),S=B(y);++f<y;)S[f]=u[i+f];f=-1;for(var T=B(i+1);++f<i;)T[f]=u[f];return T[i]=o(S),zt(e,this,T)}}function Fh(e,i){return i.length<2?e:zi(e,Nr(i,0,-1))}function R0(e,i){for(var o=e.length,u=Yt(i.length,o),f=lr(e);u--;){var y=i[u];e[u]=ui(y,o)?f[y]:r}return e}function Qa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Dh=Mh(sh),Jn=Gp||function(e,i){return Xe.setTimeout(e,i)},ec=Mh(t0);function $h(e,i,o){var u=i+"";return ec(e,S0(u,U0(b0(u),o)))}function Mh(e){var i=0,o=0;return function(){var u=Xp(),f=de-(u-o);if(o=u,f>0){if(++i>=ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function fo(e,i){var o=-1,u=e.length,f=u-1;for(i=i===r?u:i;++o<i;){var y=Da(o,f),S=e[y];e[y]=e[o],e[o]=S}return e.length=i,e}var jh=P0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Lt,function(o,u,f,y){i.push(f?y.replace(Go,"$1"):u||o)}),i});function Xr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Vi(e){if(e!=null){try{return Hs.call(e)}catch{}try{return e+""}catch{}}return""}function U0(e,i){return Ar(be,function(o){var u="_."+o[0];i&o[1]&&!Ds(e,u)&&e.push(u)}),e.sort()}function qh(e){if(e instanceof Ye)return e.clone();var i=new Tr(e.__wrapped__,e.__chain__);return i.__actions__=lr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function L0(e,i,o){(o?rr(e,i,o):i===r)?i=1:i=Bt(Me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,y=0,S=B(Ws(u/i));f<u;)S[y++]=Nr(e,f,f+=i);return S}function F0(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var y=e[i];y&&(f[u++]=y)}return f}function D0(){var e=arguments.length;if(!e)return[];for(var i=B(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return bi(Re(o)?lr(o):[o],Gt(i,1))}var $0=Ke(function(e,i){return Ct(e)?Kn(e,Gt(i,1,Ct,!0)):[]}),M0=Ke(function(e,i){var o=Rr(i);return Ct(o)&&(o=r),Ct(e)?Kn(e,Gt(i,1,Ct,!0),_e(o,2)):[]}),j0=Ke(function(e,i){var o=Rr(i);return Ct(o)&&(o=r),Ct(e)?Kn(e,Gt(i,1,Ct,!0),r,o):[]});function q0(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Me(i),Nr(e,i<0?0:i,u)):[]}function H0(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Me(i),i=u-i,Nr(e,0,i<0?0:i)):[]}function B0(e,i){return e&&e.length?no(e,_e(i,3),!0,!0):[]}function z0(e,i){return e&&e.length?no(e,_e(i,3),!0):[]}function K0(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&rr(e,i,o)&&(o=0,u=f),Dg(e,i,o,u)):[]}function Hh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:Me(o);return f<0&&(f=Bt(u+f,0)),$s(e,_e(i,3),f)}function Bh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==r&&(f=Me(o),f=o<0?Bt(u+f,0):Yt(f,u-1)),$s(e,_e(i,3),f,!0)}function zh(e){var i=e==null?0:e.length;return i?Gt(e,1):[]}function V0(e){var i=e==null?0:e.length;return i?Gt(e,X):[]}function k0(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:Me(i),Gt(e,i)):[]}function G0(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function Kh(e){return e&&e.length?e[0]:r}function W0(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:Me(o);return f<0&&(f=Bt(u+f,0)),dn(e,i,f)}function Y0(e){var i=e==null?0:e.length;return i?Nr(e,0,-1):[]}var J0=Ke(function(e){var i=_t(e,Ha);return i.length&&i[0]===e[0]?Na(i):[]}),X0=Ke(function(e){var i=Rr(e),o=_t(e,Ha);return i===Rr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Na(o,_e(i,2)):[]}),Z0=Ke(function(e){var i=Rr(e),o=_t(e,Ha);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Na(o,r,i):[]});function Q0(e,i){return e==null?"":Yp.call(e,i)}function Rr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function e1(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==r&&(f=Me(o),f=f<0?Bt(u+f,0):Yt(f,u-1)),i===i?Up(e,i,f):$s(e,Iu,f,!0)}function t1(e,i){return e&&e.length?th(e,Me(i)):r}var r1=Ke(Vh);function Vh(e,i){return e&&e.length&&i&&i.length?Fa(e,i):e}function i1(e,i,o){return e&&e.length&&i&&i.length?Fa(e,i,_e(o,2)):e}function n1(e,i,o){return e&&e.length&&i&&i.length?Fa(e,i,r,o):e}var s1=ci(function(e,i){var o=e==null?0:e.length,u=Aa(e,i);return nh(e,_t(i,function(f){return ui(f,o)?+f:f}).sort(ph)),u});function o1(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],y=e.length;for(i=_e(i,3);++u<y;){var S=e[u];i(S,u,e)&&(o.push(S),f.push(u))}return nh(e,f),o}function tc(e){return e==null?e:Qp.call(e)}function a1(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&rr(e,i,o)?(i=0,o=u):(i=i==null?0:Me(i),o=o===r?u:Me(o)),Nr(e,i,o)):[]}function c1(e,i){return io(e,i)}function u1(e,i,o){return Ma(e,i,_e(o,2))}function h1(e,i){var o=e==null?0:e.length;if(o){var u=io(e,i);if(u<o&&Br(e[u],i))return u}return-1}function l1(e,i){return io(e,i,!0)}function f1(e,i,o){return Ma(e,i,_e(o,2),!0)}function d1(e,i){var o=e==null?0:e.length;if(o){var u=io(e,i,!0)-1;if(Br(e[u],i))return u}return-1}function p1(e){return e&&e.length?oh(e):[]}function g1(e,i){return e&&e.length?oh(e,_e(i,2)):[]}function v1(e){var i=e==null?0:e.length;return i?Nr(e,1,i):[]}function y1(e,i,o){return e&&e.length?(i=o||i===r?1:Me(i),Nr(e,0,i<0?0:i)):[]}function _1(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Me(i),i=u-i,Nr(e,i<0?0:i,u)):[]}function m1(e,i){return e&&e.length?no(e,_e(i,3),!1,!0):[]}function b1(e,i){return e&&e.length?no(e,_e(i,3)):[]}var w1=Ke(function(e){return Ii(Gt(e,1,Ct,!0))}),E1=Ke(function(e){var i=Rr(e);return Ct(i)&&(i=r),Ii(Gt(e,1,Ct,!0),_e(i,2))}),S1=Ke(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,Ii(Gt(e,1,Ct,!0),r,i)});function I1(e){return e&&e.length?Ii(e):[]}function x1(e,i){return e&&e.length?Ii(e,_e(i,2)):[]}function O1(e,i){return i=typeof i=="function"?i:r,e&&e.length?Ii(e,r,i):[]}function rc(e){if(!(e&&e.length))return[];var i=0;return e=mi(e,function(o){if(Ct(o))return i=Bt(o.length,i),!0}),ma(i,function(o){return _t(e,va(o))})}function kh(e,i){if(!(e&&e.length))return[];var o=rc(e);return i==null?o:_t(o,function(u){return zt(i,r,u)})}var A1=Ke(function(e,i){return Ct(e)?Kn(e,i):[]}),P1=Ke(function(e){return qa(mi(e,Ct))}),T1=Ke(function(e){var i=Rr(e);return Ct(i)&&(i=r),qa(mi(e,Ct),_e(i,2))}),C1=Ke(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,qa(mi(e,Ct),r,i)}),N1=Ke(rc);function R1(e,i){return hh(e||[],i||[],zn)}function U1(e,i){return hh(e||[],i||[],Gn)}var L1=Ke(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,kh(e,o)});function Gh(e){var i=g(e);return i.__chain__=!0,i}function F1(e,i){return i(e),e}function po(e,i){return i(e)}var D1=ci(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(y){return Aa(y,e)};return i>1||this.__actions__.length||!(u instanceof Ye)||!ui(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:po,args:[f],thisArg:r}),new Tr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function $1(){return Gh(this)}function M1(){return new Tr(this.value(),this.__chain__)}function j1(){this.__values__===r&&(this.__values__=al(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function q1(){return this}function H1(e){for(var i,o=this;o instanceof Zs;){var u=qh(o);u.__index__=0,u.__values__=r,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function B1(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:po,args:[tc],thisArg:r}),new Tr(i,this.__chain__)}return this.thru(tc)}function z1(){return uh(this.__wrapped__,this.__actions__)}var K1=so(function(e,i,o){nt.call(e,o)?++e[o]:oi(e,o,1)});function V1(e,i,o){var u=Re(e)?Eu:Fg;return o&&rr(e,i,o)&&(i=r),u(e,_e(i,3))}function k1(e,i){var o=Re(e)?mi:ku;return o(e,_e(i,3))}var G1=bh(Hh),W1=bh(Bh);function Y1(e,i){return Gt(go(e,i),1)}function J1(e,i){return Gt(go(e,i),X)}function X1(e,i,o){return o=o===r?1:Me(o),Gt(go(e,i),o)}function Wh(e,i){var o=Re(e)?Ar:Si;return o(e,_e(i,3))}function Yh(e,i){var o=Re(e)?vp:Vu;return o(e,_e(i,3))}var Z1=so(function(e,i,o){nt.call(e,o)?e[o].push(i):oi(e,o,[i])});function Q1(e,i,o,u){e=fr(e)?e:xn(e),o=o&&!u?Me(o):0;var f=e.length;return o<0&&(o=Bt(f+o,0)),bo(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&dn(e,i,o)>-1}var ev=Ke(function(e,i,o){var u=-1,f=typeof i=="function",y=fr(e)?B(e.length):[];return Si(e,function(S){y[++u]=f?zt(i,S,o):Vn(S,i,o)}),y}),tv=so(function(e,i,o){oi(e,o,i)});function go(e,i){var o=Re(e)?_t:Zu;return o(e,_e(i,3))}function rv(e,i,o,u){return e==null?[]:(Re(i)||(i=i==null?[]:[i]),o=u?r:o,Re(o)||(o=o==null?[]:[o]),rh(e,i,o))}var iv=so(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function nv(e,i,o){var u=Re(e)?pa:Ou,f=arguments.length<3;return u(e,_e(i,4),o,f,Si)}function sv(e,i,o){var u=Re(e)?yp:Ou,f=arguments.length<3;return u(e,_e(i,4),o,f,Vu)}function ov(e,i){var o=Re(e)?mi:ku;return o(e,_o(_e(i,3)))}function av(e){var i=Re(e)?Hu:Qg;return i(e)}function cv(e,i,o){(o?rr(e,i,o):i===r)?i=1:i=Me(i);var u=Re(e)?Cg:e0;return u(e,i)}function uv(e){var i=Re(e)?Ng:r0;return i(e)}function hv(e){if(e==null)return 0;if(fr(e))return bo(e)?gn(e):e.length;var i=Jt(e);return i==xe||i==Oe?e.size:Ua(e).length}function lv(e,i,o){var u=Re(e)?ga:i0;return o&&rr(e,i,o)&&(i=r),u(e,_e(i,3))}var fv=Ke(function(e,i){if(e==null)return[];var o=i.length;return o>1&&rr(e,i[0],i[1])?i=[]:o>2&&rr(i[0],i[1],i[2])&&(i=[i[0]]),rh(e,Gt(i,1),[])}),vo=kp||function(){return Xe.Date.now()};function dv(e,i){if(typeof i!="function")throw new Pr(p);return e=Me(e),function(){if(--e<1)return i.apply(this,arguments)}}function Jh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,ai(e,c,r,r,r,r,i)}function Xh(e,i){var o;if(typeof i!="function")throw new Pr(p);return e=Me(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var ic=Ke(function(e,i,o){var u=V;if(o.length){var f=wi(o,Sn(ic));u|=P}return ai(e,u,i,o,f)}),Zh=Ke(function(e,i,o){var u=V|ae;if(o.length){var f=wi(o,Sn(Zh));u|=P}return ai(i,u,e,o,f)});function Qh(e,i,o){i=o?r:i;var u=ai(e,$,r,r,r,r,r,i);return u.placeholder=Qh.placeholder,u}function el(e,i,o){i=o?r:i;var u=ai(e,x,r,r,r,r,r,i);return u.placeholder=el.placeholder,u}function tl(e,i,o){var u,f,y,S,T,D,Z=0,Q=!1,ie=!1,ue=!0;if(typeof e!="function")throw new Pr(p);i=Ur(i)||0,bt(o)&&(Q=!!o.leading,ie="maxWait"in o,y=ie?Bt(Ur(o.maxWait)||0,i):y,ue="trailing"in o?!!o.trailing:ue);function ve(Nt){var zr=u,fi=f;return u=f=r,Z=Nt,S=e.apply(fi,zr),S}function we(Nt){return Z=Nt,T=Jn(Ge,i),Q?ve(Nt):S}function He(Nt){var zr=Nt-D,fi=Nt-Z,bl=i-zr;return ie?Yt(bl,y-fi):bl}function Ee(Nt){var zr=Nt-D,fi=Nt-Z;return D===r||zr>=i||zr<0||ie&&fi>=y}function Ge(){var Nt=vo();if(Ee(Nt))return Ze(Nt);T=Jn(Ge,He(Nt))}function Ze(Nt){return T=r,ue&&u?ve(Nt):(u=f=r,S)}function Er(){T!==r&&lh(T),Z=0,u=D=f=T=r}function ir(){return T===r?S:Ze(vo())}function Sr(){var Nt=vo(),zr=Ee(Nt);if(u=arguments,f=this,D=Nt,zr){if(T===r)return we(D);if(ie)return lh(T),T=Jn(Ge,i),ve(D)}return T===r&&(T=Jn(Ge,i)),S}return Sr.cancel=Er,Sr.flush=ir,Sr}var pv=Ke(function(e,i){return Ku(e,1,i)}),gv=Ke(function(e,i,o){return Ku(e,Ur(i)||0,o)});function vv(e){return ai(e,Y)}function yo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Pr(p);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],y=o.cache;if(y.has(f))return y.get(f);var S=e.apply(this,u);return o.cache=y.set(f,S)||y,S};return o.cache=new(yo.Cache||si),o}yo.Cache=si;function _o(e){if(typeof e!="function")throw new Pr(p);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function yv(e){return Xh(2,e)}var _v=n0(function(e,i){i=i.length==1&&Re(i[0])?_t(i[0],mr(_e())):_t(Gt(i,1),mr(_e()));var o=i.length;return Ke(function(u){for(var f=-1,y=Yt(u.length,o);++f<y;)u[f]=i[f].call(this,u[f]);return zt(e,this,u)})}),nc=Ke(function(e,i){var o=wi(i,Sn(nc));return ai(e,P,r,i,o)}),rl=Ke(function(e,i){var o=wi(i,Sn(rl));return ai(e,b,r,i,o)}),mv=ci(function(e,i){return ai(e,m,r,r,r,i)});function bv(e,i){if(typeof e!="function")throw new Pr(p);return i=i===r?i:Me(i),Ke(e,i)}function wv(e,i){if(typeof e!="function")throw new Pr(p);return i=i==null?0:Bt(Me(i),0),Ke(function(o){var u=o[i],f=Oi(o,0,i);return u&&bi(f,u),zt(e,this,f)})}function Ev(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new Pr(p);return bt(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),tl(e,i,{leading:u,maxWait:i,trailing:f})}function Sv(e){return Jh(e,1)}function Iv(e,i){return nc(Ba(i),e)}function xv(){if(!arguments.length)return[];var e=arguments[0];return Re(e)?e:[e]}function Ov(e){return Cr(e,F)}function Av(e,i){return i=typeof i=="function"?i:r,Cr(e,F,i)}function Pv(e){return Cr(e,N|F)}function Tv(e,i){return i=typeof i=="function"?i:r,Cr(e,N|F,i)}function Cv(e,i){return i==null||zu(e,i,Kt(i))}function Br(e,i){return e===i||e!==e&&i!==i}var Nv=uo(Ca),Rv=uo(function(e,i){return e>=i}),ki=Yu(function(){return arguments}())?Yu:function(e){return At(e)&&nt.call(e,"callee")&&!Fu.call(e,"callee")},Re=B.isArray,Uv=er?mr(er):Hg;function fr(e){return e!=null&&mo(e.length)&&!hi(e)}function Ct(e){return At(e)&&fr(e)}function Lv(e){return e===!0||e===!1||At(e)&&tr(e)==j}var Ai=Wp||gc,Fv=jr?mr(jr):Bg;function Dv(e){return At(e)&&e.nodeType===1&&!Xn(e)}function $v(e){if(e==null)return!0;if(fr(e)&&(Re(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||In(e)||ki(e)))return!e.length;var i=Jt(e);if(i==xe||i==Oe)return!e.size;if(Yn(e))return!Ua(e).length;for(var o in e)if(nt.call(e,o))return!1;return!0}function Mv(e,i){return kn(e,i)}function jv(e,i,o){o=typeof o=="function"?o:r;var u=o?o(e,i):r;return u===r?kn(e,i,r,o):!!u}function sc(e){if(!At(e))return!1;var i=tr(e);return i==O||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Xn(e)}function qv(e){return typeof e=="number"&&$u(e)}function hi(e){if(!bt(e))return!1;var i=tr(e);return i==oe||i==fe||i==q||i==gt}function il(e){return typeof e=="number"&&e==Me(e)}function mo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=z}function bt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function At(e){return e!=null&&typeof e=="object"}var nl=Or?mr(Or):Kg;function Hv(e,i){return e===i||Ra(e,i,Ya(i))}function Bv(e,i,o){return o=typeof o=="function"?o:r,Ra(e,i,Ya(i),o)}function zv(e){return sl(e)&&e!=+e}function Kv(e){if(A0(e))throw new Ce(l);return Ju(e)}function Vv(e){return e===null}function kv(e){return e==null}function sl(e){return typeof e=="number"||At(e)&&tr(e)==Be}function Xn(e){if(!At(e)||tr(e)!=$e)return!1;var i=Vs(e);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Hs.call(o)==Bp}var oc=Wr?mr(Wr):Vg;function Gv(e){return il(e)&&e>=-z&&e<=z}var ol=Dn?mr(Dn):kg;function bo(e){return typeof e=="string"||!Re(e)&&At(e)&&tr(e)==Ue}function wr(e){return typeof e=="symbol"||At(e)&&tr(e)==Le}var In=Mi?mr(Mi):Gg;function Wv(e){return e===r}function Yv(e){return At(e)&&Jt(e)==Pe}function Jv(e){return At(e)&&tr(e)==Fe}var Xv=uo(La),Zv=uo(function(e,i){return e<=i});function al(e){if(!e)return[];if(fr(e))return bo(e)?qr(e):lr(e);if(Mn&&e[Mn])return Cp(e[Mn]());var i=Jt(e),o=i==xe?wa:i==Oe?Ms:xn;return o(e)}function li(e){if(!e)return e===0?e:0;if(e=Ur(e),e===X||e===-X){var i=e<0?-1:1;return i*k}return e===e?e:0}function Me(e){var i=li(e),o=i%1;return i===i?o?i-o:i:0}function cl(e){return e?Bi(Me(e),0,re):0}function Ur(e){if(typeof e=="number")return e;if(wr(e))return J;if(bt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=bt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Au(e);var o=Jo.test(e);return o||Zo.test(e)?Ne(e.slice(2),o?2:8):Yo.test(e)?J:+e}function ul(e){return Jr(e,dr(e))}function Qv(e){return e?Bi(Me(e),-z,z):e===0?e:0}function it(e){return e==null?"":br(e)}var ey=wn(function(e,i){if(Yn(i)||fr(i)){Jr(i,Kt(i),e);return}for(var o in i)nt.call(i,o)&&zn(e,o,i[o])}),hl=wn(function(e,i){Jr(i,dr(i),e)}),wo=wn(function(e,i,o,u){Jr(i,dr(i),e,u)}),ty=wn(function(e,i,o,u){Jr(i,Kt(i),e,u)}),ry=ci(Aa);function iy(e,i){var o=bn(e);return i==null?o:Bu(o,i)}var ny=Ke(function(e,i){e=ut(e);var o=-1,u=i.length,f=u>2?i[2]:r;for(f&&rr(i[0],i[1],f)&&(u=1);++o<u;)for(var y=i[o],S=dr(y),T=-1,D=S.length;++T<D;){var Z=S[T],Q=e[Z];(Q===r||Br(Q,yn[Z])&&!nt.call(e,Z))&&(e[Z]=y[Z])}return e}),sy=Ke(function(e){return e.push(r,Ah),zt(ll,r,e)});function oy(e,i){return Su(e,_e(i,3),Yr)}function ay(e,i){return Su(e,_e(i,3),Ta)}function cy(e,i){return e==null?e:Pa(e,_e(i,3),dr)}function uy(e,i){return e==null?e:Gu(e,_e(i,3),dr)}function hy(e,i){return e&&Yr(e,_e(i,3))}function ly(e,i){return e&&Ta(e,_e(i,3))}function fy(e){return e==null?[]:to(e,Kt(e))}function dy(e){return e==null?[]:to(e,dr(e))}function ac(e,i,o){var u=e==null?r:zi(e,i);return u===r?o:u}function py(e,i){return e!=null&&Ch(e,i,$g)}function cc(e,i){return e!=null&&Ch(e,i,Mg)}var gy=Eh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),e[i]=o},hc(pr)),vy=Eh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),nt.call(e,i)?e[i].push(o):e[i]=[o]},_e),yy=Ke(Vn);function Kt(e){return fr(e)?qu(e):Ua(e)}function dr(e){return fr(e)?qu(e,!0):Wg(e)}function _y(e,i){var o={};return i=_e(i,3),Yr(e,function(u,f,y){oi(o,i(u,f,y),u)}),o}function my(e,i){var o={};return i=_e(i,3),Yr(e,function(u,f,y){oi(o,f,i(u,f,y))}),o}var by=wn(function(e,i,o){ro(e,i,o)}),ll=wn(function(e,i,o,u){ro(e,i,o,u)}),wy=ci(function(e,i){var o={};if(e==null)return o;var u=!1;i=_t(i,function(y){return y=xi(y,e),u||(u=y.length>1),y}),Jr(e,Ga(e),o),u&&(o=Cr(o,N|H|F,g0));for(var f=i.length;f--;)ja(o,i[f]);return o});function Ey(e,i){return fl(e,_o(_e(i)))}var Sy=ci(function(e,i){return e==null?{}:Jg(e,i)});function fl(e,i){if(e==null)return{};var o=_t(Ga(e),function(u){return[u]});return i=_e(i),ih(e,o,function(u,f){return i(u,f[0])})}function Iy(e,i,o){i=xi(i,e);var u=-1,f=i.length;for(f||(f=1,e=r);++u<f;){var y=e==null?r:e[Xr(i[u])];y===r&&(u=f,y=o),e=hi(y)?y.call(e):y}return e}function xy(e,i,o){return e==null?e:Gn(e,i,o)}function Oy(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Gn(e,i,o,u)}var dl=xh(Kt),pl=xh(dr);function Ay(e,i,o){var u=Re(e),f=u||Ai(e)||In(e);if(i=_e(i,4),o==null){var y=e&&e.constructor;f?o=u?new y:[]:bt(e)?o=hi(y)?bn(Vs(e)):{}:o={}}return(f?Ar:Yr)(e,function(S,T,D){return i(o,S,T,D)}),o}function Py(e,i){return e==null?!0:ja(e,i)}function Ty(e,i,o){return e==null?e:ch(e,i,Ba(o))}function Cy(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:ch(e,i,Ba(o),u)}function xn(e){return e==null?[]:ba(e,Kt(e))}function Ny(e){return e==null?[]:ba(e,dr(e))}function Ry(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Ur(o),o=o===o?o:0),i!==r&&(i=Ur(i),i=i===i?i:0),Bi(Ur(e),i,o)}function Uy(e,i,o){return i=li(i),o===r?(o=i,i=0):o=li(o),e=Ur(e),jg(e,i,o)}function Ly(e,i,o){if(o&&typeof o!="boolean"&&rr(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=li(e),i===r?(i=e,e=0):i=li(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=Mu();return Yt(e+f*(i-e+at("1e-"+((f+"").length-1))),i)}return Da(e,i)}var Fy=En(function(e,i,o){return i=i.toLowerCase(),e+(o?gl(i):i)});function gl(e){return uc(it(e).toLowerCase())}function vl(e){return e=it(e),e&&e.replace(ri,xp).replace(la,"")}function Dy(e,i,o){e=it(e),i=br(i);var u=e.length;o=o===r?u:Bi(Me(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function $y(e){return e=it(e),e&&vt.test(e)?e.replace(Ui,Op):e}function My(e){return e=it(e),e&&Ft.test(e)?e.replace(It,"\\$&"):e}var jy=En(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),qy=En(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Hy=mh("toLowerCase");function By(e,i,o){e=it(e),i=Me(i);var u=i?gn(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return co(Ys(f),o)+e+co(Ws(f),o)}function zy(e,i,o){e=it(e),i=Me(i);var u=i?gn(e):0;return i&&u<i?e+co(i-u,o):e}function Ky(e,i,o){e=it(e),i=Me(i);var u=i?gn(e):0;return i&&u<i?co(i-u,o)+e:e}function Vy(e,i,o){return o||i==null?i=0:i&&(i=+i),Zp(it(e).replace(xt,""),i||0)}function ky(e,i,o){return(o?rr(e,i,o):i===r)?i=1:i=Me(i),$a(it(e),i)}function Gy(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Wy=En(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Yy(e,i,o){return o&&typeof o!="number"&&rr(e,i,o)&&(i=o=r),o=o===r?re:o>>>0,o?(e=it(e),e&&(typeof i=="string"||i!=null&&!oc(i))&&(i=br(i),!i&&pn(e))?Oi(qr(e),0,o):e.split(i,o)):[]}var Jy=En(function(e,i,o){return e+(o?" ":"")+uc(i)});function Xy(e,i,o){return e=it(e),o=o==null?0:Bi(Me(o),0,e.length),i=br(i),e.slice(o,o+i.length)==i}function Zy(e,i,o){var u=g.templateSettings;o&&rr(e,i,o)&&(i=r),e=it(e),i=wo({},i,u,Oh);var f=wo({},i.imports,u.imports,Oh),y=Kt(f),S=ba(f,y),T,D,Z=0,Q=i.interpolate||on,ie="__p += '",ue=Ea((i.escape||on).source+"|"+Q.source+"|"+(Q===mt?Wo:on).source+"|"+(i.evaluate||on).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fa+"]")+`
`;e.replace(ue,function(Ee,Ge,Ze,Er,ir,Sr){return Ze||(Ze=Er),ie+=e.slice(Z,Sr).replace(ea,Ap),Ge&&(T=!0,ie+=`' +
__e(`+Ge+`) +
'`),ir&&(D=!0,ie+=`';
`+ir+`;
__p += '`),Ze&&(ie+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),Z=Sr+Ee.length,Ee}),ie+=`';
`;var we=nt.call(i,"variable")&&i.variable;if(!we)ie=`with (obj) {
`+ie+`
}
`;else if(ko.test(we))throw new Ce(d);ie=(D?ie.replace(kr,""):ie).replace(Qt,"$1").replace(ti,"$1;"),ie="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(D?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var He=_l(function(){return rt(y,ve+"return "+ie).apply(r,S)});if(He.source=ie,sc(He))throw He;return He}function Qy(e){return it(e).toLowerCase()}function e_(e){return it(e).toUpperCase()}function t_(e,i,o){if(e=it(e),e&&(o||i===r))return Au(e);if(!e||!(i=br(i)))return e;var u=qr(e),f=qr(i),y=Pu(u,f),S=Tu(u,f)+1;return Oi(u,y,S).join("")}function r_(e,i,o){if(e=it(e),e&&(o||i===r))return e.slice(0,Nu(e)+1);if(!e||!(i=br(i)))return e;var u=qr(e),f=Tu(u,qr(i))+1;return Oi(u,0,f).join("")}function i_(e,i,o){if(e=it(e),e&&(o||i===r))return e.replace(xt,"");if(!e||!(i=br(i)))return e;var u=qr(e),f=Pu(u,qr(i));return Oi(u,f).join("")}function n_(e,i){var o=G,u=ne;if(bt(i)){var f="separator"in i?i.separator:f;o="length"in i?Me(i.length):o,u="omission"in i?br(i.omission):u}e=it(e);var y=e.length;if(pn(e)){var S=qr(e);y=S.length}if(o>=y)return e;var T=o-gn(u);if(T<1)return u;var D=S?Oi(S,0,T).join(""):e.slice(0,T);if(f===r)return D+u;if(S&&(T+=D.length-T),oc(f)){if(e.slice(T).search(f)){var Z,Q=D;for(f.global||(f=Ea(f.source,it(xr.exec(f))+"g")),f.lastIndex=0;Z=f.exec(Q);)var ie=Z.index;D=D.slice(0,ie===r?T:ie)}}else if(e.indexOf(br(f),T)!=T){var ue=D.lastIndexOf(f);ue>-1&&(D=D.slice(0,ue))}return D+u}function s_(e){return e=it(e),e&&wt.test(e)?e.replace(yi,Lp):e}var o_=En(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),uc=mh("toUpperCase");function yl(e,i,o){return e=it(e),i=o?r:i,i===r?Tp(e)?$p(e):bp(e):e.match(i)||[]}var _l=Ke(function(e,i){try{return zt(e,r,i)}catch(o){return sc(o)?o:new Ce(o)}}),a_=ci(function(e,i){return Ar(i,function(o){o=Xr(o),oi(e,o,ic(e[o],e))}),e});function c_(e){var i=e==null?0:e.length,o=_e();return e=i?_t(e,function(u){if(typeof u[1]!="function")throw new Pr(p);return[o(u[0]),u[1]]}):[],Ke(function(u){for(var f=-1;++f<i;){var y=e[f];if(zt(y[0],this,u))return zt(y[1],this,u)}})}function u_(e){return Lg(Cr(e,N))}function hc(e){return function(){return e}}function h_(e,i){return e==null||e!==e?i:e}var l_=wh(),f_=wh(!0);function pr(e){return e}function lc(e){return Xu(typeof e=="function"?e:Cr(e,N))}function d_(e){return Qu(Cr(e,N))}function p_(e,i){return eh(e,Cr(i,N))}var g_=Ke(function(e,i){return function(o){return Vn(o,e,i)}}),v_=Ke(function(e,i){return function(o){return Vn(e,o,i)}});function fc(e,i,o){var u=Kt(i),f=to(i,u);o==null&&!(bt(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=to(i,Kt(i)));var y=!(bt(o)&&"chain"in o)||!!o.chain,S=hi(e);return Ar(f,function(T){var D=i[T];e[T]=D,S&&(e.prototype[T]=function(){var Z=this.__chain__;if(y||Z){var Q=e(this.__wrapped__),ie=Q.__actions__=lr(this.__actions__);return ie.push({func:D,args:arguments,thisArg:e}),Q.__chain__=Z,Q}return D.apply(e,bi([this.value()],arguments))})}),e}function y_(){return Xe._===this&&(Xe._=zp),this}function dc(){}function __(e){return e=Me(e),Ke(function(i){return th(i,e)})}var m_=Ka(_t),b_=Ka(Eu),w_=Ka(ga);function ml(e){return Xa(e)?va(Xr(e)):Xg(e)}function E_(e){return function(i){return e==null?r:zi(e,i)}}var S_=Sh(),I_=Sh(!0);function pc(){return[]}function gc(){return!1}function x_(){return{}}function O_(){return""}function A_(){return!0}function P_(e,i){if(e=Me(e),e<1||e>z)return[];var o=re,u=Yt(e,re);i=_e(i),e-=re;for(var f=ma(u,i);++o<e;)i(o);return f}function T_(e){return Re(e)?_t(e,Xr):wr(e)?[e]:lr(jh(it(e)))}function C_(e){var i=++Hp;return it(e)+i}var N_=ao(function(e,i){return e+i},0),R_=Va("ceil"),U_=ao(function(e,i){return e/i},1),L_=Va("floor");function F_(e){return e&&e.length?eo(e,pr,Ca):r}function D_(e,i){return e&&e.length?eo(e,_e(i,2),Ca):r}function $_(e){return xu(e,pr)}function M_(e,i){return xu(e,_e(i,2))}function j_(e){return e&&e.length?eo(e,pr,La):r}function q_(e,i){return e&&e.length?eo(e,_e(i,2),La):r}var H_=ao(function(e,i){return e*i},1),B_=Va("round"),z_=ao(function(e,i){return e-i},0);function K_(e){return e&&e.length?_a(e,pr):0}function V_(e,i){return e&&e.length?_a(e,_e(i,2)):0}return g.after=dv,g.ary=Jh,g.assign=ey,g.assignIn=hl,g.assignInWith=wo,g.assignWith=ty,g.at=ry,g.before=Xh,g.bind=ic,g.bindAll=a_,g.bindKey=Zh,g.castArray=xv,g.chain=Gh,g.chunk=L0,g.compact=F0,g.concat=D0,g.cond=c_,g.conforms=u_,g.constant=hc,g.countBy=K1,g.create=iy,g.curry=Qh,g.curryRight=el,g.debounce=tl,g.defaults=ny,g.defaultsDeep=sy,g.defer=pv,g.delay=gv,g.difference=$0,g.differenceBy=M0,g.differenceWith=j0,g.drop=q0,g.dropRight=H0,g.dropRightWhile=B0,g.dropWhile=z0,g.fill=K0,g.filter=k1,g.flatMap=Y1,g.flatMapDeep=J1,g.flatMapDepth=X1,g.flatten=zh,g.flattenDeep=V0,g.flattenDepth=k0,g.flip=vv,g.flow=l_,g.flowRight=f_,g.fromPairs=G0,g.functions=fy,g.functionsIn=dy,g.groupBy=Z1,g.initial=Y0,g.intersection=J0,g.intersectionBy=X0,g.intersectionWith=Z0,g.invert=gy,g.invertBy=vy,g.invokeMap=ev,g.iteratee=lc,g.keyBy=tv,g.keys=Kt,g.keysIn=dr,g.map=go,g.mapKeys=_y,g.mapValues=my,g.matches=d_,g.matchesProperty=p_,g.memoize=yo,g.merge=by,g.mergeWith=ll,g.method=g_,g.methodOf=v_,g.mixin=fc,g.negate=_o,g.nthArg=__,g.omit=wy,g.omitBy=Ey,g.once=yv,g.orderBy=rv,g.over=m_,g.overArgs=_v,g.overEvery=b_,g.overSome=w_,g.partial=nc,g.partialRight=rl,g.partition=iv,g.pick=Sy,g.pickBy=fl,g.property=ml,g.propertyOf=E_,g.pull=r1,g.pullAll=Vh,g.pullAllBy=i1,g.pullAllWith=n1,g.pullAt=s1,g.range=S_,g.rangeRight=I_,g.rearg=mv,g.reject=ov,g.remove=o1,g.rest=bv,g.reverse=tc,g.sampleSize=cv,g.set=xy,g.setWith=Oy,g.shuffle=uv,g.slice=a1,g.sortBy=fv,g.sortedUniq=p1,g.sortedUniqBy=g1,g.split=Yy,g.spread=wv,g.tail=v1,g.take=y1,g.takeRight=_1,g.takeRightWhile=m1,g.takeWhile=b1,g.tap=F1,g.throttle=Ev,g.thru=po,g.toArray=al,g.toPairs=dl,g.toPairsIn=pl,g.toPath=T_,g.toPlainObject=ul,g.transform=Ay,g.unary=Sv,g.union=w1,g.unionBy=E1,g.unionWith=S1,g.uniq=I1,g.uniqBy=x1,g.uniqWith=O1,g.unset=Py,g.unzip=rc,g.unzipWith=kh,g.update=Ty,g.updateWith=Cy,g.values=xn,g.valuesIn=Ny,g.without=A1,g.words=yl,g.wrap=Iv,g.xor=P1,g.xorBy=T1,g.xorWith=C1,g.zip=N1,g.zipObject=R1,g.zipObjectDeep=U1,g.zipWith=L1,g.entries=dl,g.entriesIn=pl,g.extend=hl,g.extendWith=wo,fc(g,g),g.add=N_,g.attempt=_l,g.camelCase=Fy,g.capitalize=gl,g.ceil=R_,g.clamp=Ry,g.clone=Ov,g.cloneDeep=Pv,g.cloneDeepWith=Tv,g.cloneWith=Av,g.conformsTo=Cv,g.deburr=vl,g.defaultTo=h_,g.divide=U_,g.endsWith=Dy,g.eq=Br,g.escape=$y,g.escapeRegExp=My,g.every=V1,g.find=G1,g.findIndex=Hh,g.findKey=oy,g.findLast=W1,g.findLastIndex=Bh,g.findLastKey=ay,g.floor=L_,g.forEach=Wh,g.forEachRight=Yh,g.forIn=cy,g.forInRight=uy,g.forOwn=hy,g.forOwnRight=ly,g.get=ac,g.gt=Nv,g.gte=Rv,g.has=py,g.hasIn=cc,g.head=Kh,g.identity=pr,g.includes=Q1,g.indexOf=W0,g.inRange=Uy,g.invoke=yy,g.isArguments=ki,g.isArray=Re,g.isArrayBuffer=Uv,g.isArrayLike=fr,g.isArrayLikeObject=Ct,g.isBoolean=Lv,g.isBuffer=Ai,g.isDate=Fv,g.isElement=Dv,g.isEmpty=$v,g.isEqual=Mv,g.isEqualWith=jv,g.isError=sc,g.isFinite=qv,g.isFunction=hi,g.isInteger=il,g.isLength=mo,g.isMap=nl,g.isMatch=Hv,g.isMatchWith=Bv,g.isNaN=zv,g.isNative=Kv,g.isNil=kv,g.isNull=Vv,g.isNumber=sl,g.isObject=bt,g.isObjectLike=At,g.isPlainObject=Xn,g.isRegExp=oc,g.isSafeInteger=Gv,g.isSet=ol,g.isString=bo,g.isSymbol=wr,g.isTypedArray=In,g.isUndefined=Wv,g.isWeakMap=Yv,g.isWeakSet=Jv,g.join=Q0,g.kebabCase=jy,g.last=Rr,g.lastIndexOf=e1,g.lowerCase=qy,g.lowerFirst=Hy,g.lt=Xv,g.lte=Zv,g.max=F_,g.maxBy=D_,g.mean=$_,g.meanBy=M_,g.min=j_,g.minBy=q_,g.stubArray=pc,g.stubFalse=gc,g.stubObject=x_,g.stubString=O_,g.stubTrue=A_,g.multiply=H_,g.nth=t1,g.noConflict=y_,g.noop=dc,g.now=vo,g.pad=By,g.padEnd=zy,g.padStart=Ky,g.parseInt=Vy,g.random=Ly,g.reduce=nv,g.reduceRight=sv,g.repeat=ky,g.replace=Gy,g.result=Iy,g.round=B_,g.runInContext=L,g.sample=av,g.size=hv,g.snakeCase=Wy,g.some=lv,g.sortedIndex=c1,g.sortedIndexBy=u1,g.sortedIndexOf=h1,g.sortedLastIndex=l1,g.sortedLastIndexBy=f1,g.sortedLastIndexOf=d1,g.startCase=Jy,g.startsWith=Xy,g.subtract=z_,g.sum=K_,g.sumBy=V_,g.template=Zy,g.times=P_,g.toFinite=li,g.toInteger=Me,g.toLength=cl,g.toLower=Qy,g.toNumber=Ur,g.toSafeInteger=Qv,g.toString=it,g.toUpper=e_,g.trim=t_,g.trimEnd=r_,g.trimStart=i_,g.truncate=n_,g.unescape=s_,g.uniqueId=C_,g.upperCase=o_,g.upperFirst=uc,g.each=Wh,g.eachRight=Yh,g.first=Kh,fc(g,function(){var e={};return Yr(g,function(i,o){nt.call(g.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),g.VERSION=s,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){g[e].placeholder=g}),Ar(["drop","take"],function(e,i){Ye.prototype[e]=function(o){o=o===r?1:Bt(Me(o),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Yt(o,u.__takeCount__):u.__views__.push({size:Yt(o,re),type:e+(u.__dir__<0?"Right":"")}),u},Ye.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Ar(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==_||o==ee;Ye.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:_e(f,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),Ar(["head","last"],function(e,i){var o="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[o](1).value()[0]}}),Ar(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(pr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(o){return Vn(o,e,i)})}),Ye.prototype.reject=function(e){return this.filter(_o(_e(e)))},Ye.prototype.slice=function(e,i){e=Me(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Ye(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=Me(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Yr(Ye.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=g[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);f&&(g.prototype[i]=function(){var S=this.__wrapped__,T=u?[1]:arguments,D=S instanceof Ye,Z=T[0],Q=D||Re(S),ie=function(Ge){var Ze=f.apply(g,bi([Ge],T));return u&&ue?Ze[0]:Ze};Q&&o&&typeof Z=="function"&&Z.length!=1&&(D=Q=!1);var ue=this.__chain__,ve=!!this.__actions__.length,we=y&&!ue,He=D&&!ve;if(!y&&Q){S=He?S:new Ye(this);var Ee=e.apply(S,T);return Ee.__actions__.push({func:po,args:[ie],thisArg:r}),new Tr(Ee,ue)}return we&&He?e.apply(this,T):(Ee=this.thru(ie),we?u?Ee.value()[0]:Ee.value():Ee)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(e){var i=js[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);g.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(Re(y)?y:[],f)}return this[o](function(S){return i.apply(Re(S)?S:[],f)})}}),Yr(Ye.prototype,function(e,i){var o=g[i];if(o){var u=o.name+"";nt.call(mn,u)||(mn[u]=[]),mn[u].push({name:i,func:o})}}),mn[oo(r,ae).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=sg,Ye.prototype.reverse=og,Ye.prototype.value=ag,g.prototype.at=D1,g.prototype.chain=$1,g.prototype.commit=M1,g.prototype.next=j1,g.prototype.plant=H1,g.prototype.reverse=B1,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=z1,g.prototype.first=g.prototype.head,Mn&&(g.prototype[Mn]=q1),g},vn=Mp();Tt?((Tt.exports=vn)._=vn,ct._=vn):Xe._=vn}).call(cs)})(Yc,Yc.exports);var LS=Object.defineProperty,FS=Object.defineProperties,DS=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,$S=Object.prototype.hasOwnProperty,MS=Object.prototype.propertyIsEnumerable,Yf=(n,t,r)=>t in n?LS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,So=(n,t)=>{for(var r in t||(t={}))$S.call(t,r)&&Yf(n,r,t[r]);if(Wf)for(var r of Wf(t))MS.call(t,r)&&Yf(n,r,t[r]);return n},jS=(n,t)=>FS(n,DS(t));function Dr(n,t,r){let s;const a=Jc(n);return t.rpcMap&&(s=t.rpcMap[a]),s||(s=`${US}?chainId=eip155:${a}&projectId=${r}`),s}function Jc(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function qS(n,t){if(!t.includes(n))throw new Error(`Chain '${n}' not approved. Please use one of the following: ${t.toString()}`)}function HS(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function BS(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=t.namespaces[a].accounts;s.push(...l)}),s}function zS(n,t={}){const r=Jf(n),s=Jf(t);return Yc.exports.merge(r,s)}function Jf(n){var t,r,s,a;const l={};if(!Tn(n))return l;for(const[p,d]of Object.entries(n)){const v=Nd(p)?[p]:d.chains,E=d.methods||[],A=d.events||[],N=d.rpcMap||{},H=Oo(p);l[H]=jS(So(So({},l[H]),d),{chains:wc(v,(t=l[H])==null?void 0:t.chains),methods:wc(E,(r=l[H])==null?void 0:r.methods),events:wc(A,(s=l[H])==null?void 0:s.events),rpcMap:So(So({},N),(a=l[H])==null?void 0:a.rpcMap)})}return l}const sn=(n,t)=>{const r=s=>{s.request!==t.request||s.topic!==t.topic||(n.events.removeListener("session_request_sent",r),KS(t,n.core.storage))};n.on("session_request_sent",r)};async function KS(n,t){try{const r=await t.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&a.slice(0,-1);const l=`${a}/wc?requestId=${n.id}&sessionTopic=${n.topic}`,p=Od();p===Xi.browser?window.open(l,"_self","noreferrer noopener"):p===Xi.reactNative&&await require("react-native").Linking.openURL(l)}catch(r){console.error(r)}}class VS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Dr(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Dr(t,this.namespace);return typeof s>"u"?void 0:new Ni(new nn(s))}}class kS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.client=t.client,this.events=t.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){var r;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),await this.client.request(t)):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=Jc(t);if(!this.httpProviders[s]){const a=r||Dr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Dr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Jc(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}handleSwitchChain(t){const r=parseInt(t,16),s=`${this.name}:${r}`;qS(s,this.namespace.chains),this.setDefaultChain(`${r}`)}}class GS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Dr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Dr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s))}}class WS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Dr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Dr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s))}}class YS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ni(new nn(s))}}class JS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Dr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Dr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s))}}class XS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(sn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Dr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Dr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s))}}var ZS=Object.defineProperty,QS=Object.defineProperties,e5=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,t5=Object.prototype.hasOwnProperty,r5=Object.prototype.propertyIsEnumerable,Zf=(n,t,r)=>t in n?ZS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Io=(n,t)=>{for(var r in t||(t={}))t5.call(t,r)&&Zf(n,r,t[r]);if(Xf)for(var r of Xf(t))r5.call(t,r)&&Zf(n,r,t[r]);return n},Uc=(n,t)=>QS(n,e5(t));class bu{constructor(t){this.events=new cr,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||kf}))}static async init(t){const r=new bu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Io({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Rt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l}).catch(l=>{if(l.message!==dp)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(vi(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await OS.init({logger:this.providerOpts.logger||kf,relayUrl:this.providerOpts.relayUrl||CS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");[...new Set(Object.keys(this.session.namespaces).map(t=>Oo(t)))].forEach(t=>{if(!this.session)return;const r=BS(t,this.session),s=HS(r),a=zS(this.namespaces,this.optionalNamespaces),l=Uc(Io({},a[t]),{accounts:r,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new kS({client:this.client,namespace:l,events:this.events});break;case"solana":this.rpcProviders[t]=new GS({client:this.client,namespace:l,events:this.events});break;case"cosmos":this.rpcProviders[t]=new WS({client:this.client,namespace:l,events:this.events});break;case"polkadot":this.rpcProviders[t]=new VS({client:this.client,namespace:l,events:this.events});break;case"cip34":this.rpcProviders[t]=new YS({client:this.client,namespace:l,events:this.events});break;case"elrond":this.rpcProviders[t]=new JS({client:this.client,namespace:l,events:this.events});break;case"multiversx":this.rpcProviders[t]=new XS({client:this.client,namespace:l,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Uc(Io({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Uc(Io({},Rt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ri.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(p=>Oo(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Oo(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[a,l]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Gf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Gf}/${t}`)}}const i5=bu,n5="wc",s5="ethereum_provider",o5=`${n5}@${2}:${s5}:`,a5="https://rpc.walletconnect.com/v1/",Xc=["eth_sendTransaction","personal_sign"],A5=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Zc=["chainChanged","accountsChanged"],P5=["message","disconnect","connect"];var c5=Object.defineProperty,u5=Object.defineProperties,h5=Object.getOwnPropertyDescriptors,Qf=Object.getOwnPropertySymbols,l5=Object.prototype.hasOwnProperty,f5=Object.prototype.propertyIsEnumerable,ed=(n,t,r)=>t in n?c5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lc=(n,t)=>{for(var r in t||(t={}))l5.call(t,r)&&ed(n,r,t[r]);if(Qf)for(var r of Qf(t))f5.call(t,r)&&ed(n,r,t[r]);return n},td=(n,t)=>u5(n,h5(t));function Qc(n){return Number(n[0].split(":")[1])}function Fc(n){return`0x${n.toString(16)}`}function d5(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:p,rpcMap:d}=n;if(!vi(t))throw new Error("Invalid chains");const v=t,E=s||Xc,A=l||Zc,N={[Qc(v)]:d[Qc(v)]},H={chains:v,methods:E,events:A,rpcMap:N},F=l==null?void 0:l.filter(ae=>!Zc.includes(ae)),M=s==null?void 0:s.filter(ae=>!Xc.includes(ae));if(!r&&!p&&!a&&!(F!=null&&F.length)&&!(M!=null&&M.length))return{required:H};const K=(F==null?void 0:F.length)&&(M==null?void 0:M.length)||!r,V={chains:[...new Set(K?v.concat(r||[]):r)],methods:[...new Set(E.concat(a||[]))],events:[...new Set(A.concat(p||[]))],rpcMap:d};return{required:H,optional:V}}class wu{constructor(){this.events=new cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=o5,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new wu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=d5(this.rpc);try{const a=await new Promise(async(p,d)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(E=>{!E.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(td(Lc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(E=>{p(E)}).catch(E=>{d(new Error(E.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const l=Eb(a.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:Fc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Fc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",td(Lc({},Rt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}setHttpProvider(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Fc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.setHttpProvider(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(a=>this.formatChainId(a)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(a=>this.formatChainId(a)):void 0,methods:(t==null?void 0:t.methods)||Xc,events:(t==null?void 0:t.events)||Zc,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:Boolean(t==null?void 0:t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=Qc(this.rpc.chains),this.signer=await i5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal)try{const{Web3Modal:r}=await W_(()=>import("./chunk-3a7b432c.js").then(s=>s.i),["js/chunk-3a7b432c.js","js/chunk-8aace738.js","css/chunk-25eea26e.css"]);this.modal=new r(Lc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch{throw new Error("To use QR modal, please install @web3modal/standalone package")}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&vi(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),s&&vi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${a5}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const T5=wu;export{T5 as EthereumProvider,P5 as OPTIONAL_EVENTS,A5 as OPTIONAL_METHODS,Zc as REQUIRED_EVENTS,Xc as REQUIRED_METHODS,wu as default};
