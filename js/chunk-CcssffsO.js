const __vite__fileDeps=["js/chunk-DOlFtnKY.js","js/chunk-CiXiLY6i.js","css/chunk-DPiSB0oC.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{cy as Du,S as na,b4 as Gr,be as R_}from"./chunk-CiXiLY6i.js";import{e as qr,U as $u}from"./chunk-Isa72J0q.js";import{c as T_,b as tf}from"./chunk-bvReVY-B.js";import{r as A_}from"./chunk-DudE75_9.js";var Uu={},sa={},Le={},jd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var g=f>>>16&65535,m=f&65535,_=y>>>16&65535,x=y&65535;return m*x+(g*x+m*_<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function o(f,y){return f<<y|f>>>32-y}i.rotl=o;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(jd);Object.defineProperty(Le,"__esModule",{value:!0});var qd=jd;function N_(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Le.readInt16BE=N_;function C_(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Le.readUint16BE=C_;function D_(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Le.readInt16LE=D_;function $_(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Le.readUint16LE=$_;function Hd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Le.writeUint16BE=Hd;Le.writeInt16BE=Hd;function zd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Le.writeUint16LE=zd;Le.writeInt16LE=zd;function hu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Le.readInt32BE=hu;function lu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Le.readUint32BE=lu;function fu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Le.readInt32LE=fu;function du(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Le.readUint32LE=du;function Qo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Le.writeUint32BE=Qo;Le.writeInt32BE=Qo;function Xo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Le.writeUint32LE=Xo;Le.writeInt32LE=Xo;function U_(i,e){e===void 0&&(e=0);var t=hu(i,e),s=hu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=U_;function L_(i,e){e===void 0&&(e=0);var t=lu(i,e),s=lu(i,e+4);return t*4294967296+s}Le.readUint64BE=L_;function M_(i,e){e===void 0&&(e=0);var t=fu(i,e),s=fu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=M_;function j_(i,e){e===void 0&&(e=0);var t=du(i,e),s=du(i,e+4);return s*4294967296+t}Le.readUint64LE=j_;function Fd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Qo(i/4294967296>>>0,e,t),Qo(i>>>0,e,t+4),e}Le.writeUint64BE=Fd;Le.writeInt64BE=Fd;function Bd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Xo(i>>>0,e,t),Xo(i/4294967296>>>0,e,t+4),e}Le.writeUint64LE=Bd;Le.writeInt64LE=Bd;function q_(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=q_;function H_(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=H_;function z_(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!qd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=z_;function F_(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!qd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=F_;function B_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Le.readFloat32BE=B_;function K_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=K_;function k_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Le.readFloat64BE=k_;function V_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=V_;function W_(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Le.writeFloat32BE=W_;function G_(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Le.writeFloat32LE=G_;function Y_(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Le.writeFloat64BE=Y_;function J_(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Le.writeFloat64LE=J_;var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});function Q_(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Rr.wipe=Q_;Object.defineProperty(sa,"__esModule",{value:!0});var Qt=Le,pu=Rr,X_=20;function Z_(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,d=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],g=t[11]<<24|t[10]<<16|t[9]<<8|t[8],m=t[15]<<24|t[14]<<16|t[13]<<8|t[12],_=t[19]<<24|t[18]<<16|t[17]<<8|t[16],x=t[23]<<24|t[22]<<16|t[21]<<8|t[20],P=t[27]<<24|t[26]<<16|t[25]<<8|t[24],A=t[31]<<24|t[30]<<16|t[29]<<8|t[28],W=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],q=s,O=o,N=c,C=d,h=f,I=y,re=g,ne=m,ue=_,ge=x,ye=P,E=A,T=W,X=K,J=ie,B=$,k=0;k<X_;k+=2)q=q+h|0,T^=q,T=T>>>16|T<<16,ue=ue+T|0,h^=ue,h=h>>>20|h<<12,O=O+I|0,X^=O,X=X>>>16|X<<16,ge=ge+X|0,I^=ge,I=I>>>20|I<<12,N=N+re|0,J^=N,J=J>>>16|J<<16,ye=ye+J|0,re^=ye,re=re>>>20|re<<12,C=C+ne|0,B^=C,B=B>>>16|B<<16,E=E+B|0,ne^=E,ne=ne>>>20|ne<<12,N=N+re|0,J^=N,J=J>>>24|J<<8,ye=ye+J|0,re^=ye,re=re>>>25|re<<7,C=C+ne|0,B^=C,B=B>>>24|B<<8,E=E+B|0,ne^=E,ne=ne>>>25|ne<<7,O=O+I|0,X^=O,X=X>>>24|X<<8,ge=ge+X|0,I^=ge,I=I>>>25|I<<7,q=q+h|0,T^=q,T=T>>>24|T<<8,ue=ue+T|0,h^=ue,h=h>>>25|h<<7,q=q+I|0,B^=q,B=B>>>16|B<<16,ye=ye+B|0,I^=ye,I=I>>>20|I<<12,O=O+re|0,T^=O,T=T>>>16|T<<16,E=E+T|0,re^=E,re=re>>>20|re<<12,N=N+ne|0,X^=N,X=X>>>16|X<<16,ue=ue+X|0,ne^=ue,ne=ne>>>20|ne<<12,C=C+h|0,J^=C,J=J>>>16|J<<16,ge=ge+J|0,h^=ge,h=h>>>20|h<<12,N=N+ne|0,X^=N,X=X>>>24|X<<8,ue=ue+X|0,ne^=ue,ne=ne>>>25|ne<<7,C=C+h|0,J^=C,J=J>>>24|J<<8,ge=ge+J|0,h^=ge,h=h>>>25|h<<7,O=O+re|0,T^=O,T=T>>>24|T<<8,E=E+T|0,re^=E,re=re>>>25|re<<7,q=q+I|0,B^=q,B=B>>>24|B<<8,ye=ye+B|0,I^=ye,I=I>>>25|I<<7;Qt.writeUint32LE(q+s|0,i,0),Qt.writeUint32LE(O+o|0,i,4),Qt.writeUint32LE(N+c|0,i,8),Qt.writeUint32LE(C+d|0,i,12),Qt.writeUint32LE(h+f|0,i,16),Qt.writeUint32LE(I+y|0,i,20),Qt.writeUint32LE(re+g|0,i,24),Qt.writeUint32LE(ne+m|0,i,28),Qt.writeUint32LE(ue+_|0,i,32),Qt.writeUint32LE(ge+x|0,i,36),Qt.writeUint32LE(ye+P|0,i,40),Qt.writeUint32LE(E+A|0,i,44),Qt.writeUint32LE(T+W|0,i,48),Qt.writeUint32LE(X+K|0,i,52),Qt.writeUint32LE(J+ie|0,i,56),Qt.writeUint32LE(B+$|0,i,60)}function Kd(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-e.length,c.set(e,d)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,d=o}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){Z_(f,c,i);for(var g=y;g<y+64&&g<t.length;g++)s[g]=t[g]^f[g-y];t1(c,0,d)}return pu.wipe(f),o===0&&pu.wipe(c),s}sa.streamXOR=Kd;function e1(i,e,t,s){return s===void 0&&(s=0),pu.wipe(t),Kd(i,e,t,t,s)}sa.stream=e1;function t1(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var kd={},Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});function r1(i,e,t){return~(i-1)&e|i-1&t}Hi.select=r1;function i1(i,e){return(i|0)-(e|0)-1>>>31&1}Hi.lessOrEqual=i1;function Vd(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Hi.compare=Vd;function n1(i,e){return i.length===0||e.length===0?!1:Vd(i,e)!==0}Hi.equal=n1;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Hi,t=Rr;i.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var g=f[2]|f[3]<<8;this._r[1]=(y>>>13|g<<3)&8191;var m=f[4]|f[5]<<8;this._r[2]=(g>>>10|m<<6)&7939;var _=f[6]|f[7]<<8;this._r[3]=(m>>>7|_<<9)&8191;var x=f[8]|f[9]<<8;this._r[4]=(_>>>4|x<<12)&255,this._r[5]=x>>>1&8190;var P=f[10]|f[11]<<8;this._r[6]=(x>>>14|P<<2)&8191;var A=f[12]|f[13]<<8;this._r[7]=(P>>>11|A<<5)&8065;var W=f[14]|f[15]<<8;this._r[8]=(A>>>8|W<<8)&8191,this._r[9]=W>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,y,g){for(var m=this._fin?0:2048,_=this._h[0],x=this._h[1],P=this._h[2],A=this._h[3],W=this._h[4],K=this._h[5],ie=this._h[6],$=this._h[7],q=this._h[8],O=this._h[9],N=this._r[0],C=this._r[1],h=this._r[2],I=this._r[3],re=this._r[4],ne=this._r[5],ue=this._r[6],ge=this._r[7],ye=this._r[8],E=this._r[9];g>=16;){var T=f[y+0]|f[y+1]<<8;_+=T&8191;var X=f[y+2]|f[y+3]<<8;x+=(T>>>13|X<<3)&8191;var J=f[y+4]|f[y+5]<<8;P+=(X>>>10|J<<6)&8191;var B=f[y+6]|f[y+7]<<8;A+=(J>>>7|B<<9)&8191;var k=f[y+8]|f[y+9]<<8;W+=(B>>>4|k<<12)&8191,K+=k>>>1&8191;var Z=f[y+10]|f[y+11]<<8;ie+=(k>>>14|Z<<2)&8191;var te=f[y+12]|f[y+13]<<8;$+=(Z>>>11|te<<5)&8191;var Ie=f[y+14]|f[y+15]<<8;q+=(te>>>8|Ie<<8)&8191,O+=Ie>>>5|m;var oe=0,Se=oe;Se+=_*N,Se+=x*(5*E),Se+=P*(5*ye),Se+=A*(5*ge),Se+=W*(5*ue),oe=Se>>>13,Se&=8191,Se+=K*(5*ne),Se+=ie*(5*re),Se+=$*(5*I),Se+=q*(5*h),Se+=O*(5*C),oe+=Se>>>13,Se&=8191;var le=oe;le+=_*C,le+=x*N,le+=P*(5*E),le+=A*(5*ye),le+=W*(5*ge),oe=le>>>13,le&=8191,le+=K*(5*ue),le+=ie*(5*ne),le+=$*(5*re),le+=q*(5*I),le+=O*(5*h),oe+=le>>>13,le&=8191;var Ae=oe;Ae+=_*h,Ae+=x*C,Ae+=P*N,Ae+=A*(5*E),Ae+=W*(5*ye),oe=Ae>>>13,Ae&=8191,Ae+=K*(5*ge),Ae+=ie*(5*ue),Ae+=$*(5*ne),Ae+=q*(5*re),Ae+=O*(5*I),oe+=Ae>>>13,Ae&=8191;var z=oe;z+=_*I,z+=x*h,z+=P*C,z+=A*N,z+=W*(5*E),oe=z>>>13,z&=8191,z+=K*(5*ye),z+=ie*(5*ge),z+=$*(5*ue),z+=q*(5*ne),z+=O*(5*re),oe+=z>>>13,z&=8191;var H=oe;H+=_*re,H+=x*I,H+=P*h,H+=A*C,H+=W*N,oe=H>>>13,H&=8191,H+=K*(5*E),H+=ie*(5*ye),H+=$*(5*ge),H+=q*(5*ue),H+=O*(5*ne),oe+=H>>>13,H&=8191;var U=oe;U+=_*ne,U+=x*re,U+=P*I,U+=A*h,U+=W*C,oe=U>>>13,U&=8191,U+=K*N,U+=ie*(5*E),U+=$*(5*ye),U+=q*(5*ge),U+=O*(5*ue),oe+=U>>>13,U&=8191;var l=oe;l+=_*ue,l+=x*ne,l+=P*re,l+=A*I,l+=W*h,oe=l>>>13,l&=8191,l+=K*C,l+=ie*N,l+=$*(5*E),l+=q*(5*ye),l+=O*(5*ge),oe+=l>>>13,l&=8191;var R=oe;R+=_*ge,R+=x*ue,R+=P*ne,R+=A*re,R+=W*I,oe=R>>>13,R&=8191,R+=K*h,R+=ie*C,R+=$*N,R+=q*(5*E),R+=O*(5*ye),oe+=R>>>13,R&=8191;var se=oe;se+=_*ye,se+=x*ge,se+=P*ue,se+=A*ne,se+=W*re,oe=se>>>13,se&=8191,se+=K*I,se+=ie*h,se+=$*C,se+=q*N,se+=O*(5*E),oe+=se>>>13,se&=8191;var he=oe;he+=_*E,he+=x*ye,he+=P*ge,he+=A*ue,he+=W*ne,oe=he>>>13,he&=8191,he+=K*re,he+=ie*I,he+=$*h,he+=q*C,he+=O*N,oe+=he>>>13,he&=8191,oe=(oe<<2)+oe|0,oe=oe+Se|0,Se=oe&8191,oe=oe>>>13,le+=oe,_=Se,x=le,P=Ae,A=z,W=H,K=U,ie=l,$=R,q=se,O=he,y+=16,g-=16}this._h[0]=_,this._h[1]=x,this._h[2]=P,this._h[3]=A,this._h[4]=W,this._h[5]=K,this._h[6]=ie,this._h[7]=$,this._h[8]=q,this._h[9]=O},d.prototype.finish=function(f,y){y===void 0&&(y=0);var g=new Uint16Array(10),m,_,x,P;if(this._leftover){for(P=this._leftover,this._buffer[P++]=1;P<16;P++)this._buffer[P]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(m=this._h[1]>>>13,this._h[1]&=8191,P=2;P<10;P++)this._h[P]+=m,m=this._h[P]>>>13,this._h[P]&=8191;for(this._h[0]+=m*5,m=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=m,m=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=m,g[0]=this._h[0]+5,m=g[0]>>>13,g[0]&=8191,P=1;P<10;P++)g[P]=this._h[P]+m,m=g[P]>>>13,g[P]&=8191;for(g[9]-=8192,_=(m^1)-1,P=0;P<10;P++)g[P]&=_;for(_=~_,P=0;P<10;P++)this._h[P]=this._h[P]&_|g[P];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,x=this._h[0]+this._pad[0],this._h[0]=x&65535,P=1;P<8;P++)x=(this._h[P]+this._pad[P]|0)+(x>>>16)|0,this._h[P]=x&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var y=0,g=f.length,m;if(this._leftover){m=16-this._leftover,m>g&&(m=g);for(var _=0;_<m;_++)this._buffer[this._leftover+_]=f[y+_];if(g-=m,y+=m,this._leftover+=m,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(m=g-g%16,this._blocks(f,y,m),y+=m,g-=m),g){for(var _=0;_<g;_++)this._buffer[this._leftover+_]=f[y+_];this._leftover+=g}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();i.Poly1305=s;function o(d,f){var y=new s(d);y.update(f);var g=y.digest();return y.clean(),g}i.oneTimeAuth=o;function c(d,f){return d.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(d,f)}i.equal=c})(kd);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=sa,t=kd,s=Rr,o=Le,c=Hi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function y(g){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,g.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return y.prototype.seal=function(g,m,_,x){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var P=new Uint8Array(16);P.set(g,P.length-g.length);var A=new Uint8Array(32);e.stream(this._key,P,A,4);var W=m.length+this.tagLength,K;if(x){if(x.length!==W)throw new Error("ChaCha20Poly1305: incorrect destination length");K=x}else K=new Uint8Array(W);return e.streamXOR(this._key,P,m,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),A,K.subarray(0,K.length-this.tagLength),_),s.wipe(P),K},y.prototype.open=function(g,m,_,x){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(m.length<this.tagLength)return null;var P=new Uint8Array(16);P.set(g,P.length-g.length);var A=new Uint8Array(32);e.stream(this._key,P,A,4);var W=new Uint8Array(this.tagLength);if(this._authenticate(W,A,m.subarray(0,m.length-this.tagLength),_),!c.equal(W,m.subarray(m.length-this.tagLength,m.length)))return null;var K=m.length-this.tagLength,ie;if(x){if(x.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=x}else ie=new Uint8Array(K);return e.streamXOR(this._key,P,m.subarray(0,m.length-this.tagLength),ie,4),s.wipe(P),ie},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(g,m,_,x){var P=new t.Poly1305(m);x&&(P.update(x),x.length%16>0&&P.update(d.subarray(x.length%16))),P.update(_),_.length%16>0&&P.update(d.subarray(_.length%16));var A=new Uint8Array(8);x&&o.writeUint64LE(x.length,A),P.update(A),o.writeUint64LE(_.length,A),P.update(A);for(var W=P.digest(),K=0;K<W.length;K++)g[K]=W[K];P.clean(),s.wipe(W),s.wipe(A)},y}();i.ChaCha20Poly1305=f})(Uu);var Wd={},Ts={},Lu={};Object.defineProperty(Lu,"__esModule",{value:!0});function s1(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Lu.isSerializableHash=s1;Object.defineProperty(Ts,"__esModule",{value:!0});var ti=Lu,o1=Hi,a1=Rr,Gd=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ti.isSerializableHash(this._inner)&&ti.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),a1.wipe(s)}return i.prototype.reset=function(){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ti.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ti.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Ts.HMAC=Gd;function c1(i,e,t){var s=new Gd(i,e);s.update(t);var o=s.digest();return s.clean(),o}Ts.hmac=c1;Ts.equal=o1.equal;Object.defineProperty(Wd,"__esModule",{value:!0});var rf=Ts,nf=Rr,u1=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=rf.hmac(this._hash,s,t);this._hmac=new rf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),nf.wipe(this._buffer),nf.wipe(this._counter),this._bufpos=0},i}(),h1=Wd.HKDF=u1,zn={},oa={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.BrowserRandomSource=void 0;const sf=65536;class l1{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=sf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,sf)));return t}}aa.BrowserRandomSource=l1;var ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.NodeRandomSource=void 0;const f1=Rr;class d1{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof T_<"u"){const e=A_;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,f1.wipe)(t),s}}ca.NodeRandomSource=d1;Object.defineProperty(oa,"__esModule",{value:!0});oa.SystemRandomSource=void 0;const p1=aa,g1=ca;class y1{constructor(){if(this.isAvailable=!1,this.name="",this._source=new p1.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new g1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}oa.SystemRandomSource=y1;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=oa,t=Le,s=Rr;i.defaultRandomSource=new e.SystemRandomSource;function o(g,m=i.defaultRandomSource){return m.randomBytes(g)}i.randomBytes=o;function c(g=i.defaultRandomSource){const m=o(4,g),_=(0,t.readUint32LE)(m);return(0,s.wipe)(m),_}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,m=d,_=i.defaultRandomSource){if(m.length<2)throw new Error("randomString charset is too short");if(m.length>256)throw new Error("randomString charset is too long");let x="";const P=m.length,A=256-256%P;for(;g>0;){const W=o(Math.ceil(g*256/A),_);for(let K=0;K<W.length&&g>0;K++){const ie=W[K];ie<A&&(x+=m.charAt(ie%P),g--)}(0,s.wipe)(W)}return x}i.randomString=f;function y(g,m=d,_=i.defaultRandomSource){const x=Math.ceil(g/(Math.log(m.length)/Math.LN2));return f(x,m,_)}i.randomStringForEntropy=y})(zn);var ua={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Rr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._temp,this._state,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,_=g/536870912|0,x=g<<3,P=g%64<56?64:128;this._buffer[m]=128;for(var A=m+1;A<P-8;A++)this._buffer[A]=0;e.writeUint32BE(_,this._buffer,P-8),e.writeUint32BE(x,this._buffer,P-4),c(this._temp,this._state,this._buffer,0,P),this._finished=!0}for(var A=0;A<this.digestLength/4;A++)e.writeUint32BE(this._state[A],y,A*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,g,m,_){for(;_>=64;){for(var x=y[0],P=y[1],A=y[2],W=y[3],K=y[4],ie=y[5],$=y[6],q=y[7],O=0;O<16;O++){var N=m+O*4;f[O]=e.readUint32BE(g,N)}for(var O=16;O<64;O++){var C=f[O-2],h=(C>>>17|C<<15)^(C>>>19|C<<13)^C>>>10;C=f[O-15];var I=(C>>>7|C<<25)^(C>>>18|C<<14)^C>>>3;f[O]=(h+f[O-7]|0)+(I+f[O-16]|0)}for(var O=0;O<64;O++){var h=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&ie^~K&$)|0)+(q+(o[O]+f[O]|0)|0)|0,I=((x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10))+(x&P^x&A^P&A)|0;q=$,$=ie,ie=K,K=W+h|0,W=A,A=P,P=x,x=h+I|0}y[0]+=x,y[1]+=P,y[2]+=A,y[3]+=W,y[4]+=K,y[5]+=ie,y[6]+=$,y[7]+=q,m+=64,_-=64}return m}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(ua);var Mu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=zn,t=Rr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(O){const N=new Float64Array(16);if(O)for(let C=0;C<O.length;C++)N[C]=O[C];return N}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function d(O){let N=1;for(let C=0;C<16;C++){let h=O[C]+N+65535;N=Math.floor(h/65536),O[C]=h-N*65536}O[0]+=N-1+37*(N-1)}function f(O,N,C){const h=~(C-1);for(let I=0;I<16;I++){const re=h&(O[I]^N[I]);O[I]^=re,N[I]^=re}}function y(O,N){const C=s(),h=s();for(let I=0;I<16;I++)h[I]=N[I];d(h),d(h),d(h);for(let I=0;I<2;I++){C[0]=h[0]-65517;for(let ne=1;ne<15;ne++)C[ne]=h[ne]-65535-(C[ne-1]>>16&1),C[ne-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const re=C[15]>>16&1;C[14]&=65535,f(h,C,1-re)}for(let I=0;I<16;I++)O[2*I]=h[I]&255,O[2*I+1]=h[I]>>8}function g(O,N){for(let C=0;C<16;C++)O[C]=N[2*C]+(N[2*C+1]<<8);O[15]&=32767}function m(O,N,C){for(let h=0;h<16;h++)O[h]=N[h]+C[h]}function _(O,N,C){for(let h=0;h<16;h++)O[h]=N[h]-C[h]}function x(O,N,C){let h,I,re=0,ne=0,ue=0,ge=0,ye=0,E=0,T=0,X=0,J=0,B=0,k=0,Z=0,te=0,Ie=0,oe=0,Se=0,le=0,Ae=0,z=0,H=0,U=0,l=0,R=0,se=0,he=0,Ee=0,Fe=0,ke=0,Me=0,dt=0,pt=0,qe=C[0],xe=C[1],De=C[2],$e=C[3],He=C[4],Oe=C[5],Ue=C[6],be=C[7],Re=C[8],Be=C[9],Pe=C[10],Ve=C[11],Ge=C[12],Ze=C[13],et=C[14],Je=C[15];h=N[0],re+=h*qe,ne+=h*xe,ue+=h*De,ge+=h*$e,ye+=h*He,E+=h*Oe,T+=h*Ue,X+=h*be,J+=h*Re,B+=h*Be,k+=h*Pe,Z+=h*Ve,te+=h*Ge,Ie+=h*Ze,oe+=h*et,Se+=h*Je,h=N[1],ne+=h*qe,ue+=h*xe,ge+=h*De,ye+=h*$e,E+=h*He,T+=h*Oe,X+=h*Ue,J+=h*be,B+=h*Re,k+=h*Be,Z+=h*Pe,te+=h*Ve,Ie+=h*Ge,oe+=h*Ze,Se+=h*et,le+=h*Je,h=N[2],ue+=h*qe,ge+=h*xe,ye+=h*De,E+=h*$e,T+=h*He,X+=h*Oe,J+=h*Ue,B+=h*be,k+=h*Re,Z+=h*Be,te+=h*Pe,Ie+=h*Ve,oe+=h*Ge,Se+=h*Ze,le+=h*et,Ae+=h*Je,h=N[3],ge+=h*qe,ye+=h*xe,E+=h*De,T+=h*$e,X+=h*He,J+=h*Oe,B+=h*Ue,k+=h*be,Z+=h*Re,te+=h*Be,Ie+=h*Pe,oe+=h*Ve,Se+=h*Ge,le+=h*Ze,Ae+=h*et,z+=h*Je,h=N[4],ye+=h*qe,E+=h*xe,T+=h*De,X+=h*$e,J+=h*He,B+=h*Oe,k+=h*Ue,Z+=h*be,te+=h*Re,Ie+=h*Be,oe+=h*Pe,Se+=h*Ve,le+=h*Ge,Ae+=h*Ze,z+=h*et,H+=h*Je,h=N[5],E+=h*qe,T+=h*xe,X+=h*De,J+=h*$e,B+=h*He,k+=h*Oe,Z+=h*Ue,te+=h*be,Ie+=h*Re,oe+=h*Be,Se+=h*Pe,le+=h*Ve,Ae+=h*Ge,z+=h*Ze,H+=h*et,U+=h*Je,h=N[6],T+=h*qe,X+=h*xe,J+=h*De,B+=h*$e,k+=h*He,Z+=h*Oe,te+=h*Ue,Ie+=h*be,oe+=h*Re,Se+=h*Be,le+=h*Pe,Ae+=h*Ve,z+=h*Ge,H+=h*Ze,U+=h*et,l+=h*Je,h=N[7],X+=h*qe,J+=h*xe,B+=h*De,k+=h*$e,Z+=h*He,te+=h*Oe,Ie+=h*Ue,oe+=h*be,Se+=h*Re,le+=h*Be,Ae+=h*Pe,z+=h*Ve,H+=h*Ge,U+=h*Ze,l+=h*et,R+=h*Je,h=N[8],J+=h*qe,B+=h*xe,k+=h*De,Z+=h*$e,te+=h*He,Ie+=h*Oe,oe+=h*Ue,Se+=h*be,le+=h*Re,Ae+=h*Be,z+=h*Pe,H+=h*Ve,U+=h*Ge,l+=h*Ze,R+=h*et,se+=h*Je,h=N[9],B+=h*qe,k+=h*xe,Z+=h*De,te+=h*$e,Ie+=h*He,oe+=h*Oe,Se+=h*Ue,le+=h*be,Ae+=h*Re,z+=h*Be,H+=h*Pe,U+=h*Ve,l+=h*Ge,R+=h*Ze,se+=h*et,he+=h*Je,h=N[10],k+=h*qe,Z+=h*xe,te+=h*De,Ie+=h*$e,oe+=h*He,Se+=h*Oe,le+=h*Ue,Ae+=h*be,z+=h*Re,H+=h*Be,U+=h*Pe,l+=h*Ve,R+=h*Ge,se+=h*Ze,he+=h*et,Ee+=h*Je,h=N[11],Z+=h*qe,te+=h*xe,Ie+=h*De,oe+=h*$e,Se+=h*He,le+=h*Oe,Ae+=h*Ue,z+=h*be,H+=h*Re,U+=h*Be,l+=h*Pe,R+=h*Ve,se+=h*Ge,he+=h*Ze,Ee+=h*et,Fe+=h*Je,h=N[12],te+=h*qe,Ie+=h*xe,oe+=h*De,Se+=h*$e,le+=h*He,Ae+=h*Oe,z+=h*Ue,H+=h*be,U+=h*Re,l+=h*Be,R+=h*Pe,se+=h*Ve,he+=h*Ge,Ee+=h*Ze,Fe+=h*et,ke+=h*Je,h=N[13],Ie+=h*qe,oe+=h*xe,Se+=h*De,le+=h*$e,Ae+=h*He,z+=h*Oe,H+=h*Ue,U+=h*be,l+=h*Re,R+=h*Be,se+=h*Pe,he+=h*Ve,Ee+=h*Ge,Fe+=h*Ze,ke+=h*et,Me+=h*Je,h=N[14],oe+=h*qe,Se+=h*xe,le+=h*De,Ae+=h*$e,z+=h*He,H+=h*Oe,U+=h*Ue,l+=h*be,R+=h*Re,se+=h*Be,he+=h*Pe,Ee+=h*Ve,Fe+=h*Ge,ke+=h*Ze,Me+=h*et,dt+=h*Je,h=N[15],Se+=h*qe,le+=h*xe,Ae+=h*De,z+=h*$e,H+=h*He,U+=h*Oe,l+=h*Ue,R+=h*be,se+=h*Re,he+=h*Be,Ee+=h*Pe,Fe+=h*Ve,ke+=h*Ge,Me+=h*Ze,dt+=h*et,pt+=h*Je,re+=38*le,ne+=38*Ae,ue+=38*z,ge+=38*H,ye+=38*U,E+=38*l,T+=38*R,X+=38*se,J+=38*he,B+=38*Ee,k+=38*Fe,Z+=38*ke,te+=38*Me,Ie+=38*dt,oe+=38*pt,I=1,h=re+I+65535,I=Math.floor(h/65536),re=h-I*65536,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=ye+I+65535,I=Math.floor(h/65536),ye=h-I*65536,h=E+I+65535,I=Math.floor(h/65536),E=h-I*65536,h=T+I+65535,I=Math.floor(h/65536),T=h-I*65536,h=X+I+65535,I=Math.floor(h/65536),X=h-I*65536,h=J+I+65535,I=Math.floor(h/65536),J=h-I*65536,h=B+I+65535,I=Math.floor(h/65536),B=h-I*65536,h=k+I+65535,I=Math.floor(h/65536),k=h-I*65536,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=te+I+65535,I=Math.floor(h/65536),te=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=oe+I+65535,I=Math.floor(h/65536),oe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,re+=I-1+37*(I-1),I=1,h=re+I+65535,I=Math.floor(h/65536),re=h-I*65536,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=ye+I+65535,I=Math.floor(h/65536),ye=h-I*65536,h=E+I+65535,I=Math.floor(h/65536),E=h-I*65536,h=T+I+65535,I=Math.floor(h/65536),T=h-I*65536,h=X+I+65535,I=Math.floor(h/65536),X=h-I*65536,h=J+I+65535,I=Math.floor(h/65536),J=h-I*65536,h=B+I+65535,I=Math.floor(h/65536),B=h-I*65536,h=k+I+65535,I=Math.floor(h/65536),k=h-I*65536,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=te+I+65535,I=Math.floor(h/65536),te=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=oe+I+65535,I=Math.floor(h/65536),oe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,re+=I-1+37*(I-1),O[0]=re,O[1]=ne,O[2]=ue,O[3]=ge,O[4]=ye,O[5]=E,O[6]=T,O[7]=X,O[8]=J,O[9]=B,O[10]=k,O[11]=Z,O[12]=te,O[13]=Ie,O[14]=oe,O[15]=Se}function P(O,N){x(O,N,N)}function A(O,N){const C=s();for(let h=0;h<16;h++)C[h]=N[h];for(let h=253;h>=0;h--)P(C,C),h!==2&&h!==4&&x(C,C,N);for(let h=0;h<16;h++)O[h]=C[h]}function W(O,N){const C=new Uint8Array(32),h=new Float64Array(80),I=s(),re=s(),ne=s(),ue=s(),ge=s(),ye=s();for(let J=0;J<31;J++)C[J]=O[J];C[31]=O[31]&127|64,C[0]&=248,g(h,N);for(let J=0;J<16;J++)re[J]=h[J];I[0]=ue[0]=1;for(let J=254;J>=0;--J){const B=C[J>>>3]>>>(J&7)&1;f(I,re,B),f(ne,ue,B),m(ge,I,ne),_(I,I,ne),m(ne,re,ue),_(re,re,ue),P(ue,ge),P(ye,I),x(I,ne,I),x(ne,re,ge),m(ge,I,ne),_(I,I,ne),P(re,I),_(ne,ue,ye),x(I,ne,c),m(I,I,ue),x(ne,ne,I),x(I,ue,ye),x(ue,re,h),P(re,ge),f(I,re,B),f(ne,ue,B)}for(let J=0;J<16;J++)h[J+16]=I[J],h[J+32]=ne[J],h[J+48]=re[J],h[J+64]=ue[J];const E=h.subarray(32),T=h.subarray(16);A(E,E),x(T,T,E);const X=new Uint8Array(32);return y(X,T),X}i.scalarMult=W;function K(O){return W(O,o)}i.scalarMultBase=K;function ie(O){if(O.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const N=new Uint8Array(O);return{publicKey:K(N),secretKey:N}}i.generateKeyPairFromSeed=ie;function $(O){const N=(0,e.randomBytes)(32,O),C=ie(N);return(0,t.wipe)(N),C}i.generateKeyPair=$;function q(O,N,C=!1){if(O.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(N.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=W(O,N);if(C){let I=0;for(let re=0;re<h.length;re++)I|=h[re];if(I===0)throw new Error("X25519: invalid shared key")}return h}i.sharedKey=q})(Mu);function ju(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Yd(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ju(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function gu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=Yd(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return ju(t)}function Jd(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const of=Jd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Fc=Jd("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=Yd(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),Qd={utf8:of,"utf-8":of,hex:tf.base16,latin1:Fc,ascii:Fc,binary:Fc,...tf};function vr(i,e="utf8"){const t=Qd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ju(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function ar(i,e="utf8"){const t=Qd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var af=function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},v1=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),m1=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}(),w1=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),_1=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),b1=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),E1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,I1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,cf=3,S1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",E1]],uf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function x1(i){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new b1:typeof navigator<"u"?O1(navigator.userAgent):T1()}function P1(i){return i!==""&&S1.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function O1(i){var e=P1(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new _1;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<cf&&(o=af(af([],o,!0),A1(cf-o.length),!0)):o=[];var c=o.join("."),d=R1(i),f=I1.exec(i);return f&&f[1]?new w1(t,c,d,f[1]):new v1(t,c,d)}function R1(i){for(var e=0,t=uf.length;e<t;e++){var s=uf[e],o=s[0],c=s[1],d=c.exec(i);if(d)return o}return null}function T1(){var i=typeof process<"u"&&process.version;return i?new m1(process.version.slice(1)):null}function A1(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yu=function(i,e){return yu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},yu(i,e)};function N1(i,e){yu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var vu=function(){return vu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},vu.apply(this,arguments)};function C1(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function D1(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(o<3?d(c):o>3?d(e,t,c):d(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function $1(i,e){return function(t,s){e(t,s,i)}}function U1(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function L1(i,e,t,s){function o(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function f(m){try{g(s.next(m))}catch(_){d(_)}}function y(m){try{g(s.throw(m))}catch(_){d(_)}}function g(m){m.done?c(m.value):o(m.value).then(f,y)}g((s=s.apply(i,e||[])).next())})}function M1(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(m){return y([g,m])}}function y(g){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,o=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(i,t)}catch(m){g=[6,m],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function j1(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function q1(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function mu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xd(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(d)throw d.error}}return c}function H1(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Xd(arguments[e]));return i}function z1(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function Is(i){return this instanceof Is?(this.v=i,this):new Is(i)}function F1(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(x){s[x]&&(o[x]=function(P){return new Promise(function(A,W){c.push([x,P,A,W])>1||f(x,P)})})}function f(x,P){try{y(s[x](P))}catch(A){_(c[0][3],A)}}function y(x){x.value instanceof Is?Promise.resolve(x.value.v).then(g,m):_(c[0][2],x)}function g(x){f("next",x)}function m(x){f("throw",x)}function _(x,P){x(P),c.shift(),c.length&&f(c[0][0],c[0][1])}}function B1(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(d){return(t=!t)?{value:Is(i[o](d)),done:o==="return"}:c?c(d):d}:c}}function K1(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof mu=="function"?mu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(d){return new Promise(function(f,y){d=i[c](d),o(f,y,d.done,d.value)})}}function o(c,d,f,y){Promise.resolve(y).then(function(g){c({value:g,done:f})},d)}}function k1(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function V1(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function W1(i){return i&&i.__esModule?i:{default:i}}function G1(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Y1(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const J1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return vu},__asyncDelegator:B1,__asyncGenerator:F1,__asyncValues:K1,__await:Is,__awaiter:L1,__classPrivateFieldGet:G1,__classPrivateFieldSet:Y1,__createBinding:j1,__decorate:D1,__exportStar:q1,__extends:N1,__generator:M1,__importDefault:W1,__importStar:V1,__makeTemplateObject:k1,__metadata:U1,__param:$1,__read:Xd,__rest:C1,__spread:H1,__spreadArrays:z1,__values:mu},Symbol.toStringTag,{value:"Module"})),Ii=Du(J1);var Bc={},fs={},hf;function Q1(){if(hf)return fs;hf=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return fs.delay=i,fs}var rn={},Kc={},nn={},lf;function X1(){return lf||(lf=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.ONE_THOUSAND=nn.ONE_HUNDRED=void 0,nn.ONE_HUNDRED=100,nn.ONE_THOUSAND=1e3),nn}var kc={},ff;function Z1(){return ff||(ff=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(kc)),kc}var df;function Zd(){return df||(df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ii;e.__exportStar(X1(),i),e.__exportStar(Z1(),i)}(Kc)),Kc}var pf;function eb(){if(pf)return rn;pf=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.fromMiliseconds=rn.toMiliseconds=void 0;const i=Zd();function e(s){return s*i.ONE_THOUSAND}rn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return rn.fromMiliseconds=t,rn}var gf;function tb(){return gf||(gf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ii;e.__exportStar(Q1(),i),e.__exportStar(eb(),i)}(Bc)),Bc}var Dn={},yf;function rb(){if(yf)return Dn;yf=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Dn.Watch=i,Dn.default=i,Dn}var Vc={},ds={},vf;function ib(){if(vf)return ds;vf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IWatch=void 0;class i{}return ds.IWatch=i,ds}var mf;function nb(){return mf||(mf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ii.__exportStar(ib(),i)}(Vc)),Vc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ii;e.__exportStar(tb(),i),e.__exportStar(rb(),i),e.__exportStar(nb(),i),e.__exportStar(Zd(),i)})(ve);var ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.getLocalStorage=ht.getLocalStorageOrThrow=ht.getCrypto=ht.getCryptoOrThrow=ep=ht.getLocation=ht.getLocationOrThrow=Hu=ht.getNavigator=ht.getNavigatorOrThrow=qu=ht.getDocument=ht.getDocumentOrThrow=ht.getFromWindowOrThrow=ht.getFromWindow=void 0;function cn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}ht.getFromWindow=cn;function Fn(i){const e=cn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}ht.getFromWindowOrThrow=Fn;function sb(){return Fn("document")}ht.getDocumentOrThrow=sb;function ob(){return cn("document")}var qu=ht.getDocument=ob;function ab(){return Fn("navigator")}ht.getNavigatorOrThrow=ab;function cb(){return cn("navigator")}var Hu=ht.getNavigator=cb;function ub(){return Fn("location")}ht.getLocationOrThrow=ub;function hb(){return cn("location")}var ep=ht.getLocation=hb;function lb(){return Fn("crypto")}ht.getCryptoOrThrow=lb;function fb(){return cn("crypto")}ht.getCrypto=fb;function db(){return Fn("localStorage")}ht.getLocalStorageOrThrow=db;function pb(){return cn("localStorage")}ht.getLocalStorage=pb;var zu={};Object.defineProperty(zu,"__esModule",{value:!0});var tp=zu.getWindowMetadata=void 0;const wf=ht;function gb(){let i,e;try{i=wf.getDocumentOrThrow(),e=wf.getLocationOrThrow()}catch{return null}function t(){const _=i.getElementsByTagName("link"),x=[];for(let P=0;P<_.length;P++){const A=_[P],W=A.getAttribute("rel");if(W&&W.toLowerCase().indexOf("icon")>-1){const K=A.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(K.indexOf("/")===0)ie+=K;else{const $=e.pathname.split("/");$.pop();const q=$.join("/");ie+=q+"/"+K}x.push(ie)}else if(K.indexOf("//")===0){const ie=e.protocol+K;x.push(ie)}else x.push(K)}}return x}function s(..._){const x=i.getElementsByTagName("meta");for(let P=0;P<x.length;P++){const A=x[P],W=["itemprop","property","name"].map(K=>A.getAttribute(K)).filter(K=>K?_.includes(K):!1);if(W.length&&W){const K=A.getAttribute("content");if(K)return K}}return""}function o(){let _=s("name","og:site_name","og:title","twitter:title");return _||(_=i.title),_}function c(){return s("description","og:description","twitter:description","keywords")}const d=o(),f=c(),y=e.origin,g=t();return{description:f,url:y,icons:g,name:d}}tp=zu.getWindowMetadata=gb;var Ss={},yb=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),rp="%[a-f0-9]{2}",_f=new RegExp("("+rp+")|([^%]+?)","gi"),bf=new RegExp("("+rp+")+","gi");function wu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],wu(t),wu(s))}function vb(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(_f)||[],t=1;t<e.length;t++)i=wu(e,t).join(""),e=i.match(_f)||[];return i}}function mb(i){for(var e={"%FE%FF":"","%FF%FE":""},t=bf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=vb(t[0]);s!==t[0]&&(e[t[0]]=s)}t=bf.exec(i)}e["%C2"]="";for(var o=Object.keys(e),c=0;c<o.length;c++){var d=o[c];i=i.replace(new RegExp(d,"g"),e[d])}return i}var wb=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return mb(i)}},_b=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},bb=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var d=s[c],f=i[d];(o?e.indexOf(d)!==-1:e(d,f,i))&&(t[d]=f)}return t};(function(i){const e=yb,t=wb,s=_b,o=bb,c=$=>$==null,d=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return q=>(O,N)=>{const C=O.length;return N===void 0||$.skipNull&&N===null||$.skipEmptyString&&N===""?O:N===null?[...O,[m(q,$),"[",C,"]"].join("")]:[...O,[m(q,$),"[",m(C,$),"]=",m(N,$)].join("")]};case"bracket":return q=>(O,N)=>N===void 0||$.skipNull&&N===null||$.skipEmptyString&&N===""?O:N===null?[...O,[m(q,$),"[]"].join("")]:[...O,[m(q,$),"[]=",m(N,$)].join("")];case"colon-list-separator":return q=>(O,N)=>N===void 0||$.skipNull&&N===null||$.skipEmptyString&&N===""?O:N===null?[...O,[m(q,$),":list="].join("")]:[...O,[m(q,$),":list=",m(N,$)].join("")];case"comma":case"separator":case"bracket-separator":{const q=$.arrayFormat==="bracket-separator"?"[]=":"=";return O=>(N,C)=>C===void 0||$.skipNull&&C===null||$.skipEmptyString&&C===""?N:(C=C===null?"":C,N.length===0?[[m(O,$),q,m(C,$)].join("")]:[[N,m(C,$)].join($.arrayFormatSeparator)])}default:return q=>(O,N)=>N===void 0||$.skipNull&&N===null||$.skipEmptyString&&N===""?O:N===null?[...O,m(q,$)]:[...O,[m(q,$),"=",m(N,$)].join("")]}}function y($){let q;switch($.arrayFormat){case"index":return(O,N,C)=>{if(q=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!q){C[O]=N;return}C[O]===void 0&&(C[O]={}),C[O][q[1]]=N};case"bracket":return(O,N,C)=>{if(q=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!q){C[O]=N;return}if(C[O]===void 0){C[O]=[N];return}C[O]=[].concat(C[O],N)};case"colon-list-separator":return(O,N,C)=>{if(q=/(:list)$/.exec(O),O=O.replace(/:list$/,""),!q){C[O]=N;return}if(C[O]===void 0){C[O]=[N];return}C[O]=[].concat(C[O],N)};case"comma":case"separator":return(O,N,C)=>{const h=typeof N=="string"&&N.includes($.arrayFormatSeparator),I=typeof N=="string"&&!h&&_(N,$).includes($.arrayFormatSeparator);N=I?_(N,$):N;const re=h||I?N.split($.arrayFormatSeparator).map(ne=>_(ne,$)):N===null?N:_(N,$);C[O]=re};case"bracket-separator":return(O,N,C)=>{const h=/(\[\])$/.test(O);if(O=O.replace(/\[\]$/,""),!h){C[O]=N&&_(N,$);return}const I=N===null?[]:N.split($.arrayFormatSeparator).map(re=>_(re,$));if(C[O]===void 0){C[O]=I;return}C[O]=[].concat(C[O],I)};default:return(O,N,C)=>{if(C[O]===void 0){C[O]=N;return}C[O]=[].concat(C[O],N)}}}function g($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m($,q){return q.encode?q.strict?e($):encodeURIComponent($):$}function _($,q){return q.decode?t($):$}function x($){return Array.isArray($)?$.sort():typeof $=="object"?x(Object.keys($)).sort((q,O)=>Number(q)-Number(O)).map(q=>$[q]):$}function P($){const q=$.indexOf("#");return q!==-1&&($=$.slice(0,q)),$}function A($){let q="";const O=$.indexOf("#");return O!==-1&&(q=$.slice(O)),q}function W($){$=P($);const q=$.indexOf("?");return q===-1?"":$.slice(q+1)}function K($,q){return q.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):q.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function ie($,q){q=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},q),g(q.arrayFormatSeparator);const O=y(q),N=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return N;for(const C of $.split("&")){if(C==="")continue;let[h,I]=s(q.decode?C.replace(/\+/g," "):C,"=");I=I===void 0?null:["comma","separator","bracket-separator"].includes(q.arrayFormat)?I:_(I,q),O(_(h,q),I,N)}for(const C of Object.keys(N)){const h=N[C];if(typeof h=="object"&&h!==null)for(const I of Object.keys(h))h[I]=K(h[I],q);else N[C]=K(h,q)}return q.sort===!1?N:(q.sort===!0?Object.keys(N).sort():Object.keys(N).sort(q.sort)).reduce((C,h)=>{const I=N[h];return I&&typeof I=="object"&&!Array.isArray(I)?C[h]=x(I):C[h]=I,C},Object.create(null))}i.extract=W,i.parse=ie,i.stringify=($,q)=>{if(!$)return"";q=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},q),g(q.arrayFormatSeparator);const O=I=>q.skipNull&&c($[I])||q.skipEmptyString&&$[I]==="",N=f(q),C={};for(const I of Object.keys($))O(I)||(C[I]=$[I]);const h=Object.keys(C);return q.sort!==!1&&h.sort(q.sort),h.map(I=>{const re=$[I];return re===void 0?"":re===null?m(I,q):Array.isArray(re)?re.length===0&&q.arrayFormat==="bracket-separator"?m(I,q)+"[]":re.reduce(N(I),[]).join("&"):m(I,q)+"="+m(re,q)}).filter(I=>I.length>0).join("&")},i.parseUrl=($,q)=>{q=Object.assign({decode:!0},q);const[O,N]=s($,"#");return Object.assign({url:O.split("?")[0]||"",query:ie(W($),q)},q&&q.parseFragmentIdentifier&&N?{fragmentIdentifier:_(N,q)}:{})},i.stringifyUrl=($,q)=>{q=Object.assign({encode:!0,strict:!0,[d]:!0},q);const O=P($.url).split("?")[0]||"",N=i.extract($.url),C=i.parse(N,{sort:!1}),h=Object.assign(C,$.query);let I=i.stringify(h,q);I&&(I=`?${I}`);let re=A($.url);return $.fragmentIdentifier&&(re=`#${q[d]?m($.fragmentIdentifier,q):$.fragmentIdentifier}`),`${O}${I}${re}`},i.pick=($,q,O)=>{O=Object.assign({parseFragmentIdentifier:!0,[d]:!1},O);const{url:N,query:C,fragmentIdentifier:h}=i.parseUrl($,O);return i.stringifyUrl({url:N,query:o(C,q),fragmentIdentifier:h},O)},i.exclude=($,q,O)=>{const N=Array.isArray(q)?C=>!q.includes(C):(C,h)=>!q(C,h);return i.pick($,N,O)}})(Ss);const Eb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},Ib=":";function Sb(i){const[e,t]=i.split(Ib);return{namespace:e,reference:t}}function xb(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function ip(i,e){return i.includes(":")?[i]:e.chains||[]}const np="base10",or="base16",_u="base64pad",Fu="utf8",sp=0,un=1,Pb=0,Ef=1,bu=12,Bu=32;function Ob(){const i=Mu.generateKeyPair();return{privateKey:ar(i.secretKey,or),publicKey:ar(i.publicKey,or)}}function Eu(){const i=zn.randomBytes(Bu);return ar(i,or)}function Rb(i,e){const t=Mu.sharedKey(vr(i,or),vr(e,or),!0),s=new h1(ua.SHA256,t).expand(Bu);return ar(s,or)}function Tb(i){const e=ua.hash(vr(i,or));return ar(e,or)}function qn(i){const e=ua.hash(vr(i,Fu));return ar(e,or)}function Ab(i){return vr(`${i}`,np)}function As(i){return Number(ar(i,np))}function Nb(i){const e=Ab(typeof i.type<"u"?i.type:sp);if(As(e)===un&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?vr(i.senderPublicKey,or):void 0,s=typeof i.iv<"u"?vr(i.iv,or):zn.randomBytes(bu),o=new Uu.ChaCha20Poly1305(vr(i.symKey,or)).seal(s,vr(i.message,Fu));return Db({type:e,sealed:o,iv:s,senderPublicKey:t})}function Cb(i){const e=new Uu.ChaCha20Poly1305(vr(i.symKey,or)),{sealed:t,iv:s}=Zo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return ar(o,Fu)}function Db(i){if(As(i.type)===un){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ar(gu([i.type,i.senderPublicKey,i.iv,i.sealed]),_u)}return ar(gu([i.type,i.iv,i.sealed]),_u)}function Zo(i){const e=vr(i,_u),t=e.slice(Pb,Ef),s=Ef;if(As(t)===un){const f=s+Bu,y=f+bu,g=e.slice(s,f),m=e.slice(f,y),_=e.slice(y);return{type:t,sealed:_,iv:m,senderPublicKey:g}}const o=s+bu,c=e.slice(s,o),d=e.slice(o);return{type:t,sealed:d,iv:c}}function $b(i,e){const t=Zo(i);return op({type:As(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ar(t.senderPublicKey,or):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function op(i){const e=(i==null?void 0:i.type)||sp;if(e===un){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function If(i){return i.type===un&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var Ub=Object.defineProperty,Sf=Object.getOwnPropertySymbols,Lb=Object.prototype.hasOwnProperty,Mb=Object.prototype.propertyIsEnumerable,xf=(i,e,t)=>e in i?Ub(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Pf=(i,e)=>{for(var t in e||(e={}))Lb.call(e,t)&&xf(i,t,e[t]);if(Sf)for(var t of Sf(e))Mb.call(e,t)&&xf(i,t,e[t]);return i};const jb="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},qb="js";function Ku(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Bn(){return!qu()&&!!Hu()&&navigator.product===jb}function Kn(){return!Ku()&&!!Hu()&&!!qu()}function Ns(){return Bn()?Or.reactNative:Ku()?Or.node:Kn()?Or.browser:Or.unknown}function Hb(){var i;try{return Bn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function zb(i,e){let t=Ss.parse(i);return t=Pf(Pf({},t),e),i=Ss.stringify(t),i}function Fb(){return tp()||{name:"",description:"",url:"",icons:[""]}}function Bb(){if(Ns()===Or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=x1();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function Kb(){var i;const e=Ns();return e===Or.browser?[e,((i=ep())==null?void 0:i.host)||"unknown"].join(":"):e}function kb(i,e,t){const s=Bb(),o=Kb();return[[i,e].join("-"),[qb,t].join("-"),s,o].join("/")}function Vb({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:d,bundleId:f}){const y=t.split("?"),g=kb(i,e,s),m={auth:o,ua:g,projectId:c,useOnCloseEvent:d||void 0,origin:f||void 0},_=zb(y[1]||"",m);return y[0]+"?"+_}function on(i,e){return i.filter(t=>e.includes(t)).length===i.length}function ap(i){return Object.fromEntries(i.entries())}function cp(i){return new Map(Object.entries(i))}function Mn(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&o&&(clearTimeout(c),o(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=d,o=f})}}function xs(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const d=await i;s(d)}catch(d){o(d)}clearTimeout(c)})}function up(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function Wb(i){return up("topic",i)}function Gb(i){return up("id",i)}function hp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Pr(i,e){return ve.fromMiliseconds(Date.now()+ve.toMiliseconds(i))}function Mi(i){return Date.now()>=ve.toMiliseconds(i)}function Dt(i,e){return`${i}${e?`:${e}`:""}`}function Wc(i=[],e=[]){return[...new Set([...i,...e])]}async function Yb({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,d=Ns();d===Or.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):d===Or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch{}}async function Jb(i,e){try{return await i.getItem(e)||(Kn()?localStorage.getItem(e):void 0)}catch{}}const Qb="irn";function Iu(i){return(i==null?void 0:i.relay)||{protocol:Qb}}function Go(i){const e=Eb[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var Xb=Object.defineProperty,Zb=Object.defineProperties,eE=Object.getOwnPropertyDescriptors,Of=Object.getOwnPropertySymbols,tE=Object.prototype.hasOwnProperty,rE=Object.prototype.propertyIsEnumerable,Rf=(i,e,t)=>e in i?Xb(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,iE=(i,e)=>{for(var t in e||(e={}))tE.call(e,t)&&Rf(i,t,e[t]);if(Of)for(var t of Of(e))rE.call(e,t)&&Rf(i,t,e[t]);return i},nE=(i,e)=>Zb(i,eE(e));function sE(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),d=i[o];t[c]=d}}),t}function Tf(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",d=Ss.parse(c);return{protocol:s,topic:oE(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:sE(d),expiryTimestamp:d.expiryTimestamp?parseInt(d.expiryTimestamp,10):void 0}}function oE(i){return i.startsWith("//")?i.substring(2):i}function aE(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function cE(i){return`${i.protocol}:${i.topic}@${i.version}?`+Ss.stringify(nE(iE({symKey:i.symKey},aE(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function kn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function uE(i){const e=[];return Object.values(i).forEach(t=>{e.push(...kn(t.accounts))}),e}function hE(i,e){const t=[];return Object.values(i).forEach(s=>{kn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function lE(i,e){const t=[];return Object.values(i).forEach(s=>{kn(s.accounts).includes(e)&&t.push(...s.events)}),t}function ku(i){return i.includes(":")}function ws(i){return ku(i)?i.split(":")[0]:i}const fE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},dE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ae(i,e){const{message:t,code:s}=dE[i];return{message:e?`${t} ${e}`:t,code:s}}function mt(i,e){const{message:t,code:s}=fE[i];return{message:e?`${t} ${e}`:t,code:s}}function ni(i,e){return!!Array.isArray(i)}function Ps(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function yr(i){return typeof i>"u"}function Vt(i,e){return e&&yr(i)?!0:typeof i=="string"&&!!i.trim().length}function Vu(i,e){return typeof i=="number"&&!isNaN(i)}function pE(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return on(o,s)?(s.forEach(d=>{const{accounts:f,methods:y,events:g}=i.namespaces[d],m=kn(f),_=t[d];(!on(ip(d,_),m)||!on(_.methods,y)||!on(_.events,g))&&(c=!1)}),c):!1}function ea(i){return Vt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function gE(i){if(Vt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ea(t)}}return!1}function yE(i){if(Vt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function vE(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function mE(i){return i==null?void 0:i.topic}function wE(i,e){let t=null;return Vt(i==null?void 0:i.publicKey,!1)||(t=ae("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Af(i){let e=!0;return ni(i)?i.length&&(e=i.every(t=>Vt(t,!1))):e=!1,e}function _E(i,e,t){let s=null;return ni(e)&&e.length?e.forEach(o=>{s||ea(o)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ea(i)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function bE(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const d=_E(o,ip(o,c),`${e} ${t}`);d&&(s=d)}),s}function EE(i,e){let t=null;return ni(i)?i.forEach(s=>{t||gE(s)||(t=mt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=mt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function IE(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=EE(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function SE(i,e){let t=null;return Af(i==null?void 0:i.methods)?Af(i==null?void 0:i.events)||(t=mt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=mt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function lp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=SE(s,`${e}, namespace`);o&&(t=o)}),t}function xE(i,e,t){let s=null;if(i&&Ps(i)){const o=lp(i,e);o&&(s=o);const c=bE(i,e,t);c&&(s=c)}else s=ae("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Gc(i,e){let t=null;if(i&&Ps(i)){const s=lp(i,e);s&&(t=s);const o=IE(i,e);o&&(t=o)}else t=ae("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function fp(i){return Vt(i.protocol,!0)}function PE(i,e){let t=!1;return i?i&&ni(i)&&i.length&&i.forEach(s=>{t=fp(s)}):t=!0,t}function OE(i){return typeof i=="number"}function gr(i){return typeof i<"u"&&typeof i!==null}function RE(i){return!(!i||typeof i!="object"||!i.code||!Vu(i.code)||!i.message||!Vt(i.message,!1))}function TE(i){return!(yr(i)||!Vt(i.method,!1))}function AE(i){return!(yr(i)||yr(i.result)&&yr(i.error)||!Vu(i.id)||!Vt(i.jsonrpc,!1))}function NE(i){return!(yr(i)||!Vt(i.name,!1))}function Nf(i,e){return!(!ea(e)||!uE(i).includes(e))}function CE(i,e,t){return Vt(t,!1)?hE(i,e).includes(t):!1}function DE(i,e,t){return Vt(t,!1)?lE(i,e).includes(t):!1}function Cf(i,e,t){let s=null;const o=$E(i),c=UE(e),d=Object.keys(o),f=Object.keys(c),y=Df(Object.keys(i)),g=Df(Object.keys(e)),m=y.filter(_=>!g.includes(_));return m.length&&(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${m.toString()}
      Received: ${Object.keys(e).toString()}`)),on(d,f)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(_=>{if(!_.includes(":")||s)return;const x=kn(e[_].accounts);x.includes(_)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${_}
        Required: ${_}
        Approved: ${x.toString()}`))}),d.forEach(_=>{s||(on(o[_].methods,c[_].methods)?on(o[_].events,c[_].events)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${_}`)):s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${_}`))}),s}function $E(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Df(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function UE(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=kn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function LE(i,e){return Vu(i)&&i<=e.max&&i>=e.min}function $f(){const i=Ns();return new Promise(e=>{switch(i){case Or.browser:e(ME());break;case Or.reactNative:e(jE());break;case Or.node:e(qE());break;default:e(!0)}})}function ME(){return Kn()&&(navigator==null?void 0:navigator.onLine)}async function jE(){if(Bn()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function qE(){return!0}function HE(i){switch(Ns()){case Or.browser:zE(i);break;case Or.reactNative:FE(i);break}}function zE(i){!Bn()&&Kn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function FE(i){Bn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Yc={};let zo=class{static get(e){return Yc[e]}static set(e,t){Yc[e]=t}static delete(e){delete Yc[e]}};const BE=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,KE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,kE=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function VE(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){return}return e}function Fo(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!kE.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(BE.test(i)||KE.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,VE)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function WE(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function kt(i,...e){try{return WE(i(...e))}catch(t){return Promise.reject(t)}}function GE(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function YE(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Yo(i){if(GE(i))return String(i);if(YE(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Yo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function dp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Su="base64:";function JE(i){if(typeof i=="string")return i;dp();const e=Buffer.from(i).toString("base64");return Su+e}function QE(i){return typeof i!="string"||!i.startsWith(Su)?i:(dp(),Buffer.from(i.slice(Su.length),"base64"))}function pr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function XE(...i){return pr(i.join(":"))}function Bo(i){return i=pr(i),i?i+":":""}const ZE="memory",eI=()=>{const i=new Map;return{name:ZE,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function tI(i={}){const e={mounts:{"":i.driver||eI()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=g=>{for(const m of e.mountpoints)if(g.startsWith(m))return{base:m,relativeKey:g.slice(m.length),driver:e.mounts[m]};return{base:"",relativeKey:g,driver:e.mounts[""]}},s=(g,m)=>e.mountpoints.filter(_=>_.startsWith(g)||m&&g.startsWith(_)).map(_=>({relativeBase:g.length>_.length?g.slice(_.length):void 0,mountpoint:_,driver:e.mounts[_]})),o=(g,m)=>{if(e.watching){m=pr(m);for(const _ of e.watchListeners)_(g,m)}},c=async()=>{if(!e.watching){e.watching=!0;for(const g in e.mounts)e.unwatch[g]=await Uf(e.mounts[g],o,g)}},d=async()=>{if(e.watching){for(const g in e.unwatch)await e.unwatch[g]();e.unwatch={},e.watching=!1}},f=(g,m,_)=>{const x=new Map,P=A=>{let W=x.get(A.base);return W||(W={driver:A.driver,base:A.base,items:[]},x.set(A.base,W)),W};for(const A of g){const W=typeof A=="string",K=pr(W?A:A.key),ie=W?void 0:A.value,$=W||!A.options?m:{...m,...A.options},q=t(K);P(q).items.push({key:K,value:ie,relativeKey:q.relativeKey,options:$})}return Promise.all([...x.values()].map(A=>_(A))).then(A=>A.flat())},y={hasItem(g,m={}){g=pr(g);const{relativeKey:_,driver:x}=t(g);return kt(x.hasItem,_,m)},getItem(g,m={}){g=pr(g);const{relativeKey:_,driver:x}=t(g);return kt(x.getItem,_,m).then(P=>Fo(P))},getItems(g,m){return f(g,m,_=>_.driver.getItems?kt(_.driver.getItems,_.items.map(x=>({key:x.relativeKey,options:x.options})),m).then(x=>x.map(P=>({key:XE(_.base,P.key),value:Fo(P.value)}))):Promise.all(_.items.map(x=>kt(_.driver.getItem,x.relativeKey,x.options).then(P=>({key:x.key,value:Fo(P)})))))},getItemRaw(g,m={}){g=pr(g);const{relativeKey:_,driver:x}=t(g);return x.getItemRaw?kt(x.getItemRaw,_,m):kt(x.getItem,_,m).then(P=>QE(P))},async setItem(g,m,_={}){if(m===void 0)return y.removeItem(g);g=pr(g);const{relativeKey:x,driver:P}=t(g);P.setItem&&(await kt(P.setItem,x,Yo(m),_),P.watch||o("update",g))},async setItems(g,m){await f(g,m,async _=>{if(_.driver.setItems)return kt(_.driver.setItems,_.items.map(x=>({key:x.relativeKey,value:Yo(x.value),options:x.options})),m);_.driver.setItem&&await Promise.all(_.items.map(x=>kt(_.driver.setItem,x.relativeKey,Yo(x.value),x.options)))})},async setItemRaw(g,m,_={}){if(m===void 0)return y.removeItem(g,_);g=pr(g);const{relativeKey:x,driver:P}=t(g);if(P.setItemRaw)await kt(P.setItemRaw,x,m,_);else if(P.setItem)await kt(P.setItem,x,JE(m),_);else return;P.watch||o("update",g)},async removeItem(g,m={}){typeof m=="boolean"&&(m={removeMeta:m}),g=pr(g);const{relativeKey:_,driver:x}=t(g);x.removeItem&&(await kt(x.removeItem,_,m),(m.removeMeta||m.removeMata)&&await kt(x.removeItem,_+"$",m),x.watch||o("remove",g))},async getMeta(g,m={}){typeof m=="boolean"&&(m={nativeOnly:m}),g=pr(g);const{relativeKey:_,driver:x}=t(g),P=Object.create(null);if(x.getMeta&&Object.assign(P,await kt(x.getMeta,_,m)),!m.nativeOnly){const A=await kt(x.getItem,_+"$",m).then(W=>Fo(W));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(P,A))}return P},setMeta(g,m,_={}){return this.setItem(g+"$",m,_)},removeMeta(g,m={}){return this.removeItem(g+"$",m)},async getKeys(g,m={}){g=Bo(g);const _=s(g,!0);let x=[];const P=[];for(const A of _){const K=(await kt(A.driver.getKeys,A.relativeBase,m)).map(ie=>A.mountpoint+pr(ie)).filter(ie=>!x.some($=>ie.startsWith($)));P.push(...K),x=[A.mountpoint,...x.filter(ie=>!ie.startsWith(A.mountpoint))]}return g?P.filter(A=>A.startsWith(g)&&!A.endsWith("$")):P.filter(A=>!A.endsWith("$"))},async clear(g,m={}){g=Bo(g),await Promise.all(s(g,!1).map(async _=>{if(_.driver.clear)return kt(_.driver.clear,_.relativeBase,m);if(_.driver.removeItem){const x=await _.driver.getKeys(_.relativeBase||"",m);return Promise.all(x.map(P=>_.driver.removeItem(P,m)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(g=>Lf(g)))},async watch(g){return await c(),e.watchListeners.push(g),async()=>{e.watchListeners=e.watchListeners.filter(m=>m!==g),e.watchListeners.length===0&&await d()}},async unwatch(){e.watchListeners=[],await d()},mount(g,m){if(g=Bo(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((_,x)=>x.length-_.length)),e.mounts[g]=m,e.watching&&Promise.resolve(Uf(m,o,g)).then(_=>{e.unwatch[g]=_}).catch(console.error),y},async unmount(g,m=!0){g=Bo(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),m&&await Lf(e.mounts[g]),e.mountpoints=e.mountpoints.filter(_=>_!==g),delete e.mounts[g])},getMount(g=""){g=pr(g)+":";const m=t(g);return{driver:m.driver,base:m.base}},getMounts(g="",m={}){return g=pr(g),s(g,m.parents).map(x=>({driver:x.driver,base:x.mountpoint}))}};return y}function Uf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Lf(i){typeof i.dispose=="function"&&await kt(i.dispose)}function hn(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function pp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=hn(t);return(o,c)=>s.then(d=>c(d.transaction(e,o).objectStore(e)))}let Jc;function Cs(){return Jc||(Jc=pp("keyval-store","keyval")),Jc}function Mf(i,e=Cs()){return e("readonly",t=>hn(t.get(i)))}function rI(i,e,t=Cs()){return t("readwrite",s=>(s.put(e,i),hn(s.transaction)))}function iI(i,e=Cs()){return e("readwrite",t=>(t.delete(i),hn(t.transaction)))}function nI(i=Cs()){return i("readwrite",e=>(e.clear(),hn(e.transaction)))}function sI(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},hn(i.transaction)}function oI(i=Cs()){return i("readonly",e=>{if(e.getAllKeys)return hn(e.getAllKeys());const t=[];return sI(e,s=>t.push(s.key)).then(()=>t)})}const aI=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),cI=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ds(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return cI(i)}catch{return i}}function an(i){return typeof i=="string"?i:aI(i)||""}const uI="idb-keyval";var hI=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=pp(i.dbName,i.storeName)),{name:uI,options:i,async hasItem(o){return!(typeof await Mf(t(o),s)>"u")},async getItem(o){return await Mf(t(o),s)??null},setItem(o,c){return rI(t(o),c,s)},removeItem(o){return iI(t(o),s)},getKeys(){return oI(s)},clear(){return nI(s)}}};const lI="WALLET_CONNECT_V2_INDEXED_DB",fI="keyvaluestorage";let dI=class{constructor(){this.indexedDb=tI({driver:hI({dbName:lI,storeName:fI})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,an(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jo={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Qc<"u"&&Qc.localStorage?Jo.exports=Qc.localStorage:typeof window<"u"&&window.localStorage?Jo.exports=window.localStorage:Jo.exports=new e})();function pI(i){var e;return[i[0],Ds((e=i[1])!=null?e:"")]}class gI{constructor(){this.localStorage=Jo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(pI)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ds(t)}async setItem(e,t){this.localStorage.setItem(e,an(t))}async removeItem(e){this.localStorage.removeItem(e)}}const yI="wc_storage_version",jf=1,vI=async(i,e,t)=>{const s=yI,o=await e.getItem(s);if(o&&o>=jf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const d=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const g=await i.getItem(f);await e.setItem(f,g),d.push(f)}}await e.setItem(s,jf),t(e),mI(i,d)},mI=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let wI=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new gI;this.storage=e;try{const t=new dI;vI(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Vn={},ps={},Xc={},gs={};let ln=class{};const _I=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ln},Symbol.toStringTag,{value:"Module"})),bI=Du(_I);var qf;function EI(){if(qf)return gs;qf=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.IHeartBeat=void 0;const i=bI;class e extends i.IEvents{constructor(s){super()}}return gs.IHeartBeat=e,gs}var Hf;function gp(){return Hf||(Hf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ii.__exportStar(EI(),i)}(Xc)),Xc}var Zc={},sn={},zf;function II(){if(zf)return sn;zf=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.HEARTBEAT_EVENTS=sn.HEARTBEAT_INTERVAL=void 0;const i=ve;return sn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,sn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},sn}var Ff;function yp(){return Ff||(Ff=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ii.__exportStar(II(),i)}(Zc)),Zc}var Bf;function SI(){if(Bf)return ps;Bf=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.HeartBeat=void 0;const i=Ii,e=qr,t=ve,s=gp(),o=yp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ps.HeartBeat=c,ps}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ii;e.__exportStar(SI(),i),e.__exportStar(gp(),i),e.__exportStar(yp(),i)})(Vn);function xI(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}var PI=OI;function OI(i,e,t){var s=t&&t.stringify||xI,o=1;if(typeof i=="object"&&i!==null){var c=e.length+o;if(c===1)return i;var d=new Array(c);d[0]=s(i);for(var f=1;f<c;f++)d[f]=s(e[f]);return d.join(" ")}if(typeof i!="string")return i;var y=e.length;if(y===0)return i;for(var g="",m=1-o,_=-1,x=i&&i.length||0,P=0;P<x;){if(i.charCodeAt(P)===37&&P+1<x){switch(_=_>-1?_:0,i.charCodeAt(P+1)){case 100:case 102:if(m>=y||e[m]==null)break;_<P&&(g+=i.slice(_,P)),g+=Number(e[m]),_=P+2,P++;break;case 105:if(m>=y||e[m]==null)break;_<P&&(g+=i.slice(_,P)),g+=Math.floor(Number(e[m])),_=P+2,P++;break;case 79:case 111:case 106:if(m>=y||e[m]===void 0)break;_<P&&(g+=i.slice(_,P));var A=typeof e[m];if(A==="string"){g+="'"+e[m]+"'",_=P+2,P++;break}if(A==="function"){g+=e[m].name||"<anonymous>",_=P+2,P++;break}g+=s(e[m]),_=P+2,P++;break;case 115:if(m>=y)break;_<P&&(g+=i.slice(_,P)),g+=String(e[m]),_=P+2,P++;break;case 37:_<P&&(g+=i.slice(_,P)),g+="%",_=P+2,P++,m--;break}++m}++P}return _===-1?i:(_<x&&(g+=i.slice(_)),g)}const Kf=PI;var RI=ii;const Os=jI().console||{},TI={mapHttpRequest:Ko,mapHttpResponse:Ko,wrapRequestSerializer:eu,wrapResponseSerializer:eu,wrapErrorSerializer:eu,req:Ko,res:Ko,err:$I};function AI(i,e){return Array.isArray(i)?i.filter(function(s){return s!=="!stdSerializers.err"}):i===!0?Object.keys(e):!1}function ii(i){i=i||{},i.browser=i.browser||{};const e=i.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=i.browser.write||Os;i.browser.write&&(i.browser.asObject=!0);const s=i.serializers||{},o=AI(i.browser.serialize,s);let c=i.browser.serialize;Array.isArray(i.browser.serialize)&&i.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const d=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),i.enabled===!1&&(i.level="silent");const f=i.level||"info",y=Object.create(t);y.log||(y.log=Rs),Object.defineProperty(y,"levelVal",{get:m}),Object.defineProperty(y,"level",{get:_,set:x});const g={transmit:e,serialize:o,asObject:i.browser.asObject,levels:d,timestamp:UI(i)};y.levels=ii.levels,y.level=f,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=Rs,y.serializers=s,y._serialize=o,y._stdErrSerialize=c,y.child=P,e&&(y._logEvent=xu());function m(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function x(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,$n(g,y,"error","log"),$n(g,y,"fatal","error"),$n(g,y,"warn","error"),$n(g,y,"info","log"),$n(g,y,"debug","log"),$n(g,y,"trace","log")}function P(A,W){if(!A)throw new Error("missing bindings for child Pino");W=W||{},o&&A.serializers&&(W.serializers=A.serializers);const K=W.serializers;if(o&&K){var ie=Object.assign({},s,K),$=i.browser.serialize===!0?Object.keys(ie):o;delete A.serializers,ha([A],$,ie,this._stdErrSerialize)}function q(O){this._childLevel=(O._childLevel|0)+1,this.error=Un(O,A,"error"),this.fatal=Un(O,A,"fatal"),this.warn=Un(O,A,"warn"),this.info=Un(O,A,"info"),this.debug=Un(O,A,"debug"),this.trace=Un(O,A,"trace"),ie&&(this.serializers=ie,this._serialize=$),e&&(this._logEvent=xu([].concat(O._logEvent.bindings,A)))}return q.prototype=this,new q(this)}return y}ii.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ii.stdSerializers=TI;ii.stdTimeFunctions=Object.assign({},{nullTime:vp,epochTime:mp,unixTime:LI,isoTime:MI});function $n(i,e,t,s){const o=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Rs:o[t]?o[t]:Os[t]||Os[s]||Rs,NI(i,e,t)}function NI(i,e,t){!i.transmit&&e[t]===Rs||(e[t]=function(s){return function(){const c=i.timestamp(),d=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Os?Os:this;for(var y=0;y<d.length;y++)d[y]=arguments[y];if(i.serialize&&!i.asObject&&ha(d,this._serialize,this.serializers,this._stdErrSerialize),i.asObject?s.call(f,CI(this,t,d,c)):s.apply(f,d),i.transmit){const g=i.transmit.level||e.level,m=ii.levels.values[g],_=ii.levels.values[t];if(_<m)return;DI(this,{ts:c,methodLevel:t,methodValue:_,transmitLevel:g,transmitValue:ii.levels.values[i.transmit.level||e.level],send:i.transmit.send,val:e.levelVal},d)}}}(e[t]))}function CI(i,e,t,s){i._serialize&&ha(t,i._serialize,i.serializers,i._stdErrSerialize);const o=t.slice();let c=o[0];const d={};s&&(d.time=s),d.level=ii.levels.values[e];let f=(i._childLevel|0)+1;if(f<1&&(f=1),c!==null&&typeof c=="object"){for(;f--&&typeof o[0]=="object";)Object.assign(d,o.shift());c=o.length?Kf(o.shift(),o):void 0}else typeof c=="string"&&(c=Kf(o.shift(),o));return c!==void 0&&(d.msg=c),d}function ha(i,e,t,s){for(const o in i)if(s&&i[o]instanceof Error)i[o]=ii.stdSerializers.err(i[o]);else if(typeof i[o]=="object"&&!Array.isArray(i[o]))for(const c in i[o])e&&e.indexOf(c)>-1&&c in t&&(i[o][c]=t[c](i[o][c]))}function Un(i,e,t){return function(){const s=new Array(1+arguments.length);s[0]=e;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return i[t].apply(this,s)}}function DI(i,e,t){const s=e.send,o=e.ts,c=e.methodLevel,d=e.methodValue,f=e.val,y=i._logEvent.bindings;ha(t,i._serialize||Object.keys(i.serializers),i.serializers,i._stdErrSerialize===void 0?!0:i._stdErrSerialize),i._logEvent.ts=o,i._logEvent.messages=t.filter(function(g){return y.indexOf(g)===-1}),i._logEvent.level.label=c,i._logEvent.level.value=d,s(c,i._logEvent,f),i._logEvent=xu(y)}function xu(i){return{ts:0,messages:[],bindings:i||[],level:{label:"",value:0}}}function $I(i){const e={type:i.constructor.name,msg:i.message,stack:i.stack};for(const t in i)e[t]===void 0&&(e[t]=i[t]);return e}function UI(i){return typeof i.timestamp=="function"?i.timestamp:i.timestamp===!1?vp:mp}function Ko(){return{}}function eu(i){return i}function Rs(){}function vp(){return!1}function mp(){return Date.now()}function LI(){return Math.round(Date.now()/1e3)}function MI(){return new Date(Date.now()).toISOString()}function jI(){function i(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return i(self)||i(window)||i(this)||{}}}const la=na(RI),qI={level:"info"},$s="custom_context";var HI=Object.defineProperty,zI=Object.defineProperties,FI=Object.getOwnPropertyDescriptors,kf=Object.getOwnPropertySymbols,BI=Object.prototype.hasOwnProperty,KI=Object.prototype.propertyIsEnumerable,Vf=(i,e,t)=>e in i?HI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,kI=(i,e)=>{for(var t in e||(e={}))BI.call(e,t)&&Vf(i,t,e[t]);if(kf)for(var t of kf(e))KI.call(e,t)&&Vf(i,t,e[t]);return i},VI=(i,e)=>zI(i,FI(e));function fa(i){return VI(kI({},i),{level:(i==null?void 0:i.level)||qI.level})}function WI(i,e=$s){return i[e]||""}function GI(i,e,t=$s){return i[t]=e,i}function mr(i,e=$s){let t="";return typeof i.bindings>"u"?t=WI(i,e):t=i.bindings().context||"",t}function YI(i,e,t=$s){const s=mr(i,t);return s.trim()?`${s}/${e}`:e}function wr(i,e,t=$s){const s=YI(i,e,t),o=i.child({context:s});return GI(o,s,t)}class JI extends ln{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let QI=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},XI=class{constructor(e,t){this.logger=e,this.core=t}},ZI=class extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}},eS=class extends ln{constructor(e){super()}},tS=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class rS extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}}let iS=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t}},nS=class{constructor(e,t){this.projectId=e,this.logger=t}},sS=class{constructor(e,t){this.projectId=e,this.logger=t}},oS=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},aS=class{constructor(e){this.client=e}};var Wu={},wp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Rr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,_=g/536870912|0,x=g<<3,P=g%128<112?128:256;this._buffer[m]=128;for(var A=m+1;A<P-8;A++)this._buffer[A]=0;e.writeUint32BE(_,this._buffer,P-8),e.writeUint32BE(x,this._buffer,P-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,P),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)e.writeUint32BE(this._stateHi[A],y,A*8),e.writeUint32BE(this._stateLo[A],y,A*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,g,m,_,x,P){for(var A=g[0],W=g[1],K=g[2],ie=g[3],$=g[4],q=g[5],O=g[6],N=g[7],C=m[0],h=m[1],I=m[2],re=m[3],ne=m[4],ue=m[5],ge=m[6],ye=m[7],E,T,X,J,B,k,Z,te;P>=128;){for(var Ie=0;Ie<16;Ie++){var oe=8*Ie+x;f[Ie]=e.readUint32BE(_,oe),y[Ie]=e.readUint32BE(_,oe+4)}for(var Ie=0;Ie<80;Ie++){var Se=A,le=W,Ae=K,z=ie,H=$,U=q,l=O,R=N,se=C,he=h,Ee=I,Fe=re,ke=ne,Me=ue,dt=ge,pt=ye;if(E=N,T=ye,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=($>>>14|ne<<18)^($>>>18|ne<<14)^(ne>>>9|$<<23),T=(ne>>>14|$<<18)^(ne>>>18|$<<14)^($>>>9|ne<<23),B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,E=$&q^~$&O,T=ne&ue^~ne&ge,B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,E=o[Ie*2],T=o[Ie*2+1],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,E=f[Ie%16],T=y[Ie%16],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,X=Z&65535|te<<16,J=B&65535|k<<16,E=X,T=J,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=(A>>>28|C<<4)^(C>>>2|A<<30)^(C>>>7|A<<25),T=(C>>>28|A<<4)^(A>>>2|C<<30)^(A>>>7|C<<25),B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,E=A&W^A&K^W&K,T=C&h^C&I^h&I,B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,R=Z&65535|te<<16,pt=B&65535|k<<16,E=z,T=Fe,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=X,T=J,B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,z=Z&65535|te<<16,Fe=B&65535|k<<16,W=Se,K=le,ie=Ae,$=z,q=H,O=U,N=l,A=R,h=se,I=he,re=Ee,ne=Fe,ue=ke,ge=Me,ye=dt,C=pt,Ie%16===15)for(var oe=0;oe<16;oe++)E=f[oe],T=y[oe],B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=f[(oe+9)%16],T=y[(oe+9)%16],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,X=f[(oe+1)%16],J=y[(oe+1)%16],E=(X>>>1|J<<31)^(X>>>8|J<<24)^X>>>7,T=(J>>>1|X<<31)^(J>>>8|X<<24)^(J>>>7|X<<25),B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,X=f[(oe+14)%16],J=y[(oe+14)%16],E=(X>>>19|J<<13)^(J>>>29|X<<3)^X>>>6,T=(J>>>19|X<<13)^(X>>>29|J<<3)^(J>>>6|X<<26),B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,f[oe]=Z&65535|te<<16,y[oe]=B&65535|k<<16}E=A,T=C,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[0],T=m[0],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[0]=A=Z&65535|te<<16,m[0]=C=B&65535|k<<16,E=W,T=h,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[1],T=m[1],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[1]=W=Z&65535|te<<16,m[1]=h=B&65535|k<<16,E=K,T=I,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[2],T=m[2],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[2]=K=Z&65535|te<<16,m[2]=I=B&65535|k<<16,E=ie,T=re,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[3],T=m[3],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[3]=ie=Z&65535|te<<16,m[3]=re=B&65535|k<<16,E=$,T=ne,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[4],T=m[4],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[4]=$=Z&65535|te<<16,m[4]=ne=B&65535|k<<16,E=q,T=ue,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[5],T=m[5],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[5]=q=Z&65535|te<<16,m[5]=ue=B&65535|k<<16,E=O,T=ge,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[6],T=m[6],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[6]=O=Z&65535|te<<16,m[6]=ge=B&65535|k<<16,E=N,T=ye,B=T&65535,k=T>>>16,Z=E&65535,te=E>>>16,E=g[7],T=m[7],B+=T&65535,k+=T>>>16,Z+=E&65535,te+=E>>>16,k+=B>>>16,Z+=k>>>16,te+=Z>>>16,g[7]=N=Z&65535|te<<16,m[7]=ye=B&65535|k<<16,x+=128,P-=128}return x}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(wp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=zn,t=wp,s=Rr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(z){const H=new Float64Array(16);if(z)for(let U=0;U<z.length;U++)H[U]=z[U];return H}const c=new Uint8Array(32);c[0]=9;const d=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function P(z,H){for(let U=0;U<16;U++)z[U]=H[U]|0}function A(z){let H=1;for(let U=0;U<16;U++){let l=z[U]+H+65535;H=Math.floor(l/65536),z[U]=l-H*65536}z[0]+=H-1+37*(H-1)}function W(z,H,U){const l=~(U-1);for(let R=0;R<16;R++){const se=l&(z[R]^H[R]);z[R]^=se,H[R]^=se}}function K(z,H){const U=o(),l=o();for(let R=0;R<16;R++)l[R]=H[R];A(l),A(l),A(l);for(let R=0;R<2;R++){U[0]=l[0]-65517;for(let he=1;he<15;he++)U[he]=l[he]-65535-(U[he-1]>>16&1),U[he-1]&=65535;U[15]=l[15]-32767-(U[14]>>16&1);const se=U[15]>>16&1;U[14]&=65535,W(l,U,1-se)}for(let R=0;R<16;R++)z[2*R]=l[R]&255,z[2*R+1]=l[R]>>8}function ie(z,H){let U=0;for(let l=0;l<32;l++)U|=z[l]^H[l];return(1&U-1>>>8)-1}function $(z,H){const U=new Uint8Array(32),l=new Uint8Array(32);return K(U,z),K(l,H),ie(U,l)}function q(z){const H=new Uint8Array(32);return K(H,z),H[0]&1}function O(z,H){for(let U=0;U<16;U++)z[U]=H[2*U]+(H[2*U+1]<<8);z[15]&=32767}function N(z,H,U){for(let l=0;l<16;l++)z[l]=H[l]+U[l]}function C(z,H,U){for(let l=0;l<16;l++)z[l]=H[l]-U[l]}function h(z,H,U){let l,R,se=0,he=0,Ee=0,Fe=0,ke=0,Me=0,dt=0,pt=0,qe=0,xe=0,De=0,$e=0,He=0,Oe=0,Ue=0,be=0,Re=0,Be=0,Pe=0,Ve=0,Ge=0,Ze=0,et=0,Je=0,Zt=0,cr=0,Yr=0,er=0,si=0,Pi=0,Fi=0,Et=U[0],gt=U[1],It=U[2],St=U[3],_t=U[4],yt=U[5],$t=U[6],Ut=U[7],xt=U[8],Lt=U[9],Pt=U[10],Tt=U[11],Ot=U[12],ut=U[13],Mt=U[14],jt=U[15];l=H[0],se+=l*Et,he+=l*gt,Ee+=l*It,Fe+=l*St,ke+=l*_t,Me+=l*yt,dt+=l*$t,pt+=l*Ut,qe+=l*xt,xe+=l*Lt,De+=l*Pt,$e+=l*Tt,He+=l*Ot,Oe+=l*ut,Ue+=l*Mt,be+=l*jt,l=H[1],he+=l*Et,Ee+=l*gt,Fe+=l*It,ke+=l*St,Me+=l*_t,dt+=l*yt,pt+=l*$t,qe+=l*Ut,xe+=l*xt,De+=l*Lt,$e+=l*Pt,He+=l*Tt,Oe+=l*Ot,Ue+=l*ut,be+=l*Mt,Re+=l*jt,l=H[2],Ee+=l*Et,Fe+=l*gt,ke+=l*It,Me+=l*St,dt+=l*_t,pt+=l*yt,qe+=l*$t,xe+=l*Ut,De+=l*xt,$e+=l*Lt,He+=l*Pt,Oe+=l*Tt,Ue+=l*Ot,be+=l*ut,Re+=l*Mt,Be+=l*jt,l=H[3],Fe+=l*Et,ke+=l*gt,Me+=l*It,dt+=l*St,pt+=l*_t,qe+=l*yt,xe+=l*$t,De+=l*Ut,$e+=l*xt,He+=l*Lt,Oe+=l*Pt,Ue+=l*Tt,be+=l*Ot,Re+=l*ut,Be+=l*Mt,Pe+=l*jt,l=H[4],ke+=l*Et,Me+=l*gt,dt+=l*It,pt+=l*St,qe+=l*_t,xe+=l*yt,De+=l*$t,$e+=l*Ut,He+=l*xt,Oe+=l*Lt,Ue+=l*Pt,be+=l*Tt,Re+=l*Ot,Be+=l*ut,Pe+=l*Mt,Ve+=l*jt,l=H[5],Me+=l*Et,dt+=l*gt,pt+=l*It,qe+=l*St,xe+=l*_t,De+=l*yt,$e+=l*$t,He+=l*Ut,Oe+=l*xt,Ue+=l*Lt,be+=l*Pt,Re+=l*Tt,Be+=l*Ot,Pe+=l*ut,Ve+=l*Mt,Ge+=l*jt,l=H[6],dt+=l*Et,pt+=l*gt,qe+=l*It,xe+=l*St,De+=l*_t,$e+=l*yt,He+=l*$t,Oe+=l*Ut,Ue+=l*xt,be+=l*Lt,Re+=l*Pt,Be+=l*Tt,Pe+=l*Ot,Ve+=l*ut,Ge+=l*Mt,Ze+=l*jt,l=H[7],pt+=l*Et,qe+=l*gt,xe+=l*It,De+=l*St,$e+=l*_t,He+=l*yt,Oe+=l*$t,Ue+=l*Ut,be+=l*xt,Re+=l*Lt,Be+=l*Pt,Pe+=l*Tt,Ve+=l*Ot,Ge+=l*ut,Ze+=l*Mt,et+=l*jt,l=H[8],qe+=l*Et,xe+=l*gt,De+=l*It,$e+=l*St,He+=l*_t,Oe+=l*yt,Ue+=l*$t,be+=l*Ut,Re+=l*xt,Be+=l*Lt,Pe+=l*Pt,Ve+=l*Tt,Ge+=l*Ot,Ze+=l*ut,et+=l*Mt,Je+=l*jt,l=H[9],xe+=l*Et,De+=l*gt,$e+=l*It,He+=l*St,Oe+=l*_t,Ue+=l*yt,be+=l*$t,Re+=l*Ut,Be+=l*xt,Pe+=l*Lt,Ve+=l*Pt,Ge+=l*Tt,Ze+=l*Ot,et+=l*ut,Je+=l*Mt,Zt+=l*jt,l=H[10],De+=l*Et,$e+=l*gt,He+=l*It,Oe+=l*St,Ue+=l*_t,be+=l*yt,Re+=l*$t,Be+=l*Ut,Pe+=l*xt,Ve+=l*Lt,Ge+=l*Pt,Ze+=l*Tt,et+=l*Ot,Je+=l*ut,Zt+=l*Mt,cr+=l*jt,l=H[11],$e+=l*Et,He+=l*gt,Oe+=l*It,Ue+=l*St,be+=l*_t,Re+=l*yt,Be+=l*$t,Pe+=l*Ut,Ve+=l*xt,Ge+=l*Lt,Ze+=l*Pt,et+=l*Tt,Je+=l*Ot,Zt+=l*ut,cr+=l*Mt,Yr+=l*jt,l=H[12],He+=l*Et,Oe+=l*gt,Ue+=l*It,be+=l*St,Re+=l*_t,Be+=l*yt,Pe+=l*$t,Ve+=l*Ut,Ge+=l*xt,Ze+=l*Lt,et+=l*Pt,Je+=l*Tt,Zt+=l*Ot,cr+=l*ut,Yr+=l*Mt,er+=l*jt,l=H[13],Oe+=l*Et,Ue+=l*gt,be+=l*It,Re+=l*St,Be+=l*_t,Pe+=l*yt,Ve+=l*$t,Ge+=l*Ut,Ze+=l*xt,et+=l*Lt,Je+=l*Pt,Zt+=l*Tt,cr+=l*Ot,Yr+=l*ut,er+=l*Mt,si+=l*jt,l=H[14],Ue+=l*Et,be+=l*gt,Re+=l*It,Be+=l*St,Pe+=l*_t,Ve+=l*yt,Ge+=l*$t,Ze+=l*Ut,et+=l*xt,Je+=l*Lt,Zt+=l*Pt,cr+=l*Tt,Yr+=l*Ot,er+=l*ut,si+=l*Mt,Pi+=l*jt,l=H[15],be+=l*Et,Re+=l*gt,Be+=l*It,Pe+=l*St,Ve+=l*_t,Ge+=l*yt,Ze+=l*$t,et+=l*Ut,Je+=l*xt,Zt+=l*Lt,cr+=l*Pt,Yr+=l*Tt,er+=l*Ot,si+=l*ut,Pi+=l*Mt,Fi+=l*jt,se+=38*Re,he+=38*Be,Ee+=38*Pe,Fe+=38*Ve,ke+=38*Ge,Me+=38*Ze,dt+=38*et,pt+=38*Je,qe+=38*Zt,xe+=38*cr,De+=38*Yr,$e+=38*er,He+=38*si,Oe+=38*Pi,Ue+=38*Fi,R=1,l=se+R+65535,R=Math.floor(l/65536),se=l-R*65536,l=he+R+65535,R=Math.floor(l/65536),he=l-R*65536,l=Ee+R+65535,R=Math.floor(l/65536),Ee=l-R*65536,l=Fe+R+65535,R=Math.floor(l/65536),Fe=l-R*65536,l=ke+R+65535,R=Math.floor(l/65536),ke=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=dt+R+65535,R=Math.floor(l/65536),dt=l-R*65536,l=pt+R+65535,R=Math.floor(l/65536),pt=l-R*65536,l=qe+R+65535,R=Math.floor(l/65536),qe=l-R*65536,l=xe+R+65535,R=Math.floor(l/65536),xe=l-R*65536,l=De+R+65535,R=Math.floor(l/65536),De=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=He+R+65535,R=Math.floor(l/65536),He=l-R*65536,l=Oe+R+65535,R=Math.floor(l/65536),Oe=l-R*65536,l=Ue+R+65535,R=Math.floor(l/65536),Ue=l-R*65536,l=be+R+65535,R=Math.floor(l/65536),be=l-R*65536,se+=R-1+37*(R-1),R=1,l=se+R+65535,R=Math.floor(l/65536),se=l-R*65536,l=he+R+65535,R=Math.floor(l/65536),he=l-R*65536,l=Ee+R+65535,R=Math.floor(l/65536),Ee=l-R*65536,l=Fe+R+65535,R=Math.floor(l/65536),Fe=l-R*65536,l=ke+R+65535,R=Math.floor(l/65536),ke=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=dt+R+65535,R=Math.floor(l/65536),dt=l-R*65536,l=pt+R+65535,R=Math.floor(l/65536),pt=l-R*65536,l=qe+R+65535,R=Math.floor(l/65536),qe=l-R*65536,l=xe+R+65535,R=Math.floor(l/65536),xe=l-R*65536,l=De+R+65535,R=Math.floor(l/65536),De=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=He+R+65535,R=Math.floor(l/65536),He=l-R*65536,l=Oe+R+65535,R=Math.floor(l/65536),Oe=l-R*65536,l=Ue+R+65535,R=Math.floor(l/65536),Ue=l-R*65536,l=be+R+65535,R=Math.floor(l/65536),be=l-R*65536,se+=R-1+37*(R-1),z[0]=se,z[1]=he,z[2]=Ee,z[3]=Fe,z[4]=ke,z[5]=Me,z[6]=dt,z[7]=pt,z[8]=qe,z[9]=xe,z[10]=De,z[11]=$e,z[12]=He,z[13]=Oe,z[14]=Ue,z[15]=be}function I(z,H){h(z,H,H)}function re(z,H){const U=o();let l;for(l=0;l<16;l++)U[l]=H[l];for(l=253;l>=0;l--)I(U,U),l!==2&&l!==4&&h(U,U,H);for(l=0;l<16;l++)z[l]=U[l]}function ne(z,H){const U=o();let l;for(l=0;l<16;l++)U[l]=H[l];for(l=250;l>=0;l--)I(U,U),l!==1&&h(U,U,H);for(l=0;l<16;l++)z[l]=U[l]}function ue(z,H){const U=o(),l=o(),R=o(),se=o(),he=o(),Ee=o(),Fe=o(),ke=o(),Me=o();C(U,z[1],z[0]),C(Me,H[1],H[0]),h(U,U,Me),N(l,z[0],z[1]),N(Me,H[0],H[1]),h(l,l,Me),h(R,z[3],H[3]),h(R,R,g),h(se,z[2],H[2]),N(se,se,se),C(he,l,U),C(Ee,se,R),N(Fe,se,R),N(ke,l,U),h(z[0],he,Ee),h(z[1],ke,Fe),h(z[2],Fe,Ee),h(z[3],he,ke)}function ge(z,H,U){for(let l=0;l<4;l++)W(z[l],H[l],U)}function ye(z,H){const U=o(),l=o(),R=o();re(R,H[2]),h(U,H[0],R),h(l,H[1],R),K(z,l),z[31]^=q(U)<<7}function E(z,H,U){P(z[0],d),P(z[1],f),P(z[2],f),P(z[3],d);for(let l=255;l>=0;--l){const R=U[l/8|0]>>(l&7)&1;ge(z,H,R),ue(H,z),ue(z,z),ge(z,H,R)}}function T(z,H){const U=[o(),o(),o(),o()];P(U[0],m),P(U[1],_),P(U[2],f),h(U[3],m,_),E(z,U,H)}function X(z){if(z.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const H=(0,t.hash)(z);H[0]&=248,H[31]&=127,H[31]|=64;const U=new Uint8Array(32),l=[o(),o(),o(),o()];T(l,H),ye(U,l);const R=new Uint8Array(64);return R.set(z),R.set(U,32),{publicKey:U,secretKey:R}}i.generateKeyPairFromSeed=X;function J(z){const H=(0,e.randomBytes)(32,z),U=X(H);return(0,s.wipe)(H),U}i.generateKeyPair=J;function B(z){if(z.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}i.extractPublicKeyFromSecretKey=B;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Z(z,H){let U,l,R,se;for(l=63;l>=32;--l){for(U=0,R=l-32,se=l-12;R<se;++R)H[R]+=U-16*H[l]*k[R-(l-32)],U=Math.floor((H[R]+128)/256),H[R]-=U*256;H[R]+=U,H[l]=0}for(U=0,R=0;R<32;R++)H[R]+=U-(H[31]>>4)*k[R],U=H[R]>>8,H[R]&=255;for(R=0;R<32;R++)H[R]-=U*k[R];for(l=0;l<32;l++)H[l+1]+=H[l]>>8,z[l]=H[l]&255}function te(z){const H=new Float64Array(64);for(let U=0;U<64;U++)H[U]=z[U];for(let U=0;U<64;U++)z[U]=0;Z(z,H)}function Ie(z,H){const U=new Float64Array(64),l=[o(),o(),o(),o()],R=(0,t.hash)(z.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const se=new Uint8Array(64);se.set(R.subarray(32),32);const he=new t.SHA512;he.update(se.subarray(32)),he.update(H);const Ee=he.digest();he.clean(),te(Ee),T(l,Ee),ye(se,l),he.reset(),he.update(se.subarray(0,32)),he.update(z.subarray(32)),he.update(H);const Fe=he.digest();te(Fe);for(let ke=0;ke<32;ke++)U[ke]=Ee[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)U[ke+Me]+=Fe[ke]*R[Me];return Z(se.subarray(32),U),se}i.sign=Ie;function oe(z,H){const U=o(),l=o(),R=o(),se=o(),he=o(),Ee=o(),Fe=o();return P(z[2],f),O(z[1],H),I(R,z[1]),h(se,R,y),C(R,R,z[2]),N(se,z[2],se),I(he,se),I(Ee,he),h(Fe,Ee,he),h(U,Fe,R),h(U,U,se),ne(U,U),h(U,U,R),h(U,U,se),h(U,U,se),h(z[0],U,se),I(l,z[0]),h(l,l,se),$(l,R)&&h(z[0],z[0],x),I(l,z[0]),h(l,l,se),$(l,R)?-1:(q(z[0])===H[31]>>7&&C(z[0],d,z[0]),h(z[3],z[0],z[1]),0)}function Se(z,H,U){const l=new Uint8Array(32),R=[o(),o(),o(),o()],se=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(se,z))return!1;const he=new t.SHA512;he.update(U.subarray(0,32)),he.update(z),he.update(H);const Ee=he.digest();return te(Ee),E(R,se,Ee),T(se,U.subarray(32)),ue(R,se),ye(l,R),!ie(U,l)}i.verify=Se;function le(z){let H=[o(),o(),o(),o()];if(oe(H,z))throw new Error("Ed25519: invalid public key");let U=o(),l=o(),R=H[1];N(U,f,R),C(l,f,R),re(l,l),h(U,U,l);let se=new Uint8Array(32);return K(se,U),se}i.convertPublicKeyToX25519=le;function Ae(z){const H=(0,t.hash)(z.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const U=new Uint8Array(H.subarray(0,32));return(0,s.wipe)(H),U}i.convertSecretKeyToX25519=Ae})(Wu);const cS="EdDSA",uS="JWT",_p=".",bp="base64url",hS="utf8",lS="utf8",fS=":",dS="did",pS="key",Wf="base58btc",gS="z",yS="K36",vS=32;function ta(i){return ar(vr(an(i),hS),bp)}function Ep(i){const e=vr(yS,Wf),t=gS+ar(gu([e,i]),Wf);return[dS,pS,t].join(fS)}function mS(i){return ar(i,bp)}function wS(i){return vr([ta(i.header),ta(i.payload)].join(_p),lS)}function _S(i){return[ta(i.header),ta(i.payload),mS(i.signature)].join(_p)}function Gf(i=zn.randomBytes(vS)){return Wu.generateKeyPairFromSeed(i)}async function bS(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:cS,typ:uS},d=Ep(s.publicKey),f=o+t,y={iss:d,sub:i,aud:e,iat:o,exp:f},g=wS({header:c,payload:y}),m=Wu.sign(s.secretKey,g);return _S({header:c,payload:y,signature:m})}const ES="PARSE_ERROR",IS="INVALID_REQUEST",SS="METHOD_NOT_FOUND",xS="INVALID_PARAMS",Ip="INTERNAL_ERROR",Gu="SERVER_ERROR",PS=[-32700,-32600,-32601,-32602,-32603],Es={[ES]:{code:-32700,message:"Parse error"},[IS]:{code:-32600,message:"Invalid Request"},[SS]:{code:-32601,message:"Method not found"},[xS]:{code:-32602,message:"Invalid params"},[Ip]:{code:-32603,message:"Internal error"},[Gu]:{code:-32e3,message:"Server error"}},Sp=Gu;function OS(i){return PS.includes(i)}function Yf(i){return Object.keys(Es).includes(i)?Es[i]:Es[Sp]}function RS(i){const e=Object.values(Es).find(t=>t.code===i);return e||Es[Sp]}function xp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var Pp={},vi={},Jf;function TS(){if(Jf)return vi;Jf=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function i(){return(Gr===null||Gr===void 0?void 0:Gr.crypto)||(Gr===null||Gr===void 0?void 0:Gr.msCrypto)||{}}vi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return vi.isBrowserCryptoAvailable=t,vi}var mi={},Qf;function AS(){if(Qf)return mi;Qf=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowser=mi.isNode=mi.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mi.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}mi.isNode=e;function t(){return!i()&&!e()}return mi.isBrowser=t,mi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ii;e.__exportStar(TS(),i),e.__exportStar(AS(),i)})(Pp);function Yu(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Op(i=6){return BigInt(Yu(i))}function Hn(i,e,t){return{id:t||Yu(),jsonrpc:"2.0",method:i,params:e}}function da(i,e){return{id:i,jsonrpc:"2.0",result:e}}function pa(i,e,t){return{id:i,jsonrpc:"2.0",error:NS(e)}}function NS(i,e){return typeof i>"u"?Yf(Ip):(typeof i=="string"&&(i=Object.assign(Object.assign({},Yf(Gu)),{message:i})),OS(i.code)&&(i=RS(i.code)),i)}class CS{}class DS extends CS{constructor(){super()}}class $S extends DS{constructor(e){super()}}const US="^https?:",LS="^wss?:";function MS(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Rp(i,e){const t=MS(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function Xf(i){return Rp(i,US)}function Zf(i){return Rp(i,LS)}function jS(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Tp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Ju(i){return Tp(i)&&"method"in i}function ga(i){return Tp(i)&&(Ei(i)||Wr(i))}function Ei(i){return"result"in i}function Wr(i){return"error"in i}class Si extends $S{constructor(e){super(e),this.events=new qr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Hn(e.method,e.params||[],e.id||Op().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Wr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ga(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const qS=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),HS=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ed=i=>i.split("?")[0],td=10,zS=qS();let FS=class{constructor(e){if(this.url=e,this.events=new qr.EventEmitter,this.registering=!1,!Zf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(an(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Zf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=Pp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!jS(e)},d=new zS(e,[],c);HS()?d.onerror=f=>{const y=f;s(this.emitError(y.error))}:d.on("error",f=>{s(this.emitError(f))}),d.onopen=()=>{this.onOpen(d),t(d)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ds(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=pa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return xp(e,ed(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>td&&this.events.setMaxListeners(td)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${ed(this.url)}`));return this.events.emit("register_error",t),t}};var ra={exports:{}};ra.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,d=9007199254740991,f="[object Arguments]",y="[object Array]",g="[object AsyncFunction]",m="[object Boolean]",_="[object Date]",x="[object Error]",P="[object Function]",A="[object GeneratorFunction]",W="[object Map]",K="[object Number]",ie="[object Null]",$="[object Object]",q="[object Promise]",O="[object Proxy]",N="[object RegExp]",C="[object Set]",h="[object String]",I="[object Symbol]",re="[object Undefined]",ne="[object WeakMap]",ue="[object ArrayBuffer]",ge="[object DataView]",ye="[object Float32Array]",E="[object Float64Array]",T="[object Int8Array]",X="[object Int16Array]",J="[object Int32Array]",B="[object Uint8Array]",k="[object Uint8ClampedArray]",Z="[object Uint16Array]",te="[object Uint32Array]",Ie=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,Se=/^(?:0|[1-9]\d*)$/,le={};le[ye]=le[E]=le[T]=le[X]=le[J]=le[B]=le[k]=le[Z]=le[te]=!0,le[f]=le[y]=le[ue]=le[m]=le[ge]=le[_]=le[x]=le[P]=le[W]=le[K]=le[$]=le[N]=le[C]=le[h]=le[ne]=!1;var Ae=typeof Gr=="object"&&Gr&&Gr.Object===Object&&Gr,z=typeof self=="object"&&self&&self.Object===Object&&self,H=Ae||z||Function("return this")(),U=e&&!e.nodeType&&e,l=U&&!0&&i&&!i.nodeType&&i,R=l&&l.exports===U,se=R&&Ae.process,he=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Ee=he&&he.isTypedArray;function Fe(b,L){for(var Q=-1,fe=b==null?0:b.length,ot=0,Ne=[];++Q<fe;){var lt=b[Q];L(lt,Q,b)&&(Ne[ot++]=lt)}return Ne}function ke(b,L){for(var Q=-1,fe=L.length,ot=b.length;++Q<fe;)b[ot+Q]=L[Q];return b}function Me(b,L){for(var Q=-1,fe=b==null?0:b.length;++Q<fe;)if(L(b[Q],Q,b))return!0;return!1}function dt(b,L){for(var Q=-1,fe=Array(b);++Q<b;)fe[Q]=L(Q);return fe}function pt(b){return function(L){return b(L)}}function qe(b,L){return b.has(L)}function xe(b,L){return b==null?void 0:b[L]}function De(b){var L=-1,Q=Array(b.size);return b.forEach(function(fe,ot){Q[++L]=[ot,fe]}),Q}function $e(b,L){return function(Q){return b(L(Q))}}function He(b){var L=-1,Q=Array(b.size);return b.forEach(function(fe){Q[++L]=fe}),Q}var Oe=Array.prototype,Ue=Function.prototype,be=Object.prototype,Re=H["__core-js_shared__"],Be=Ue.toString,Pe=be.hasOwnProperty,Ve=function(){var b=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),Ge=be.toString,Ze=RegExp("^"+Be.call(Pe).replace(Ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=R?H.Buffer:void 0,Je=H.Symbol,Zt=H.Uint8Array,cr=be.propertyIsEnumerable,Yr=Oe.splice,er=Je?Je.toStringTag:void 0,si=Object.getOwnPropertySymbols,Pi=et?et.isBuffer:void 0,Fi=$e(Object.keys,Object),Et=_r(H,"DataView"),gt=_r(H,"Map"),It=_r(H,"Promise"),St=_r(H,"Set"),_t=_r(H,"WeakMap"),yt=_r(Object,"create"),$t=ai(Et),Ut=ai(gt),xt=ai(It),Lt=ai(St),Pt=ai(_t),Tt=Je?Je.prototype:void 0,Ot=Tt?Tt.valueOf:void 0;function ut(b){var L=-1,Q=b==null?0:b.length;for(this.clear();++L<Q;){var fe=b[L];this.set(fe[0],fe[1])}}function Mt(){this.__data__=yt?yt(null):{},this.size=0}function jt(b){var L=this.has(b)&&delete this.__data__[b];return this.size-=L?1:0,L}function ma(b){var L=this.__data__;if(yt){var Q=L[b];return Q===s?void 0:Q}return Pe.call(L,b)?L[b]:void 0}function wa(b){var L=this.__data__;return yt?L[b]!==void 0:Pe.call(L,b)}function _a(b,L){var Q=this.__data__;return this.size+=this.has(b)?0:1,Q[b]=yt&&L===void 0?s:L,this}ut.prototype.clear=Mt,ut.prototype.delete=jt,ut.prototype.get=ma,ut.prototype.has=wa,ut.prototype.set=_a;function Tr(b){var L=-1,Q=b==null?0:b.length;for(this.clear();++L<Q;){var fe=b[L];this.set(fe[0],fe[1])}}function ba(){this.__data__=[],this.size=0}function Ea(b){var L=this.__data__,Q=Bi(L,b);if(Q<0)return!1;var fe=L.length-1;return Q==fe?L.pop():Yr.call(L,Q,1),--this.size,!0}function Ia(b){var L=this.__data__,Q=Bi(L,b);return Q<0?void 0:L[Q][1]}function Sa(b){return Bi(this.__data__,b)>-1}function xa(b,L){var Q=this.__data__,fe=Bi(Q,b);return fe<0?(++this.size,Q.push([b,L])):Q[fe][1]=L,this}Tr.prototype.clear=ba,Tr.prototype.delete=Ea,Tr.prototype.get=Ia,Tr.prototype.has=Sa,Tr.prototype.set=xa;function oi(b){var L=-1,Q=b==null?0:b.length;for(this.clear();++L<Q;){var fe=b[L];this.set(fe[0],fe[1])}}function dn(){this.size=0,this.__data__={hash:new ut,map:new(gt||Tr),string:new ut}}function Pa(b){var L=Oi(this,b).delete(b);return this.size-=L?1:0,L}function pn(b){return Oi(this,b).get(b)}function Oa(b){return Oi(this,b).has(b)}function Ra(b,L){var Q=Oi(this,b),fe=Q.size;return Q.set(b,L),this.size+=Q.size==fe?0:1,this}oi.prototype.clear=dn,oi.prototype.delete=Pa,oi.prototype.get=pn,oi.prototype.has=Oa,oi.prototype.set=Ra;function gn(b){var L=-1,Q=b==null?0:b.length;for(this.__data__=new oi;++L<Q;)this.add(b[L])}function Ls(b){return this.__data__.set(b,s),this}function Ms(b){return this.__data__.has(b)}gn.prototype.add=gn.prototype.push=Ls,gn.prototype.has=Ms;function Hr(b){var L=this.__data__=new Tr(b);this.size=L.size}function Ta(){this.__data__=new Tr,this.size=0}function Aa(b){var L=this.__data__,Q=L.delete(b);return this.size=L.size,Q}function Na(b){return this.__data__.get(b)}function Ca(b){return this.__data__.has(b)}function js(b,L){var Q=this.__data__;if(Q instanceof Tr){var fe=Q.__data__;if(!gt||fe.length<t-1)return fe.push([b,L]),this.size=++Q.size,this;Q=this.__data__=new oi(fe)}return Q.set(b,L),this.size=Q.size,this}Hr.prototype.clear=Ta,Hr.prototype.delete=Aa,Hr.prototype.get=Na,Hr.prototype.has=Ca,Hr.prototype.set=js;function qs(b,L){var Q=mn(b),fe=!Q&&Qs(b),ot=!Q&&!fe&&Yn(b),Ne=!Q&&!fe&&!ot&&eo(b),lt=Q||fe||ot||Ne,qt=lt?dt(b.length,String):[],Qe=qt.length;for(var at in b)Pe.call(b,at)&&!(lt&&(at=="length"||ot&&(at=="offset"||at=="parent")||Ne&&(at=="buffer"||at=="byteLength"||at=="byteOffset")||Vs(at,Qe)))&&qt.push(at);return qt}function Bi(b,L){for(var Q=b.length;Q--;)if(Js(b[Q][0],L))return Q;return-1}function Wn(b,L,Q){var fe=L(b);return mn(b)?fe:ke(fe,Q(b))}function Ki(b){return b==null?b===void 0?re:ie:er&&er in Object(b)?Ks(b):Ua(b)}function Gn(b){return Vi(b)&&Ki(b)==f}function ki(b,L,Q,fe,ot){return b===L?!0:b==null||L==null||!Vi(b)&&!Vi(L)?b!==b&&L!==L:Hs(b,L,Q,fe,ki,ot)}function Hs(b,L,Q,fe,ot,Ne){var lt=mn(b),qt=mn(L),Qe=lt?y:Jr(b),at=qt?y:Jr(L);Qe=Qe==f?$:Qe,at=at==f?$:at;var At=Qe==$,ur=at==$,Ht=Qe==at;if(Ht&&Yn(b)){if(!Yn(L))return!1;lt=!0,At=!1}if(Ht&&!At)return Ne||(Ne=new Hr),lt||eo(b)?yn(b,L,Q,fe,ot,Ne):$a(b,L,Qe,Q,fe,ot,Ne);if(!(Q&o)){var ft=At&&Pe.call(b,"__wrapped__"),tr=ur&&Pe.call(L,"__wrapped__");if(ft||tr){var zr=ft?b.value():b,Ar=tr?L.value():L;return Ne||(Ne=new Hr),ot(zr,Ar,Q,fe,Ne)}}return Ht?(Ne||(Ne=new Hr),Bs(b,L,Q,fe,ot,Ne)):!1}function Da(b){if(!Zs(b)||Gs(b))return!1;var L=wn(b)?Ze:oe;return L.test(ai(b))}function zs(b){return Vi(b)&&Xs(b.length)&&!!le[Ki(b)]}function Fs(b){if(!Ys(b))return Fi(b);var L=[];for(var Q in Object(b))Pe.call(b,Q)&&Q!="constructor"&&L.push(Q);return L}function yn(b,L,Q,fe,ot,Ne){var lt=Q&o,qt=b.length,Qe=L.length;if(qt!=Qe&&!(lt&&Qe>qt))return!1;var at=Ne.get(b);if(at&&Ne.get(L))return at==L;var At=-1,ur=!0,Ht=Q&c?new gn:void 0;for(Ne.set(b,L),Ne.set(L,b);++At<qt;){var ft=b[At],tr=L[At];if(fe)var zr=lt?fe(tr,ft,At,L,b,Ne):fe(ft,tr,At,b,L,Ne);if(zr!==void 0){if(zr)continue;ur=!1;break}if(Ht){if(!Me(L,function(Ar,Qr){if(!qe(Ht,Qr)&&(ft===Ar||ot(ft,Ar,Q,fe,Ne)))return Ht.push(Qr)})){ur=!1;break}}else if(!(ft===tr||ot(ft,tr,Q,fe,Ne))){ur=!1;break}}return Ne.delete(b),Ne.delete(L),ur}function $a(b,L,Q,fe,ot,Ne,lt){switch(Q){case ge:if(b.byteLength!=L.byteLength||b.byteOffset!=L.byteOffset)return!1;b=b.buffer,L=L.buffer;case ue:return!(b.byteLength!=L.byteLength||!Ne(new Zt(b),new Zt(L)));case m:case _:case K:return Js(+b,+L);case x:return b.name==L.name&&b.message==L.message;case N:case h:return b==L+"";case W:var qt=De;case C:var Qe=fe&o;if(qt||(qt=He),b.size!=L.size&&!Qe)return!1;var at=lt.get(b);if(at)return at==L;fe|=c,lt.set(b,L);var At=yn(qt(b),qt(L),fe,ot,Ne,lt);return lt.delete(b),At;case I:if(Ot)return Ot.call(b)==Ot.call(L)}return!1}function Bs(b,L,Q,fe,ot,Ne){var lt=Q&o,qt=vn(b),Qe=qt.length,at=vn(L),At=at.length;if(Qe!=At&&!lt)return!1;for(var ur=Qe;ur--;){var Ht=qt[ur];if(!(lt?Ht in L:Pe.call(L,Ht)))return!1}var ft=Ne.get(b);if(ft&&Ne.get(L))return ft==L;var tr=!0;Ne.set(b,L),Ne.set(L,b);for(var zr=lt;++ur<Qe;){Ht=qt[ur];var Ar=b[Ht],Qr=L[Ht];if(fe)var Jn=lt?fe(Qr,Ar,Ht,L,b,Ne):fe(Ar,Qr,Ht,b,L,Ne);if(!(Jn===void 0?Ar===Qr||ot(Ar,Qr,Q,fe,Ne):Jn)){tr=!1;break}zr||(zr=Ht=="constructor")}if(tr&&!zr){var Wi=b.constructor,Bt=L.constructor;Wi!=Bt&&"constructor"in b&&"constructor"in L&&!(typeof Wi=="function"&&Wi instanceof Wi&&typeof Bt=="function"&&Bt instanceof Bt)&&(tr=!1)}return Ne.delete(b),Ne.delete(L),tr}function vn(b){return Wn(b,ja,ks)}function Oi(b,L){var Q=b.__data__;return Ws(L)?Q[typeof L=="string"?"string":"hash"]:Q.map}function _r(b,L){var Q=xe(b,L);return Da(Q)?Q:void 0}function Ks(b){var L=Pe.call(b,er),Q=b[er];try{b[er]=void 0;var fe=!0}catch{}var ot=Ge.call(b);return fe&&(L?b[er]=Q:delete b[er]),ot}var ks=si?function(b){return b==null?[]:(b=Object(b),Fe(si(b),function(L){return cr.call(b,L)}))}:st,Jr=Ki;(Et&&Jr(new Et(new ArrayBuffer(1)))!=ge||gt&&Jr(new gt)!=W||It&&Jr(It.resolve())!=q||St&&Jr(new St)!=C||_t&&Jr(new _t)!=ne)&&(Jr=function(b){var L=Ki(b),Q=L==$?b.constructor:void 0,fe=Q?ai(Q):"";if(fe)switch(fe){case $t:return ge;case Ut:return W;case xt:return q;case Lt:return C;case Pt:return ne}return L});function Vs(b,L){return L=L??d,!!L&&(typeof b=="number"||Se.test(b))&&b>-1&&b%1==0&&b<L}function Ws(b){var L=typeof b;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?b!=="__proto__":b===null}function Gs(b){return!!Ve&&Ve in b}function Ys(b){var L=b&&b.constructor,Q=typeof L=="function"&&L.prototype||be;return b===Q}function Ua(b){return Ge.call(b)}function ai(b){if(b!=null){try{return Be.call(b)}catch{}try{return b+""}catch{}}return""}function Js(b,L){return b===L||b!==b&&L!==L}var Qs=Gn(function(){return arguments}())?Gn:function(b){return Vi(b)&&Pe.call(b,"callee")&&!cr.call(b,"callee")},mn=Array.isArray;function La(b){return b!=null&&Xs(b.length)&&!wn(b)}var Yn=Pi||nt;function Ma(b,L){return ki(b,L)}function wn(b){if(!Zs(b))return!1;var L=Ki(b);return L==P||L==A||L==g||L==O}function Xs(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=d}function Zs(b){var L=typeof b;return b!=null&&(L=="object"||L=="function")}function Vi(b){return b!=null&&typeof b=="object"}var eo=Ee?pt(Ee):zs;function ja(b){return La(b)?qs(b):Fs(b)}function st(){return[]}function nt(){return!1}i.exports=Ma})(ra,ra.exports);var BS=ra.exports;const KS=na(BS);function kS(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],d=[],f={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return d},get:function(m){return f[m.toLowerCase()]},has:function(m){return m.toLowerCase()in f}}}};for(var g in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(m,_,x){c.push(_=_.toLowerCase()),d.push([_,x]),f[_]=f[_]?f[_]+","+x:x}),t(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(g,e.headers[g]);o.send(e.body||null)})}const VS=Object.freeze(Object.defineProperty({__proto__:null,default:kS},Symbol.toStringTag,{value:"Module"})),rd=Du(VS);var WS=self.fetch||(self.fetch=rd.default||rd);const GS=na(WS);var YS={LINK_API_URL:""};function JS(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,y=i.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function _(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var W=0,K=0,ie=0,$=A.length;ie!==$&&A[ie]===0;)ie++,W++;for(var q=($-ie)*m+1>>>0,O=new Uint8Array(q);ie!==$;){for(var N=A[ie],C=0,h=q-1;(N!==0||C<K)&&h!==-1;h--,C++)N+=256*O[h]>>>0,O[h]=N%f>>>0,N=N/f>>>0;if(N!==0)throw new Error("Non-zero carry");K=C,ie++}for(var I=q-K;I!==q&&O[I]===0;)I++;for(var re=y.repeat(W);I<q;++I)re+=i.charAt(O[I]);return re}function x(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var W=0;if(A[W]!==" "){for(var K=0,ie=0;A[W]===y;)K++,W++;for(var $=(A.length-W)*g+1>>>0,q=new Uint8Array($);A[W];){var O=t[A.charCodeAt(W)];if(O===255)return;for(var N=0,C=$-1;(O!==0||N<ie)&&C!==-1;C--,N++)O+=f*q[C]>>>0,q[C]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");ie=N,W++}if(A[W]!==" "){for(var h=$-ie;h!==$&&q[h]===0;)h++;for(var I=new Uint8Array(K+($-h)),re=K;h!==$;)I[re++]=q[h++];return I}}}function P(A){var W=x(A);if(W)return W;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:x,decode:P}}var QS=JS,XS=QS;const Ap=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},ZS=i=>new TextEncoder().encode(i),e6=i=>new TextDecoder().decode(i);class t6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class r6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Np(this,e)}}class i6{constructor(e){this.decoders=e}or(e){return Np(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Np=(i,e)=>new i6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class n6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new t6(e,t,s),this.decoder=new r6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ya=({name:i,prefix:e,encode:t,decode:s})=>new n6(i,e,t,s),Us=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=XS(t,e);return ya({prefix:i,name:e,encode:s,decode:c=>Ap(o(c))})},s6=(i,e,t,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const _=o[i[m]];if(_===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|_,f+=t,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},o6=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Gt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ya({prefix:e,name:i,encode(o){return o6(o,s,t)},decode(o){return s6(o,s,t,i)}}),a6=ya({prefix:"\0",name:"identity",encode:i=>e6(i),decode:i=>ZS(i)});var c6=Object.freeze({__proto__:null,identity:a6});const u6=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var h6=Object.freeze({__proto__:null,base2:u6});const l6=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var f6=Object.freeze({__proto__:null,base8:l6});const d6=Us({prefix:"9",name:"base10",alphabet:"0123456789"});var p6=Object.freeze({__proto__:null,base10:d6});const g6=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),y6=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var v6=Object.freeze({__proto__:null,base16:g6,base16upper:y6});const m6=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),w6=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_6=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b6=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),E6=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),I6=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),S6=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),x6=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),P6=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var O6=Object.freeze({__proto__:null,base32:m6,base32upper:w6,base32pad:_6,base32padupper:b6,base32hex:E6,base32hexupper:I6,base32hexpad:S6,base32hexpadupper:x6,base32z:P6});const R6=Us({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T6=Us({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var A6=Object.freeze({__proto__:null,base36:R6,base36upper:T6});const N6=Us({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),C6=Us({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var D6=Object.freeze({__proto__:null,base58btc:N6,base58flickr:C6});const $6=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),U6=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),L6=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),M6=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var j6=Object.freeze({__proto__:null,base64:$6,base64pad:U6,base64url:L6,base64urlpad:M6});const Cp=Array.from(""),q6=Cp.reduce((i,e,t)=>(i[t]=e,i),[]),H6=Cp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function z6(i){return i.reduce((e,t)=>(e+=q6[t],e),"")}function F6(i){const e=[];for(const t of i){const s=H6[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const B6=ya({prefix:"",name:"base256emoji",encode:z6,decode:F6});var K6=Object.freeze({__proto__:null,base256emoji:B6}),k6=Dp,id=128,V6=127,W6=~V6,G6=Math.pow(2,31);function Dp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=G6;)e[t++]=i&255|id,i/=128;for(;i&W6;)e[t++]=i&255|id,i>>>=7;return e[t]=i|0,Dp.bytes=t-s+1,e}var Y6=Pu,J6=128,nd=127;function Pu(i,s){var t=0,s=s||0,o=0,c=s,d,f=i.length;do{if(c>=f)throw Pu.bytes=0,new RangeError("Could not decode varint");d=i[c++],t+=o<28?(d&nd)<<o:(d&nd)*Math.pow(2,o),o+=7}while(d>=J6);return Pu.bytes=c-s,t}var Q6=Math.pow(2,7),X6=Math.pow(2,14),Z6=Math.pow(2,21),e2=Math.pow(2,28),t2=Math.pow(2,35),r2=Math.pow(2,42),i2=Math.pow(2,49),n2=Math.pow(2,56),s2=Math.pow(2,63),o2=function(i){return i<Q6?1:i<X6?2:i<Z6?3:i<e2?4:i<t2?5:i<r2?6:i<i2?7:i<n2?8:i<s2?9:10},a2={encode:k6,decode:Y6,encodingLength:o2},$p=a2;const sd=(i,e,t=0)=>($p.encode(i,e,t),e),od=i=>$p.encodingLength(i),Ou=(i,e)=>{const t=e.byteLength,s=od(i),o=s+od(t),c=new Uint8Array(o+t);return sd(i,c,0),sd(t,c,s),c.set(e,o),new c2(i,t,e,c)};class c2{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Up=({name:i,code:e,encode:t})=>new u2(i,e,t);class u2{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ou(this.code,t):t.then(s=>Ou(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Lp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),h2=Up({name:"sha2-256",code:18,encode:Lp("SHA-256")}),l2=Up({name:"sha2-512",code:19,encode:Lp("SHA-512")});var f2=Object.freeze({__proto__:null,sha256:h2,sha512:l2});const Mp=0,d2="identity",jp=Ap,p2=i=>Ou(Mp,jp(i)),g2={code:Mp,name:d2,encode:jp,digest:p2};var y2=Object.freeze({__proto__:null,identity:g2});new TextEncoder,new TextDecoder;const ad={...c6,...h6,...f6,...p6,...v6,...O6,...A6,...D6,...j6,...K6};({...f2,...y2});function qp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function v2(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?qp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Hp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const cd=Hp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),tu=Hp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=v2(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),m2={utf8:cd,"utf-8":cd,hex:ad.base16,latin1:tu,ascii:tu,binary:tu,...ad};function w2(i,e="utf8"){const t=m2[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?qp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const zp="wc",_2=2,Qu="core",ji=`${zp}@2:${Qu}:`,b2={name:Qu,logger:"error"},E2={database:":memory:"},I2="crypto",ud="client_ed25519_seed",S2=ve.ONE_DAY,x2="keychain",P2="0.3",O2="messages",R2="0.3",T2=ve.SIX_HOURS,A2="publisher",Fp="irn",N2="error",Bp="wss://relay.walletconnect.com",hd="wss://relay.walletconnect.org",C2="relayer",Xt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},D2="_subscription",wi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$2=ve.ONE_SECOND,U2="2.11.2",L2=1e4,M2="0.3",j2="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},q2="subscription",H2="0.3",z2=ve.FIVE_SECONDS*1e3,F2="pairing",B2="0.3",ys={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},_s={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ri={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},K2="history",k2="0.3",V2="expirer",jr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},W2="0.3",ru="verify-api",jn="https://verify.walletconnect.com",Ru="https://verify.walletconnect.org",G2=[jn,Ru],Y2="echo",J2="https://echo.walletconnect.com";class Q2{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=x2,this.version=P2,this.initialized=!1,this.storagePrefix=ji,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ae("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=wr(t,this.name)}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ap(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?cp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class X2{constructor(e,t,s){this.core=e,this.logger=t,this.name=I2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Gf(o);return Ep(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Ob();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),d=Gf(c),f=Eu();return await bS(f,o,S2,d)},this.generateSharedKey=(o,c,d)=>{this.isInitialized();const f=this.getPrivateKey(o),y=Rb(f,c);return this.setSymKey(y,d)},this.setSymKey=async(o,c)=>{this.isInitialized();const d=c||Tb(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,d)=>{this.isInitialized();const f=op(d),y=an(c);if(If(f)){const x=f.senderPublicKey,P=f.receiverPublicKey;o=await this.generateSharedKey(x,P)}const g=this.getSymKey(o),{type:m,senderPublicKey:_}=f;return Nb({type:m,symKey:g,message:y,senderPublicKey:_})},this.decode=async(o,c,d)=>{this.isInitialized();const f=$b(c,d);if(If(f)){const y=f.receiverPublicKey,g=f.senderPublicKey;o=await this.generateSharedKey(y,g)}try{const y=this.getSymKey(o),g=Cb({symKey:y,encoded:c});return Ds(g)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Zo(o);return As(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Zo(o);return c.senderPublicKey?ar(c.senderPublicKey,or):void 0},this.core=e,this.logger=wr(t,this.name),this.keychain=s||new Q2(this.core,this.logger)}get context(){return mr(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ud)}catch{e=Eu(),await this.keychain.set(ud,e)}return w2(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Z2 extends XI{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=O2,this.version=R2,this.initialized=!1,this.storagePrefix=ji,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=qn(o);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=o,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),d=qn(o);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=wr(e,this.name),this.core=t}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ap(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?cp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class e5 extends ZI{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new qr.EventEmitter,this.name=A2,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||T2,y=Iu(c),g=(c==null?void 0:c.prompt)||!1,m=(c==null?void 0:c.tag)||0,_=(c==null?void 0:c.id)||Op().toString(),x={topic:s,message:o,opts:{ttl:f,relay:y,prompt:g,tag:m,id:_}},P=setTimeout(()=>this.queue.set(_,x),this.publishTimeout);try{await await xs(this.rpcPublish(s,o,f,y,g,m,_),this.publishTimeout,`Failed to publish payload, please try again. id:${_} tag:${m}`),this.removeRequestFromQueue(_),this.relayer.events.emit(Xt.publish,x)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=c==null?void 0:c.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(_),A;return}finally{clearTimeout(P)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=wr(t,this.name),this.registerEventListeners()}get context(){return mr(this.logger)}rpcPublish(e,t,s,o,c,d,f){var y,g,m,_;const x={method:Go(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:d},id:f};return yr((y=x.params)==null?void 0:y.prompt)&&((g=x.params)==null||delete g.prompt),yr((m=x.params)==null?void 0:m.tag)&&((_=x.params)==null||delete _.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Xt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Xt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class t5{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var r5=Object.defineProperty,i5=Object.defineProperties,n5=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,s5=Object.prototype.hasOwnProperty,o5=Object.prototype.propertyIsEnumerable,fd=(i,e,t)=>e in i?r5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vs=(i,e)=>{for(var t in e||(e={}))s5.call(e,t)&&fd(i,t,e[t]);if(ld)for(var t of ld(e))o5.call(e,t)&&fd(i,t,e[t]);return i},iu=(i,e)=>i5(i,n5(e));class a5 extends rS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new t5,this.events=new qr.EventEmitter,this.name=q2,this.version=H2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ji,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Iu(o),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,d)=>{const f=new ve.Watch;f.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),f.stop(o),c(!0)),f.elapsed(o)>=z2&&(clearInterval(y),f.stop(o),d(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=wr(t,this.name),this.clientId=""}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Iu(s);await this.rpcUnsubscribe(e,t,o);const c=mt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Go(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}return qn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Go(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Go(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,iu(vs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,vs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,vs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Vr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Vr.deleted,iu(vs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Vr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ni(t)&&this.onBatchSubscribe(t.map((s,o)=>iu(vs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Xt.connect,async()=>{await this.onConnect()}),this.relayer.on(Xt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async e=>{const t=Vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Vr.deleted,async e=>{const t=Vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var c5=Object.defineProperty,dd=Object.getOwnPropertySymbols,u5=Object.prototype.hasOwnProperty,h5=Object.prototype.propertyIsEnumerable,pd=(i,e,t)=>e in i?c5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,l5=(i,e)=>{for(var t in e||(e={}))u5.call(e,t)&&pd(i,t,e[t]);if(dd)for(var t of dd(e))h5.call(e,t)&&pd(i,t,e[t]);return i};class f5 extends eS{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new qr.EventEmitter,this.name=C2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Xt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Xt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(wi.payload,this.onPayloadHandler),this.provider.on(wi.connect,this.onConnectHandler),this.provider.on(wi.disconnect,this.onDisconnectHandler),this.provider.on(wi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?wr(e.logger,this.name):la(fa({level:e.logger||N2})),this.messages=new Z2(this.logger,e.core),this.subscriber=new a5(this,this.logger),this.publisher=new e5(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Bp,this.projectId=e.projectId,this.bundleId=Hb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${hd}...`),await this.restartTransport(hd)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},L2)}get context(){return mr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const d=f=>{f.topic===e&&(this.subscriber.off(Vr.created,d),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Vr.created,d)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await xs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Vr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await xs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(wi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await $f())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Si(new FS(Vb({sdkVersion:U2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ju(e)){if(!e.method.endsWith(D2))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,d={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(l5({type:"event",event:t.id},d)),this.events.emit(t.id,d),await this.acknowledgePayload(e),await this.onMessageEvent(d)}else ga(e)&&this.events.emit(Xt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Xt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=da(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(wi.payload,this.onPayloadHandler),this.provider.off(wi.connect,this.onConnectHandler),this.provider.off(wi.disconnect,this.onDisconnectHandler),this.provider.off(wi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Xt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await $f();HE(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Xt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds($2)))}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var d5=Object.defineProperty,gd=Object.getOwnPropertySymbols,p5=Object.prototype.hasOwnProperty,g5=Object.prototype.propertyIsEnumerable,yd=(i,e,t)=>e in i?d5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vd=(i,e)=>{for(var t in e||(e={}))p5.call(e,t)&&yd(i,t,e[t]);if(gd)for(var t of gd(e))g5.call(e,t)&&yd(i,t,e[t]);return i};class va extends tS{constructor(e,t,s,o=ji,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=M2,this.cached=[],this.initialized=!1,this.storagePrefix=ji,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!yr(d)?this.map.set(this.getKey(d),d):vE(d)?this.map.set(d.id,d):mE(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(y=>KS(f[y],d[y]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const y=vd(vd({},this.getData(d)),f);this.map.set(d,y),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=wr(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class y5{constructor(e,t){this.core=e,this.logger=t,this.name=F2,this.version=B2,this.events=new $u,this.initialized=!1,this.storagePrefix=ji,this.ignoredPayloadTypes=[un],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Eu(),o=await this.core.crypto.setSymKey(s),c=Pr(ve.FIVE_MINUTES),d={protocol:Fp},f={topic:o,expiry:c,relay:d,active:!1},y=cE({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:d,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:d,expiryTimestamp:f}=Tf(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=f||Pr(ve.FIVE_MINUTES),m={topic:o,relay:d,expiry:g,active:!1};return await this.pairings.set(o,m),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),this.events.emit(_s.create,m),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:d})),m},this.activate=async({topic:s})=>{this.isInitialized();const o=Pr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:f,reject:y}=Mn();this.events.once(Dt("pairing_ping",c),({error:g})=>{g?y(g):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",mt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const d=Hn(o,c),f=await this.core.crypto.encode(s,d),y=ys[o].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,y),d.id},this.sendResult=async(s,o,c)=>{const d=da(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=ys[y.request.method].res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.sendError=async(s,o,c)=>{const d=pa(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=ys[y.request.method]?ys[y.request.method].res:ys.unregistered_method.res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,mt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Mi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,d=(await this.core.history.get(o,c.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(_s.ping,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Ei(o)?this.events.emit(Dt("pairing_ping",c),{}):Wr(o)&&this.events.emit(Dt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(_s.delete,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:d}=o;try{if(this.registeredMethods.includes(d))return;const f=mt("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(mt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!gr(s)){const{message:d}=ae("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(d)}if(!yE(s.uri)){const{message:d}=ae("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(d)}const c=Tf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:d}=ae("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(c!=null&&c.symKey)){const{message:d}=ae("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:d}=ae("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(d)}},this.isValidPing=async s=>{if(!gr(s)){const{message:c}=ae("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:c}=ae("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Mi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ae("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=wr(t,this.name),this.pairings=new va(this.core,this.logger,this.name,this.storagePrefix)}get context(){return mr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Xt.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{Ju(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ga(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(jr.expired,async e=>{const{topic:t}=hp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(_s.expire,{topic:t}))})}}class v5 extends QI{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new qr.EventEmitter,this.name=K2,this.version=k2,this.cached=[],this.initialized=!1,this.storagePrefix=ji,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const d={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Pr(ve.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(ri.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ri.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ri.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=wr(t,this.name)}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Hn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ri.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ri.created,e=>{const t=ri.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ri.updated,e=>{const t=ri.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ri.deleted,e=>{const t=ri.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class m5 extends iS{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new qr.EventEmitter,this.name=V2,this.version=W2,this.cached=[],this.initialized=!1,this.storagePrefix=ji,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:o};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(jr.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(jr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=wr(t,this.name)}get context(){return mr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Wb(e);if(typeof e=="number")return Gb(e);const{message:t}=ae("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(jr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(jr.created,e=>{const t=jr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(jr.expired,e=>{const t=jr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(jr.deleted,e=>{const t=jr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class w5 extends nS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=ru,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Bn()||!Kn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ru;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(d),c=await this.fetchAttestation(s.attestationId,Ru)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),d=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),d.status===200?await d.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(ru))return c();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=ru,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=c}),new Promise((c,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||jn;return G2.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${jn}`),o=jn),o},this.logger=wr(t,this.name),this.verifyUrl=jn,this.abortController=new AbortController,this.isDevEnv=Ku()&&YS.IS_VITEST}get context(){return mr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class _5 extends sS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=Y2,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:d,enableEncrypted:f=!1}=s,y=`${J2}/${this.projectId}/clients`;await GS(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:c,always_raw:f})})},this.logger=wr(t,this.context)}}var b5=Object.defineProperty,md=Object.getOwnPropertySymbols,E5=Object.prototype.hasOwnProperty,I5=Object.prototype.propertyIsEnumerable,wd=(i,e,t)=>e in i?b5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,_d=(i,e)=>{for(var t in e||(e={}))E5.call(e,t)&&wd(i,t,e[t]);if(md)for(var t of md(e))I5.call(e,t)&&wd(i,t,e[t]);return i};class Xu extends JI{constructor(e){super(e),this.protocol=zp,this.version=_2,this.name=Qu,this.events=new qr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Bp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:la(fa({level:(e==null?void 0:e.logger)||b2.logger}));this.logger=wr(t,this.name),this.heartbeat=new Vn.HeartBeat,this.crypto=new X2(this,this.logger,e==null?void 0:e.keychain),this.history=new v5(this,this.logger),this.expirer=new m5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new wI(_d(_d({},E2),e==null?void 0:e.storageOptions)),this.relayer=new f5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new y5(this,this.logger),this.verify=new w5(this.projectId||"",this.logger),this.echoClient=new _5(this.projectId||"",this.logger)}static async init(e){const t=new Xu(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(j2,s),t}get context(){return mr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const S5=Xu,Kp="wc",kp=2,Vp="client",Zu=`${Kp}@${kp}:${Vp}:`,nu={name:Vp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},bd="WALLETCONNECT_DEEPLINK_CHOICE",x5="proposal",Wp="Proposal expired",P5="session",ko=ve.SEVEN_DAYS,O5="engine",_i={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},su={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},R5="request",T5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var A5=Object.defineProperty,N5=Object.defineProperties,C5=Object.getOwnPropertyDescriptors,Ed=Object.getOwnPropertySymbols,D5=Object.prototype.hasOwnProperty,$5=Object.prototype.propertyIsEnumerable,Id=(i,e,t)=>e in i?A5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,sr=(i,e)=>{for(var t in e||(e={}))D5.call(e,t)&&Id(i,t,e[t]);if(Ed)for(var t of Ed(e))$5.call(e,t)&&Id(i,t,e[t]);return i},Ln=(i,e)=>N5(i,C5(e));class U5 extends aS{constructor(e){super(e),this.name=O5,this.events=new $u,this.initialized=!1,this.ignoredPayloadTypes=[un],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(_i)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=Ln(sr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:y}=s;let g=o,m,_=!1;if(g&&(_=this.client.core.pairing.pairings.get(g).active),!g||!_){const{topic:O,uri:N}=await this.client.core.pairing.create();g=O,m=N}const x=await this.client.core.crypto.generateKeyPair(),P=_i.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,A=Pr(P),W=sr({requiredNamespaces:c,optionalNamespaces:d,relays:y??[{protocol:Fp}],proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:A},f&&{sessionProperties:f}),{reject:K,resolve:ie,done:$}=Mn(P,Wp);if(this.events.once(Dt("session_connect"),async({error:O,session:N})=>{if(O)K(O);else if(N){N.self.publicKey=x;const C=Ln(sr({},N),{requiredNamespaces:W.requiredNamespaces,optionalNamespaces:W.optionalNamespaces});await this.client.session.set(N.topic,C),await this.setExpiry(N.topic,N.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:N.peer.metadata}),ie(C)}}),!g){const{message:O}=ae("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(O)}const q=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:W,throwOnFailedPublish:!0});return await this.setProposal(q,sr({id:q},W)),{uri:m,approval:$}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:d}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:g,requiredNamespaces:m,optionalNamespaces:_}=f;y=y||"";const x=await this.client.core.crypto.generateKeyPair(),P=g.publicKey,A=await this.client.core.crypto.generateSharedKey(x,P);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const W=sr({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:x,metadata:this.client.metadata},expiry:Pr(ko)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(A);const K=Ln(sr({},W),{topic:A,requiredNamespaces:m,optionalNamespaces:_,pairingTopic:y,acknowledged:!1,self:W.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:x});await this.client.session.set(A,K);try{await this.sendRequest({topic:A,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0})}catch(ie){throw this.client.logger.error(ie),this.client.session.delete(A,mt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(A),ie}return await this.setExpiry(A,Pr(ko)),{topic:A,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(A)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:f,reject:y}=Mn();return this.events.once(Dt("session_update",c),({error:g})=>{g?y(g):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:d}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:d,reject:f}=Mn();return this.events.once(Dt("session_extend",o),({error:y})=>{y?f(y):d()}),await this.setExpiry(s,Pr(ko)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:d=_i.wc_sessionRequest.req.ttl}=t,f=Yu(),{done:y,resolve:g,reject:m}=Mn(d,"Request expired. Please try again.");return this.events.once(Dt("session_request",f),({error:_,result:x})=>{_?m(_):g(x)}),await Promise.all([new Promise(async _=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:Ln(sr({},o),{expiryTimestamp:Pr(d)}),chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(x=>m(x)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),_()}),new Promise(async _=>{const x=await Jb(this.client.core.storage,bd);Yb({id:f,topic:c,wcDeepLink:x}),_()}),y()]).then(_=>_[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Ei(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Wr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:d,reject:f}=Mn();this.events.once(Dt("session_ping",o),({error:y})=>{y?f(y):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:mt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ae("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>pE(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:d=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,mt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(bd).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,mt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:d,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,mt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=bi.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Pr(_i.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:d}=t,f=c.request.expiryTimestamp||Pr(_i.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:d}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:d,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:g}=t,m=Hn(o,c,y);if(Kn()&&T5.includes(o)){const P=qn(JSON.stringify(m));this.client.core.verify.register({attestationId:P})}const _=await this.client.core.crypto.encode(s,m),x=_i[o].req;return d&&(x.ttl=d),f&&(x.id=f),this.client.core.history.set(s,m),g?(x.internal=Ln(sr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,_,x)):this.client.core.relayer.publish(s,_,x).catch(P=>this.client.logger.error(P)),m.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:d}=t,f=da(s,c),y=await this.client.core.crypto.encode(o,f),g=await this.client.core.history.get(o,s),m=_i[g.request.method].res;d?(m.internal=Ln(sr({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,m)):this.client.core.relayer.publish(o,y,m).catch(_=>this.client.logger.error(_)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=pa(t,o),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=_i[f.request.method].res;this.client.core.relayer.publish(s,d,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Mi(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Mi(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ae("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(sr({},s.params));const d=o.expiryTimestamp||Pr(_i.wc_sessionPropose.req.ttl),f=sr({id:c,pairingTopic:t,expiryTimestamp:d},o);await this.setProposal(c,f);const y=qn(JSON.stringify(s)),g=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:g})}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Ei(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const g=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const m=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:t})}else Wr(s)&&(await this.client.proposal.delete(o,mt("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:y,namespaces:g,sessionProperties:m,pairingTopic:_}=s.params,x=sr({topic:t,relay:d,expiry:y,namespaces:g,acknowledged:!0,pairingTopic:_,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},m&&{sessionProperties:m});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(Dt("session_connect"),{session:x}),this.cleanupDuplicatePairings(x)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Ei(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Dt("session_approve",o),{})):Wr(s)&&(await this.client.session.delete(t,mt("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const d=`${t}_session_update`,f=zo.get(d);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(sr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),zo.set(d,c)}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Dt("session_update",o),{}):Wr(s)&&this.events.emit(Dt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Pr(ko)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Dt("session_extend",o),{}):Wr(s)&&this.events.emit(Dt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Ei(s)?this.events.emit(Dt("session_ping",o),{}):Wr(s)&&this.events.emit(Dt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Xt.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:mt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(sr({topic:t},c));const d=qn(JSON.stringify(Hn("wc_sessionRequest",c,o))),f=this.client.session.get(t),y=await this.getVerifyContext(d,f.peer.metadata),g={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Dt("session_request",o),{result:s.result}):Wr(s)&&this.events.emit(Dt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const d=`${t}_session_event_${c.event.name}`,f=zo.get(d);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(sr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),zo.set(d,o)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Dt("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,Hn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!gr(t)){const{message:y}=ae("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:d,relays:f}=t;if(yr(s)||await this.isValidPairingTopic(s),!PE(f)){const{message:y}=ae("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!yr(o)&&Ps(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!yr(c)&&Ps(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),yr(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=xE(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!gr(t))throw new Error(ae("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:d}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Gc(o,"approve()");if(y)throw new Error(y.message);const g=Cf(f.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Vt(c,!0)){const{message:m}=ae("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(m)}yr(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async t=>{if(!gr(t)){const{message:c}=ae("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!RE(o)){const{message:c}=ae("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!gr(t)){const{message:g}=ae("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:d}=t;if(!fp(s)){const{message:g}=ae("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=wE(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Gc(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Mi(d)){const{message:g}=ae("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async t=>{if(!gr(t)){const{message:y}=ae("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=Gc(o,"update()");if(d)throw new Error(d.message);const f=Cf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!gr(t)){const{message:o}=ae("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!gr(t)){const{message:y}=ae("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:d}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Nf(f,c)){const{message:y}=ae("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!TE(o)){const{message:y}=ae("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!CE(f,c,o.method)){const{message:y}=ae("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(d&&!LE(d,su)){const{message:y}=ae("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${su.min} and ${su.max}`);throw new Error(y)}},this.isValidRespond=async t=>{var s;if(!gr(t)){const{message:d}=ae("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(d)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(d){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),d}if(!AE(c)){const{message:d}=ae("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(d)}},this.isValidPing=async t=>{if(!gr(t)){const{message:o}=ae("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!gr(t)){const{message:f}=ae("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Nf(d,c)){const{message:f}=ae("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!NE(o)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!DE(d,c,o.name)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!gr(t)){const{message:o}=ae("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||jn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Vt(o,!1)){const{message:c}=ae("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Xt.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{Ju(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ga(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(jr.expired,async e=>{const{topic:t,id:s}=hp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ae("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(_s.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Vt(e,!1)){const{message:t}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ae("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Vt(e,!1)){const{message:t}=ae("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ae("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ae("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Vt(e,!1)){const{message:t}=ae("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ae("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!OE(e)){const{message:t}=ae("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ae("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class L5 extends va{constructor(e,t){super(e,t,x5,Zu),this.core=e,this.logger=t}}let M5=class extends va{constructor(e,t){super(e,t,P5,Zu),this.core=e,this.logger=t}};class j5 extends va{constructor(e,t){super(e,t,R5,Zu,s=>s.id),this.core=e,this.logger=t}}let q5=class Gp extends oS{constructor(e){super(e),this.protocol=Kp,this.version=kp,this.name=nu.name,this.events=new qr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||nu.name,this.metadata=(e==null?void 0:e.metadata)||Fb();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:la(fa({level:(e==null?void 0:e.logger)||nu.logger}));this.core=(e==null?void 0:e.core)||new S5(e),this.logger=wr(t,this.name),this.session=new M5(this.core,this.logger),this.proposal=new L5(this.core,this.logger),this.pendingRequest=new j5(this.core,this.logger),this.engine=new U5(this)}static async init(e){const t=new Gp(e);return await t.initialize(),t}get context(){return mr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Tu={exports:{}};(function(i,e){var t=typeof self<"u"?self:Gr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(d){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(E){return E&&DataView.prototype.isPrototypeOf(E)}if(f.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(E){return E&&g.indexOf(Object.prototype.toString.call(E))>-1};function _(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(E))throw new TypeError("Invalid character in header field name");return E.toLowerCase()}function x(E){return typeof E!="string"&&(E=String(E)),E}function P(E){var T={next:function(){var X=E.shift();return{done:X===void 0,value:X}}};return f.iterable&&(T[Symbol.iterator]=function(){return T}),T}function A(E){this.map={},E instanceof A?E.forEach(function(T,X){this.append(X,T)},this):Array.isArray(E)?E.forEach(function(T){this.append(T[0],T[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(T){this.append(T,E[T])},this)}A.prototype.append=function(E,T){E=_(E),T=x(T);var X=this.map[E];this.map[E]=X?X+", "+T:T},A.prototype.delete=function(E){delete this.map[_(E)]},A.prototype.get=function(E){return E=_(E),this.has(E)?this.map[E]:null},A.prototype.has=function(E){return this.map.hasOwnProperty(_(E))},A.prototype.set=function(E,T){this.map[_(E)]=x(T)},A.prototype.forEach=function(E,T){for(var X in this.map)this.map.hasOwnProperty(X)&&E.call(T,this.map[X],X,this)},A.prototype.keys=function(){var E=[];return this.forEach(function(T,X){E.push(X)}),P(E)},A.prototype.values=function(){var E=[];return this.forEach(function(T){E.push(T)}),P(E)},A.prototype.entries=function(){var E=[];return this.forEach(function(T,X){E.push([X,T])}),P(E)},f.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function W(E){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}function K(E){return new Promise(function(T,X){E.onload=function(){T(E.result)},E.onerror=function(){X(E.error)}})}function ie(E){var T=new FileReader,X=K(T);return T.readAsArrayBuffer(E),X}function $(E){var T=new FileReader,X=K(T);return T.readAsText(E),X}function q(E){for(var T=new Uint8Array(E),X=new Array(T.length),J=0;J<T.length;J++)X[J]=String.fromCharCode(T[J]);return X.join("")}function O(E){if(E.slice)return E.slice(0);var T=new Uint8Array(E.byteLength);return T.set(new Uint8Array(E)),T.buffer}function N(){return this.bodyUsed=!1,this._initBody=function(E){this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:f.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:f.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():f.arrayBuffer&&f.blob&&y(E)?(this._bodyArrayBuffer=O(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||m(E))?this._bodyArrayBuffer=O(E):this._bodyText=E=Object.prototype.toString.call(E):this._bodyText="",this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var E=W(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var E=W(this);if(E)return E;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(q(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(re)}),this.json=function(){return this.text().then(JSON.parse)},this}var C=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function h(E){var T=E.toUpperCase();return C.indexOf(T)>-1?T:E}function I(E,T){T=T||{};var X=T.body;if(E instanceof I){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,T.headers||(this.headers=new A(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!X&&E._bodyInit!=null&&(X=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=T.credentials||this.credentials||"same-origin",(T.headers||!this.headers)&&(this.headers=new A(T.headers)),this.method=h(T.method||this.method||"GET"),this.mode=T.mode||this.mode||null,this.signal=T.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function re(E){var T=new FormData;return E.trim().split("&").forEach(function(X){if(X){var J=X.split("="),B=J.shift().replace(/\+/g," "),k=J.join("=").replace(/\+/g," ");T.append(decodeURIComponent(B),decodeURIComponent(k))}}),T}function ne(E){var T=new A,X=E.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(J){var B=J.split(":"),k=B.shift().trim();if(k){var Z=B.join(":").trim();T.append(k,Z)}}),T}N.call(I.prototype);function ue(E,T){T||(T={}),this.type="default",this.status=T.status===void 0?200:T.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in T?T.statusText:"OK",this.headers=new A(T.headers),this.url=T.url||"",this._initBody(E)}N.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ue.error=function(){var E=new ue(null,{status:0,statusText:""});return E.type="error",E};var ge=[301,302,303,307,308];ue.redirect=function(E,T){if(ge.indexOf(T)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:T,headers:{location:E}})},d.DOMException=c.DOMException;try{new d.DOMException}catch{d.DOMException=function(T,X){this.message=T,this.name=X;var J=Error(T);this.stack=J.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function ye(E,T){return new Promise(function(X,J){var B=new I(E,T);if(B.signal&&B.signal.aborted)return J(new d.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function Z(){k.abort()}k.onload=function(){var te={status:k.status,statusText:k.statusText,headers:ne(k.getAllResponseHeaders()||"")};te.url="responseURL"in k?k.responseURL:te.headers.get("X-Request-URL");var Ie="response"in k?k.response:k.responseText;X(new ue(Ie,te))},k.onerror=function(){J(new TypeError("Network request failed"))},k.ontimeout=function(){J(new TypeError("Network request failed"))},k.onabort=function(){J(new d.DOMException("Aborted","AbortError"))},k.open(B.method,B.url,!0),B.credentials==="include"?k.withCredentials=!0:B.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&f.blob&&(k.responseType="blob"),B.headers.forEach(function(te,Ie){k.setRequestHeader(Ie,te)}),B.signal&&(B.signal.addEventListener("abort",Z),k.onreadystatechange=function(){k.readyState===4&&B.signal.removeEventListener("abort",Z)}),k.send(typeof B._bodyInit>"u"?null:B._bodyInit)})}return ye.polyfill=!0,c.fetch||(c.fetch=ye,c.Headers=A,c.Request=I,c.Response=ue),d.Headers=A,d.Request=I,d.Response=ue,d.fetch=ye,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Tu,Tu.exports);var H5=Tu.exports;const Sd=na(H5),z5={Accept:"application/json","Content-Type":"application/json"},F5="POST",xd={headers:z5,method:F5},Pd=10;class zi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new qr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Xf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=an(e),c=await(await Sd(this.url,Object.assign(Object.assign({},xd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Xf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=an({id:1,jsonrpc:"2.0",method:"test",params:[]});await Sd(e,Object.assign(Object.assign({},xd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ds(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=pa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return xp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Pd&&this.events.setMaxListeners(Pd)}}const Od="error",B5="wss://relay.walletconnect.com",K5="wc",k5="universal_provider",Rd=`${K5}@2:${k5}:`,V5="https://rpc.walletconnect.com/v1/",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Au={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",g=500,m="__lodash_placeholder__",_=1,x=2,P=4,A=1,W=2,K=1,ie=2,$=4,q=8,O=16,N=32,C=64,h=128,I=256,re=512,ne=30,ue="...",ge=800,ye=16,E=1,T=2,X=3,J=1/0,B=9007199254740991,k=17976931348623157e292,Z=NaN,te=4294967295,Ie=te-1,oe=te>>>1,Se=[["ary",h],["bind",K],["bindKey",ie],["curry",q],["curryRight",O],["flip",re],["partial",N],["partialRight",C],["rearg",I]],le="[object Arguments]",Ae="[object Array]",z="[object AsyncFunction]",H="[object Boolean]",U="[object Date]",l="[object DOMException]",R="[object Error]",se="[object Function]",he="[object GeneratorFunction]",Ee="[object Map]",Fe="[object Number]",ke="[object Null]",Me="[object Object]",dt="[object Promise]",pt="[object Proxy]",qe="[object RegExp]",xe="[object Set]",De="[object String]",$e="[object Symbol]",He="[object Undefined]",Oe="[object WeakMap]",Ue="[object WeakSet]",be="[object ArrayBuffer]",Re="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",Ve="[object Int8Array]",Ge="[object Int16Array]",Ze="[object Int32Array]",et="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",cr="[object Uint32Array]",Yr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,si=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pi=/&(?:amp|lt|gt|quot|#39);/g,Fi=/[&<>"']/g,Et=RegExp(Pi.source),gt=RegExp(Fi.source),It=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(xt.source),Pt=/^\s+/,Tt=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ut=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ma=/[()=,{}\[\]\/\s]/,wa=/\\(\\)?/g,_a=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tr=/\w*$/,ba=/^[-+]0x[0-9a-f]+$/i,Ea=/^0b[01]+$/i,Ia=/^\[object .+?Constructor\]$/,Sa=/^0o[0-7]+$/i,xa=/^(?:0|[1-9]\d*)$/,oi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dn=/($^)/,Pa=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",Oa="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",gn="\\u20d0-\\u20ff",Ls=Oa+Ra+gn,Ms="\\u2700-\\u27bf",Hr="a-z\\xdf-\\xf6\\xf8-\\xff",Ta="\\xac\\xb1\\xd7\\xf7",Aa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Na="\\u2000-\\u206f",Ca=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",js="A-Z\\xc0-\\xd6\\xd8-\\xde",qs="\\ufe0e\\ufe0f",Bi=Ta+Aa+Na+Ca,Wn="[']",Ki="["+pn+"]",Gn="["+Bi+"]",ki="["+Ls+"]",Hs="\\d+",Da="["+Ms+"]",zs="["+Hr+"]",Fs="[^"+pn+Bi+Hs+Ms+Hr+js+"]",yn="\\ud83c[\\udffb-\\udfff]",$a="(?:"+ki+"|"+yn+")",Bs="[^"+pn+"]",vn="(?:\\ud83c[\\udde6-\\uddff]){2}",Oi="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+js+"]",Ks="\\u200d",ks="(?:"+zs+"|"+Fs+")",Jr="(?:"+_r+"|"+Fs+")",Vs="(?:"+Wn+"(?:d|ll|m|re|s|t|ve))?",Ws="(?:"+Wn+"(?:D|LL|M|RE|S|T|VE))?",Gs=$a+"?",Ys="["+qs+"]?",Ua="(?:"+Ks+"(?:"+[Bs,vn,Oi].join("|")+")"+Ys+Gs+")*",ai="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qs=Ys+Gs+Ua,mn="(?:"+[Da,vn,Oi].join("|")+")"+Qs,La="(?:"+[Bs+ki+"?",ki,vn,Oi,Ki].join("|")+")",Yn=RegExp(Wn,"g"),Ma=RegExp(ki,"g"),wn=RegExp(yn+"(?="+yn+")|"+La+Qs,"g"),Xs=RegExp([_r+"?"+zs+"+"+Vs+"(?="+[Gn,_r,"$"].join("|")+")",Jr+"+"+Ws+"(?="+[Gn,_r+ks,"$"].join("|")+")",_r+"?"+ks+"+"+Vs,_r+"+"+Ws,Js,ai,Hs,mn].join("|"),"g"),Zs=RegExp("["+Ks+pn+Ls+qs+"]"),Vi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ja=-1,st={};st[Be]=st[Pe]=st[Ve]=st[Ge]=st[Ze]=st[et]=st[Je]=st[Zt]=st[cr]=!0,st[le]=st[Ae]=st[be]=st[H]=st[Re]=st[U]=st[R]=st[se]=st[Ee]=st[Fe]=st[Me]=st[qe]=st[xe]=st[De]=st[Oe]=!1;var nt={};nt[le]=nt[Ae]=nt[be]=nt[Re]=nt[H]=nt[U]=nt[Be]=nt[Pe]=nt[Ve]=nt[Ge]=nt[Ze]=nt[Ee]=nt[Fe]=nt[Me]=nt[qe]=nt[xe]=nt[De]=nt[$e]=nt[et]=nt[Je]=nt[Zt]=nt[cr]=!0,nt[R]=nt[se]=nt[Oe]=!1;var b={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Ne=parseInt,lt=typeof ms=="object"&&ms&&ms.Object===Object&&ms,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=lt||qt||Function("return this")(),at=e&&!e.nodeType&&e,At=at&&!0&&i&&!i.nodeType&&i,ur=At&&At.exports===at,Ht=ur&&lt.process,ft=function(){try{var M=At&&At.require&&At.require("util").types;return M||Ht&&Ht.binding&&Ht.binding("util")}catch{}}(),tr=ft&&ft.isArrayBuffer,zr=ft&&ft.isDate,Ar=ft&&ft.isMap,Qr=ft&&ft.isRegExp,Jn=ft&&ft.isSet,Wi=ft&&ft.isTypedArray;function Bt(M,V,F){switch(F.length){case 0:return M.call(V);case 1:return M.call(V,F[0]);case 2:return M.call(V,F[0],F[1]);case 3:return M.call(V,F[0],F[1],F[2])}return M.apply(V,F)}function Qp(M,V,F,de){for(var Te=-1,tt=M==null?0:M.length;++Te<tt;){var zt=M[Te];V(de,zt,F(zt),M)}return de}function Nr(M,V){for(var F=-1,de=M==null?0:M.length;++F<de&&V(M[F],F,M)!==!1;);return M}function Xp(M,V){for(var F=M==null?0:M.length;F--&&V(M[F],F,M)!==!1;);return M}function rh(M,V){for(var F=-1,de=M==null?0:M.length;++F<de;)if(!V(M[F],F,M))return!1;return!0}function Ri(M,V){for(var F=-1,de=M==null?0:M.length,Te=0,tt=[];++F<de;){var zt=M[F];V(zt,F,M)&&(tt[Te++]=zt)}return tt}function to(M,V){var F=M==null?0:M.length;return!!F&&_n(M,V,0)>-1}function qa(M,V,F){for(var de=-1,Te=M==null?0:M.length;++de<Te;)if(F(V,M[de]))return!0;return!1}function vt(M,V){for(var F=-1,de=M==null?0:M.length,Te=Array(de);++F<de;)Te[F]=V(M[F],F,M);return Te}function Ti(M,V){for(var F=-1,de=V.length,Te=M.length;++F<de;)M[Te+F]=V[F];return M}function Ha(M,V,F,de){var Te=-1,tt=M==null?0:M.length;for(de&&tt&&(F=M[++Te]);++Te<tt;)F=V(F,M[Te],Te,M);return F}function Zp(M,V,F,de){var Te=M==null?0:M.length;for(de&&Te&&(F=M[--Te]);Te--;)F=V(F,M[Te],Te,M);return F}function za(M,V){for(var F=-1,de=M==null?0:M.length;++F<de;)if(V(M[F],F,M))return!0;return!1}var eg=Fa("length");function tg(M){return M.split("")}function rg(M){return M.match(jt)||[]}function ih(M,V,F){var de;return F(M,function(Te,tt,zt){if(V(Te,tt,zt))return de=tt,!1}),de}function ro(M,V,F,de){for(var Te=M.length,tt=F+(de?1:-1);de?tt--:++tt<Te;)if(V(M[tt],tt,M))return tt;return-1}function _n(M,V,F){return V===V?pg(M,V,F):ro(M,nh,F)}function ig(M,V,F,de){for(var Te=F-1,tt=M.length;++Te<tt;)if(de(M[Te],V))return Te;return-1}function nh(M){return M!==M}function sh(M,V){var F=M==null?0:M.length;return F?Ka(M,V)/F:Z}function Fa(M){return function(V){return V==null?t:V[M]}}function Ba(M){return function(V){return M==null?t:M[V]}}function oh(M,V,F,de,Te){return Te(M,function(tt,zt,ct){F=de?(de=!1,tt):V(F,tt,zt,ct)}),F}function ng(M,V){var F=M.length;for(M.sort(V);F--;)M[F]=M[F].value;return M}function Ka(M,V){for(var F,de=-1,Te=M.length;++de<Te;){var tt=V(M[de]);tt!==t&&(F=F===t?tt:F+tt)}return F}function ka(M,V){for(var F=-1,de=Array(M);++F<M;)de[F]=V(F);return de}function sg(M,V){return vt(V,function(F){return[F,M[F]]})}function ah(M){return M&&M.slice(0,lh(M)+1).replace(Pt,"")}function br(M){return function(V){return M(V)}}function Va(M,V){return vt(V,function(F){return M[F]})}function Qn(M,V){return M.has(V)}function ch(M,V){for(var F=-1,de=M.length;++F<de&&_n(V,M[F],0)>-1;);return F}function uh(M,V){for(var F=M.length;F--&&_n(V,M[F],0)>-1;);return F}function og(M,V){for(var F=M.length,de=0;F--;)M[F]===V&&++de;return de}var ag=Ba(b),cg=Ba(L);function ug(M){return"\\"+fe[M]}function hg(M,V){return M==null?t:M[V]}function bn(M){return Zs.test(M)}function lg(M){return Vi.test(M)}function fg(M){for(var V,F=[];!(V=M.next()).done;)F.push(V.value);return F}function Wa(M){var V=-1,F=Array(M.size);return M.forEach(function(de,Te){F[++V]=[Te,de]}),F}function hh(M,V){return function(F){return M(V(F))}}function Ai(M,V){for(var F=-1,de=M.length,Te=0,tt=[];++F<de;){var zt=M[F];(zt===V||zt===m)&&(M[F]=m,tt[Te++]=F)}return tt}function io(M){var V=-1,F=Array(M.size);return M.forEach(function(de){F[++V]=de}),F}function dg(M){var V=-1,F=Array(M.size);return M.forEach(function(de){F[++V]=[de,de]}),F}function pg(M,V,F){for(var de=F-1,Te=M.length;++de<Te;)if(M[de]===V)return de;return-1}function gg(M,V,F){for(var de=F+1;de--;)if(M[de]===V)return de;return de}function En(M){return bn(M)?vg(M):eg(M)}function Fr(M){return bn(M)?mg(M):tg(M)}function lh(M){for(var V=M.length;V--&&Tt.test(M.charAt(V)););return V}var yg=Ba(Q);function vg(M){for(var V=wn.lastIndex=0;wn.test(M);)++V;return V}function mg(M){return M.match(wn)||[]}function wg(M){return M.match(Xs)||[]}var _g=function M(V){V=V==null?Qe:In.defaults(Qe.Object(),V,In.pick(Qe,eo));var F=V.Array,de=V.Date,Te=V.Error,tt=V.Function,zt=V.Math,ct=V.Object,Ga=V.RegExp,bg=V.String,Cr=V.TypeError,no=F.prototype,Eg=tt.prototype,Sn=ct.prototype,so=V["__core-js_shared__"],oo=Eg.toString,it=Sn.hasOwnProperty,Ig=0,fh=function(){var r=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ao=Sn.toString,Sg=oo.call(ct),xg=Qe._,Pg=Ga("^"+oo.call(it).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),co=ur?V.Buffer:t,Ni=V.Symbol,uo=V.Uint8Array,dh=co?co.allocUnsafe:t,ho=hh(ct.getPrototypeOf,ct),ph=ct.create,gh=Sn.propertyIsEnumerable,lo=no.splice,yh=Ni?Ni.isConcatSpreadable:t,Xn=Ni?Ni.iterator:t,Gi=Ni?Ni.toStringTag:t,fo=function(){try{var r=Zi(ct,"defineProperty");return r({},"",{}),r}catch{}}(),Og=V.clearTimeout!==Qe.clearTimeout&&V.clearTimeout,Rg=de&&de.now!==Qe.Date.now&&de.now,Tg=V.setTimeout!==Qe.setTimeout&&V.setTimeout,po=zt.ceil,go=zt.floor,Ya=ct.getOwnPropertySymbols,Ag=co?co.isBuffer:t,vh=V.isFinite,Ng=no.join,Cg=hh(ct.keys,ct),Ft=zt.max,Yt=zt.min,Dg=de.now,$g=V.parseInt,mh=zt.random,Ug=no.reverse,Ja=Zi(V,"DataView"),Zn=Zi(V,"Map"),Qa=Zi(V,"Promise"),xn=Zi(V,"Set"),es=Zi(V,"WeakMap"),ts=Zi(ct,"create"),yo=es&&new es,Pn={},Lg=en(Ja),Mg=en(Zn),jg=en(Qa),qg=en(xn),Hg=en(es),vo=Ni?Ni.prototype:t,rs=vo?vo.valueOf:t,wh=vo?vo.toString:t;function v(r){if(Rt(r)&&!Ce(r)&&!(r instanceof Ye)){if(r instanceof Dr)return r;if(it.call(r,"__wrapped__"))return _l(r)}return new Dr(r)}var On=function(){function r(){}return function(n){if(!bt(n))return{};if(ph)return ph(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function mo(){}function Dr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:It,evaluate:St,interpolate:_t,variable:"",imports:{_:v}},v.prototype=mo.prototype,v.prototype.constructor=v,Dr.prototype=On(mo.prototype),Dr.prototype.constructor=Dr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=te,this.__views__=[]}function zg(){var r=new Ye(this.__wrapped__);return r.__actions__=hr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=hr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=hr(this.__views__),r}function Fg(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Bg(){var r=this.__wrapped__.value(),n=this.__dir__,a=Ce(r),u=n<0,p=a?r.length:0,w=ty(0,p,this.__views__),S=w.start,D=w.end,j=D-S,G=u?D:S-1,Y=this.__iteratees__,ee=Y.length,ce=0,pe=Yt(j,this.__takeCount__);if(!a||!u&&p==j&&pe==j)return Bh(r,this.__actions__);var we=[];e:for(;j--&&ce<pe;){G+=n;for(var ze=-1,_e=r[G];++ze<ee;){var We=Y[ze],Xe=We.iteratee,Sr=We.type,nr=Xe(_e);if(Sr==T)_e=nr;else if(!nr){if(Sr==E)continue e;break e}}we[ce++]=_e}return we}Ye.prototype=On(mo.prototype),Ye.prototype.constructor=Ye;function Yi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function Kg(){this.__data__=ts?ts(null):{},this.size=0}function kg(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function Vg(r){var n=this.__data__;if(ts){var a=n[r];return a===y?t:a}return it.call(n,r)?n[r]:t}function Wg(r){var n=this.__data__;return ts?n[r]!==t:it.call(n,r)}function Gg(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=ts&&n===t?y:n,this}Yi.prototype.clear=Kg,Yi.prototype.delete=kg,Yi.prototype.get=Vg,Yi.prototype.has=Wg,Yi.prototype.set=Gg;function ci(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function Yg(){this.__data__=[],this.size=0}function Jg(r){var n=this.__data__,a=wo(n,r);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():lo.call(n,a,1),--this.size,!0}function Qg(r){var n=this.__data__,a=wo(n,r);return a<0?t:n[a][1]}function Xg(r){return wo(this.__data__,r)>-1}function Zg(r,n){var a=this.__data__,u=wo(a,r);return u<0?(++this.size,a.push([r,n])):a[u][1]=n,this}ci.prototype.clear=Yg,ci.prototype.delete=Jg,ci.prototype.get=Qg,ci.prototype.has=Xg,ci.prototype.set=Zg;function ui(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function e0(){this.size=0,this.__data__={hash:new Yi,map:new(Zn||ci),string:new Yi}}function t0(r){var n=No(this,r).delete(r);return this.size-=n?1:0,n}function r0(r){return No(this,r).get(r)}function i0(r){return No(this,r).has(r)}function n0(r,n){var a=No(this,r),u=a.size;return a.set(r,n),this.size+=a.size==u?0:1,this}ui.prototype.clear=e0,ui.prototype.delete=t0,ui.prototype.get=r0,ui.prototype.has=i0,ui.prototype.set=n0;function Ji(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new ui;++n<a;)this.add(r[n])}function s0(r){return this.__data__.set(r,y),this}function o0(r){return this.__data__.has(r)}Ji.prototype.add=Ji.prototype.push=s0,Ji.prototype.has=o0;function Br(r){var n=this.__data__=new ci(r);this.size=n.size}function a0(){this.__data__=new ci,this.size=0}function c0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function u0(r){return this.__data__.get(r)}function h0(r){return this.__data__.has(r)}function l0(r,n){var a=this.__data__;if(a instanceof ci){var u=a.__data__;if(!Zn||u.length<o-1)return u.push([r,n]),this.size=++a.size,this;a=this.__data__=new ui(u)}return a.set(r,n),this.size=a.size,this}Br.prototype.clear=a0,Br.prototype.delete=c0,Br.prototype.get=u0,Br.prototype.has=h0,Br.prototype.set=l0;function _h(r,n){var a=Ce(r),u=!a&&tn(r),p=!a&&!u&&Li(r),w=!a&&!u&&!p&&Nn(r),S=a||u||p||w,D=S?ka(r.length,bg):[],j=D.length;for(var G in r)(n||it.call(r,G))&&!(S&&(G=="length"||p&&(G=="offset"||G=="parent")||w&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||di(G,j)))&&D.push(G);return D}function bh(r){var n=r.length;return n?r[cc(0,n-1)]:t}function f0(r,n){return Co(hr(r),Qi(n,0,r.length))}function d0(r){return Co(hr(r))}function Xa(r,n,a){(a!==t&&!Kr(r[n],a)||a===t&&!(n in r))&&hi(r,n,a)}function is(r,n,a){var u=r[n];(!(it.call(r,n)&&Kr(u,a))||a===t&&!(n in r))&&hi(r,n,a)}function wo(r,n){for(var a=r.length;a--;)if(Kr(r[a][0],n))return a;return-1}function p0(r,n,a,u){return Ci(r,function(p,w,S){n(u,p,a(p),S)}),u}function Eh(r,n){return r&&Zr(n,Kt(n),r)}function g0(r,n){return r&&Zr(n,fr(n),r)}function hi(r,n,a){n=="__proto__"&&fo?fo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Za(r,n){for(var a=-1,u=n.length,p=F(u),w=r==null;++a<u;)p[a]=w?t:Dc(r,n[a]);return p}function Qi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function $r(r,n,a,u,p,w){var S,D=n&_,j=n&x,G=n&P;if(a&&(S=p?a(r,u,p,w):a(r)),S!==t)return S;if(!bt(r))return r;var Y=Ce(r);if(Y){if(S=iy(r),!D)return hr(r,S)}else{var ee=Jt(r),ce=ee==se||ee==he;if(Li(r))return Vh(r,D);if(ee==Me||ee==le||ce&&!p){if(S=j||ce?{}:ll(r),!D)return j?V0(r,g0(S,r)):k0(r,Eh(S,r))}else{if(!nt[ee])return p?r:{};S=ny(r,ee,D)}}w=new Br;var pe=w.get(r);if(pe)return pe;w.set(r,S),Hl(r)?r.forEach(function(_e){S.add($r(_e,n,a,_e,r,w))}):jl(r)&&r.forEach(function(_e,We){S.set(We,$r(_e,n,a,We,r,w))});var we=G?j?wc:mc:j?fr:Kt,ze=Y?t:we(r);return Nr(ze||r,function(_e,We){ze&&(We=_e,_e=r[We]),is(S,We,$r(_e,n,a,We,r,w))}),S}function y0(r){var n=Kt(r);return function(a){return Ih(a,r,n)}}function Ih(r,n,a){var u=a.length;if(r==null)return!u;for(r=ct(r);u--;){var p=a[u],w=n[p],S=r[p];if(S===t&&!(p in r)||!w(S))return!1}return!0}function Sh(r,n,a){if(typeof r!="function")throw new Cr(d);return hs(function(){r.apply(t,a)},n)}function ns(r,n,a,u){var p=-1,w=to,S=!0,D=r.length,j=[],G=n.length;if(!D)return j;a&&(n=vt(n,br(a))),u?(w=qa,S=!1):n.length>=o&&(w=Qn,S=!1,n=new Ji(n));e:for(;++p<D;){var Y=r[p],ee=a==null?Y:a(Y);if(Y=u||Y!==0?Y:0,S&&ee===ee){for(var ce=G;ce--;)if(n[ce]===ee)continue e;j.push(Y)}else w(n,ee,u)||j.push(Y)}return j}var Ci=Qh(Xr),xh=Qh(tc,!0);function v0(r,n){var a=!0;return Ci(r,function(u,p,w){return a=!!n(u,p,w),a}),a}function _o(r,n,a){for(var u=-1,p=r.length;++u<p;){var w=r[u],S=n(w);if(S!=null&&(D===t?S===S&&!Ir(S):a(S,D)))var D=S,j=w}return j}function m0(r,n,a,u){var p=r.length;for(a=je(a),a<0&&(a=-a>p?0:p+a),u=u===t||u>p?p:je(u),u<0&&(u+=p),u=a>u?0:Fl(u);a<u;)r[a++]=n;return r}function Ph(r,n){var a=[];return Ci(r,function(u,p,w){n(u,p,w)&&a.push(u)}),a}function Wt(r,n,a,u,p){var w=-1,S=r.length;for(a||(a=oy),p=[];++w<S;){var D=r[w];n>0&&a(D)?n>1?Wt(D,n-1,a,u,p):Ti(p,D):u||(p[p.length]=D)}return p}var ec=Xh(),Oh=Xh(!0);function Xr(r,n){return r&&ec(r,n,Kt)}function tc(r,n){return r&&Oh(r,n,Kt)}function bo(r,n){return Ri(n,function(a){return pi(r[a])})}function Xi(r,n){n=$i(n,r);for(var a=0,u=n.length;r!=null&&a<u;)r=r[ei(n[a++])];return a&&a==u?r:t}function Rh(r,n,a){var u=n(r);return Ce(r)?u:Ti(u,a(r))}function rr(r){return r==null?r===t?He:ke:Gi&&Gi in ct(r)?ey(r):dy(r)}function rc(r,n){return r>n}function w0(r,n){return r!=null&&it.call(r,n)}function _0(r,n){return r!=null&&n in ct(r)}function b0(r,n,a){return r>=Yt(n,a)&&r<Ft(n,a)}function ic(r,n,a){for(var u=a?qa:to,p=r[0].length,w=r.length,S=w,D=F(w),j=1/0,G=[];S--;){var Y=r[S];S&&n&&(Y=vt(Y,br(n))),j=Yt(Y.length,j),D[S]=!a&&(n||p>=120&&Y.length>=120)?new Ji(S&&Y):t}Y=r[0];var ee=-1,ce=D[0];e:for(;++ee<p&&G.length<j;){var pe=Y[ee],we=n?n(pe):pe;if(pe=a||pe!==0?pe:0,!(ce?Qn(ce,we):u(G,we,a))){for(S=w;--S;){var ze=D[S];if(!(ze?Qn(ze,we):u(r[S],we,a)))continue e}ce&&ce.push(we),G.push(pe)}}return G}function E0(r,n,a,u){return Xr(r,function(p,w,S){n(u,a(p),w,S)}),u}function ss(r,n,a){n=$i(n,r),r=gl(r,n);var u=r==null?r:r[ei(Lr(n))];return u==null?t:Bt(u,r,a)}function Th(r){return Rt(r)&&rr(r)==le}function I0(r){return Rt(r)&&rr(r)==be}function S0(r){return Rt(r)&&rr(r)==U}function os(r,n,a,u,p){return r===n?!0:r==null||n==null||!Rt(r)&&!Rt(n)?r!==r&&n!==n:x0(r,n,a,u,os,p)}function x0(r,n,a,u,p,w){var S=Ce(r),D=Ce(n),j=S?Ae:Jt(r),G=D?Ae:Jt(n);j=j==le?Me:j,G=G==le?Me:G;var Y=j==Me,ee=G==Me,ce=j==G;if(ce&&Li(r)){if(!Li(n))return!1;S=!0,Y=!1}if(ce&&!Y)return w||(w=new Br),S||Nn(r)?cl(r,n,a,u,p,w):X0(r,n,j,a,u,p,w);if(!(a&A)){var pe=Y&&it.call(r,"__wrapped__"),we=ee&&it.call(n,"__wrapped__");if(pe||we){var ze=pe?r.value():r,_e=we?n.value():n;return w||(w=new Br),p(ze,_e,a,u,w)}}return ce?(w||(w=new Br),Z0(r,n,a,u,p,w)):!1}function P0(r){return Rt(r)&&Jt(r)==Ee}function nc(r,n,a,u){var p=a.length,w=p,S=!u;if(r==null)return!w;for(r=ct(r);p--;){var D=a[p];if(S&&D[2]?D[1]!==r[D[0]]:!(D[0]in r))return!1}for(;++p<w;){D=a[p];var j=D[0],G=r[j],Y=D[1];if(S&&D[2]){if(G===t&&!(j in r))return!1}else{var ee=new Br;if(u)var ce=u(G,Y,j,r,n,ee);if(!(ce===t?os(Y,G,A|W,u,ee):ce))return!1}}return!0}function Ah(r){if(!bt(r)||cy(r))return!1;var n=pi(r)?Pg:Ia;return n.test(en(r))}function O0(r){return Rt(r)&&rr(r)==qe}function R0(r){return Rt(r)&&Jt(r)==xe}function T0(r){return Rt(r)&&jo(r.length)&&!!st[rr(r)]}function Nh(r){return typeof r=="function"?r:r==null?dr:typeof r=="object"?Ce(r)?$h(r[0],r[1]):Dh(r):Zl(r)}function sc(r){if(!us(r))return Cg(r);var n=[];for(var a in ct(r))it.call(r,a)&&a!="constructor"&&n.push(a);return n}function A0(r){if(!bt(r))return fy(r);var n=us(r),a=[];for(var u in r)u=="constructor"&&(n||!it.call(r,u))||a.push(u);return a}function oc(r,n){return r<n}function Ch(r,n){var a=-1,u=lr(r)?F(r.length):[];return Ci(r,function(p,w,S){u[++a]=n(p,w,S)}),u}function Dh(r){var n=bc(r);return n.length==1&&n[0][2]?dl(n[0][0],n[0][1]):function(a){return a===r||nc(a,r,n)}}function $h(r,n){return Ic(r)&&fl(n)?dl(ei(r),n):function(a){var u=Dc(a,r);return u===t&&u===n?$c(a,r):os(n,u,A|W)}}function Eo(r,n,a,u,p){r!==n&&ec(n,function(w,S){if(p||(p=new Br),bt(w))N0(r,n,S,a,Eo,u,p);else{var D=u?u(xc(r,S),w,S+"",r,n,p):t;D===t&&(D=w),Xa(r,S,D)}},fr)}function N0(r,n,a,u,p,w,S){var D=xc(r,a),j=xc(n,a),G=S.get(j);if(G){Xa(r,a,G);return}var Y=w?w(D,j,a+"",r,n,S):t,ee=Y===t;if(ee){var ce=Ce(j),pe=!ce&&Li(j),we=!ce&&!pe&&Nn(j);Y=j,ce||pe||we?Ce(D)?Y=D:Nt(D)?Y=hr(D):pe?(ee=!1,Y=Vh(j,!0)):we?(ee=!1,Y=Wh(j,!0)):Y=[]:ls(j)||tn(j)?(Y=D,tn(D)?Y=Bl(D):(!bt(D)||pi(D))&&(Y=ll(j))):ee=!1}ee&&(S.set(j,Y),p(Y,j,u,w,S),S.delete(j)),Xa(r,a,Y)}function Uh(r,n){var a=r.length;if(a)return n+=n<0?a:0,di(n,a)?r[n]:t}function Lh(r,n,a){n.length?n=vt(n,function(w){return Ce(w)?function(S){return Xi(S,w.length===1?w[0]:w)}:w}):n=[dr];var u=-1;n=vt(n,br(me()));var p=Ch(r,function(w,S,D){var j=vt(n,function(G){return G(w)});return{criteria:j,index:++u,value:w}});return ng(p,function(w,S){return K0(w,S,a)})}function C0(r,n){return Mh(r,n,function(a,u){return $c(r,u)})}function Mh(r,n,a){for(var u=-1,p=n.length,w={};++u<p;){var S=n[u],D=Xi(r,S);a(D,S)&&as(w,$i(S,r),D)}return w}function D0(r){return function(n){return Xi(n,r)}}function ac(r,n,a,u){var p=u?ig:_n,w=-1,S=n.length,D=r;for(r===n&&(n=hr(n)),a&&(D=vt(r,br(a)));++w<S;)for(var j=0,G=n[w],Y=a?a(G):G;(j=p(D,Y,j,u))>-1;)D!==r&&lo.call(D,j,1),lo.call(r,j,1);return r}function jh(r,n){for(var a=r?n.length:0,u=a-1;a--;){var p=n[a];if(a==u||p!==w){var w=p;di(p)?lo.call(r,p,1):lc(r,p)}}return r}function cc(r,n){return r+go(mh()*(n-r+1))}function $0(r,n,a,u){for(var p=-1,w=Ft(po((n-r)/(a||1)),0),S=F(w);w--;)S[u?w:++p]=r,r+=a;return S}function uc(r,n){var a="";if(!r||n<1||n>B)return a;do n%2&&(a+=r),n=go(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return Pc(pl(r,n,dr),r+"")}function U0(r){return bh(Cn(r))}function L0(r,n){var a=Cn(r);return Co(a,Qi(n,0,a.length))}function as(r,n,a,u){if(!bt(r))return r;n=$i(n,r);for(var p=-1,w=n.length,S=w-1,D=r;D!=null&&++p<w;){var j=ei(n[p]),G=a;if(j==="__proto__"||j==="constructor"||j==="prototype")return r;if(p!=S){var Y=D[j];G=u?u(Y,j,D):t,G===t&&(G=bt(Y)?Y:di(n[p+1])?[]:{})}is(D,j,G),D=D[j]}return r}var qh=yo?function(r,n){return yo.set(r,n),r}:dr,M0=fo?function(r,n){return fo(r,"toString",{configurable:!0,enumerable:!1,value:Lc(n),writable:!0})}:dr;function j0(r){return Co(Cn(r))}function Ur(r,n,a){var u=-1,p=r.length;n<0&&(n=-n>p?0:p+n),a=a>p?p:a,a<0&&(a+=p),p=n>a?0:a-n>>>0,n>>>=0;for(var w=F(p);++u<p;)w[u]=r[u+n];return w}function q0(r,n){var a;return Ci(r,function(u,p,w){return a=n(u,p,w),!a}),!!a}function Io(r,n,a){var u=0,p=r==null?u:r.length;if(typeof n=="number"&&n===n&&p<=oe){for(;u<p;){var w=u+p>>>1,S=r[w];S!==null&&!Ir(S)&&(a?S<=n:S<n)?u=w+1:p=w}return p}return hc(r,n,dr,a)}function hc(r,n,a,u){var p=0,w=r==null?0:r.length;if(w===0)return 0;n=a(n);for(var S=n!==n,D=n===null,j=Ir(n),G=n===t;p<w;){var Y=go((p+w)/2),ee=a(r[Y]),ce=ee!==t,pe=ee===null,we=ee===ee,ze=Ir(ee);if(S)var _e=u||we;else G?_e=we&&(u||ce):D?_e=we&&ce&&(u||!pe):j?_e=we&&ce&&!pe&&(u||!ze):pe||ze?_e=!1:_e=u?ee<=n:ee<n;_e?p=Y+1:w=Y}return Yt(w,Ie)}function Hh(r,n){for(var a=-1,u=r.length,p=0,w=[];++a<u;){var S=r[a],D=n?n(S):S;if(!a||!Kr(D,j)){var j=D;w[p++]=S===0?0:S}}return w}function zh(r){return typeof r=="number"?r:Ir(r)?Z:+r}function Er(r){if(typeof r=="string")return r;if(Ce(r))return vt(r,Er)+"";if(Ir(r))return wh?wh.call(r):"";var n=r+"";return n=="0"&&1/r==-J?"-0":n}function Di(r,n,a){var u=-1,p=to,w=r.length,S=!0,D=[],j=D;if(a)S=!1,p=qa;else if(w>=o){var G=n?null:J0(r);if(G)return io(G);S=!1,p=Qn,j=new Ji}else j=n?[]:D;e:for(;++u<w;){var Y=r[u],ee=n?n(Y):Y;if(Y=a||Y!==0?Y:0,S&&ee===ee){for(var ce=j.length;ce--;)if(j[ce]===ee)continue e;n&&j.push(ee),D.push(Y)}else p(j,ee,a)||(j!==D&&j.push(ee),D.push(Y))}return D}function lc(r,n){return n=$i(n,r),r=gl(r,n),r==null||delete r[ei(Lr(n))]}function Fh(r,n,a,u){return as(r,n,a(Xi(r,n)),u)}function So(r,n,a,u){for(var p=r.length,w=u?p:-1;(u?w--:++w<p)&&n(r[w],w,r););return a?Ur(r,u?0:w,u?w+1:p):Ur(r,u?w+1:0,u?p:w)}function Bh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),Ha(n,function(u,p){return p.func.apply(p.thisArg,Ti([u],p.args))},a)}function fc(r,n,a){var u=r.length;if(u<2)return u?Di(r[0]):[];for(var p=-1,w=F(u);++p<u;)for(var S=r[p],D=-1;++D<u;)D!=p&&(w[p]=ns(w[p]||S,r[D],n,a));return Di(Wt(w,1),n,a)}function Kh(r,n,a){for(var u=-1,p=r.length,w=n.length,S={};++u<p;){var D=u<w?n[u]:t;a(S,r[u],D)}return S}function dc(r){return Nt(r)?r:[]}function pc(r){return typeof r=="function"?r:dr}function $i(r,n){return Ce(r)?r:Ic(r,n)?[r]:wl(rt(r))}var H0=Ke;function Ui(r,n,a){var u=r.length;return a=a===t?u:a,!n&&a>=u?r:Ur(r,n,a)}var kh=Og||function(r){return Qe.clearTimeout(r)};function Vh(r,n){if(n)return r.slice();var a=r.length,u=dh?dh(a):new r.constructor(a);return r.copy(u),u}function gc(r){var n=new r.constructor(r.byteLength);return new uo(n).set(new uo(r)),n}function z0(r,n){var a=n?gc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function F0(r){var n=new r.constructor(r.source,Tr.exec(r));return n.lastIndex=r.lastIndex,n}function B0(r){return rs?ct(rs.call(r)):{}}function Wh(r,n){var a=n?gc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function Gh(r,n){if(r!==n){var a=r!==t,u=r===null,p=r===r,w=Ir(r),S=n!==t,D=n===null,j=n===n,G=Ir(n);if(!D&&!G&&!w&&r>n||w&&S&&j&&!D&&!G||u&&S&&j||!a&&j||!p)return 1;if(!u&&!w&&!G&&r<n||G&&a&&p&&!u&&!w||D&&a&&p||!S&&p||!j)return-1}return 0}function K0(r,n,a){for(var u=-1,p=r.criteria,w=n.criteria,S=p.length,D=a.length;++u<S;){var j=Gh(p[u],w[u]);if(j){if(u>=D)return j;var G=a[u];return j*(G=="desc"?-1:1)}}return r.index-n.index}function Yh(r,n,a,u){for(var p=-1,w=r.length,S=a.length,D=-1,j=n.length,G=Ft(w-S,0),Y=F(j+G),ee=!u;++D<j;)Y[D]=n[D];for(;++p<S;)(ee||p<w)&&(Y[a[p]]=r[p]);for(;G--;)Y[D++]=r[p++];return Y}function Jh(r,n,a,u){for(var p=-1,w=r.length,S=-1,D=a.length,j=-1,G=n.length,Y=Ft(w-D,0),ee=F(Y+G),ce=!u;++p<Y;)ee[p]=r[p];for(var pe=p;++j<G;)ee[pe+j]=n[j];for(;++S<D;)(ce||p<w)&&(ee[pe+a[S]]=r[p++]);return ee}function hr(r,n){var a=-1,u=r.length;for(n||(n=F(u));++a<u;)n[a]=r[a];return n}function Zr(r,n,a,u){var p=!a;a||(a={});for(var w=-1,S=n.length;++w<S;){var D=n[w],j=u?u(a[D],r[D],D,a,r):t;j===t&&(j=r[D]),p?hi(a,D,j):is(a,D,j)}return a}function k0(r,n){return Zr(r,Ec(r),n)}function V0(r,n){return Zr(r,ul(r),n)}function xo(r,n){return function(a,u){var p=Ce(a)?Qp:p0,w=n?n():{};return p(a,r,me(u,2),w)}}function Rn(r){return Ke(function(n,a){var u=-1,p=a.length,w=p>1?a[p-1]:t,S=p>2?a[2]:t;for(w=r.length>3&&typeof w=="function"?(p--,w):t,S&&ir(a[0],a[1],S)&&(w=p<3?t:w,p=1),n=ct(n);++u<p;){var D=a[u];D&&r(n,D,u,w)}return n})}function Qh(r,n){return function(a,u){if(a==null)return a;if(!lr(a))return r(a,u);for(var p=a.length,w=n?p:-1,S=ct(a);(n?w--:++w<p)&&u(S[w],w,S)!==!1;);return a}}function Xh(r){return function(n,a,u){for(var p=-1,w=ct(n),S=u(n),D=S.length;D--;){var j=S[r?D:++p];if(a(w[j],j,w)===!1)break}return n}}function W0(r,n,a){var u=n&K,p=cs(r);function w(){var S=this&&this!==Qe&&this instanceof w?p:r;return S.apply(u?a:this,arguments)}return w}function Zh(r){return function(n){n=rt(n);var a=bn(n)?Fr(n):t,u=a?a[0]:n.charAt(0),p=a?Ui(a,1).join(""):n.slice(1);return u[r]()+p}}function Tn(r){return function(n){return Ha(Ql(Jl(n).replace(Yn,"")),r,"")}}function cs(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=On(r.prototype),u=r.apply(a,n);return bt(u)?u:a}}function G0(r,n,a){var u=cs(r);function p(){for(var w=arguments.length,S=F(w),D=w,j=An(p);D--;)S[D]=arguments[D];var G=w<3&&S[0]!==j&&S[w-1]!==j?[]:Ai(S,j);if(w-=G.length,w<a)return nl(r,n,Po,p.placeholder,t,S,G,t,t,a-w);var Y=this&&this!==Qe&&this instanceof p?u:r;return Bt(Y,this,S)}return p}function el(r){return function(n,a,u){var p=ct(n);if(!lr(n)){var w=me(a,3);n=Kt(n),a=function(D){return w(p[D],D,p)}}var S=r(n,a,u);return S>-1?p[w?n[S]:S]:t}}function tl(r){return fi(function(n){var a=n.length,u=a,p=Dr.prototype.thru;for(r&&n.reverse();u--;){var w=n[u];if(typeof w!="function")throw new Cr(d);if(p&&!S&&Ao(w)=="wrapper")var S=new Dr([],!0)}for(u=S?u:a;++u<a;){w=n[u];var D=Ao(w),j=D=="wrapper"?_c(w):t;j&&Sc(j[0])&&j[1]==(h|q|N|I)&&!j[4].length&&j[9]==1?S=S[Ao(j[0])].apply(S,j[3]):S=w.length==1&&Sc(w)?S[D]():S.thru(w)}return function(){var G=arguments,Y=G[0];if(S&&G.length==1&&Ce(Y))return S.plant(Y).value();for(var ee=0,ce=a?n[ee].apply(this,G):Y;++ee<a;)ce=n[ee].call(this,ce);return ce}})}function Po(r,n,a,u,p,w,S,D,j,G){var Y=n&h,ee=n&K,ce=n&ie,pe=n&(q|O),we=n&re,ze=ce?t:cs(r);function _e(){for(var We=arguments.length,Xe=F(We),Sr=We;Sr--;)Xe[Sr]=arguments[Sr];if(pe)var nr=An(_e),xr=og(Xe,nr);if(u&&(Xe=Yh(Xe,u,p,pe)),w&&(Xe=Jh(Xe,w,S,pe)),We-=xr,pe&&We<G){var Ct=Ai(Xe,nr);return nl(r,n,Po,_e.placeholder,a,Xe,Ct,D,j,G-We)}var kr=ee?a:this,yi=ce?kr[r]:r;return We=Xe.length,D?Xe=py(Xe,D):we&&We>1&&Xe.reverse(),Y&&j<We&&(Xe.length=j),this&&this!==Qe&&this instanceof _e&&(yi=ze||cs(yi)),yi.apply(kr,Xe)}return _e}function rl(r,n){return function(a,u){return E0(a,r,n(u),{})}}function Oo(r,n){return function(a,u){var p;if(a===t&&u===t)return n;if(a!==t&&(p=a),u!==t){if(p===t)return u;typeof a=="string"||typeof u=="string"?(a=Er(a),u=Er(u)):(a=zh(a),u=zh(u)),p=r(a,u)}return p}}function yc(r){return fi(function(n){return n=vt(n,br(me())),Ke(function(a){var u=this;return r(n,function(p){return Bt(p,u,a)})})})}function Ro(r,n){n=n===t?" ":Er(n);var a=n.length;if(a<2)return a?uc(n,r):n;var u=uc(n,po(r/En(n)));return bn(n)?Ui(Fr(u),0,r).join(""):u.slice(0,r)}function Y0(r,n,a,u){var p=n&K,w=cs(r);function S(){for(var D=-1,j=arguments.length,G=-1,Y=u.length,ee=F(Y+j),ce=this&&this!==Qe&&this instanceof S?w:r;++G<Y;)ee[G]=u[G];for(;j--;)ee[G++]=arguments[++D];return Bt(ce,p?a:this,ee)}return S}function il(r){return function(n,a,u){return u&&typeof u!="number"&&ir(n,a,u)&&(a=u=t),n=gi(n),a===t?(a=n,n=0):a=gi(a),u=u===t?n<a?1:-1:gi(u),$0(n,a,u,r)}}function To(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Mr(n),a=Mr(a)),r(n,a)}}function nl(r,n,a,u,p,w,S,D,j,G){var Y=n&q,ee=Y?S:t,ce=Y?t:S,pe=Y?w:t,we=Y?t:w;n|=Y?N:C,n&=~(Y?C:N),n&$||(n&=~(K|ie));var ze=[r,n,p,pe,ee,we,ce,D,j,G],_e=a.apply(t,ze);return Sc(r)&&yl(_e,ze),_e.placeholder=u,vl(_e,r,n)}function vc(r){var n=zt[r];return function(a,u){if(a=Mr(a),u=u==null?0:Yt(je(u),292),u&&vh(a)){var p=(rt(a)+"e").split("e"),w=n(p[0]+"e"+(+p[1]+u));return p=(rt(w)+"e").split("e"),+(p[0]+"e"+(+p[1]-u))}return n(a)}}var J0=xn&&1/io(new xn([,-0]))[1]==J?function(r){return new xn(r)}:qc;function sl(r){return function(n){var a=Jt(n);return a==Ee?Wa(n):a==xe?dg(n):sg(n,r(n))}}function li(r,n,a,u,p,w,S,D){var j=n&ie;if(!j&&typeof r!="function")throw new Cr(d);var G=u?u.length:0;if(G||(n&=~(N|C),u=p=t),S=S===t?S:Ft(je(S),0),D=D===t?D:je(D),G-=p?p.length:0,n&C){var Y=u,ee=p;u=p=t}var ce=j?t:_c(r),pe=[r,n,a,u,p,Y,ee,w,S,D];if(ce&&ly(pe,ce),r=pe[0],n=pe[1],a=pe[2],u=pe[3],p=pe[4],D=pe[9]=pe[9]===t?j?0:r.length:Ft(pe[9]-G,0),!D&&n&(q|O)&&(n&=~(q|O)),!n||n==K)var we=W0(r,n,a);else n==q||n==O?we=G0(r,n,D):(n==N||n==(K|N))&&!p.length?we=Y0(r,n,a,u):we=Po.apply(t,pe);var ze=ce?qh:yl;return vl(ze(we,pe),r,n)}function ol(r,n,a,u){return r===t||Kr(r,Sn[a])&&!it.call(u,a)?n:r}function al(r,n,a,u,p,w){return bt(r)&&bt(n)&&(w.set(n,r),Eo(r,n,t,al,w),w.delete(n)),r}function Q0(r){return ls(r)?t:r}function cl(r,n,a,u,p,w){var S=a&A,D=r.length,j=n.length;if(D!=j&&!(S&&j>D))return!1;var G=w.get(r),Y=w.get(n);if(G&&Y)return G==n&&Y==r;var ee=-1,ce=!0,pe=a&W?new Ji:t;for(w.set(r,n),w.set(n,r);++ee<D;){var we=r[ee],ze=n[ee];if(u)var _e=S?u(ze,we,ee,n,r,w):u(we,ze,ee,r,n,w);if(_e!==t){if(_e)continue;ce=!1;break}if(pe){if(!za(n,function(We,Xe){if(!Qn(pe,Xe)&&(we===We||p(we,We,a,u,w)))return pe.push(Xe)})){ce=!1;break}}else if(!(we===ze||p(we,ze,a,u,w))){ce=!1;break}}return w.delete(r),w.delete(n),ce}function X0(r,n,a,u,p,w,S){switch(a){case Re:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case be:return!(r.byteLength!=n.byteLength||!w(new uo(r),new uo(n)));case H:case U:case Fe:return Kr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case qe:case De:return r==n+"";case Ee:var D=Wa;case xe:var j=u&A;if(D||(D=io),r.size!=n.size&&!j)return!1;var G=S.get(r);if(G)return G==n;u|=W,S.set(r,n);var Y=cl(D(r),D(n),u,p,w,S);return S.delete(r),Y;case $e:if(rs)return rs.call(r)==rs.call(n)}return!1}function Z0(r,n,a,u,p,w){var S=a&A,D=mc(r),j=D.length,G=mc(n),Y=G.length;if(j!=Y&&!S)return!1;for(var ee=j;ee--;){var ce=D[ee];if(!(S?ce in n:it.call(n,ce)))return!1}var pe=w.get(r),we=w.get(n);if(pe&&we)return pe==n&&we==r;var ze=!0;w.set(r,n),w.set(n,r);for(var _e=S;++ee<j;){ce=D[ee];var We=r[ce],Xe=n[ce];if(u)var Sr=S?u(Xe,We,ce,n,r,w):u(We,Xe,ce,r,n,w);if(!(Sr===t?We===Xe||p(We,Xe,a,u,w):Sr)){ze=!1;break}_e||(_e=ce=="constructor")}if(ze&&!_e){var nr=r.constructor,xr=n.constructor;nr!=xr&&"constructor"in r&&"constructor"in n&&!(typeof nr=="function"&&nr instanceof nr&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return w.delete(r),w.delete(n),ze}function fi(r){return Pc(pl(r,t,Il),r+"")}function mc(r){return Rh(r,Kt,Ec)}function wc(r){return Rh(r,fr,ul)}var _c=yo?function(r){return yo.get(r)}:qc;function Ao(r){for(var n=r.name+"",a=Pn[n],u=it.call(Pn,n)?a.length:0;u--;){var p=a[u],w=p.func;if(w==null||w==r)return p.name}return n}function An(r){var n=it.call(v,"placeholder")?v:r;return n.placeholder}function me(){var r=v.iteratee||Mc;return r=r===Mc?Nh:r,arguments.length?r(arguments[0],arguments[1]):r}function No(r,n){var a=r.__data__;return ay(n)?a[typeof n=="string"?"string":"hash"]:a.map}function bc(r){for(var n=Kt(r),a=n.length;a--;){var u=n[a],p=r[u];n[a]=[u,p,fl(p)]}return n}function Zi(r,n){var a=hg(r,n);return Ah(a)?a:t}function ey(r){var n=it.call(r,Gi),a=r[Gi];try{r[Gi]=t;var u=!0}catch{}var p=ao.call(r);return u&&(n?r[Gi]=a:delete r[Gi]),p}var Ec=Ya?function(r){return r==null?[]:(r=ct(r),Ri(Ya(r),function(n){return gh.call(r,n)}))}:Hc,ul=Ya?function(r){for(var n=[];r;)Ti(n,Ec(r)),r=ho(r);return n}:Hc,Jt=rr;(Ja&&Jt(new Ja(new ArrayBuffer(1)))!=Re||Zn&&Jt(new Zn)!=Ee||Qa&&Jt(Qa.resolve())!=dt||xn&&Jt(new xn)!=xe||es&&Jt(new es)!=Oe)&&(Jt=function(r){var n=rr(r),a=n==Me?r.constructor:t,u=a?en(a):"";if(u)switch(u){case Lg:return Re;case Mg:return Ee;case jg:return dt;case qg:return xe;case Hg:return Oe}return n});function ty(r,n,a){for(var u=-1,p=a.length;++u<p;){var w=a[u],S=w.size;switch(w.type){case"drop":r+=S;break;case"dropRight":n-=S;break;case"take":n=Yt(n,r+S);break;case"takeRight":r=Ft(r,n-S);break}}return{start:r,end:n}}function ry(r){var n=r.match(ut);return n?n[1].split(Mt):[]}function hl(r,n,a){n=$i(n,r);for(var u=-1,p=n.length,w=!1;++u<p;){var S=ei(n[u]);if(!(w=r!=null&&a(r,S)))break;r=r[S]}return w||++u!=p?w:(p=r==null?0:r.length,!!p&&jo(p)&&di(S,p)&&(Ce(r)||tn(r)))}function iy(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function ll(r){return typeof r.constructor=="function"&&!us(r)?On(ho(r)):{}}function ny(r,n,a){var u=r.constructor;switch(n){case be:return gc(r);case H:case U:return new u(+r);case Re:return z0(r,a);case Be:case Pe:case Ve:case Ge:case Ze:case et:case Je:case Zt:case cr:return Wh(r,a);case Ee:return new u;case Fe:case De:return new u(r);case qe:return F0(r);case xe:return new u;case $e:return B0(r)}}function sy(r,n){var a=n.length;if(!a)return r;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),r.replace(Ot,`{
/* [wrapped with `+n+`] */
`)}function oy(r){return Ce(r)||tn(r)||!!(yh&&r&&r[yh])}function di(r,n){var a=typeof r;return n=n??B,!!n&&(a=="number"||a!="symbol"&&xa.test(r))&&r>-1&&r%1==0&&r<n}function ir(r,n,a){if(!bt(a))return!1;var u=typeof n;return(u=="number"?lr(a)&&di(n,a.length):u=="string"&&n in a)?Kr(a[n],r):!1}function Ic(r,n){if(Ce(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Ir(r)?!0:$t.test(r)||!yt.test(r)||n!=null&&r in ct(n)}function ay(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Sc(r){var n=Ao(r),a=v[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var u=_c(a);return!!u&&r===u[0]}function cy(r){return!!fh&&fh in r}var uy=so?pi:zc;function us(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||Sn;return r===a}function fl(r){return r===r&&!bt(r)}function dl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ct(a))}}function hy(r){var n=Lo(r,function(u){return a.size===g&&a.clear(),u}),a=n.cache;return n}function ly(r,n){var a=r[1],u=n[1],p=a|u,w=p<(K|ie|h),S=u==h&&a==q||u==h&&a==I&&r[7].length<=n[8]||u==(h|I)&&n[7].length<=n[8]&&a==q;if(!(w||S))return r;u&K&&(r[2]=n[2],p|=a&K?0:$);var D=n[3];if(D){var j=r[3];r[3]=j?Yh(j,D,n[4]):D,r[4]=j?Ai(r[3],m):n[4]}return D=n[5],D&&(j=r[5],r[5]=j?Jh(j,D,n[6]):D,r[6]=j?Ai(r[5],m):n[6]),D=n[7],D&&(r[7]=D),u&h&&(r[8]=r[8]==null?n[8]:Yt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=p,r}function fy(r){var n=[];if(r!=null)for(var a in ct(r))n.push(a);return n}function dy(r){return ao.call(r)}function pl(r,n,a){return n=Ft(n===t?r.length-1:n,0),function(){for(var u=arguments,p=-1,w=Ft(u.length-n,0),S=F(w);++p<w;)S[p]=u[n+p];p=-1;for(var D=F(n+1);++p<n;)D[p]=u[p];return D[n]=a(S),Bt(r,this,D)}}function gl(r,n){return n.length<2?r:Xi(r,Ur(n,0,-1))}function py(r,n){for(var a=r.length,u=Yt(n.length,a),p=hr(r);u--;){var w=n[u];r[u]=di(w,a)?p[w]:t}return r}function xc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var yl=ml(qh),hs=Tg||function(r,n){return Qe.setTimeout(r,n)},Pc=ml(M0);function vl(r,n,a){var u=n+"";return Pc(r,sy(u,gy(ry(u),a)))}function ml(r){var n=0,a=0;return function(){var u=Dg(),p=ye-(u-a);if(a=u,p>0){if(++n>=ge)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Co(r,n){var a=-1,u=r.length,p=u-1;for(n=n===t?u:n;++a<n;){var w=cc(a,p),S=r[w];r[w]=r[a],r[a]=S}return r.length=n,r}var wl=hy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ut,function(a,u,p,w){n.push(p?w.replace(wa,"$1"):u||a)}),n});function ei(r){if(typeof r=="string"||Ir(r))return r;var n=r+"";return n=="0"&&1/r==-J?"-0":n}function en(r){if(r!=null){try{return oo.call(r)}catch{}try{return r+""}catch{}}return""}function gy(r,n){return Nr(Se,function(a){var u="_."+a[0];n&a[1]&&!to(r,u)&&r.push(u)}),r.sort()}function _l(r){if(r instanceof Ye)return r.clone();var n=new Dr(r.__wrapped__,r.__chain__);return n.__actions__=hr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function yy(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=Ft(je(n),0);var u=r==null?0:r.length;if(!u||n<1)return[];for(var p=0,w=0,S=F(po(u/n));p<u;)S[w++]=Ur(r,p,p+=n);return S}function vy(r){for(var n=-1,a=r==null?0:r.length,u=0,p=[];++n<a;){var w=r[n];w&&(p[u++]=w)}return p}function my(){var r=arguments.length;if(!r)return[];for(var n=F(r-1),a=arguments[0],u=r;u--;)n[u-1]=arguments[u];return Ti(Ce(a)?hr(a):[a],Wt(n,1))}var wy=Ke(function(r,n){return Nt(r)?ns(r,Wt(n,1,Nt,!0)):[]}),_y=Ke(function(r,n){var a=Lr(n);return Nt(a)&&(a=t),Nt(r)?ns(r,Wt(n,1,Nt,!0),me(a,2)):[]}),by=Ke(function(r,n){var a=Lr(n);return Nt(a)&&(a=t),Nt(r)?ns(r,Wt(n,1,Nt,!0),t,a):[]});function Ey(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:je(n),Ur(r,n<0?0:n,u)):[]}function Iy(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:je(n),n=u-n,Ur(r,0,n<0?0:n)):[]}function Sy(r,n){return r&&r.length?So(r,me(n,3),!0,!0):[]}function xy(r,n){return r&&r.length?So(r,me(n,3),!0):[]}function Py(r,n,a,u){var p=r==null?0:r.length;return p?(a&&typeof a!="number"&&ir(r,n,a)&&(a=0,u=p),m0(r,n,a,u)):[]}function bl(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=a==null?0:je(a);return p<0&&(p=Ft(u+p,0)),ro(r,me(n,3),p)}function El(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=u-1;return a!==t&&(p=je(a),p=a<0?Ft(u+p,0):Yt(p,u-1)),ro(r,me(n,3),p,!0)}function Il(r){var n=r==null?0:r.length;return n?Wt(r,1):[]}function Oy(r){var n=r==null?0:r.length;return n?Wt(r,J):[]}function Ry(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:je(n),Wt(r,n)):[]}function Ty(r){for(var n=-1,a=r==null?0:r.length,u={};++n<a;){var p=r[n];u[p[0]]=p[1]}return u}function Sl(r){return r&&r.length?r[0]:t}function Ay(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=a==null?0:je(a);return p<0&&(p=Ft(u+p,0)),_n(r,n,p)}function Ny(r){var n=r==null?0:r.length;return n?Ur(r,0,-1):[]}var Cy=Ke(function(r){var n=vt(r,dc);return n.length&&n[0]===r[0]?ic(n):[]}),Dy=Ke(function(r){var n=Lr(r),a=vt(r,dc);return n===Lr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?ic(a,me(n,2)):[]}),$y=Ke(function(r){var n=Lr(r),a=vt(r,dc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?ic(a,t,n):[]});function Uy(r,n){return r==null?"":Ng.call(r,n)}function Lr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Ly(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=u;return a!==t&&(p=je(a),p=p<0?Ft(u+p,0):Yt(p,u-1)),n===n?gg(r,n,p):ro(r,nh,p,!0)}function My(r,n){return r&&r.length?Uh(r,je(n)):t}var jy=Ke(xl);function xl(r,n){return r&&r.length&&n&&n.length?ac(r,n):r}function qy(r,n,a){return r&&r.length&&n&&n.length?ac(r,n,me(a,2)):r}function Hy(r,n,a){return r&&r.length&&n&&n.length?ac(r,n,t,a):r}var zy=fi(function(r,n){var a=r==null?0:r.length,u=Za(r,n);return jh(r,vt(n,function(p){return di(p,a)?+p:p}).sort(Gh)),u});function Fy(r,n){var a=[];if(!(r&&r.length))return a;var u=-1,p=[],w=r.length;for(n=me(n,3);++u<w;){var S=r[u];n(S,u,r)&&(a.push(S),p.push(u))}return jh(r,p),a}function Oc(r){return r==null?r:Ug.call(r)}function By(r,n,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&ir(r,n,a)?(n=0,a=u):(n=n==null?0:je(n),a=a===t?u:je(a)),Ur(r,n,a)):[]}function Ky(r,n){return Io(r,n)}function ky(r,n,a){return hc(r,n,me(a,2))}function Vy(r,n){var a=r==null?0:r.length;if(a){var u=Io(r,n);if(u<a&&Kr(r[u],n))return u}return-1}function Wy(r,n){return Io(r,n,!0)}function Gy(r,n,a){return hc(r,n,me(a,2),!0)}function Yy(r,n){var a=r==null?0:r.length;if(a){var u=Io(r,n,!0)-1;if(Kr(r[u],n))return u}return-1}function Jy(r){return r&&r.length?Hh(r):[]}function Qy(r,n){return r&&r.length?Hh(r,me(n,2)):[]}function Xy(r){var n=r==null?0:r.length;return n?Ur(r,1,n):[]}function Zy(r,n,a){return r&&r.length?(n=a||n===t?1:je(n),Ur(r,0,n<0?0:n)):[]}function ev(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:je(n),n=u-n,Ur(r,n<0?0:n,u)):[]}function tv(r,n){return r&&r.length?So(r,me(n,3),!1,!0):[]}function rv(r,n){return r&&r.length?So(r,me(n,3)):[]}var iv=Ke(function(r){return Di(Wt(r,1,Nt,!0))}),nv=Ke(function(r){var n=Lr(r);return Nt(n)&&(n=t),Di(Wt(r,1,Nt,!0),me(n,2))}),sv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,Di(Wt(r,1,Nt,!0),t,n)});function ov(r){return r&&r.length?Di(r):[]}function av(r,n){return r&&r.length?Di(r,me(n,2)):[]}function cv(r,n){return n=typeof n=="function"?n:t,r&&r.length?Di(r,t,n):[]}function Rc(r){if(!(r&&r.length))return[];var n=0;return r=Ri(r,function(a){if(Nt(a))return n=Ft(a.length,n),!0}),ka(n,function(a){return vt(r,Fa(a))})}function Pl(r,n){if(!(r&&r.length))return[];var a=Rc(r);return n==null?a:vt(a,function(u){return Bt(n,t,u)})}var uv=Ke(function(r,n){return Nt(r)?ns(r,n):[]}),hv=Ke(function(r){return fc(Ri(r,Nt))}),lv=Ke(function(r){var n=Lr(r);return Nt(n)&&(n=t),fc(Ri(r,Nt),me(n,2))}),fv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,fc(Ri(r,Nt),t,n)}),dv=Ke(Rc);function pv(r,n){return Kh(r||[],n||[],is)}function gv(r,n){return Kh(r||[],n||[],as)}var yv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Pl(r,a)});function Ol(r){var n=v(r);return n.__chain__=!0,n}function vv(r,n){return n(r),r}function Do(r,n){return n(r)}var mv=fi(function(r){var n=r.length,a=n?r[0]:0,u=this.__wrapped__,p=function(w){return Za(w,r)};return n>1||this.__actions__.length||!(u instanceof Ye)||!di(a)?this.thru(p):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:Do,args:[p],thisArg:t}),new Dr(u,this.__chain__).thru(function(w){return n&&!w.length&&w.push(t),w}))});function wv(){return Ol(this)}function _v(){return new Dr(this.value(),this.__chain__)}function bv(){this.__values__===t&&(this.__values__=zl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function Ev(){return this}function Iv(r){for(var n,a=this;a instanceof mo;){var u=_l(a);u.__index__=0,u.__values__=t,n?p.__wrapped__=u:n=u;var p=u;a=a.__wrapped__}return p.__wrapped__=r,n}function Sv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:Do,args:[Oc],thisArg:t}),new Dr(n,this.__chain__)}return this.thru(Oc)}function xv(){return Bh(this.__wrapped__,this.__actions__)}var Pv=xo(function(r,n,a){it.call(r,a)?++r[a]:hi(r,a,1)});function Ov(r,n,a){var u=Ce(r)?rh:v0;return a&&ir(r,n,a)&&(n=t),u(r,me(n,3))}function Rv(r,n){var a=Ce(r)?Ri:Ph;return a(r,me(n,3))}var Tv=el(bl),Av=el(El);function Nv(r,n){return Wt($o(r,n),1)}function Cv(r,n){return Wt($o(r,n),J)}function Dv(r,n,a){return a=a===t?1:je(a),Wt($o(r,n),a)}function Rl(r,n){var a=Ce(r)?Nr:Ci;return a(r,me(n,3))}function Tl(r,n){var a=Ce(r)?Xp:xh;return a(r,me(n,3))}var $v=xo(function(r,n,a){it.call(r,a)?r[a].push(n):hi(r,a,[n])});function Uv(r,n,a,u){r=lr(r)?r:Cn(r),a=a&&!u?je(a):0;var p=r.length;return a<0&&(a=Ft(p+a,0)),qo(r)?a<=p&&r.indexOf(n,a)>-1:!!p&&_n(r,n,a)>-1}var Lv=Ke(function(r,n,a){var u=-1,p=typeof n=="function",w=lr(r)?F(r.length):[];return Ci(r,function(S){w[++u]=p?Bt(n,S,a):ss(S,n,a)}),w}),Mv=xo(function(r,n,a){hi(r,a,n)});function $o(r,n){var a=Ce(r)?vt:Ch;return a(r,me(n,3))}function jv(r,n,a,u){return r==null?[]:(Ce(n)||(n=n==null?[]:[n]),a=u?t:a,Ce(a)||(a=a==null?[]:[a]),Lh(r,n,a))}var qv=xo(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Hv(r,n,a){var u=Ce(r)?Ha:oh,p=arguments.length<3;return u(r,me(n,4),a,p,Ci)}function zv(r,n,a){var u=Ce(r)?Zp:oh,p=arguments.length<3;return u(r,me(n,4),a,p,xh)}function Fv(r,n){var a=Ce(r)?Ri:Ph;return a(r,Mo(me(n,3)))}function Bv(r){var n=Ce(r)?bh:U0;return n(r)}function Kv(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=je(n);var u=Ce(r)?f0:L0;return u(r,n)}function kv(r){var n=Ce(r)?d0:j0;return n(r)}function Vv(r){if(r==null)return 0;if(lr(r))return qo(r)?En(r):r.length;var n=Jt(r);return n==Ee||n==xe?r.size:sc(r).length}function Wv(r,n,a){var u=Ce(r)?za:q0;return a&&ir(r,n,a)&&(n=t),u(r,me(n,3))}var Gv=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&ir(r,n[0],n[1])?n=[]:a>2&&ir(n[0],n[1],n[2])&&(n=[n[0]]),Lh(r,Wt(n,1),[])}),Uo=Rg||function(){return Qe.Date.now()};function Yv(r,n){if(typeof n!="function")throw new Cr(d);return r=je(r),function(){if(--r<1)return n.apply(this,arguments)}}function Al(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,li(r,h,t,t,t,t,n)}function Nl(r,n){var a;if(typeof n!="function")throw new Cr(d);return r=je(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Tc=Ke(function(r,n,a){var u=K;if(a.length){var p=Ai(a,An(Tc));u|=N}return li(r,u,n,a,p)}),Cl=Ke(function(r,n,a){var u=K|ie;if(a.length){var p=Ai(a,An(Cl));u|=N}return li(n,u,r,a,p)});function Dl(r,n,a){n=a?t:n;var u=li(r,q,t,t,t,t,t,n);return u.placeholder=Dl.placeholder,u}function $l(r,n,a){n=a?t:n;var u=li(r,O,t,t,t,t,t,n);return u.placeholder=$l.placeholder,u}function Ul(r,n,a){var u,p,w,S,D,j,G=0,Y=!1,ee=!1,ce=!0;if(typeof r!="function")throw new Cr(d);n=Mr(n)||0,bt(a)&&(Y=!!a.leading,ee="maxWait"in a,w=ee?Ft(Mr(a.maxWait)||0,n):w,ce="trailing"in a?!!a.trailing:ce);function pe(Ct){var kr=u,yi=p;return u=p=t,G=Ct,S=r.apply(yi,kr),S}function we(Ct){return G=Ct,D=hs(We,n),Y?pe(Ct):S}function ze(Ct){var kr=Ct-j,yi=Ct-G,ef=n-kr;return ee?Yt(ef,w-yi):ef}function _e(Ct){var kr=Ct-j,yi=Ct-G;return j===t||kr>=n||kr<0||ee&&yi>=w}function We(){var Ct=Uo();if(_e(Ct))return Xe(Ct);D=hs(We,ze(Ct))}function Xe(Ct){return D=t,ce&&u?pe(Ct):(u=p=t,S)}function Sr(){D!==t&&kh(D),G=0,u=j=p=D=t}function nr(){return D===t?S:Xe(Uo())}function xr(){var Ct=Uo(),kr=_e(Ct);if(u=arguments,p=this,j=Ct,kr){if(D===t)return we(j);if(ee)return kh(D),D=hs(We,n),pe(j)}return D===t&&(D=hs(We,n)),S}return xr.cancel=Sr,xr.flush=nr,xr}var Jv=Ke(function(r,n){return Sh(r,1,n)}),Qv=Ke(function(r,n,a){return Sh(r,Mr(n)||0,a)});function Xv(r){return li(r,re)}function Lo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Cr(d);var a=function(){var u=arguments,p=n?n.apply(this,u):u[0],w=a.cache;if(w.has(p))return w.get(p);var S=r.apply(this,u);return a.cache=w.set(p,S)||w,S};return a.cache=new(Lo.Cache||ui),a}Lo.Cache=ui;function Mo(r){if(typeof r!="function")throw new Cr(d);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Zv(r){return Nl(2,r)}var em=H0(function(r,n){n=n.length==1&&Ce(n[0])?vt(n[0],br(me())):vt(Wt(n,1),br(me()));var a=n.length;return Ke(function(u){for(var p=-1,w=Yt(u.length,a);++p<w;)u[p]=n[p].call(this,u[p]);return Bt(r,this,u)})}),Ac=Ke(function(r,n){var a=Ai(n,An(Ac));return li(r,N,t,n,a)}),Ll=Ke(function(r,n){var a=Ai(n,An(Ll));return li(r,C,t,n,a)}),tm=fi(function(r,n){return li(r,I,t,t,t,n)});function rm(r,n){if(typeof r!="function")throw new Cr(d);return n=n===t?n:je(n),Ke(r,n)}function im(r,n){if(typeof r!="function")throw new Cr(d);return n=n==null?0:Ft(je(n),0),Ke(function(a){var u=a[n],p=Ui(a,0,n);return u&&Ti(p,u),Bt(r,this,p)})}function nm(r,n,a){var u=!0,p=!0;if(typeof r!="function")throw new Cr(d);return bt(a)&&(u="leading"in a?!!a.leading:u,p="trailing"in a?!!a.trailing:p),Ul(r,n,{leading:u,maxWait:n,trailing:p})}function sm(r){return Al(r,1)}function om(r,n){return Ac(pc(n),r)}function am(){if(!arguments.length)return[];var r=arguments[0];return Ce(r)?r:[r]}function cm(r){return $r(r,P)}function um(r,n){return n=typeof n=="function"?n:t,$r(r,P,n)}function hm(r){return $r(r,_|P)}function lm(r,n){return n=typeof n=="function"?n:t,$r(r,_|P,n)}function fm(r,n){return n==null||Ih(r,n,Kt(n))}function Kr(r,n){return r===n||r!==r&&n!==n}var dm=To(rc),pm=To(function(r,n){return r>=n}),tn=Th(function(){return arguments}())?Th:function(r){return Rt(r)&&it.call(r,"callee")&&!gh.call(r,"callee")},Ce=F.isArray,gm=tr?br(tr):I0;function lr(r){return r!=null&&jo(r.length)&&!pi(r)}function Nt(r){return Rt(r)&&lr(r)}function ym(r){return r===!0||r===!1||Rt(r)&&rr(r)==H}var Li=Ag||zc,vm=zr?br(zr):S0;function mm(r){return Rt(r)&&r.nodeType===1&&!ls(r)}function wm(r){if(r==null)return!0;if(lr(r)&&(Ce(r)||typeof r=="string"||typeof r.splice=="function"||Li(r)||Nn(r)||tn(r)))return!r.length;var n=Jt(r);if(n==Ee||n==xe)return!r.size;if(us(r))return!sc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function _m(r,n){return os(r,n)}function bm(r,n,a){a=typeof a=="function"?a:t;var u=a?a(r,n):t;return u===t?os(r,n,t,a):!!u}function Nc(r){if(!Rt(r))return!1;var n=rr(r);return n==R||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!ls(r)}function Em(r){return typeof r=="number"&&vh(r)}function pi(r){if(!bt(r))return!1;var n=rr(r);return n==se||n==he||n==z||n==pt}function Ml(r){return typeof r=="number"&&r==je(r)}function jo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=B}function bt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Rt(r){return r!=null&&typeof r=="object"}var jl=Ar?br(Ar):P0;function Im(r,n){return r===n||nc(r,n,bc(n))}function Sm(r,n,a){return a=typeof a=="function"?a:t,nc(r,n,bc(n),a)}function xm(r){return ql(r)&&r!=+r}function Pm(r){if(uy(r))throw new Te(c);return Ah(r)}function Om(r){return r===null}function Rm(r){return r==null}function ql(r){return typeof r=="number"||Rt(r)&&rr(r)==Fe}function ls(r){if(!Rt(r)||rr(r)!=Me)return!1;var n=ho(r);if(n===null)return!0;var a=it.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&oo.call(a)==Sg}var Cc=Qr?br(Qr):O0;function Tm(r){return Ml(r)&&r>=-B&&r<=B}var Hl=Jn?br(Jn):R0;function qo(r){return typeof r=="string"||!Ce(r)&&Rt(r)&&rr(r)==De}function Ir(r){return typeof r=="symbol"||Rt(r)&&rr(r)==$e}var Nn=Wi?br(Wi):T0;function Am(r){return r===t}function Nm(r){return Rt(r)&&Jt(r)==Oe}function Cm(r){return Rt(r)&&rr(r)==Ue}var Dm=To(oc),$m=To(function(r,n){return r<=n});function zl(r){if(!r)return[];if(lr(r))return qo(r)?Fr(r):hr(r);if(Xn&&r[Xn])return fg(r[Xn]());var n=Jt(r),a=n==Ee?Wa:n==xe?io:Cn;return a(r)}function gi(r){if(!r)return r===0?r:0;if(r=Mr(r),r===J||r===-J){var n=r<0?-1:1;return n*k}return r===r?r:0}function je(r){var n=gi(r),a=n%1;return n===n?a?n-a:n:0}function Fl(r){return r?Qi(je(r),0,te):0}function Mr(r){if(typeof r=="number")return r;if(Ir(r))return Z;if(bt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=bt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=ah(r);var a=Ea.test(r);return a||Sa.test(r)?Ne(r.slice(2),a?2:8):ba.test(r)?Z:+r}function Bl(r){return Zr(r,fr(r))}function Um(r){return r?Qi(je(r),-B,B):r===0?r:0}function rt(r){return r==null?"":Er(r)}var Lm=Rn(function(r,n){if(us(n)||lr(n)){Zr(n,Kt(n),r);return}for(var a in n)it.call(n,a)&&is(r,a,n[a])}),Kl=Rn(function(r,n){Zr(n,fr(n),r)}),Ho=Rn(function(r,n,a,u){Zr(n,fr(n),r,u)}),Mm=Rn(function(r,n,a,u){Zr(n,Kt(n),r,u)}),jm=fi(Za);function qm(r,n){var a=On(r);return n==null?a:Eh(a,n)}var Hm=Ke(function(r,n){r=ct(r);var a=-1,u=n.length,p=u>2?n[2]:t;for(p&&ir(n[0],n[1],p)&&(u=1);++a<u;)for(var w=n[a],S=fr(w),D=-1,j=S.length;++D<j;){var G=S[D],Y=r[G];(Y===t||Kr(Y,Sn[G])&&!it.call(r,G))&&(r[G]=w[G])}return r}),zm=Ke(function(r){return r.push(t,al),Bt(kl,t,r)});function Fm(r,n){return ih(r,me(n,3),Xr)}function Bm(r,n){return ih(r,me(n,3),tc)}function Km(r,n){return r==null?r:ec(r,me(n,3),fr)}function km(r,n){return r==null?r:Oh(r,me(n,3),fr)}function Vm(r,n){return r&&Xr(r,me(n,3))}function Wm(r,n){return r&&tc(r,me(n,3))}function Gm(r){return r==null?[]:bo(r,Kt(r))}function Ym(r){return r==null?[]:bo(r,fr(r))}function Dc(r,n,a){var u=r==null?t:Xi(r,n);return u===t?a:u}function Jm(r,n){return r!=null&&hl(r,n,w0)}function $c(r,n){return r!=null&&hl(r,n,_0)}var Qm=rl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),r[n]=a},Lc(dr)),Xm=rl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),it.call(r,n)?r[n].push(a):r[n]=[a]},me),Zm=Ke(ss);function Kt(r){return lr(r)?_h(r):sc(r)}function fr(r){return lr(r)?_h(r,!0):A0(r)}function ew(r,n){var a={};return n=me(n,3),Xr(r,function(u,p,w){hi(a,n(u,p,w),u)}),a}function tw(r,n){var a={};return n=me(n,3),Xr(r,function(u,p,w){hi(a,p,n(u,p,w))}),a}var rw=Rn(function(r,n,a){Eo(r,n,a)}),kl=Rn(function(r,n,a,u){Eo(r,n,a,u)}),iw=fi(function(r,n){var a={};if(r==null)return a;var u=!1;n=vt(n,function(w){return w=$i(w,r),u||(u=w.length>1),w}),Zr(r,wc(r),a),u&&(a=$r(a,_|x|P,Q0));for(var p=n.length;p--;)lc(a,n[p]);return a});function nw(r,n){return Vl(r,Mo(me(n)))}var sw=fi(function(r,n){return r==null?{}:C0(r,n)});function Vl(r,n){if(r==null)return{};var a=vt(wc(r),function(u){return[u]});return n=me(n),Mh(r,a,function(u,p){return n(u,p[0])})}function ow(r,n,a){n=$i(n,r);var u=-1,p=n.length;for(p||(p=1,r=t);++u<p;){var w=r==null?t:r[ei(n[u])];w===t&&(u=p,w=a),r=pi(w)?w.call(r):w}return r}function aw(r,n,a){return r==null?r:as(r,n,a)}function cw(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:as(r,n,a,u)}var Wl=sl(Kt),Gl=sl(fr);function uw(r,n,a){var u=Ce(r),p=u||Li(r)||Nn(r);if(n=me(n,4),a==null){var w=r&&r.constructor;p?a=u?new w:[]:bt(r)?a=pi(w)?On(ho(r)):{}:a={}}return(p?Nr:Xr)(r,function(S,D,j){return n(a,S,D,j)}),a}function hw(r,n){return r==null?!0:lc(r,n)}function lw(r,n,a){return r==null?r:Fh(r,n,pc(a))}function fw(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:Fh(r,n,pc(a),u)}function Cn(r){return r==null?[]:Va(r,Kt(r))}function dw(r){return r==null?[]:Va(r,fr(r))}function pw(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=Mr(a),a=a===a?a:0),n!==t&&(n=Mr(n),n=n===n?n:0),Qi(Mr(r),n,a)}function gw(r,n,a){return n=gi(n),a===t?(a=n,n=0):a=gi(a),r=Mr(r),b0(r,n,a)}function yw(r,n,a){if(a&&typeof a!="boolean"&&ir(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=gi(r),n===t?(n=r,r=0):n=gi(n)),r>n){var u=r;r=n,n=u}if(a||r%1||n%1){var p=mh();return Yt(r+p*(n-r+ot("1e-"+((p+"").length-1))),n)}return cc(r,n)}var vw=Tn(function(r,n,a){return n=n.toLowerCase(),r+(a?Yl(n):n)});function Yl(r){return Uc(rt(r).toLowerCase())}function Jl(r){return r=rt(r),r&&r.replace(oi,ag).replace(Ma,"")}function mw(r,n,a){r=rt(r),n=Er(n);var u=r.length;a=a===t?u:Qi(je(a),0,u);var p=a;return a-=n.length,a>=0&&r.slice(a,p)==n}function ww(r){return r=rt(r),r&&gt.test(r)?r.replace(Fi,cg):r}function _w(r){return r=rt(r),r&&Lt.test(r)?r.replace(xt,"\\$&"):r}var bw=Tn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),Ew=Tn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),Iw=Zh("toLowerCase");function Sw(r,n,a){r=rt(r),n=je(n);var u=n?En(r):0;if(!n||u>=n)return r;var p=(n-u)/2;return Ro(go(p),a)+r+Ro(po(p),a)}function xw(r,n,a){r=rt(r),n=je(n);var u=n?En(r):0;return n&&u<n?r+Ro(n-u,a):r}function Pw(r,n,a){r=rt(r),n=je(n);var u=n?En(r):0;return n&&u<n?Ro(n-u,a)+r:r}function Ow(r,n,a){return a||n==null?n=0:n&&(n=+n),$g(rt(r).replace(Pt,""),n||0)}function Rw(r,n,a){return(a?ir(r,n,a):n===t)?n=1:n=je(n),uc(rt(r),n)}function Tw(){var r=arguments,n=rt(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Aw=Tn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function Nw(r,n,a){return a&&typeof a!="number"&&ir(r,n,a)&&(n=a=t),a=a===t?te:a>>>0,a?(r=rt(r),r&&(typeof n=="string"||n!=null&&!Cc(n))&&(n=Er(n),!n&&bn(r))?Ui(Fr(r),0,a):r.split(n,a)):[]}var Cw=Tn(function(r,n,a){return r+(a?" ":"")+Uc(n)});function Dw(r,n,a){return r=rt(r),a=a==null?0:Qi(je(a),0,r.length),n=Er(n),r.slice(a,a+n.length)==n}function $w(r,n,a){var u=v.templateSettings;a&&ir(r,n,a)&&(n=t),r=rt(r),n=Ho({},n,u,ol);var p=Ho({},n.imports,u.imports,ol),w=Kt(p),S=Va(p,w),D,j,G=0,Y=n.interpolate||dn,ee="__p += '",ce=Ga((n.escape||dn).source+"|"+Y.source+"|"+(Y===_t?_a:dn).source+"|"+(n.evaluate||dn).source+"|$","g"),pe="//# sourceURL="+(it.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ja+"]")+`
`;r.replace(ce,function(_e,We,Xe,Sr,nr,xr){return Xe||(Xe=Sr),ee+=r.slice(G,xr).replace(Pa,ug),We&&(D=!0,ee+=`' +
__e(`+We+`) +
'`),nr&&(j=!0,ee+=`';
`+nr+`;
__p += '`),Xe&&(ee+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),G=xr+_e.length,_e}),ee+=`';
`;var we=it.call(n,"variable")&&n.variable;if(!we)ee=`with (obj) {
`+ee+`
}
`;else if(ma.test(we))throw new Te(f);ee=(j?ee.replace(Yr,""):ee).replace(er,"$1").replace(si,"$1;"),ee="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(D?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ee+`return __p
}`;var ze=Xl(function(){return tt(w,pe+"return "+ee).apply(t,S)});if(ze.source=ee,Nc(ze))throw ze;return ze}function Uw(r){return rt(r).toLowerCase()}function Lw(r){return rt(r).toUpperCase()}function Mw(r,n,a){if(r=rt(r),r&&(a||n===t))return ah(r);if(!r||!(n=Er(n)))return r;var u=Fr(r),p=Fr(n),w=ch(u,p),S=uh(u,p)+1;return Ui(u,w,S).join("")}function jw(r,n,a){if(r=rt(r),r&&(a||n===t))return r.slice(0,lh(r)+1);if(!r||!(n=Er(n)))return r;var u=Fr(r),p=uh(u,Fr(n))+1;return Ui(u,0,p).join("")}function qw(r,n,a){if(r=rt(r),r&&(a||n===t))return r.replace(Pt,"");if(!r||!(n=Er(n)))return r;var u=Fr(r),p=ch(u,Fr(n));return Ui(u,p).join("")}function Hw(r,n){var a=ne,u=ue;if(bt(n)){var p="separator"in n?n.separator:p;a="length"in n?je(n.length):a,u="omission"in n?Er(n.omission):u}r=rt(r);var w=r.length;if(bn(r)){var S=Fr(r);w=S.length}if(a>=w)return r;var D=a-En(u);if(D<1)return u;var j=S?Ui(S,0,D).join(""):r.slice(0,D);if(p===t)return j+u;if(S&&(D+=j.length-D),Cc(p)){if(r.slice(D).search(p)){var G,Y=j;for(p.global||(p=Ga(p.source,rt(Tr.exec(p))+"g")),p.lastIndex=0;G=p.exec(Y);)var ee=G.index;j=j.slice(0,ee===t?D:ee)}}else if(r.indexOf(Er(p),D)!=D){var ce=j.lastIndexOf(p);ce>-1&&(j=j.slice(0,ce))}return j+u}function zw(r){return r=rt(r),r&&Et.test(r)?r.replace(Pi,yg):r}var Fw=Tn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Uc=Zh("toUpperCase");function Ql(r,n,a){return r=rt(r),n=a?t:n,n===t?lg(r)?wg(r):rg(r):r.match(n)||[]}var Xl=Ke(function(r,n){try{return Bt(r,t,n)}catch(a){return Nc(a)?a:new Te(a)}}),Bw=fi(function(r,n){return Nr(n,function(a){a=ei(a),hi(r,a,Tc(r[a],r))}),r});function Kw(r){var n=r==null?0:r.length,a=me();return r=n?vt(r,function(u){if(typeof u[1]!="function")throw new Cr(d);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var p=-1;++p<n;){var w=r[p];if(Bt(w[0],this,u))return Bt(w[1],this,u)}})}function kw(r){return y0($r(r,_))}function Lc(r){return function(){return r}}function Vw(r,n){return r==null||r!==r?n:r}var Ww=tl(),Gw=tl(!0);function dr(r){return r}function Mc(r){return Nh(typeof r=="function"?r:$r(r,_))}function Yw(r){return Dh($r(r,_))}function Jw(r,n){return $h(r,$r(n,_))}var Qw=Ke(function(r,n){return function(a){return ss(a,r,n)}}),Xw=Ke(function(r,n){return function(a){return ss(r,a,n)}});function jc(r,n,a){var u=Kt(n),p=bo(n,u);a==null&&!(bt(n)&&(p.length||!u.length))&&(a=n,n=r,r=this,p=bo(n,Kt(n)));var w=!(bt(a)&&"chain"in a)||!!a.chain,S=pi(r);return Nr(p,function(D){var j=n[D];r[D]=j,S&&(r.prototype[D]=function(){var G=this.__chain__;if(w||G){var Y=r(this.__wrapped__),ee=Y.__actions__=hr(this.__actions__);return ee.push({func:j,args:arguments,thisArg:r}),Y.__chain__=G,Y}return j.apply(r,Ti([this.value()],arguments))})}),r}function Zw(){return Qe._===this&&(Qe._=xg),this}function qc(){}function e_(r){return r=je(r),Ke(function(n){return Uh(n,r)})}var t_=yc(vt),r_=yc(rh),i_=yc(za);function Zl(r){return Ic(r)?Fa(ei(r)):D0(r)}function n_(r){return function(n){return r==null?t:Xi(r,n)}}var s_=il(),o_=il(!0);function Hc(){return[]}function zc(){return!1}function a_(){return{}}function c_(){return""}function u_(){return!0}function h_(r,n){if(r=je(r),r<1||r>B)return[];var a=te,u=Yt(r,te);n=me(n),r-=te;for(var p=ka(u,n);++a<r;)n(a);return p}function l_(r){return Ce(r)?vt(r,ei):Ir(r)?[r]:hr(wl(rt(r)))}function f_(r){var n=++Ig;return rt(r)+n}var d_=Oo(function(r,n){return r+n},0),p_=vc("ceil"),g_=Oo(function(r,n){return r/n},1),y_=vc("floor");function v_(r){return r&&r.length?_o(r,dr,rc):t}function m_(r,n){return r&&r.length?_o(r,me(n,2),rc):t}function w_(r){return sh(r,dr)}function __(r,n){return sh(r,me(n,2))}function b_(r){return r&&r.length?_o(r,dr,oc):t}function E_(r,n){return r&&r.length?_o(r,me(n,2),oc):t}var I_=Oo(function(r,n){return r*n},1),S_=vc("round"),x_=Oo(function(r,n){return r-n},0);function P_(r){return r&&r.length?Ka(r,dr):0}function O_(r,n){return r&&r.length?Ka(r,me(n,2)):0}return v.after=Yv,v.ary=Al,v.assign=Lm,v.assignIn=Kl,v.assignInWith=Ho,v.assignWith=Mm,v.at=jm,v.before=Nl,v.bind=Tc,v.bindAll=Bw,v.bindKey=Cl,v.castArray=am,v.chain=Ol,v.chunk=yy,v.compact=vy,v.concat=my,v.cond=Kw,v.conforms=kw,v.constant=Lc,v.countBy=Pv,v.create=qm,v.curry=Dl,v.curryRight=$l,v.debounce=Ul,v.defaults=Hm,v.defaultsDeep=zm,v.defer=Jv,v.delay=Qv,v.difference=wy,v.differenceBy=_y,v.differenceWith=by,v.drop=Ey,v.dropRight=Iy,v.dropRightWhile=Sy,v.dropWhile=xy,v.fill=Py,v.filter=Rv,v.flatMap=Nv,v.flatMapDeep=Cv,v.flatMapDepth=Dv,v.flatten=Il,v.flattenDeep=Oy,v.flattenDepth=Ry,v.flip=Xv,v.flow=Ww,v.flowRight=Gw,v.fromPairs=Ty,v.functions=Gm,v.functionsIn=Ym,v.groupBy=$v,v.initial=Ny,v.intersection=Cy,v.intersectionBy=Dy,v.intersectionWith=$y,v.invert=Qm,v.invertBy=Xm,v.invokeMap=Lv,v.iteratee=Mc,v.keyBy=Mv,v.keys=Kt,v.keysIn=fr,v.map=$o,v.mapKeys=ew,v.mapValues=tw,v.matches=Yw,v.matchesProperty=Jw,v.memoize=Lo,v.merge=rw,v.mergeWith=kl,v.method=Qw,v.methodOf=Xw,v.mixin=jc,v.negate=Mo,v.nthArg=e_,v.omit=iw,v.omitBy=nw,v.once=Zv,v.orderBy=jv,v.over=t_,v.overArgs=em,v.overEvery=r_,v.overSome=i_,v.partial=Ac,v.partialRight=Ll,v.partition=qv,v.pick=sw,v.pickBy=Vl,v.property=Zl,v.propertyOf=n_,v.pull=jy,v.pullAll=xl,v.pullAllBy=qy,v.pullAllWith=Hy,v.pullAt=zy,v.range=s_,v.rangeRight=o_,v.rearg=tm,v.reject=Fv,v.remove=Fy,v.rest=rm,v.reverse=Oc,v.sampleSize=Kv,v.set=aw,v.setWith=cw,v.shuffle=kv,v.slice=By,v.sortBy=Gv,v.sortedUniq=Jy,v.sortedUniqBy=Qy,v.split=Nw,v.spread=im,v.tail=Xy,v.take=Zy,v.takeRight=ev,v.takeRightWhile=tv,v.takeWhile=rv,v.tap=vv,v.throttle=nm,v.thru=Do,v.toArray=zl,v.toPairs=Wl,v.toPairsIn=Gl,v.toPath=l_,v.toPlainObject=Bl,v.transform=uw,v.unary=sm,v.union=iv,v.unionBy=nv,v.unionWith=sv,v.uniq=ov,v.uniqBy=av,v.uniqWith=cv,v.unset=hw,v.unzip=Rc,v.unzipWith=Pl,v.update=lw,v.updateWith=fw,v.values=Cn,v.valuesIn=dw,v.without=uv,v.words=Ql,v.wrap=om,v.xor=hv,v.xorBy=lv,v.xorWith=fv,v.zip=dv,v.zipObject=pv,v.zipObjectDeep=gv,v.zipWith=yv,v.entries=Wl,v.entriesIn=Gl,v.extend=Kl,v.extendWith=Ho,jc(v,v),v.add=d_,v.attempt=Xl,v.camelCase=vw,v.capitalize=Yl,v.ceil=p_,v.clamp=pw,v.clone=cm,v.cloneDeep=hm,v.cloneDeepWith=lm,v.cloneWith=um,v.conformsTo=fm,v.deburr=Jl,v.defaultTo=Vw,v.divide=g_,v.endsWith=mw,v.eq=Kr,v.escape=ww,v.escapeRegExp=_w,v.every=Ov,v.find=Tv,v.findIndex=bl,v.findKey=Fm,v.findLast=Av,v.findLastIndex=El,v.findLastKey=Bm,v.floor=y_,v.forEach=Rl,v.forEachRight=Tl,v.forIn=Km,v.forInRight=km,v.forOwn=Vm,v.forOwnRight=Wm,v.get=Dc,v.gt=dm,v.gte=pm,v.has=Jm,v.hasIn=$c,v.head=Sl,v.identity=dr,v.includes=Uv,v.indexOf=Ay,v.inRange=gw,v.invoke=Zm,v.isArguments=tn,v.isArray=Ce,v.isArrayBuffer=gm,v.isArrayLike=lr,v.isArrayLikeObject=Nt,v.isBoolean=ym,v.isBuffer=Li,v.isDate=vm,v.isElement=mm,v.isEmpty=wm,v.isEqual=_m,v.isEqualWith=bm,v.isError=Nc,v.isFinite=Em,v.isFunction=pi,v.isInteger=Ml,v.isLength=jo,v.isMap=jl,v.isMatch=Im,v.isMatchWith=Sm,v.isNaN=xm,v.isNative=Pm,v.isNil=Rm,v.isNull=Om,v.isNumber=ql,v.isObject=bt,v.isObjectLike=Rt,v.isPlainObject=ls,v.isRegExp=Cc,v.isSafeInteger=Tm,v.isSet=Hl,v.isString=qo,v.isSymbol=Ir,v.isTypedArray=Nn,v.isUndefined=Am,v.isWeakMap=Nm,v.isWeakSet=Cm,v.join=Uy,v.kebabCase=bw,v.last=Lr,v.lastIndexOf=Ly,v.lowerCase=Ew,v.lowerFirst=Iw,v.lt=Dm,v.lte=$m,v.max=v_,v.maxBy=m_,v.mean=w_,v.meanBy=__,v.min=b_,v.minBy=E_,v.stubArray=Hc,v.stubFalse=zc,v.stubObject=a_,v.stubString=c_,v.stubTrue=u_,v.multiply=I_,v.nth=My,v.noConflict=Zw,v.noop=qc,v.now=Uo,v.pad=Sw,v.padEnd=xw,v.padStart=Pw,v.parseInt=Ow,v.random=yw,v.reduce=Hv,v.reduceRight=zv,v.repeat=Rw,v.replace=Tw,v.result=ow,v.round=S_,v.runInContext=M,v.sample=Bv,v.size=Vv,v.snakeCase=Aw,v.some=Wv,v.sortedIndex=Ky,v.sortedIndexBy=ky,v.sortedIndexOf=Vy,v.sortedLastIndex=Wy,v.sortedLastIndexBy=Gy,v.sortedLastIndexOf=Yy,v.startCase=Cw,v.startsWith=Dw,v.subtract=x_,v.sum=P_,v.sumBy=O_,v.template=$w,v.times=h_,v.toFinite=gi,v.toInteger=je,v.toLength=Fl,v.toLower=Uw,v.toNumber=Mr,v.toSafeInteger=Um,v.toString=rt,v.toUpper=Lw,v.trim=Mw,v.trimEnd=jw,v.trimStart=qw,v.truncate=Hw,v.unescape=zw,v.uniqueId=f_,v.upperCase=Fw,v.upperFirst=Uc,v.each=Rl,v.eachRight=Tl,v.first=Sl,jc(v,function(){var r={};return Xr(v,function(n,a){it.call(v.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),v.VERSION=s,Nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),Nr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Ft(je(a),0);var u=this.__filtered__&&!n?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Yt(a,u.__takeCount__):u.__views__.push({size:Yt(a,te),type:r+(u.__dir__<0?"Right":"")}),u},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Nr(["filter","map","takeWhile"],function(r,n){var a=n+1,u=a==E||a==X;Ye.prototype[r]=function(p){var w=this.clone();return w.__iteratees__.push({iteratee:me(p,3),type:a}),w.__filtered__=w.__filtered__||u,w}}),Nr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Nr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(dr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return ss(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(Mo(me(r)))},Ye.prototype.slice=function(r,n){r=je(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=je(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(te)},Xr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),p=v[u?"take"+(n=="last"?"Right":""):n],w=u||/^find/.test(n);p&&(v.prototype[n]=function(){var S=this.__wrapped__,D=u?[1]:arguments,j=S instanceof Ye,G=D[0],Y=j||Ce(S),ee=function(We){var Xe=p.apply(v,Ti([We],D));return u&&ce?Xe[0]:Xe};Y&&a&&typeof G=="function"&&G.length!=1&&(j=Y=!1);var ce=this.__chain__,pe=!!this.__actions__.length,we=w&&!ce,ze=j&&!pe;if(!w&&Y){S=ze?S:new Ye(this);var _e=r.apply(S,D);return _e.__actions__.push({func:Do,args:[ee],thisArg:t}),new Dr(_e,ce)}return we&&ze?r.apply(this,D):(_e=this.thru(ee),we?u?_e.value()[0]:_e.value():_e)})}),Nr(["pop","push","shift","sort","splice","unshift"],function(r){var n=no[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var p=arguments;if(u&&!this.__chain__){var w=this.value();return n.apply(Ce(w)?w:[],p)}return this[a](function(S){return n.apply(Ce(S)?S:[],p)})}}),Xr(Ye.prototype,function(r,n){var a=v[n];if(a){var u=a.name+"";it.call(Pn,u)||(Pn[u]=[]),Pn[u].push({name:n,func:a})}}),Pn[Po(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=zg,Ye.prototype.reverse=Fg,Ye.prototype.value=Bg,v.prototype.at=mv,v.prototype.chain=wv,v.prototype.commit=_v,v.prototype.next=bv,v.prototype.plant=Iv,v.prototype.reverse=Sv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=xv,v.prototype.first=v.prototype.head,Xn&&(v.prototype[Xn]=Ev),v},In=_g();At?((At.exports=In)._=In,at._=In):Qe._=In}).call(ms)})(Au,Au.exports);var W5=Object.defineProperty,G5=Object.defineProperties,Y5=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,J5=Object.prototype.hasOwnProperty,Q5=Object.prototype.propertyIsEnumerable,Ad=(i,e,t)=>e in i?W5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Vo=(i,e)=>{for(var t in e||(e={}))J5.call(e,t)&&Ad(i,t,e[t]);if(Td)for(var t of Td(e))Q5.call(e,t)&&Ad(i,t,e[t]);return i},X5=(i,e)=>G5(i,Y5(e));function qi(i,e,t){var s;const o=Sb(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${V5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function fn(i){return i.includes(":")?i.split(":")[1]:i}function Yp(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Z5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Nd(i={},e={}){const t=Cd(i),s=Cd(e);return Au.exports.merge(t,s)}function Cd(i){var e,t,s,o;const c={};if(!Ps(i))return c;for(const[d,f]of Object.entries(i)){const y=ku(d)?[d]:f.chains,g=f.methods||[],m=f.events||[],_=f.rpcMap||{},x=ws(d);c[x]=X5(Vo(Vo({},c[x]),f),{chains:Wc(y,(e=c[x])==null?void 0:e.chains),methods:Wc(g,(t=c[x])==null?void 0:t.methods),events:Wc(m,(s=c[x])==null?void 0:s.events),rpcMap:Vo(Vo({},_),(o=c[x])==null?void 0:o.rpcMap)})}return c}function ex(i){return i.includes(":")?i.split(":")[2]:i}function tx(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],d=s.accounts||[],f=ku(t)?[t]:s.chains?s.chains:Yp(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:d}}return e}function ou(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const Jp={},wt=i=>Jp[i],au=(i,e)=>{Jp[i]=e};class rx{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class ix{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||qi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(fn(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class nx{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class sx{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class ox{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=fn(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class ax{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class cx{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,wt("disableProviderPing")))}}class ux{constructor(e){this.name="near",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||qi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace);return typeof s>"u"?void 0:new Si(new zi(s,wt("disableProviderPing")))}}var hx=Object.defineProperty,lx=Object.defineProperties,fx=Object.getOwnPropertyDescriptors,Dd=Object.getOwnPropertySymbols,dx=Object.prototype.hasOwnProperty,px=Object.prototype.propertyIsEnumerable,$d=(i,e,t)=>e in i?hx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Wo=(i,e)=>{for(var t in e||(e={}))dx.call(e,t)&&$d(i,t,e[t]);if(Dd)for(var t of Dd(e))px.call(e,t)&&$d(i,t,e[t]);return i},cu=(i,e)=>lx(i,fx(e));class eh{constructor(e){this.events=new $u,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:la(fa({level:(e==null?void 0:e.logger)||Od})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new eh(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Wo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(d=>t(null,da(c,d))).catch(d=>t(d,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:mt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const d=tx(c.namespaces);this.namespaces=Nd(this.namespaces,d),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==Wp)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ni(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await q5.init({logger:this.providerOpts.logger||Od,relayUrl:this.providerOpts.relayUrl||B5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ws(t)))];au("client",this.client),au("events",this.events),au("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=Z5(t,this.session),o=Yp(s),c=Nd(this.namespaces,this.optionalNamespaces),d=cu(Wo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new ix({namespace:d});break;case"solana":this.rpcProviders[t]=new nx({namespace:d});break;case"cosmos":this.rpcProviders[t]=new sx({namespace:d});break;case"polkadot":this.rpcProviders[t]=new rx({namespace:d});break;case"cip34":this.rpcProviders[t]=new ox({namespace:d});break;case"elrond":this.rpcProviders[t]=new ax({namespace:d});break;case"multiversx":this.rpcProviders[t]=new cx({namespace:d});break;case"near":this.rpcProviders[t]=new ux({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ni(o)&&this.events.emit("accountsChanged",o.map(ex))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,d=ws(o),f=ou(o)!==ou(c)?`${d}:${ou(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=cu(Wo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cu(Wo({},mt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(d=>ws(d)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=ws(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Rd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Rd}/${e}`)}}const gx=eh,yx="wc",vx="ethereum_provider",mx=`${yx}@2:${vx}:`,wx="https://rpc.walletconnect.com/v1/",Nu=["eth_sendTransaction","personal_sign"],_x=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Cu=["chainChanged","accountsChanged"],bx=["chainChanged","accountsChanged","message","disconnect","connect"];var Ex=Object.defineProperty,Ix=Object.defineProperties,Sx=Object.getOwnPropertyDescriptors,Ud=Object.getOwnPropertySymbols,xx=Object.prototype.hasOwnProperty,Px=Object.prototype.propertyIsEnumerable,Ld=(i,e,t)=>e in i?Ex(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,bs=(i,e)=>{for(var t in e||(e={}))xx.call(e,t)&&Ld(i,t,e[t]);if(Ud)for(var t of Ud(e))Px.call(e,t)&&Ld(i,t,e[t]);return i},Md=(i,e)=>Ix(i,Sx(e));function ia(i){return Number(i[0].split(":")[1])}function uu(i){return`0x${i.toString(16)}`}function Ox(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:d,rpcMap:f}=i;if(!ni(e))throw new Error("Invalid chains");const y={chains:e,methods:s||Nu,events:c||Cu,rpcMap:bs({},e.length?{[ia(e)]:f[ia(e)]}:{})},g=c==null?void 0:c.filter(P=>!Cu.includes(P)),m=s==null?void 0:s.filter(P=>!Nu.includes(P));if(!t&&!d&&!o&&!(g!=null&&g.length)&&!(m!=null&&m.length))return{required:e.length?y:void 0};const _=(g==null?void 0:g.length)&&(m==null?void 0:m.length)||!t,x={chains:[...new Set(_?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:_x))],events:[...new Set(y.events.concat(d!=null&&d.length?d:bx))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?x:void 0}}class th{constructor(){this.events=new qr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=mx,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new th;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=Ox(this.rpc);try{const o=await new Promise(async(d,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Md(bs({namespaces:bs({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{d(g)}).catch(g=>{f(new Error(g.message))})});if(!o)return;const c=xb(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:uu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",uu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Md(bs({},mt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",uu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],d=o.concat(c);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Nu:[],y=o.length?(e==null?void 0:e.events)||Cu:[],g=(e==null?void 0:e.optionalMethods)||[],m=(e==null?void 0:e.optionalEvents)||[],_=(e==null?void 0:e.rpcMap)||this.buildRpcMap(d,e.projectId),x=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(P=>this.formatChainId(P)),optionalChains:c.map(P=>this.formatChainId(P)),methods:f,events:y,optionalMethods:g,optionalEvents:m,rpcMap:_,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:x,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ia(this.rpc.chains):ia(this.rpc.optionalChains),this.signer=await gx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await R_(()=>import("./chunk-DOlFtnKY.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(bs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&ni(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ni(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${wx}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Gx=th;export{Gx as EthereumProvider,bx as OPTIONAL_EVENTS,_x as OPTIONAL_METHODS,Cu as REQUIRED_EVENTS,Nu as REQUIRED_METHODS,th as default};
