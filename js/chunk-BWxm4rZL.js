import{b6 as Eu,b5 as Gr,S as Iu,bg as dw}from"./chunk-DP0Z30vw.js";import{e as qr,U as Su}from"./chunk-C7SamJ7R.js";import{a as pw,f as _r,t as hr,c as eu}from"./chunk-C5nkJ5Sq.js";import{r as gw}from"./chunk-BfSifOQd.js";var xu={},Xo={},Ue={},Pd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,y){var g=f>>>16&65535,m=f&65535,I=y>>>16&65535,x=y&65535;return m*x+(g*x+m*I<<16>>>0)|0}n.mul=Math.imul||e;function r(f,y){return f+y|0}n.add=r;function s(f,y){return f-y|0}n.sub=s;function o(f,y){return f<<y|f>>>32-y}n.rotl=o;function c(f,y){return f<<32-y|f>>>y}n.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||d,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(Pd);Object.defineProperty(Ue,"__esModule",{value:!0});var Td=Pd;function yw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Ue.readInt16BE=yw;function vw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Ue.readUint16BE=vw;function mw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Ue.readInt16LE=mw;function _w(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Ue.readUint16LE=_w;function Rd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>8,e[r+1]=n>>>0,e}Ue.writeUint16BE=Rd;Ue.writeInt16BE=Rd;function Nd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e}Ue.writeUint16LE=Nd;Ue.writeInt16LE=Nd;function tu(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Ue.readInt32BE=tu;function ru(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Ue.readUint32BE=ru;function iu(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Ue.readInt32LE=iu;function nu(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Ue.readUint32LE=nu;function ko(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>24,e[r+1]=n>>>16,e[r+2]=n>>>8,e[r+3]=n>>>0,e}Ue.writeUint32BE=ko;Ue.writeInt32BE=ko;function Vo(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e[r+2]=n>>>16,e[r+3]=n>>>24,e}Ue.writeUint32LE=Vo;Ue.writeInt32LE=Vo;function ww(n,e){e===void 0&&(e=0);var r=tu(n,e),s=tu(n,e+4);return r*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=ww;function bw(n,e){e===void 0&&(e=0);var r=ru(n,e),s=ru(n,e+4);return r*4294967296+s}Ue.readUint64BE=bw;function Ew(n,e){e===void 0&&(e=0);var r=iu(n,e),s=iu(n,e+4);return s*4294967296+r-(r>>31)*4294967296}Ue.readInt64LE=Ew;function Iw(n,e){e===void 0&&(e=0);var r=nu(n,e),s=nu(n,e+4);return s*4294967296+r}Ue.readUint64LE=Iw;function Ad(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ko(n/4294967296>>>0,e,r),ko(n>>>0,e,r+4),e}Ue.writeUint64BE=Ad;Ue.writeInt64BE=Ad;function Cd(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Vo(n>>>0,e,r),Vo(n/4294967296>>>0,e,r+4),e}Ue.writeUint64LE=Cd;Ue.writeInt64LE=Cd;function Sw(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=n/8+r-1;c>=r;c--)s+=e[c]*o,o*=256;return s}Ue.readUintBE=Sw;function xw(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=r;c<r+n/8;c++)s+=e[c]*o,o*=256;return s}Ue.readUintLE=xw;function Ow(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Td.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=n/8+s-1;c>=s;c--)r[c]=e/o&255,o*=256;return r}Ue.writeUintBE=Ow;function Pw(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Td.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+n/8;c++)r[c]=e/o&255,o*=256;return r}Ue.writeUintLE=Pw;function Tw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e)}Ue.readFloat32BE=Tw;function Rw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e,!0)}Ue.readFloat32LE=Rw;function Nw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e)}Ue.readFloat64BE=Nw;function Aw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e,!0)}Ue.readFloat64LE=Aw;function Cw(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n),e}Ue.writeFloat32BE=Cw;function Dw(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n,!0),e}Ue.writeFloat32LE=Dw;function Lw(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n),e}Ue.writeFloat64BE=Lw;function $w(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n,!0),e}Ue.writeFloat64LE=$w;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});function Uw(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Tr.wipe=Uw;Object.defineProperty(Xo,"__esModule",{value:!0});var Xt=Ue,su=Tr,Mw=20;function jw(n,e,r){for(var s=1634760805,o=857760878,c=2036477234,d=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],g=r[11]<<24|r[10]<<16|r[9]<<8|r[8],m=r[15]<<24|r[14]<<16|r[13]<<8|r[12],I=r[19]<<24|r[18]<<16|r[17]<<8|r[16],x=r[23]<<24|r[22]<<16|r[21]<<8|r[20],T=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],F=e[3]<<24|e[2]<<16|e[1]<<8|e[0],k=e[7]<<24|e[6]<<16|e[5]<<8|e[4],se=e[11]<<24|e[10]<<16|e[9]<<8|e[8],L=e[15]<<24|e[14]<<16|e[13]<<8|e[12],q=s,R=o,A=c,E=d,u=f,b=y,Y=g,W=m,ne=I,ue=x,de=T,w=D,P=F,ee=k,Q=se,K=L,V=0;V<Mw;V+=2)q=q+u|0,P^=q,P=P>>>16|P<<16,ne=ne+P|0,u^=ne,u=u>>>20|u<<12,R=R+b|0,ee^=R,ee=ee>>>16|ee<<16,ue=ue+ee|0,b^=ue,b=b>>>20|b<<12,A=A+Y|0,Q^=A,Q=Q>>>16|Q<<16,de=de+Q|0,Y^=de,Y=Y>>>20|Y<<12,E=E+W|0,K^=E,K=K>>>16|K<<16,w=w+K|0,W^=w,W=W>>>20|W<<12,A=A+Y|0,Q^=A,Q=Q>>>24|Q<<8,de=de+Q|0,Y^=de,Y=Y>>>25|Y<<7,E=E+W|0,K^=E,K=K>>>24|K<<8,w=w+K|0,W^=w,W=W>>>25|W<<7,R=R+b|0,ee^=R,ee=ee>>>24|ee<<8,ue=ue+ee|0,b^=ue,b=b>>>25|b<<7,q=q+u|0,P^=q,P=P>>>24|P<<8,ne=ne+P|0,u^=ne,u=u>>>25|u<<7,q=q+b|0,K^=q,K=K>>>16|K<<16,de=de+K|0,b^=de,b=b>>>20|b<<12,R=R+Y|0,P^=R,P=P>>>16|P<<16,w=w+P|0,Y^=w,Y=Y>>>20|Y<<12,A=A+W|0,ee^=A,ee=ee>>>16|ee<<16,ne=ne+ee|0,W^=ne,W=W>>>20|W<<12,E=E+u|0,Q^=E,Q=Q>>>16|Q<<16,ue=ue+Q|0,u^=ue,u=u>>>20|u<<12,A=A+W|0,ee^=A,ee=ee>>>24|ee<<8,ne=ne+ee|0,W^=ne,W=W>>>25|W<<7,E=E+u|0,Q^=E,Q=Q>>>24|Q<<8,ue=ue+Q|0,u^=ue,u=u>>>25|u<<7,R=R+Y|0,P^=R,P=P>>>24|P<<8,w=w+P|0,Y^=w,Y=Y>>>25|Y<<7,q=q+b|0,K^=q,K=K>>>24|K<<8,de=de+K|0,b^=de,b=b>>>25|b<<7;Xt.writeUint32LE(q+s|0,n,0),Xt.writeUint32LE(R+o|0,n,4),Xt.writeUint32LE(A+c|0,n,8),Xt.writeUint32LE(E+d|0,n,12),Xt.writeUint32LE(u+f|0,n,16),Xt.writeUint32LE(b+y|0,n,20),Xt.writeUint32LE(Y+g|0,n,24),Xt.writeUint32LE(W+m|0,n,28),Xt.writeUint32LE(ne+I|0,n,32),Xt.writeUint32LE(ue+x|0,n,36),Xt.writeUint32LE(de+T|0,n,40),Xt.writeUint32LE(w+D|0,n,44),Xt.writeUint32LE(P+F|0,n,48),Xt.writeUint32LE(ee+k|0,n,52),Xt.writeUint32LE(Q+se|0,n,56),Xt.writeUint32LE(K+L|0,n,60)}function Dd(n,e,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-e.length,c.set(e,d)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,d=o}for(var f=new Uint8Array(64),y=0;y<r.length;y+=64){jw(f,c,n);for(var g=y;g<y+64&&g<r.length;g++)s[g]=r[g]^f[g-y];Hw(c,0,d)}return su.wipe(f),o===0&&su.wipe(c),s}Xo.streamXOR=Dd;function qw(n,e,r,s){return s===void 0&&(s=0),su.wipe(r),Dd(n,e,r,r,s)}Xo.stream=qw;function Hw(n,e,r){for(var s=1;r--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Ld={},qi={};Object.defineProperty(qi,"__esModule",{value:!0});function zw(n,e,r){return~(n-1)&e|n-1&r}qi.select=zw;function Fw(n,e){return(n|0)-(e|0)-1>>>31&1}qi.lessOrEqual=Fw;function $d(n,e){if(n.length!==e.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^e[s];return 1&r-1>>>8}qi.compare=$d;function Bw(n,e){return n.length===0||e.length===0?!1:$d(n,e)!==0}qi.equal=Bw;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=qi,r=Tr;n.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var g=f[2]|f[3]<<8;this._r[1]=(y>>>13|g<<3)&8191;var m=f[4]|f[5]<<8;this._r[2]=(g>>>10|m<<6)&7939;var I=f[6]|f[7]<<8;this._r[3]=(m>>>7|I<<9)&8191;var x=f[8]|f[9]<<8;this._r[4]=(I>>>4|x<<12)&255,this._r[5]=x>>>1&8190;var T=f[10]|f[11]<<8;this._r[6]=(x>>>14|T<<2)&8191;var D=f[12]|f[13]<<8;this._r[7]=(T>>>11|D<<5)&8065;var F=f[14]|f[15]<<8;this._r[8]=(D>>>8|F<<8)&8191,this._r[9]=F>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,y,g){for(var m=this._fin?0:2048,I=this._h[0],x=this._h[1],T=this._h[2],D=this._h[3],F=this._h[4],k=this._h[5],se=this._h[6],L=this._h[7],q=this._h[8],R=this._h[9],A=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],Y=this._r[4],W=this._r[5],ne=this._r[6],ue=this._r[7],de=this._r[8],w=this._r[9];g>=16;){var P=f[y+0]|f[y+1]<<8;I+=P&8191;var ee=f[y+2]|f[y+3]<<8;x+=(P>>>13|ee<<3)&8191;var Q=f[y+4]|f[y+5]<<8;T+=(ee>>>10|Q<<6)&8191;var K=f[y+6]|f[y+7]<<8;D+=(Q>>>7|K<<9)&8191;var V=f[y+8]|f[y+9]<<8;F+=(K>>>4|V<<12)&8191,k+=V>>>1&8191;var J=f[y+10]|f[y+11]<<8;se+=(V>>>14|J<<2)&8191;var re=f[y+12]|f[y+13]<<8;L+=(J>>>11|re<<5)&8191;var we=f[y+14]|f[y+15]<<8;q+=(re>>>8|we<<8)&8191,R+=we>>>5|m;var oe=0,be=oe;be+=I*A,be+=x*(5*w),be+=T*(5*de),be+=D*(5*ue),be+=F*(5*ne),oe=be>>>13,be&=8191,be+=k*(5*W),be+=se*(5*Y),be+=L*(5*b),be+=q*(5*u),be+=R*(5*E),oe+=be>>>13,be&=8191;var le=oe;le+=I*E,le+=x*A,le+=T*(5*w),le+=D*(5*de),le+=F*(5*ue),oe=le>>>13,le&=8191,le+=k*(5*ne),le+=se*(5*W),le+=L*(5*Y),le+=q*(5*b),le+=R*(5*u),oe+=le>>>13,le&=8191;var me=oe;me+=I*u,me+=x*E,me+=T*A,me+=D*(5*w),me+=F*(5*de),oe=me>>>13,me&=8191,me+=k*(5*ue),me+=se*(5*ne),me+=L*(5*W),me+=q*(5*Y),me+=R*(5*b),oe+=me>>>13,me&=8191;var z=oe;z+=I*b,z+=x*u,z+=T*E,z+=D*A,z+=F*(5*w),oe=z>>>13,z&=8191,z+=k*(5*de),z+=se*(5*ue),z+=L*(5*ne),z+=q*(5*W),z+=R*(5*Y),oe+=z>>>13,z&=8191;var H=oe;H+=I*Y,H+=x*b,H+=T*u,H+=D*E,H+=F*A,oe=H>>>13,H&=8191,H+=k*(5*w),H+=se*(5*de),H+=L*(5*ue),H+=q*(5*ne),H+=R*(5*W),oe+=H>>>13,H&=8191;var $=oe;$+=I*W,$+=x*Y,$+=T*b,$+=D*u,$+=F*E,oe=$>>>13,$&=8191,$+=k*A,$+=se*(5*w),$+=L*(5*de),$+=q*(5*ue),$+=R*(5*ne),oe+=$>>>13,$&=8191;var l=oe;l+=I*ne,l+=x*W,l+=T*Y,l+=D*b,l+=F*u,oe=l>>>13,l&=8191,l+=k*E,l+=se*A,l+=L*(5*w),l+=q*(5*de),l+=R*(5*ue),oe+=l>>>13,l&=8191;var N=oe;N+=I*ue,N+=x*ne,N+=T*W,N+=D*Y,N+=F*b,oe=N>>>13,N&=8191,N+=k*u,N+=se*E,N+=L*A,N+=q*(5*w),N+=R*(5*de),oe+=N>>>13,N&=8191;var ae=oe;ae+=I*de,ae+=x*ue,ae+=T*ne,ae+=D*W,ae+=F*Y,oe=ae>>>13,ae&=8191,ae+=k*b,ae+=se*u,ae+=L*E,ae+=q*A,ae+=R*(5*w),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=I*w,fe+=x*de,fe+=T*ue,fe+=D*ne,fe+=F*W,oe=fe>>>13,fe&=8191,fe+=k*Y,fe+=se*b,fe+=L*u,fe+=q*E,fe+=R*A,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+be|0,be=oe&8191,oe=oe>>>13,le+=oe,I=be,x=le,T=me,D=z,F=H,k=$,se=l,L=N,q=ae,R=fe,y+=16,g-=16}this._h[0]=I,this._h[1]=x,this._h[2]=T,this._h[3]=D,this._h[4]=F,this._h[5]=k,this._h[6]=se,this._h[7]=L,this._h[8]=q,this._h[9]=R},d.prototype.finish=function(f,y){y===void 0&&(y=0);var g=new Uint16Array(10),m,I,x,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(m=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=m,m=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=m*5,m=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=m,m=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=m,g[0]=this._h[0]+5,m=g[0]>>>13,g[0]&=8191,T=1;T<10;T++)g[T]=this._h[T]+m,m=g[T]>>>13,g[T]&=8191;for(g[9]-=8192,I=(m^1)-1,T=0;T<10;T++)g[T]&=I;for(I=~I,T=0;T<10;T++)this._h[T]=this._h[T]&I|g[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,x=this._h[0]+this._pad[0],this._h[0]=x&65535,T=1;T<8;T++)x=(this._h[T]+this._pad[T]|0)+(x>>>16)|0,this._h[T]=x&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var y=0,g=f.length,m;if(this._leftover){m=16-this._leftover,m>g&&(m=g);for(var I=0;I<m;I++)this._buffer[this._leftover+I]=f[y+I];if(g-=m,y+=m,this._leftover+=m,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(m=g-g%16,this._blocks(f,y,m),y+=m,g-=m),g){for(var I=0;I<g;I++)this._buffer[this._leftover+I]=f[y+I];this._leftover+=g}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();n.Poly1305=s;function o(d,f){var y=new s(d);y.update(f);var g=y.digest();return y.clean(),g}n.oneTimeAuth=o;function c(d,f){return d.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(d,f)}n.equal=c})(Ld);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Xo,r=Ld,s=Tr,o=Ue,c=qi;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function y(g){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,g.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return y.prototype.seal=function(g,m,I,x){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(g,T.length-g.length);var D=new Uint8Array(32);e.stream(this._key,T,D,4);var F=m.length+this.tagLength,k;if(x){if(x.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");k=x}else k=new Uint8Array(F);return e.streamXOR(this._key,T,m,k,4),this._authenticate(k.subarray(k.length-this.tagLength,k.length),D,k.subarray(0,k.length-this.tagLength),I),s.wipe(T),k},y.prototype.open=function(g,m,I,x){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(m.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(g,T.length-g.length);var D=new Uint8Array(32);e.stream(this._key,T,D,4);var F=new Uint8Array(this.tagLength);if(this._authenticate(F,D,m.subarray(0,m.length-this.tagLength),I),!c.equal(F,m.subarray(m.length-this.tagLength,m.length)))return null;var k=m.length-this.tagLength,se;if(x){if(x.length!==k)throw new Error("ChaCha20Poly1305: incorrect destination length");se=x}else se=new Uint8Array(k);return e.streamXOR(this._key,T,m.subarray(0,m.length-this.tagLength),se,4),s.wipe(T),se},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(g,m,I,x){var T=new r.Poly1305(m);x&&(T.update(x),x.length%16>0&&T.update(d.subarray(x.length%16))),T.update(I),I.length%16>0&&T.update(d.subarray(I.length%16));var D=new Uint8Array(8);x&&o.writeUint64LE(x.length,D),T.update(D),o.writeUint64LE(I.length,D),T.update(D);for(var F=T.digest(),k=0;k<F.length;k++)g[k]=F[k];T.clean(),s.wipe(F),s.wipe(D)},y}();n.ChaCha20Poly1305=f})(xu);var Ud={},xs={},Ou={};Object.defineProperty(Ou,"__esModule",{value:!0});function Kw(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Ou.isSerializableHash=Kw;Object.defineProperty(xs,"__esModule",{value:!0});var ti=Ou,kw=qi,Vw=Tr,Md=function(){function n(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ti.isSerializableHash(this._inner)&&ti.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Vw.wipe(s)}return n.prototype.reset=function(){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){ti.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ti.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();xs.HMAC=Md;function Ww(n,e,r){var s=new Md(n,e);s.update(r);var o=s.digest();return s.clean(),o}xs.hmac=Ww;xs.equal=kw.equal;Object.defineProperty(Ud,"__esModule",{value:!0});var Kl=xs,kl=Tr,Gw=function(){function n(e,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Kl.hmac(this._hash,s,r);this._hmac=new Kl.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var r=new Uint8Array(e),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),kl.wipe(this._buffer),kl.wipe(this._counter),this._bufpos=0},n}(),Yw=Ud.HKDF=Gw,qn={},Zo={},ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.BrowserRandomSource=void 0;const Vl=65536;class Jw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let s=0;s<r.length;s+=Vl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Vl)));return r}}ea.BrowserRandomSource=Jw;var ta={};Object.defineProperty(ta,"__esModule",{value:!0});ta.NodeRandomSource=void 0;const Qw=Tr;class Xw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof pw<"u"){const e=gw;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,Qw.wipe)(r),s}}ta.NodeRandomSource=Xw;Object.defineProperty(Zo,"__esModule",{value:!0});Zo.SystemRandomSource=void 0;const Zw=ea,e1=ta;class t1{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Zw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new e1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Zo.SystemRandomSource=t1;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Zo,r=Ue,s=Tr;n.defaultRandomSource=new e.SystemRandomSource;function o(g,m=n.defaultRandomSource){return m.randomBytes(g)}n.randomBytes=o;function c(g=n.defaultRandomSource){const m=o(4,g),I=(0,r.readUint32LE)(m);return(0,s.wipe)(m),I}n.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,m=d,I=n.defaultRandomSource){if(m.length<2)throw new Error("randomString charset is too short");if(m.length>256)throw new Error("randomString charset is too long");let x="";const T=m.length,D=256-256%T;for(;g>0;){const F=o(Math.ceil(g*256/D),I);for(let k=0;k<F.length&&g>0;k++){const se=F[k];se<D&&(x+=m.charAt(se%T),g--)}(0,s.wipe)(F)}return x}n.randomString=f;function y(g,m=d,I=n.defaultRandomSource){const x=Math.ceil(g/(Math.log(m.length)/Math.LN2));return f(x,m,I)}n.randomStringForEntropy=y})(qn);var ra={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,r=Tr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._temp,this._state,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,I=g/536870912|0,x=g<<3,T=g%64<56?64:128;this._buffer[m]=128;for(var D=m+1;D<T-8;D++)this._buffer[D]=0;e.writeUint32BE(I,this._buffer,T-8),e.writeUint32BE(x,this._buffer,T-4),c(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)e.writeUint32BE(this._state[D],y,D*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){r.wipe(y.state),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,g,m,I){for(;I>=64;){for(var x=y[0],T=y[1],D=y[2],F=y[3],k=y[4],se=y[5],L=y[6],q=y[7],R=0;R<16;R++){var A=m+R*4;f[R]=e.readUint32BE(g,A)}for(var R=16;R<64;R++){var E=f[R-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[R-15];var b=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[R]=(u+f[R-7]|0)+(b+f[R-16]|0)}for(var R=0;R<64;R++){var u=(((k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7))+(k&se^~k&L)|0)+(q+(o[R]+f[R]|0)|0)|0,b=((x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10))+(x&T^x&D^T&D)|0;q=L,L=se,se=k,k=F+u|0,F=D,D=T,T=x,x=u+b|0}y[0]+=x,y[1]+=T,y[2]+=D,y[3]+=F,y[4]+=k,y[5]+=se,y[6]+=L,y[7]+=q,m+=64,I-=64}return m}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}n.hash=d})(ra);var Pu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=qn,r=Tr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(R){const A=new Float64Array(16);if(R)for(let E=0;E<R.length;E++)A[E]=R[E];return A}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function d(R){let A=1;for(let E=0;E<16;E++){let u=R[E]+A+65535;A=Math.floor(u/65536),R[E]=u-A*65536}R[0]+=A-1+37*(A-1)}function f(R,A,E){const u=~(E-1);for(let b=0;b<16;b++){const Y=u&(R[b]^A[b]);R[b]^=Y,A[b]^=Y}}function y(R,A){const E=s(),u=s();for(let b=0;b<16;b++)u[b]=A[b];d(u),d(u),d(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const Y=E[15]>>16&1;E[14]&=65535,f(u,E,1-Y)}for(let b=0;b<16;b++)R[2*b]=u[b]&255,R[2*b+1]=u[b]>>8}function g(R,A){for(let E=0;E<16;E++)R[E]=A[2*E]+(A[2*E+1]<<8);R[15]&=32767}function m(R,A,E){for(let u=0;u<16;u++)R[u]=A[u]+E[u]}function I(R,A,E){for(let u=0;u<16;u++)R[u]=A[u]-E[u]}function x(R,A,E){let u,b,Y=0,W=0,ne=0,ue=0,de=0,w=0,P=0,ee=0,Q=0,K=0,V=0,J=0,re=0,we=0,oe=0,be=0,le=0,me=0,z=0,H=0,$=0,l=0,N=0,ae=0,fe=0,xe=0,Fe=0,ke=0,Me=0,pt=0,gt=0,qe=E[0],Oe=E[1],De=E[2],Le=E[3],He=E[4],Te=E[5],$e=E[6],Se=E[7],Re=E[8],Be=E[9],Pe=E[10],Ve=E[11],Ge=E[12],et=E[13],tt=E[14],Qe=E[15];u=A[0],Y+=u*qe,W+=u*Oe,ne+=u*De,ue+=u*Le,de+=u*He,w+=u*Te,P+=u*$e,ee+=u*Se,Q+=u*Re,K+=u*Be,V+=u*Pe,J+=u*Ve,re+=u*Ge,we+=u*et,oe+=u*tt,be+=u*Qe,u=A[1],W+=u*qe,ne+=u*Oe,ue+=u*De,de+=u*Le,w+=u*He,P+=u*Te,ee+=u*$e,Q+=u*Se,K+=u*Re,V+=u*Be,J+=u*Pe,re+=u*Ve,we+=u*Ge,oe+=u*et,be+=u*tt,le+=u*Qe,u=A[2],ne+=u*qe,ue+=u*Oe,de+=u*De,w+=u*Le,P+=u*He,ee+=u*Te,Q+=u*$e,K+=u*Se,V+=u*Re,J+=u*Be,re+=u*Pe,we+=u*Ve,oe+=u*Ge,be+=u*et,le+=u*tt,me+=u*Qe,u=A[3],ue+=u*qe,de+=u*Oe,w+=u*De,P+=u*Le,ee+=u*He,Q+=u*Te,K+=u*$e,V+=u*Se,J+=u*Re,re+=u*Be,we+=u*Pe,oe+=u*Ve,be+=u*Ge,le+=u*et,me+=u*tt,z+=u*Qe,u=A[4],de+=u*qe,w+=u*Oe,P+=u*De,ee+=u*Le,Q+=u*He,K+=u*Te,V+=u*$e,J+=u*Se,re+=u*Re,we+=u*Be,oe+=u*Pe,be+=u*Ve,le+=u*Ge,me+=u*et,z+=u*tt,H+=u*Qe,u=A[5],w+=u*qe,P+=u*Oe,ee+=u*De,Q+=u*Le,K+=u*He,V+=u*Te,J+=u*$e,re+=u*Se,we+=u*Re,oe+=u*Be,be+=u*Pe,le+=u*Ve,me+=u*Ge,z+=u*et,H+=u*tt,$+=u*Qe,u=A[6],P+=u*qe,ee+=u*Oe,Q+=u*De,K+=u*Le,V+=u*He,J+=u*Te,re+=u*$e,we+=u*Se,oe+=u*Re,be+=u*Be,le+=u*Pe,me+=u*Ve,z+=u*Ge,H+=u*et,$+=u*tt,l+=u*Qe,u=A[7],ee+=u*qe,Q+=u*Oe,K+=u*De,V+=u*Le,J+=u*He,re+=u*Te,we+=u*$e,oe+=u*Se,be+=u*Re,le+=u*Be,me+=u*Pe,z+=u*Ve,H+=u*Ge,$+=u*et,l+=u*tt,N+=u*Qe,u=A[8],Q+=u*qe,K+=u*Oe,V+=u*De,J+=u*Le,re+=u*He,we+=u*Te,oe+=u*$e,be+=u*Se,le+=u*Re,me+=u*Be,z+=u*Pe,H+=u*Ve,$+=u*Ge,l+=u*et,N+=u*tt,ae+=u*Qe,u=A[9],K+=u*qe,V+=u*Oe,J+=u*De,re+=u*Le,we+=u*He,oe+=u*Te,be+=u*$e,le+=u*Se,me+=u*Re,z+=u*Be,H+=u*Pe,$+=u*Ve,l+=u*Ge,N+=u*et,ae+=u*tt,fe+=u*Qe,u=A[10],V+=u*qe,J+=u*Oe,re+=u*De,we+=u*Le,oe+=u*He,be+=u*Te,le+=u*$e,me+=u*Se,z+=u*Re,H+=u*Be,$+=u*Pe,l+=u*Ve,N+=u*Ge,ae+=u*et,fe+=u*tt,xe+=u*Qe,u=A[11],J+=u*qe,re+=u*Oe,we+=u*De,oe+=u*Le,be+=u*He,le+=u*Te,me+=u*$e,z+=u*Se,H+=u*Re,$+=u*Be,l+=u*Pe,N+=u*Ve,ae+=u*Ge,fe+=u*et,xe+=u*tt,Fe+=u*Qe,u=A[12],re+=u*qe,we+=u*Oe,oe+=u*De,be+=u*Le,le+=u*He,me+=u*Te,z+=u*$e,H+=u*Se,$+=u*Re,l+=u*Be,N+=u*Pe,ae+=u*Ve,fe+=u*Ge,xe+=u*et,Fe+=u*tt,ke+=u*Qe,u=A[13],we+=u*qe,oe+=u*Oe,be+=u*De,le+=u*Le,me+=u*He,z+=u*Te,H+=u*$e,$+=u*Se,l+=u*Re,N+=u*Be,ae+=u*Pe,fe+=u*Ve,xe+=u*Ge,Fe+=u*et,ke+=u*tt,Me+=u*Qe,u=A[14],oe+=u*qe,be+=u*Oe,le+=u*De,me+=u*Le,z+=u*He,H+=u*Te,$+=u*$e,l+=u*Se,N+=u*Re,ae+=u*Be,fe+=u*Pe,xe+=u*Ve,Fe+=u*Ge,ke+=u*et,Me+=u*tt,pt+=u*Qe,u=A[15],be+=u*qe,le+=u*Oe,me+=u*De,z+=u*Le,H+=u*He,$+=u*Te,l+=u*$e,N+=u*Se,ae+=u*Re,fe+=u*Be,xe+=u*Pe,Fe+=u*Ve,ke+=u*Ge,Me+=u*et,pt+=u*tt,gt+=u*Qe,Y+=38*le,W+=38*me,ne+=38*z,ue+=38*H,de+=38*$,w+=38*l,P+=38*N,ee+=38*ae,Q+=38*fe,K+=38*xe,V+=38*Fe,J+=38*ke,re+=38*Me,we+=38*pt,oe+=38*gt,b=1,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,Y+=b-1+37*(b-1),b=1,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,Y+=b-1+37*(b-1),R[0]=Y,R[1]=W,R[2]=ne,R[3]=ue,R[4]=de,R[5]=w,R[6]=P,R[7]=ee,R[8]=Q,R[9]=K,R[10]=V,R[11]=J,R[12]=re,R[13]=we,R[14]=oe,R[15]=be}function T(R,A){x(R,A,A)}function D(R,A){const E=s();for(let u=0;u<16;u++)E[u]=A[u];for(let u=253;u>=0;u--)T(E,E),u!==2&&u!==4&&x(E,E,A);for(let u=0;u<16;u++)R[u]=E[u]}function F(R,A){const E=new Uint8Array(32),u=new Float64Array(80),b=s(),Y=s(),W=s(),ne=s(),ue=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=R[Q];E[31]=R[31]&127|64,E[0]&=248,g(u,A);for(let Q=0;Q<16;Q++)Y[Q]=u[Q];b[0]=ne[0]=1;for(let Q=254;Q>=0;--Q){const K=E[Q>>>3]>>>(Q&7)&1;f(b,Y,K),f(W,ne,K),m(ue,b,W),I(b,b,W),m(W,Y,ne),I(Y,Y,ne),T(ne,ue),T(de,b),x(b,W,b),x(W,Y,ue),m(ue,b,W),I(b,b,W),T(Y,b),I(W,ne,de),x(b,W,c),m(b,b,ne),x(W,W,b),x(b,ne,de),x(ne,Y,u),T(Y,ue),f(b,Y,K),f(W,ne,K)}for(let Q=0;Q<16;Q++)u[Q+16]=b[Q],u[Q+32]=W[Q],u[Q+48]=Y[Q],u[Q+64]=ne[Q];const w=u.subarray(32),P=u.subarray(16);D(w,w),x(P,P,w);const ee=new Uint8Array(32);return y(ee,P),ee}n.scalarMult=F;function k(R){return F(R,o)}n.scalarMultBase=k;function se(R){if(R.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const A=new Uint8Array(R);return{publicKey:k(A),secretKey:A}}n.generateKeyPairFromSeed=se;function L(R){const A=(0,e.randomBytes)(32,R),E=se(A);return(0,r.wipe)(A),E}n.generateKeyPair=L;function q(R,A,E=!1){if(R.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(A.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=F(R,A);if(E){let b=0;for(let Y=0;Y<u.length;Y++)b|=u[Y];if(b===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=q})(Pu);var Wl=function(n,e,r){if(r||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return n.concat(c||Array.prototype.slice.call(e))},r1=function(){function n(e,r,s){this.name=e,this.version=r,this.os=s,this.type="browser"}return n}(),i1=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),n1=function(){function n(e,r,s,o){this.name=e,this.version=r,this.os=s,this.bot=o,this.type="bot-device"}return n}(),s1=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),o1=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),a1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,c1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Gl=3,u1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",a1]],Yl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function h1(n){return n?Jl(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new o1:typeof navigator<"u"?Jl(navigator.userAgent):d1()}function l1(n){return n!==""&&u1.reduce(function(e,r){var s=r[0],o=r[1];if(e)return e;var c=o.exec(n);return!!c&&[s,c]},!1)}function Jl(n){var e=l1(n);if(!e)return null;var r=e[0],s=e[1];if(r==="searchbot")return new s1;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Gl&&(o=Wl(Wl([],o,!0),p1(Gl-o.length),!0)):o=[];var c=o.join("."),d=f1(n),f=c1.exec(n);return f&&f[1]?new n1(r,c,d,f[1]):new r1(r,c,d)}function f1(n){for(var e=0,r=Yl.length;e<r;e++){var s=Yl[e],o=s[0],c=s[1],d=c.exec(n);if(d)return o}return null}function d1(){var n=typeof process<"u"&&process.version;return n?new i1(process.version.slice(1)):null}function p1(n){for(var e=[],r=0;r<n;r++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ou=function(n,e){return ou=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},ou(n,e)};function g1(n,e){ou(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var au=function(){return au=Object.assign||function(e){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c])}return e},au.apply(this,arguments)};function y1(n,e){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(r[s[o]]=n[s[o]]);return r}function v1(n,e,r,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,r,s);else for(var f=n.length-1;f>=0;f--)(d=n[f])&&(c=(o<3?d(c):o>3?d(e,r,c):d(e,r))||c);return o>3&&c&&Object.defineProperty(e,r,c),c}function m1(n,e){return function(r,s){e(r,s,n)}}function _1(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function w1(n,e,r,s){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(m){try{g(s.next(m))}catch(I){d(I)}}function y(m){try{g(s.throw(m))}catch(I){d(I)}}function g(m){m.done?c(m.value):o(m.value).then(f,y)}g((s=s.apply(n,e||[])).next())})}function b1(n,e){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(m){return y([g,m])}}function y(g){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,o=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=e.call(n,r)}catch(m){g=[6,m],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function E1(n,e,r,s){s===void 0&&(s=r),n[s]=e[r]}function I1(n,e){for(var r in n)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=n[r])}function cu(n){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&n[e],s=0;if(r)return r.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function jd(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var s=r.call(n),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(d)throw d.error}}return c}function S1(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(jd(arguments[e]));return n}function x1(){for(var n=0,e=0,r=arguments.length;e<r;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<r;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function bs(n){return this instanceof bs?(this.v=n,this):new bs(n)}function O1(n,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(n,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(x){s[x]&&(o[x]=function(T){return new Promise(function(D,F){c.push([x,T,D,F])>1||f(x,T)})})}function f(x,T){try{y(s[x](T))}catch(D){I(c[0][3],D)}}function y(x){x.value instanceof bs?Promise.resolve(x.value.v).then(g,m):I(c[0][2],x)}function g(x){f("next",x)}function m(x){f("throw",x)}function I(x,T){x(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function P1(n){var e,r;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(d){return(r=!r)?{value:bs(n[o](d)),done:o==="return"}:c?c(d):d}:c}}function T1(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],r;return e?e.call(n):(n=typeof cu=="function"?cu(n):n[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(c){r[c]=n[c]&&function(d){return new Promise(function(f,y){d=n[c](d),o(f,y,d.done,d.value)})}}function o(c,d,f,y){Promise.resolve(y).then(function(g){c({value:g,done:f})},d)}}function R1(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function N1(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var r in n)Object.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e.default=n,e}function A1(n){return n&&n.__esModule?n:{default:n}}function C1(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function D1(n,e,r){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,r),r}const L1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return au},__asyncDelegator:P1,__asyncGenerator:O1,__asyncValues:T1,__await:bs,__awaiter:w1,__classPrivateFieldGet:C1,__classPrivateFieldSet:D1,__createBinding:E1,__decorate:v1,__exportStar:I1,__extends:g1,__generator:b1,__importDefault:A1,__importStar:N1,__makeTemplateObject:R1,__metadata:_1,__param:m1,__read:jd,__rest:y1,__spread:S1,__spreadArrays:x1,__values:cu},Symbol.toStringTag,{value:"Module"})),ni=Eu(L1);var Cc={},hs={},Ql;function $1(){if(Ql)return hs;Ql=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.delay=void 0;function n(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return hs.delay=n,hs}var tn={},Dc={},rn={},Xl;function U1(){return Xl||(Xl=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var Lc={},Zl;function M1(){return Zl||(Zl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Lc)),Lc}var ef;function qd(){return ef||(ef=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ni;e.__exportStar(U1(),n),e.__exportStar(M1(),n)}(Dc)),Dc}var tf;function j1(){if(tf)return tn;tf=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const n=qd();function e(s){return s*n.ONE_THOUSAND}tn.toMiliseconds=e;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return tn.fromMiliseconds=r,tn}var rf;function q1(){return rf||(rf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ni;e.__exportStar($1(),n),e.__exportStar(j1(),n)}(Cc)),Cc}var Dn={},nf;function H1(){if(nf)return Dn;nf=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Dn.Watch=n,Dn.default=n,Dn}var $c={},ls={},sf;function z1(){if(sf)return ls;sf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.IWatch=void 0;class n{}return ls.IWatch=n,ls}var of;function F1(){return of||(of=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ni.__exportStar(z1(),n)}($c)),$c}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ni;e.__exportStar(q1(),n),e.__exportStar(H1(),n),e.__exportStar(F1(),n),e.__exportStar(qd(),n)})(ve);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Hd=lt.getLocation=lt.getLocationOrThrow=Ru=lt.getNavigator=lt.getNavigatorOrThrow=Tu=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function cn(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}lt.getFromWindow=cn;function Hn(n){const e=cn(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}lt.getFromWindowOrThrow=Hn;function B1(){return Hn("document")}lt.getDocumentOrThrow=B1;function K1(){return cn("document")}var Tu=lt.getDocument=K1;function k1(){return Hn("navigator")}lt.getNavigatorOrThrow=k1;function V1(){return cn("navigator")}var Ru=lt.getNavigator=V1;function W1(){return Hn("location")}lt.getLocationOrThrow=W1;function G1(){return cn("location")}var Hd=lt.getLocation=G1;function Y1(){return Hn("crypto")}lt.getCryptoOrThrow=Y1;function J1(){return cn("crypto")}lt.getCrypto=J1;function Q1(){return Hn("localStorage")}lt.getLocalStorageOrThrow=Q1;function X1(){return cn("localStorage")}lt.getLocalStorage=X1;var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});var zd=Nu.getWindowMetadata=void 0;const af=lt;function Z1(){let n,e;try{n=af.getDocumentOrThrow(),e=af.getLocationOrThrow()}catch{return null}function r(){const I=n.getElementsByTagName("link"),x=[];for(let T=0;T<I.length;T++){const D=I[T],F=D.getAttribute("rel");if(F&&F.toLowerCase().indexOf("icon")>-1){const k=D.getAttribute("href");if(k)if(k.toLowerCase().indexOf("https:")===-1&&k.toLowerCase().indexOf("http:")===-1&&k.indexOf("//")!==0){let se=e.protocol+"//"+e.host;if(k.indexOf("/")===0)se+=k;else{const L=e.pathname.split("/");L.pop();const q=L.join("/");se+=q+"/"+k}x.push(se)}else if(k.indexOf("//")===0){const se=e.protocol+k;x.push(se)}else x.push(k)}}return x}function s(...I){const x=n.getElementsByTagName("meta");for(let T=0;T<x.length;T++){const D=x[T],F=["itemprop","property","name"].map(k=>D.getAttribute(k)).filter(k=>k?I.includes(k):!1);if(F.length&&F){const k=D.getAttribute("content");if(k)return k}}return""}function o(){let I=s("name","og:site_name","og:title","twitter:title");return I||(I=n.title),I}function c(){return s("description","og:description","twitter:description","keywords")}const d=o(),f=c(),y=e.origin,g=r();return{description:f,url:y,icons:g,name:d}}zd=Nu.getWindowMetadata=Z1;var Es={},eb=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Fd="%[a-f0-9]{2}",cf=new RegExp("("+Fd+")|([^%]+?)","gi"),uf=new RegExp("("+Fd+")+","gi");function uu(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var r=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],uu(r),uu(s))}function tb(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(cf)||[],r=1;r<e.length;r++)n=uu(e,r).join(""),e=n.match(cf)||[];return n}}function rb(n){for(var e={"%FE%FF":"","%FF%FE":""},r=uf.exec(n);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var s=tb(r[0]);s!==r[0]&&(e[r[0]]=s)}r=uf.exec(n)}e["%C2"]="";for(var o=Object.keys(e),c=0;c<o.length;c++){var d=o[c];n=n.replace(new RegExp(d,"g"),e[d])}return n}var ib=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return rb(n)}},nb=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const r=n.indexOf(e);return r===-1?[n]:[n.slice(0,r),n.slice(r+e.length)]},sb=function(n,e){for(var r={},s=Object.keys(n),o=Array.isArray(e),c=0;c<s.length;c++){var d=s[c],f=n[d];(o?e.indexOf(d)!==-1:e(d,f,n))&&(r[d]=f)}return r};(function(n){const e=eb,r=ib,s=nb,o=sb,c=L=>L==null,d=Symbol("encodeFragmentIdentifier");function f(L){switch(L.arrayFormat){case"index":return q=>(R,A)=>{const E=R.length;return A===void 0||L.skipNull&&A===null||L.skipEmptyString&&A===""?R:A===null?[...R,[m(q,L),"[",E,"]"].join("")]:[...R,[m(q,L),"[",m(E,L),"]=",m(A,L)].join("")]};case"bracket":return q=>(R,A)=>A===void 0||L.skipNull&&A===null||L.skipEmptyString&&A===""?R:A===null?[...R,[m(q,L),"[]"].join("")]:[...R,[m(q,L),"[]=",m(A,L)].join("")];case"colon-list-separator":return q=>(R,A)=>A===void 0||L.skipNull&&A===null||L.skipEmptyString&&A===""?R:A===null?[...R,[m(q,L),":list="].join("")]:[...R,[m(q,L),":list=",m(A,L)].join("")];case"comma":case"separator":case"bracket-separator":{const q=L.arrayFormat==="bracket-separator"?"[]=":"=";return R=>(A,E)=>E===void 0||L.skipNull&&E===null||L.skipEmptyString&&E===""?A:(E=E===null?"":E,A.length===0?[[m(R,L),q,m(E,L)].join("")]:[[A,m(E,L)].join(L.arrayFormatSeparator)])}default:return q=>(R,A)=>A===void 0||L.skipNull&&A===null||L.skipEmptyString&&A===""?R:A===null?[...R,m(q,L)]:[...R,[m(q,L),"=",m(A,L)].join("")]}}function y(L){let q;switch(L.arrayFormat){case"index":return(R,A,E)=>{if(q=/\[(\d*)\]$/.exec(R),R=R.replace(/\[\d*\]$/,""),!q){E[R]=A;return}E[R]===void 0&&(E[R]={}),E[R][q[1]]=A};case"bracket":return(R,A,E)=>{if(q=/(\[\])$/.exec(R),R=R.replace(/\[\]$/,""),!q){E[R]=A;return}if(E[R]===void 0){E[R]=[A];return}E[R]=[].concat(E[R],A)};case"colon-list-separator":return(R,A,E)=>{if(q=/(:list)$/.exec(R),R=R.replace(/:list$/,""),!q){E[R]=A;return}if(E[R]===void 0){E[R]=[A];return}E[R]=[].concat(E[R],A)};case"comma":case"separator":return(R,A,E)=>{const u=typeof A=="string"&&A.includes(L.arrayFormatSeparator),b=typeof A=="string"&&!u&&I(A,L).includes(L.arrayFormatSeparator);A=b?I(A,L):A;const Y=u||b?A.split(L.arrayFormatSeparator).map(W=>I(W,L)):A===null?A:I(A,L);E[R]=Y};case"bracket-separator":return(R,A,E)=>{const u=/(\[\])$/.test(R);if(R=R.replace(/\[\]$/,""),!u){E[R]=A&&I(A,L);return}const b=A===null?[]:A.split(L.arrayFormatSeparator).map(Y=>I(Y,L));if(E[R]===void 0){E[R]=b;return}E[R]=[].concat(E[R],b)};default:return(R,A,E)=>{if(E[R]===void 0){E[R]=A;return}E[R]=[].concat(E[R],A)}}}function g(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(L,q){return q.encode?q.strict?e(L):encodeURIComponent(L):L}function I(L,q){return q.decode?r(L):L}function x(L){return Array.isArray(L)?L.sort():typeof L=="object"?x(Object.keys(L)).sort((q,R)=>Number(q)-Number(R)).map(q=>L[q]):L}function T(L){const q=L.indexOf("#");return q!==-1&&(L=L.slice(0,q)),L}function D(L){let q="";const R=L.indexOf("#");return R!==-1&&(q=L.slice(R)),q}function F(L){L=T(L);const q=L.indexOf("?");return q===-1?"":L.slice(q+1)}function k(L,q){return q.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):q.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function se(L,q){q=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},q),g(q.arrayFormatSeparator);const R=y(q),A=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return A;for(const E of L.split("&")){if(E==="")continue;let[u,b]=s(q.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(q.arrayFormat)?b:I(b,q),R(I(u,q),b,A)}for(const E of Object.keys(A)){const u=A[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=k(u[b],q);else A[E]=k(u,q)}return q.sort===!1?A:(q.sort===!0?Object.keys(A).sort():Object.keys(A).sort(q.sort)).reduce((E,u)=>{const b=A[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=x(b):E[u]=b,E},Object.create(null))}n.extract=F,n.parse=se,n.stringify=(L,q)=>{if(!L)return"";q=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},q),g(q.arrayFormatSeparator);const R=b=>q.skipNull&&c(L[b])||q.skipEmptyString&&L[b]==="",A=f(q),E={};for(const b of Object.keys(L))R(b)||(E[b]=L[b]);const u=Object.keys(E);return q.sort!==!1&&u.sort(q.sort),u.map(b=>{const Y=L[b];return Y===void 0?"":Y===null?m(b,q):Array.isArray(Y)?Y.length===0&&q.arrayFormat==="bracket-separator"?m(b,q)+"[]":Y.reduce(A(b),[]).join("&"):m(b,q)+"="+m(Y,q)}).filter(b=>b.length>0).join("&")},n.parseUrl=(L,q)=>{q=Object.assign({decode:!0},q);const[R,A]=s(L,"#");return Object.assign({url:R.split("?")[0]||"",query:se(F(L),q)},q&&q.parseFragmentIdentifier&&A?{fragmentIdentifier:I(A,q)}:{})},n.stringifyUrl=(L,q)=>{q=Object.assign({encode:!0,strict:!0,[d]:!0},q);const R=T(L.url).split("?")[0]||"",A=n.extract(L.url),E=n.parse(A,{sort:!1}),u=Object.assign(E,L.query);let b=n.stringify(u,q);b&&(b=`?${b}`);let Y=D(L.url);return L.fragmentIdentifier&&(Y=`#${q[d]?m(L.fragmentIdentifier,q):L.fragmentIdentifier}`),`${R}${b}${Y}`},n.pick=(L,q,R)=>{R=Object.assign({parseFragmentIdentifier:!0,[d]:!1},R);const{url:A,query:E,fragmentIdentifier:u}=n.parseUrl(L,R);return n.stringifyUrl({url:A,query:o(E,q),fragmentIdentifier:u},R)},n.exclude=(L,q,R)=>{const A=Array.isArray(q)?E=>!q.includes(E):(E,u)=>!q(E,u);return n.pick(L,A,R)}})(Es);const ob={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},ab=":";function cb(n){const[e,r]=n.split(ab);return{namespace:e,reference:r}}function ub(n,e=[]){const r=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}function Bd(n,e){return n.includes(":")?[n]:e.chains||[]}const Kd="base10",ur="base16",hu="base64pad",Au="utf8",kd=0,un=1,hb=0,hf=1,lu=12,Cu=32;function lb(){const n=Pu.generateKeyPair();return{privateKey:hr(n.secretKey,ur),publicKey:hr(n.publicKey,ur)}}function fu(){const n=qn.randomBytes(Cu);return hr(n,ur)}function fb(n,e){const r=Pu.sharedKey(_r(n,ur),_r(e,ur),!0),s=new Yw(ra.SHA256,r).expand(Cu);return hr(s,ur)}function db(n){const e=ra.hash(_r(n,ur));return hr(e,ur)}function Mn(n){const e=ra.hash(_r(n,Au));return hr(e,ur)}function pb(n){return _r(`${n}`,Kd)}function Os(n){return Number(hr(n,Kd))}function gb(n){const e=pb(typeof n.type<"u"?n.type:kd);if(Os(e)===un&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?_r(n.senderPublicKey,ur):void 0,s=typeof n.iv<"u"?_r(n.iv,ur):qn.randomBytes(lu),o=new xu.ChaCha20Poly1305(_r(n.symKey,ur)).seal(s,_r(n.message,Au));return vb({type:e,sealed:o,iv:s,senderPublicKey:r})}function yb(n){const e=new xu.ChaCha20Poly1305(_r(n.symKey,ur)),{sealed:r,iv:s}=Wo(n.encoded),o=e.open(s,r);if(o===null)throw new Error("Failed to decrypt");return hr(o,Au)}function vb(n){if(Os(n.type)===un){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(eu([n.type,n.senderPublicKey,n.iv,n.sealed]),hu)}return hr(eu([n.type,n.iv,n.sealed]),hu)}function Wo(n){const e=_r(n,hu),r=e.slice(hb,hf),s=hf;if(Os(r)===un){const f=s+Cu,y=f+lu,g=e.slice(s,f),m=e.slice(f,y),I=e.slice(y);return{type:r,sealed:I,iv:m,senderPublicKey:g}}const o=s+lu,c=e.slice(s,o),d=e.slice(o);return{type:r,sealed:d,iv:c}}function mb(n,e){const r=Wo(n);return Vd({type:Os(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?hr(r.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Vd(n){const e=(n==null?void 0:n.type)||kd;if(e===un){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function lf(n){return n.type===un&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var _b=Object.defineProperty,ff=Object.getOwnPropertySymbols,wb=Object.prototype.hasOwnProperty,bb=Object.prototype.propertyIsEnumerable,df=(n,e,r)=>e in n?_b(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,pf=(n,e)=>{for(var r in e||(e={}))wb.call(e,r)&&df(n,r,e[r]);if(ff)for(var r of ff(e))bb.call(e,r)&&df(n,r,e[r]);return n};const Eb="ReactNative",Pr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Ib="js";function Du(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zn(){return!Tu()&&!!Ru()&&navigator.product===Eb}function Fn(){return!Du()&&!!Ru()&&!!Tu()}function Ps(){return zn()?Pr.reactNative:Du()?Pr.node:Fn()?Pr.browser:Pr.unknown}function Sb(){var n;try{return zn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function xb(n,e){let r=Es.parse(n);return r=pf(pf({},r),e),n=Es.stringify(r),n}function Ob(){return zd()||{name:"",description:"",url:"",icons:[""]}}function Pb(){if(Ps()===Pr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=h1();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function Tb(){var n;const e=Ps();return e===Pr.browser?[e,((n=Hd())==null?void 0:n.host)||"unknown"].join(":"):e}function Rb(n,e,r){const s=Pb(),o=Tb();return[[n,e].join("-"),[Ib,r].join("-"),s,o].join("/")}function Nb({protocol:n,version:e,relayUrl:r,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:d,bundleId:f}){const y=r.split("?"),g=Rb(n,e,s),m={auth:o,ua:g,projectId:c,useOnCloseEvent:d||void 0,origin:f||void 0},I=xb(y[1]||"",m);return y[0]+"?"+I}function on(n,e){return n.filter(r=>e.includes(r)).length===n.length}function Wd(n){return Object.fromEntries(n.entries())}function Gd(n){return new Map(Object.entries(n))}function $n(n=ve.FIVE_MINUTES,e){const r=ve.toMiliseconds(n||ve.FIVE_MINUTES);let s,o,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&o&&(clearTimeout(c),o(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(e))},r),s=d,o=f})}}function Is(n,e,r){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(r)),e);try{const d=await n;s(d)}catch(d){o(d)}clearTimeout(c)})}function Yd(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function Ab(n){return Yd("topic",n)}function Cb(n){return Yd("id",n)}function Jd(n){const[e,r]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")s.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return s}function Or(n,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(n))}function Ui(n){return Date.now()>=ve.toMiliseconds(n)}function Lt(n,e){return`${n}${e?`:${e}`:""}`}function Uc(n=[],e=[]){return[...new Set([...n,...e])]}async function Db({id:n,topic:e,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${n}&sessionTopic=${e}`,d=Ps();d===Pr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):d===Pr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function Lb(n,e){try{return await n.getItem(e)||(Fn()?localStorage.getItem(e):void 0)}catch(r){console.error(r)}}const $b="irn";function du(n){return(n==null?void 0:n.relay)||{protocol:$b}}function Fo(n){const e=ob[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var Ub=Object.defineProperty,Mb=Object.defineProperties,jb=Object.getOwnPropertyDescriptors,gf=Object.getOwnPropertySymbols,qb=Object.prototype.hasOwnProperty,Hb=Object.prototype.propertyIsEnumerable,yf=(n,e,r)=>e in n?Ub(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,zb=(n,e)=>{for(var r in e||(e={}))qb.call(e,r)&&yf(n,r,e[r]);if(gf)for(var r of gf(e))Hb.call(e,r)&&yf(n,r,e[r]);return n},Fb=(n,e)=>Mb(n,jb(e));function Bb(n,e="-"){const r={},s="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),d=n[o];r[c]=d}}),r}function vf(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const e=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),o=n.substring(e+1,r).split("@"),c=typeof r<"u"?n.substring(r):"",d=Es.parse(c);return{protocol:s,topic:Kb(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:Bb(d),expiryTimestamp:d.expiryTimestamp?parseInt(d.expiryTimestamp,10):void 0}}function Kb(n){return n.startsWith("//")?n.substring(2):n}function kb(n,e="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const c=r+e+o;n[o]&&(s[c]=n[o])}),s}function Vb(n){return`${n.protocol}:${n.topic}@${n.version}?`+Es.stringify(Fb(zb({symKey:n.symKey},kb(n.relay)),{expiryTimestamp:n.expiryTimestamp}))}function Bn(n){const e=[];return n.forEach(r=>{const[s,o]=r.split(":");e.push(`${s}:${o}`)}),e}function Wb(n){const e=[];return Object.values(n).forEach(r=>{e.push(...Bn(r.accounts))}),e}function Gb(n,e){const r=[];return Object.values(n).forEach(s=>{Bn(s.accounts).includes(e)&&r.push(...s.methods)}),r}function Yb(n,e){const r=[];return Object.values(n).forEach(s=>{Bn(s.accounts).includes(e)&&r.push(...s.events)}),r}function Lu(n){return n.includes(":")}function vs(n){return Lu(n)?n.split(":")[0]:n}const Jb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Qb={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(n,e){const{message:r,code:s}=Qb[n];return{message:e?`${r} ${e}`:r,code:s}}function _t(n,e){const{message:r,code:s}=Jb[n];return{message:e?`${r} ${e}`:r,code:s}}function ii(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Ss(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function cr(n){return typeof n>"u"}function Wt(n,e){return e&&cr(n)?!0:typeof n=="string"&&!!n.trim().length}function $u(n,e){return e&&cr(n)?!0:typeof n=="number"&&!isNaN(n)}function Xb(n,e){const{requiredNamespaces:r}=e,s=Object.keys(n.namespaces),o=Object.keys(r);let c=!0;return on(o,s)?(s.forEach(d=>{const{accounts:f,methods:y,events:g}=n.namespaces[d],m=Bn(f),I=r[d];(!on(Bd(d,I),m)||!on(I.methods,y)||!on(I.events,g))&&(c=!1)}),c):!1}function Go(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Zb(n){if(Wt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Go(r)}}return!1}function eE(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function tE(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function rE(n){return n==null?void 0:n.topic}function iE(n,e){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function mf(n){let e=!0;return ii(n)?n.length&&(e=n.every(r=>Wt(r,!1))):e=!1,e}function nE(n,e,r){let s=null;return ii(e)&&e.length?e.forEach(o=>{s||Go(o)||(s=_t("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Go(n)||(s=_t("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function sE(n,e,r){let s=null;return Object.entries(n).forEach(([o,c])=>{if(s)return;const d=nE(o,Bd(o,c),`${e} ${r}`);d&&(s=d)}),s}function oE(n,e){let r=null;return ii(n)?n.forEach(s=>{r||Zb(s)||(r=_t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=_t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function aE(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=oE(s==null?void 0:s.accounts,`${e} namespace`);o&&(r=o)}),r}function cE(n,e){let r=null;return mf(n==null?void 0:n.methods)?mf(n==null?void 0:n.events)||(r=_t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=_t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Qd(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=cE(s,`${e}, namespace`);o&&(r=o)}),r}function uE(n,e,r){let s=null;if(n&&Ss(n)){const o=Qd(n,e);o&&(s=o);const c=sE(n,e,r);c&&(s=c)}else s=ce("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return s}function Mc(n,e){let r=null;if(n&&Ss(n)){const s=Qd(n,e);s&&(r=s);const o=aE(n,e);o&&(r=o)}else r=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Xd(n){return Wt(n.protocol,!0)}function hE(n,e){let r=!1;return e&&!n?r=!0:n&&ii(n)&&n.length&&n.forEach(s=>{r=Xd(s)}),r}function lE(n){return typeof n=="number"}function mr(n){return typeof n<"u"&&typeof n!==null}function fE(n){return!(!n||typeof n!="object"||!n.code||!$u(n.code,!1)||!n.message||!Wt(n.message,!1))}function dE(n){return!(cr(n)||!Wt(n.method,!1))}function pE(n){return!(cr(n)||cr(n.result)&&cr(n.error)||!$u(n.id,!1)||!Wt(n.jsonrpc,!1))}function gE(n){return!(cr(n)||!Wt(n.name,!1))}function _f(n,e){return!(!Go(e)||!Wb(n).includes(e))}function yE(n,e,r){return Wt(r,!1)?Gb(n,e).includes(r):!1}function vE(n,e,r){return Wt(r,!1)?Yb(n,e).includes(r):!1}function wf(n,e,r){let s=null;const o=mE(n),c=_E(e),d=Object.keys(o),f=Object.keys(c),y=bf(Object.keys(n)),g=bf(Object.keys(e)),m=y.filter(I=>!g.includes(I));return m.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${m.toString()}
      Received: ${Object.keys(e).toString()}`)),on(d,f)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(I=>{if(!I.includes(":")||s)return;const x=Bn(e[I].accounts);x.includes(I)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${I}
        Required: ${I}
        Approved: ${x.toString()}`))}),d.forEach(I=>{s||(on(o[I].methods,c[I].methods)?on(o[I].events,c[I].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${I}`)):s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${I}`))}),s}function mE(n){const e={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?e[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{e[o]={methods:n[r].methods,events:n[r].events}})}),e}function bf(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function _E(n){const e={};return Object.keys(n).forEach(r=>{if(r.includes(":"))e[r]=n[r];else{const s=Bn(n[r].accounts);s==null||s.forEach(o=>{e[o]={accounts:n[r].accounts.filter(c=>c.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),e}function wE(n,e){return $u(n,!1)&&n<=e.max&&n>=e.min}function Ef(){const n=Ps();return new Promise(e=>{switch(n){case Pr.browser:e(bE());break;case Pr.reactNative:e(EE());break;case Pr.node:e(IE());break;default:e(!0)}})}function bE(){return Fn()&&(navigator==null?void 0:navigator.onLine)}async function EE(){if(zn()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function IE(){return!0}function SE(n){switch(Ps()){case Pr.browser:xE(n);break;case Pr.reactNative:OE(n);break}}function xE(n){!zn()&&Fn()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function OE(n){zn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>n(e==null?void 0:e.isConnected)))}const jc={};let Uo=class{static get(e){return jc[e]}static set(e,r){jc[e]=r}static delete(e){delete jc[e]}};const PE=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,TE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,RE=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function NE(n,e){if(n==="__proto__"||n==="constructor"&&e&&typeof e=="object"&&"prototype"in e){AE(n);return}return e}function AE(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Mo(n,e={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.endsWith('"')&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!RE.test(n)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(PE.test(n)||TE.test(n)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,NE)}return JSON.parse(n)}catch(s){if(e.strict)throw s;return n}}function CE(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Vt(n,...e){try{return CE(n(...e))}catch(r){return Promise.reject(r)}}function DE(n){const e=typeof n;return n===null||e!=="object"&&e!=="function"}function LE(n){const e=Object.getPrototypeOf(n);return!e||e.isPrototypeOf(Object)}function Bo(n){if(DE(n))return String(n);if(LE(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Bo(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Zd(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const pu="base64:";function $E(n){if(typeof n=="string")return n;Zd();const e=Buffer.from(n).toString("base64");return pu+e}function UE(n){return typeof n!="string"||!n.startsWith(pu)?n:(Zd(),Buffer.from(n.slice(pu.length),"base64"))}function vr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function ME(...n){return vr(n.join(":"))}function jo(n){return n=vr(n),n?n+":":""}const jE="memory",qE=()=>{const n=new Map;return{name:jE,options:{},hasItem(e){return n.has(e)},getItem(e){return n.get(e)??null},getItemRaw(e){return n.get(e)??null},setItem(e,r){n.set(e,r)},setItemRaw(e,r){n.set(e,r)},removeItem(e){n.delete(e)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function HE(n={}){const e={mounts:{"":n.driver||qE()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=g=>{for(const m of e.mountpoints)if(g.startsWith(m))return{base:m,relativeKey:g.slice(m.length),driver:e.mounts[m]};return{base:"",relativeKey:g,driver:e.mounts[""]}},s=(g,m)=>e.mountpoints.filter(I=>I.startsWith(g)||m&&g.startsWith(I)).map(I=>({relativeBase:g.length>I.length?g.slice(I.length):void 0,mountpoint:I,driver:e.mounts[I]})),o=(g,m)=>{if(e.watching){m=vr(m);for(const I of e.watchListeners)I(g,m)}},c=async()=>{if(!e.watching){e.watching=!0;for(const g in e.mounts)e.unwatch[g]=await If(e.mounts[g],o,g)}},d=async()=>{if(e.watching){for(const g in e.unwatch)await e.unwatch[g]();e.unwatch={},e.watching=!1}},f=(g,m,I)=>{const x=new Map,T=D=>{let F=x.get(D.base);return F||(F={driver:D.driver,base:D.base,items:[]},x.set(D.base,F)),F};for(const D of g){const F=typeof D=="string",k=vr(F?D:D.key),se=F?void 0:D.value,L=F||!D.options?m:{...m,...D.options},q=r(k);T(q).items.push({key:k,value:se,relativeKey:q.relativeKey,options:L})}return Promise.all([...x.values()].map(D=>I(D))).then(D=>D.flat())},y={hasItem(g,m={}){g=vr(g);const{relativeKey:I,driver:x}=r(g);return Vt(x.hasItem,I,m)},getItem(g,m={}){g=vr(g);const{relativeKey:I,driver:x}=r(g);return Vt(x.getItem,I,m).then(T=>Mo(T))},getItems(g,m){return f(g,m,I=>I.driver.getItems?Vt(I.driver.getItems,I.items.map(x=>({key:x.relativeKey,options:x.options})),m).then(x=>x.map(T=>({key:ME(I.base,T.key),value:Mo(T.value)}))):Promise.all(I.items.map(x=>Vt(I.driver.getItem,x.relativeKey,x.options).then(T=>({key:x.key,value:Mo(T)})))))},getItemRaw(g,m={}){g=vr(g);const{relativeKey:I,driver:x}=r(g);return x.getItemRaw?Vt(x.getItemRaw,I,m):Vt(x.getItem,I,m).then(T=>UE(T))},async setItem(g,m,I={}){if(m===void 0)return y.removeItem(g);g=vr(g);const{relativeKey:x,driver:T}=r(g);T.setItem&&(await Vt(T.setItem,x,Bo(m),I),T.watch||o("update",g))},async setItems(g,m){await f(g,m,async I=>{I.driver.setItems&&await Vt(I.driver.setItems,I.items.map(x=>({key:x.relativeKey,value:Bo(x.value),options:x.options})),m),I.driver.setItem&&await Promise.all(I.items.map(x=>Vt(I.driver.setItem,x.relativeKey,Bo(x.value),x.options)))})},async setItemRaw(g,m,I={}){if(m===void 0)return y.removeItem(g,I);g=vr(g);const{relativeKey:x,driver:T}=r(g);if(T.setItemRaw)await Vt(T.setItemRaw,x,m,I);else if(T.setItem)await Vt(T.setItem,x,$E(m),I);else return;T.watch||o("update",g)},async removeItem(g,m={}){typeof m=="boolean"&&(m={removeMeta:m}),g=vr(g);const{relativeKey:I,driver:x}=r(g);x.removeItem&&(await Vt(x.removeItem,I,m),(m.removeMeta||m.removeMata)&&await Vt(x.removeItem,I+"$",m),x.watch||o("remove",g))},async getMeta(g,m={}){typeof m=="boolean"&&(m={nativeOnly:m}),g=vr(g);const{relativeKey:I,driver:x}=r(g),T=Object.create(null);if(x.getMeta&&Object.assign(T,await Vt(x.getMeta,I,m)),!m.nativeOnly){const D=await Vt(x.getItem,I+"$",m).then(F=>Mo(F));D&&typeof D=="object"&&(typeof D.atime=="string"&&(D.atime=new Date(D.atime)),typeof D.mtime=="string"&&(D.mtime=new Date(D.mtime)),Object.assign(T,D))}return T},setMeta(g,m,I={}){return this.setItem(g+"$",m,I)},removeMeta(g,m={}){return this.removeItem(g+"$",m)},async getKeys(g,m={}){g=jo(g);const I=s(g,!0);let x=[];const T=[];for(const D of I){const k=(await Vt(D.driver.getKeys,D.relativeBase,m)).map(se=>D.mountpoint+vr(se)).filter(se=>!x.some(L=>se.startsWith(L)));T.push(...k),x=[D.mountpoint,...x.filter(se=>!se.startsWith(D.mountpoint))]}return g?T.filter(D=>D.startsWith(g)&&!D.endsWith("$")):T.filter(D=>!D.endsWith("$"))},async clear(g,m={}){g=jo(g),await Promise.all(s(g,!1).map(async I=>{if(I.driver.clear)return Vt(I.driver.clear,I.relativeBase,m);if(I.driver.removeItem){const x=await I.driver.getKeys(I.relativeBase||"",m);return Promise.all(x.map(T=>I.driver.removeItem(T,m)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(g=>Sf(g)))},async watch(g){return await c(),e.watchListeners.push(g),async()=>{e.watchListeners=e.watchListeners.filter(m=>m!==g),e.watchListeners.length===0&&await d()}},async unwatch(){e.watchListeners=[],await d()},mount(g,m){if(g=jo(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((I,x)=>x.length-I.length)),e.mounts[g]=m,e.watching&&Promise.resolve(If(m,o,g)).then(I=>{e.unwatch[g]=I}).catch(console.error),y},async unmount(g,m=!0){g=jo(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),m&&await Sf(e.mounts[g]),e.mountpoints=e.mountpoints.filter(I=>I!==g),delete e.mounts[g])},getMount(g=""){g=vr(g)+":";const m=r(g);return{driver:m.driver,base:m.base}},getMounts(g="",m={}){return g=vr(g),s(g,m.parents).map(x=>({driver:x.driver,base:x.mountpoint}))}};return y}function If(n,e,r){return n.watch?n.watch((s,o)=>e(s,r+o)):()=>{}}async function Sf(n){typeof n.dispose=="function"&&await Vt(n.dispose)}function hn(n){return new Promise((e,r)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>r(n.error)})}function ep(n,e){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(e);const s=hn(r);return(o,c)=>s.then(d=>c(d.transaction(e,o).objectStore(e)))}let qc;function Ts(){return qc||(qc=ep("keyval-store","keyval")),qc}function xf(n,e=Ts()){return e("readonly",r=>hn(r.get(n)))}function zE(n,e,r=Ts()){return r("readwrite",s=>(s.put(e,n),hn(s.transaction)))}function FE(n,e=Ts()){return e("readwrite",r=>(r.delete(n),hn(r.transaction)))}function BE(n=Ts()){return n("readwrite",e=>(e.clear(),hn(e.transaction)))}function KE(n,e){return n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},hn(n.transaction)}function kE(n=Ts()){return n("readonly",e=>{if(e.getAllKeys)return hn(e.getAllKeys());const r=[];return KE(e,s=>r.push(s.key)).then(()=>r)})}const VE=n=>JSON.stringify(n,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),WE=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Rs(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return WE(n)}catch{return n}}function an(n){return typeof n=="string"?n:VE(n)||""}const GE="idb-keyval";var YE=(n={})=>{const e=n.base&&n.base.length>0?`${n.base}:`:"",r=o=>e+o;let s;return n.dbName&&n.storeName&&(s=ep(n.dbName,n.storeName)),{name:GE,options:n,async hasItem(o){return!(typeof await xf(r(o),s)>"u")},async getItem(o){return await xf(r(o),s)??null},setItem(o,c){return zE(r(o),c,s)},removeItem(o){return FE(r(o),s)},getKeys(){return kE(s)},clear(){return BE(s)}}};const JE="WALLET_CONNECT_V2_INDEXED_DB",QE="keyvaluestorage";let XE=class{constructor(){this.indexedDb=HE({driver:YE({dbName:JE,storeName:QE})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,an(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Hc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ko={exports:{}};(function(){let n;function e(){}n=e,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Hc<"u"&&Hc.localStorage?Ko.exports=Hc.localStorage:typeof window<"u"&&window.localStorage?Ko.exports=window.localStorage:Ko.exports=new e})();function ZE(n){var e;return[n[0],Rs((e=n[1])!=null?e:"")]}class eI{constructor(){this.localStorage=Ko.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ZE)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Rs(r)}async setItem(e,r){this.localStorage.setItem(e,an(r))}async removeItem(e){this.localStorage.removeItem(e)}}const tI="wc_storage_version",Of=1,rI=async(n,e,r)=>{const s=tI,o=await e.getItem(s);if(o&&o>=Of){r(e);return}const c=await n.getKeys();if(!c.length){r(e);return}const d=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const g=await n.getItem(f);await e.setItem(f,g),d.push(f)}}await e.setItem(s,Of),r(e),iI(n,d)},iI=async(n,e)=>{e.length&&e.forEach(async r=>{await n.removeItem(r)})};let nI=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new eI;this.storage=e;try{const r=new XE;rI(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var Kn={},fs={},zc={},ds={};let ln=class{};const sI=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ln},Symbol.toStringTag,{value:"Module"})),oI=Eu(sI);var Pf;function aI(){if(Pf)return ds;Pf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IHeartBeat=void 0;const n=oI;class e extends n.IEvents{constructor(s){super()}}return ds.IHeartBeat=e,ds}var Tf;function tp(){return Tf||(Tf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ni.__exportStar(aI(),n)}(zc)),zc}var Fc={},nn={},Rf;function cI(){if(Rf)return nn;Rf=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HEARTBEAT_EVENTS=nn.HEARTBEAT_INTERVAL=void 0;const n=ve;return nn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,nn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nn}var Nf;function rp(){return Nf||(Nf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ni.__exportStar(cI(),n)}(Fc)),Fc}var Af;function uI(){if(Af)return fs;Af=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.HeartBeat=void 0;const n=ni,e=qr,r=ve,s=tp(),o=rp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return fs.HeartBeat=c,fs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ni;e.__exportStar(uI(),n),e.__exportStar(tp(),n),e.__exportStar(rp(),n)})(Kn);var Je={},Bc,Cf;function hI(){if(Cf)return Bc;Cf=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Bc=e;function e(r,s,o){var c=o&&o.stringify||n,d=1;if(typeof r=="object"&&r!==null){var f=s.length+d;if(f===1)return r;var y=new Array(f);y[0]=c(r);for(var g=1;g<f;g++)y[g]=c(s[g]);return y.join(" ")}if(typeof r!="string")return r;var m=s.length;if(m===0)return r;for(var I="",x=1-d,T=-1,D=r&&r.length||0,F=0;F<D;){if(r.charCodeAt(F)===37&&F+1<D){switch(T=T>-1?T:0,r.charCodeAt(F+1)){case 100:case 102:if(x>=m||s[x]==null)break;T<F&&(I+=r.slice(T,F)),I+=Number(s[x]),T=F+2,F++;break;case 105:if(x>=m||s[x]==null)break;T<F&&(I+=r.slice(T,F)),I+=Math.floor(Number(s[x])),T=F+2,F++;break;case 79:case 111:case 106:if(x>=m||s[x]===void 0)break;T<F&&(I+=r.slice(T,F));var k=typeof s[x];if(k==="string"){I+="'"+s[x]+"'",T=F+2,F++;break}if(k==="function"){I+=s[x].name||"<anonymous>",T=F+2,F++;break}I+=c(s[x]),T=F+2,F++;break;case 115:if(x>=m)break;T<F&&(I+=r.slice(T,F)),I+=String(s[x]),T=F+2,F++;break;case 37:T<F&&(I+=r.slice(T,F)),I+="%",T=F+2,F++,x--;break}++x}++F}return T===-1?r:(T<D&&(I+=r.slice(T)),I)}return Bc}var Kc,Df;function lI(){if(Df)return Kc;Df=1;const n=hI();Kc=o;const e=A().console||{},r={mapHttpRequest:D,mapHttpResponse:D,wrapRequestSerializer:F,wrapResponseSerializer:F,wrapErrorSerializer:F,req:D,res:D,err:x};function s(E,u){return Array.isArray(E)?E.filter(function(Y){return Y!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const Y=E.serializers||{},W=s(E.browser.serialize,Y);let ne=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ne=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),E.enabled===!1&&(E.level="silent");const de=E.level||"info",w=Object.create(b);w.log||(w.log=k),Object.defineProperty(w,"levelVal",{get:ee}),Object.defineProperty(w,"level",{get:Q,set:K});const P={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ue,timestamp:T(E)};w.levels=o.levels,w.level=de,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=k,w.serializers=Y,w._serialize=W,w._stdErrSerialize=ne,w.child=V,u&&(w._logEvent=I());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function K(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(P,w,"error","log"),c(P,w,"fatal","error"),c(P,w,"warn","error"),c(P,w,"info","log"),c(P,w,"debug","log"),c(P,w,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const we=re.serializers;if(W&&we){var oe=Object.assign({},Y,we),be=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,y([J],be,oe,this._stdErrSerialize)}function le(me){this._childLevel=(me._childLevel|0)+1,this.error=g(me,J,"error"),this.fatal=g(me,J,"fatal"),this.warn=g(me,J,"warn"),this.info=g(me,J,"info"),this.debug=g(me,J,"debug"),this.trace=g(me,J,"trace"),oe&&(this.serializers=oe,this._serialize=be),u&&(this._logEvent=I([].concat(me._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return w}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:se,epochTime:L,unixTime:q,isoTime:R});function c(E,u,b,Y){const W=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?k:W[b]?W[b]:e[b]||e[Y]||k,d(E,u,b)}function d(E,u,b){!E.transmit&&u[b]===k||(u[b]=function(Y){return function(){const ne=E.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var w=0;w<ue.length;w++)ue[w]=arguments[w];if(E.serialize&&!E.asObject&&y(ue,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?Y.call(de,f(this,b,ue,ne)):Y.apply(de,ue),E.transmit){const P=E.transmit.level||u.level,ee=o.levels.values[P],Q=o.levels.values[b];if(Q<ee)return;m(this,{ts:ne,methodLevel:b,methodValue:Q,transmitLevel:P,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ue)}}}(u[b]))}function f(E,u,b,Y){E._serialize&&y(b,E._serialize,E.serializers,E._stdErrSerialize);const W=b.slice();let ne=W[0];const ue={};Y&&(ue.time=Y),ue.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),ne!==null&&typeof ne=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ue,W.shift());ne=W.length?n(W.shift(),W):void 0}else typeof ne=="string"&&(ne=n(W.shift(),W));return ne!==void 0&&(ue.msg=ne),ue}function y(E,u,b,Y){for(const W in E)if(Y&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const ne in E[W])u&&u.indexOf(ne)>-1&&ne in b&&(E[W][ne]=b[ne](E[W][ne]))}function g(E,u,b){return function(){const Y=new Array(1+arguments.length);Y[0]=u;for(var W=1;W<Y.length;W++)Y[W]=arguments[W-1];return E[b].apply(this,Y)}}function m(E,u,b){const Y=u.send,W=u.ts,ne=u.methodLevel,ue=u.methodValue,de=u.val,w=E._logEvent.bindings;y(b,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=b.filter(function(P){return w.indexOf(P)===-1}),E._logEvent.level.label=ne,E._logEvent.level.value=ue,Y(ne,E._logEvent,de),E._logEvent=I(w)}function I(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function x(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const b in E)u[b]===void 0&&(u[b]=E[b]);return u}function T(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?se:L}function D(){return{}}function F(E){return E}function k(){}function se(){return!1}function L(){return Date.now()}function q(){return Math.round(Date.now()/1e3)}function R(){return new Date(Date.now()).toISOString()}function A(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Kc}var sn={},Lf;function ip(){return Lf||(Lf=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.PINO_CUSTOM_CONTEXT_KEY=sn.PINO_LOGGER_DEFAULTS=void 0,sn.PINO_LOGGER_DEFAULTS={level:"info"},sn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sn}var or={},$f;function fI(){if($f)return or;$f=1,Object.defineProperty(or,"__esModule",{value:!0}),or.generateChildLogger=or.formatChildLoggerContext=or.getLoggerContext=or.setBrowserLoggerContext=or.getBrowserLoggerContext=or.getDefaultLoggerOptions=void 0;const n=ip();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}or.getDefaultLoggerOptions=e;function r(f,y=n.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}or.getBrowserLoggerContext=r;function s(f,y,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]=y,f}or.setBrowserLoggerContext=s;function o(f,y=n.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof f.bindings>"u"?g=r(f,y):g=f.bindings().context||"",g}or.getLoggerContext=o;function c(f,y,g=n.PINO_CUSTOM_CONTEXT_KEY){const m=o(f,g);return m.trim()?`${m}/${y}`:y}or.formatChildLoggerContext=c;function d(f,y,g=n.PINO_CUSTOM_CONTEXT_KEY){const m=c(f,y,g),I=f.child({context:m});return s(I,m,g)}return or.generateChildLogger=d,or}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=ni,r=e.__importDefault(lI());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(ip(),n),e.__exportStar(fI(),n)})(Je);class dI extends ln{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let pI=class extends ln{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}},gI=class{constructor(e,r){this.logger=e,this.core=r}},yI=class extends ln{constructor(e,r){super(),this.relayer=e,this.logger=r}},vI=class extends ln{constructor(e){super()}},mI=class{constructor(e,r,s,o){this.core=e,this.logger=r,this.name=s}};class _I extends ln{constructor(e,r){super(),this.relayer=e,this.logger=r}}let wI=class extends ln{constructor(e,r){super(),this.core=e,this.logger=r}},bI=class{constructor(e,r){this.projectId=e,this.logger=r}},EI=class{constructor(e,r){this.projectId=e,this.logger=r}},II=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},SI=class{constructor(e){this.client=e}};var Uu={},np={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,r=Tr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,I=g/536870912|0,x=g<<3,T=g%128<112?128:256;this._buffer[m]=128;for(var D=m+1;D<T-8;D++)this._buffer[D]=0;e.writeUint32BE(I,this._buffer,T-8),e.writeUint32BE(x,this._buffer,T-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)e.writeUint32BE(this._stateHi[D],y,D*8),e.writeUint32BE(this._stateLo[D],y,D*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){r.wipe(y.stateHi),r.wipe(y.stateLo),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,g,m,I,x,T){for(var D=g[0],F=g[1],k=g[2],se=g[3],L=g[4],q=g[5],R=g[6],A=g[7],E=m[0],u=m[1],b=m[2],Y=m[3],W=m[4],ne=m[5],ue=m[6],de=m[7],w,P,ee,Q,K,V,J,re;T>=128;){for(var we=0;we<16;we++){var oe=8*we+x;f[we]=e.readUint32BE(I,oe),y[we]=e.readUint32BE(I,oe+4)}for(var we=0;we<80;we++){var be=D,le=F,me=k,z=se,H=L,$=q,l=R,N=A,ae=E,fe=u,xe=b,Fe=Y,ke=W,Me=ne,pt=ue,gt=de;if(w=A,P=de,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=(L>>>14|W<<18)^(L>>>18|W<<14)^(W>>>9|L<<23),P=(W>>>14|L<<18)^(W>>>18|L<<14)^(L>>>9|W<<23),K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,w=L&q^~L&R,P=W&ne^~W&ue,K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,w=o[we*2],P=o[we*2+1],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,w=f[we%16],P=y[we%16],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=K&65535|V<<16,w=ee,P=Q,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=(D>>>28|E<<4)^(E>>>2|D<<30)^(E>>>7|D<<25),P=(E>>>28|D<<4)^(D>>>2|E<<30)^(D>>>7|E<<25),K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,w=D&F^D&k^F&k,P=E&u^E&b^u&b,K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,N=J&65535|re<<16,gt=K&65535|V<<16,w=z,P=Fe,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=ee,P=Q,K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,z=J&65535|re<<16,Fe=K&65535|V<<16,F=be,k=le,se=me,L=z,q=H,R=$,A=l,D=N,u=ae,b=fe,Y=xe,W=Fe,ne=ke,ue=Me,de=pt,E=gt,we%16===15)for(var oe=0;oe<16;oe++)w=f[oe],P=y[oe],K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=f[(oe+9)%16],P=y[(oe+9)%16],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+1)%16],Q=y[(oe+1)%16],w=(ee>>>1|Q<<31)^(ee>>>8|Q<<24)^ee>>>7,P=(Q>>>1|ee<<31)^(Q>>>8|ee<<24)^(Q>>>7|ee<<25),K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+14)%16],Q=y[(oe+14)%16],w=(ee>>>19|Q<<13)^(Q>>>29|ee<<3)^ee>>>6,P=(Q>>>19|ee<<13)^(ee>>>29|Q<<3)^(Q>>>6|ee<<26),K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,y[oe]=K&65535|V<<16}w=D,P=E,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[0],P=m[0],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[0]=D=J&65535|re<<16,m[0]=E=K&65535|V<<16,w=F,P=u,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[1],P=m[1],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[1]=F=J&65535|re<<16,m[1]=u=K&65535|V<<16,w=k,P=b,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[2],P=m[2],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[2]=k=J&65535|re<<16,m[2]=b=K&65535|V<<16,w=se,P=Y,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[3],P=m[3],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[3]=se=J&65535|re<<16,m[3]=Y=K&65535|V<<16,w=L,P=W,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[4],P=m[4],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[4]=L=J&65535|re<<16,m[4]=W=K&65535|V<<16,w=q,P=ne,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[5],P=m[5],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[5]=q=J&65535|re<<16,m[5]=ne=K&65535|V<<16,w=R,P=ue,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[6],P=m[6],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[6]=R=J&65535|re<<16,m[6]=ue=K&65535|V<<16,w=A,P=de,K=P&65535,V=P>>>16,J=w&65535,re=w>>>16,w=g[7],P=m[7],K+=P&65535,V+=P>>>16,J+=w&65535,re+=w>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,g[7]=A=J&65535|re<<16,m[7]=de=K&65535|V<<16,x+=128,T-=128}return x}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}n.hash=d})(np);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=qn,r=np,s=Tr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(z){const H=new Float64Array(16);if(z)for(let $=0;$<z.length;$++)H[$]=z[$];return H}const c=new Uint8Array(32);c[0]=9;const d=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(z,H){for(let $=0;$<16;$++)z[$]=H[$]|0}function D(z){let H=1;for(let $=0;$<16;$++){let l=z[$]+H+65535;H=Math.floor(l/65536),z[$]=l-H*65536}z[0]+=H-1+37*(H-1)}function F(z,H,$){const l=~($-1);for(let N=0;N<16;N++){const ae=l&(z[N]^H[N]);z[N]^=ae,H[N]^=ae}}function k(z,H){const $=o(),l=o();for(let N=0;N<16;N++)l[N]=H[N];D(l),D(l),D(l);for(let N=0;N<2;N++){$[0]=l[0]-65517;for(let fe=1;fe<15;fe++)$[fe]=l[fe]-65535-($[fe-1]>>16&1),$[fe-1]&=65535;$[15]=l[15]-32767-($[14]>>16&1);const ae=$[15]>>16&1;$[14]&=65535,F(l,$,1-ae)}for(let N=0;N<16;N++)z[2*N]=l[N]&255,z[2*N+1]=l[N]>>8}function se(z,H){let $=0;for(let l=0;l<32;l++)$|=z[l]^H[l];return(1&$-1>>>8)-1}function L(z,H){const $=new Uint8Array(32),l=new Uint8Array(32);return k($,z),k(l,H),se($,l)}function q(z){const H=new Uint8Array(32);return k(H,z),H[0]&1}function R(z,H){for(let $=0;$<16;$++)z[$]=H[2*$]+(H[2*$+1]<<8);z[15]&=32767}function A(z,H,$){for(let l=0;l<16;l++)z[l]=H[l]+$[l]}function E(z,H,$){for(let l=0;l<16;l++)z[l]=H[l]-$[l]}function u(z,H,$){let l,N,ae=0,fe=0,xe=0,Fe=0,ke=0,Me=0,pt=0,gt=0,qe=0,Oe=0,De=0,Le=0,He=0,Te=0,$e=0,Se=0,Re=0,Be=0,Pe=0,Ve=0,Ge=0,et=0,tt=0,Qe=0,er=0,lr=0,Yr=0,tr=0,si=0,xi=0,zi=0,It=$[0],yt=$[1],St=$[2],xt=$[3],bt=$[4],vt=$[5],$t=$[6],Ut=$[7],Ot=$[8],Mt=$[9],Pt=$[10],Nt=$[11],Tt=$[12],ht=$[13],jt=$[14],qt=$[15];l=H[0],ae+=l*It,fe+=l*yt,xe+=l*St,Fe+=l*xt,ke+=l*bt,Me+=l*vt,pt+=l*$t,gt+=l*Ut,qe+=l*Ot,Oe+=l*Mt,De+=l*Pt,Le+=l*Nt,He+=l*Tt,Te+=l*ht,$e+=l*jt,Se+=l*qt,l=H[1],fe+=l*It,xe+=l*yt,Fe+=l*St,ke+=l*xt,Me+=l*bt,pt+=l*vt,gt+=l*$t,qe+=l*Ut,Oe+=l*Ot,De+=l*Mt,Le+=l*Pt,He+=l*Nt,Te+=l*Tt,$e+=l*ht,Se+=l*jt,Re+=l*qt,l=H[2],xe+=l*It,Fe+=l*yt,ke+=l*St,Me+=l*xt,pt+=l*bt,gt+=l*vt,qe+=l*$t,Oe+=l*Ut,De+=l*Ot,Le+=l*Mt,He+=l*Pt,Te+=l*Nt,$e+=l*Tt,Se+=l*ht,Re+=l*jt,Be+=l*qt,l=H[3],Fe+=l*It,ke+=l*yt,Me+=l*St,pt+=l*xt,gt+=l*bt,qe+=l*vt,Oe+=l*$t,De+=l*Ut,Le+=l*Ot,He+=l*Mt,Te+=l*Pt,$e+=l*Nt,Se+=l*Tt,Re+=l*ht,Be+=l*jt,Pe+=l*qt,l=H[4],ke+=l*It,Me+=l*yt,pt+=l*St,gt+=l*xt,qe+=l*bt,Oe+=l*vt,De+=l*$t,Le+=l*Ut,He+=l*Ot,Te+=l*Mt,$e+=l*Pt,Se+=l*Nt,Re+=l*Tt,Be+=l*ht,Pe+=l*jt,Ve+=l*qt,l=H[5],Me+=l*It,pt+=l*yt,gt+=l*St,qe+=l*xt,Oe+=l*bt,De+=l*vt,Le+=l*$t,He+=l*Ut,Te+=l*Ot,$e+=l*Mt,Se+=l*Pt,Re+=l*Nt,Be+=l*Tt,Pe+=l*ht,Ve+=l*jt,Ge+=l*qt,l=H[6],pt+=l*It,gt+=l*yt,qe+=l*St,Oe+=l*xt,De+=l*bt,Le+=l*vt,He+=l*$t,Te+=l*Ut,$e+=l*Ot,Se+=l*Mt,Re+=l*Pt,Be+=l*Nt,Pe+=l*Tt,Ve+=l*ht,Ge+=l*jt,et+=l*qt,l=H[7],gt+=l*It,qe+=l*yt,Oe+=l*St,De+=l*xt,Le+=l*bt,He+=l*vt,Te+=l*$t,$e+=l*Ut,Se+=l*Ot,Re+=l*Mt,Be+=l*Pt,Pe+=l*Nt,Ve+=l*Tt,Ge+=l*ht,et+=l*jt,tt+=l*qt,l=H[8],qe+=l*It,Oe+=l*yt,De+=l*St,Le+=l*xt,He+=l*bt,Te+=l*vt,$e+=l*$t,Se+=l*Ut,Re+=l*Ot,Be+=l*Mt,Pe+=l*Pt,Ve+=l*Nt,Ge+=l*Tt,et+=l*ht,tt+=l*jt,Qe+=l*qt,l=H[9],Oe+=l*It,De+=l*yt,Le+=l*St,He+=l*xt,Te+=l*bt,$e+=l*vt,Se+=l*$t,Re+=l*Ut,Be+=l*Ot,Pe+=l*Mt,Ve+=l*Pt,Ge+=l*Nt,et+=l*Tt,tt+=l*ht,Qe+=l*jt,er+=l*qt,l=H[10],De+=l*It,Le+=l*yt,He+=l*St,Te+=l*xt,$e+=l*bt,Se+=l*vt,Re+=l*$t,Be+=l*Ut,Pe+=l*Ot,Ve+=l*Mt,Ge+=l*Pt,et+=l*Nt,tt+=l*Tt,Qe+=l*ht,er+=l*jt,lr+=l*qt,l=H[11],Le+=l*It,He+=l*yt,Te+=l*St,$e+=l*xt,Se+=l*bt,Re+=l*vt,Be+=l*$t,Pe+=l*Ut,Ve+=l*Ot,Ge+=l*Mt,et+=l*Pt,tt+=l*Nt,Qe+=l*Tt,er+=l*ht,lr+=l*jt,Yr+=l*qt,l=H[12],He+=l*It,Te+=l*yt,$e+=l*St,Se+=l*xt,Re+=l*bt,Be+=l*vt,Pe+=l*$t,Ve+=l*Ut,Ge+=l*Ot,et+=l*Mt,tt+=l*Pt,Qe+=l*Nt,er+=l*Tt,lr+=l*ht,Yr+=l*jt,tr+=l*qt,l=H[13],Te+=l*It,$e+=l*yt,Se+=l*St,Re+=l*xt,Be+=l*bt,Pe+=l*vt,Ve+=l*$t,Ge+=l*Ut,et+=l*Ot,tt+=l*Mt,Qe+=l*Pt,er+=l*Nt,lr+=l*Tt,Yr+=l*ht,tr+=l*jt,si+=l*qt,l=H[14],$e+=l*It,Se+=l*yt,Re+=l*St,Be+=l*xt,Pe+=l*bt,Ve+=l*vt,Ge+=l*$t,et+=l*Ut,tt+=l*Ot,Qe+=l*Mt,er+=l*Pt,lr+=l*Nt,Yr+=l*Tt,tr+=l*ht,si+=l*jt,xi+=l*qt,l=H[15],Se+=l*It,Re+=l*yt,Be+=l*St,Pe+=l*xt,Ve+=l*bt,Ge+=l*vt,et+=l*$t,tt+=l*Ut,Qe+=l*Ot,er+=l*Mt,lr+=l*Pt,Yr+=l*Nt,tr+=l*Tt,si+=l*ht,xi+=l*jt,zi+=l*qt,ae+=38*Re,fe+=38*Be,xe+=38*Pe,Fe+=38*Ve,ke+=38*Ge,Me+=38*et,pt+=38*tt,gt+=38*Qe,qe+=38*er,Oe+=38*lr,De+=38*Yr,Le+=38*tr,He+=38*si,Te+=38*xi,$e+=38*zi,N=1,l=ae+N+65535,N=Math.floor(l/65536),ae=l-N*65536,l=fe+N+65535,N=Math.floor(l/65536),fe=l-N*65536,l=xe+N+65535,N=Math.floor(l/65536),xe=l-N*65536,l=Fe+N+65535,N=Math.floor(l/65536),Fe=l-N*65536,l=ke+N+65535,N=Math.floor(l/65536),ke=l-N*65536,l=Me+N+65535,N=Math.floor(l/65536),Me=l-N*65536,l=pt+N+65535,N=Math.floor(l/65536),pt=l-N*65536,l=gt+N+65535,N=Math.floor(l/65536),gt=l-N*65536,l=qe+N+65535,N=Math.floor(l/65536),qe=l-N*65536,l=Oe+N+65535,N=Math.floor(l/65536),Oe=l-N*65536,l=De+N+65535,N=Math.floor(l/65536),De=l-N*65536,l=Le+N+65535,N=Math.floor(l/65536),Le=l-N*65536,l=He+N+65535,N=Math.floor(l/65536),He=l-N*65536,l=Te+N+65535,N=Math.floor(l/65536),Te=l-N*65536,l=$e+N+65535,N=Math.floor(l/65536),$e=l-N*65536,l=Se+N+65535,N=Math.floor(l/65536),Se=l-N*65536,ae+=N-1+37*(N-1),N=1,l=ae+N+65535,N=Math.floor(l/65536),ae=l-N*65536,l=fe+N+65535,N=Math.floor(l/65536),fe=l-N*65536,l=xe+N+65535,N=Math.floor(l/65536),xe=l-N*65536,l=Fe+N+65535,N=Math.floor(l/65536),Fe=l-N*65536,l=ke+N+65535,N=Math.floor(l/65536),ke=l-N*65536,l=Me+N+65535,N=Math.floor(l/65536),Me=l-N*65536,l=pt+N+65535,N=Math.floor(l/65536),pt=l-N*65536,l=gt+N+65535,N=Math.floor(l/65536),gt=l-N*65536,l=qe+N+65535,N=Math.floor(l/65536),qe=l-N*65536,l=Oe+N+65535,N=Math.floor(l/65536),Oe=l-N*65536,l=De+N+65535,N=Math.floor(l/65536),De=l-N*65536,l=Le+N+65535,N=Math.floor(l/65536),Le=l-N*65536,l=He+N+65535,N=Math.floor(l/65536),He=l-N*65536,l=Te+N+65535,N=Math.floor(l/65536),Te=l-N*65536,l=$e+N+65535,N=Math.floor(l/65536),$e=l-N*65536,l=Se+N+65535,N=Math.floor(l/65536),Se=l-N*65536,ae+=N-1+37*(N-1),z[0]=ae,z[1]=fe,z[2]=xe,z[3]=Fe,z[4]=ke,z[5]=Me,z[6]=pt,z[7]=gt,z[8]=qe,z[9]=Oe,z[10]=De,z[11]=Le,z[12]=He,z[13]=Te,z[14]=$e,z[15]=Se}function b(z,H){u(z,H,H)}function Y(z,H){const $=o();let l;for(l=0;l<16;l++)$[l]=H[l];for(l=253;l>=0;l--)b($,$),l!==2&&l!==4&&u($,$,H);for(l=0;l<16;l++)z[l]=$[l]}function W(z,H){const $=o();let l;for(l=0;l<16;l++)$[l]=H[l];for(l=250;l>=0;l--)b($,$),l!==1&&u($,$,H);for(l=0;l<16;l++)z[l]=$[l]}function ne(z,H){const $=o(),l=o(),N=o(),ae=o(),fe=o(),xe=o(),Fe=o(),ke=o(),Me=o();E($,z[1],z[0]),E(Me,H[1],H[0]),u($,$,Me),A(l,z[0],z[1]),A(Me,H[0],H[1]),u(l,l,Me),u(N,z[3],H[3]),u(N,N,g),u(ae,z[2],H[2]),A(ae,ae,ae),E(fe,l,$),E(xe,ae,N),A(Fe,ae,N),A(ke,l,$),u(z[0],fe,xe),u(z[1],ke,Fe),u(z[2],Fe,xe),u(z[3],fe,ke)}function ue(z,H,$){for(let l=0;l<4;l++)F(z[l],H[l],$)}function de(z,H){const $=o(),l=o(),N=o();Y(N,H[2]),u($,H[0],N),u(l,H[1],N),k(z,l),z[31]^=q($)<<7}function w(z,H,$){T(z[0],d),T(z[1],f),T(z[2],f),T(z[3],d);for(let l=255;l>=0;--l){const N=$[l/8|0]>>(l&7)&1;ue(z,H,N),ne(H,z),ne(z,z),ue(z,H,N)}}function P(z,H){const $=[o(),o(),o(),o()];T($[0],m),T($[1],I),T($[2],f),u($[3],m,I),w(z,$,H)}function ee(z){if(z.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const H=(0,r.hash)(z);H[0]&=248,H[31]&=127,H[31]|=64;const $=new Uint8Array(32),l=[o(),o(),o(),o()];P(l,H),de($,l);const N=new Uint8Array(64);return N.set(z),N.set($,32),{publicKey:$,secretKey:N}}n.generateKeyPairFromSeed=ee;function Q(z){const H=(0,e.randomBytes)(32,z),$=ee(H);return(0,s.wipe)(H),$}n.generateKeyPair=Q;function K(z){if(z.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}n.extractPublicKeyFromSecretKey=K;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(z,H){let $,l,N,ae;for(l=63;l>=32;--l){for($=0,N=l-32,ae=l-12;N<ae;++N)H[N]+=$-16*H[l]*V[N-(l-32)],$=Math.floor((H[N]+128)/256),H[N]-=$*256;H[N]+=$,H[l]=0}for($=0,N=0;N<32;N++)H[N]+=$-(H[31]>>4)*V[N],$=H[N]>>8,H[N]&=255;for(N=0;N<32;N++)H[N]-=$*V[N];for(l=0;l<32;l++)H[l+1]+=H[l]>>8,z[l]=H[l]&255}function re(z){const H=new Float64Array(64);for(let $=0;$<64;$++)H[$]=z[$];for(let $=0;$<64;$++)z[$]=0;J(z,H)}function we(z,H){const $=new Float64Array(64),l=[o(),o(),o(),o()],N=(0,r.hash)(z.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const ae=new Uint8Array(64);ae.set(N.subarray(32),32);const fe=new r.SHA512;fe.update(ae.subarray(32)),fe.update(H);const xe=fe.digest();fe.clean(),re(xe),P(l,xe),de(ae,l),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(z.subarray(32)),fe.update(H);const Fe=fe.digest();re(Fe);for(let ke=0;ke<32;ke++)$[ke]=xe[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)$[ke+Me]+=Fe[ke]*N[Me];return J(ae.subarray(32),$),ae}n.sign=we;function oe(z,H){const $=o(),l=o(),N=o(),ae=o(),fe=o(),xe=o(),Fe=o();return T(z[2],f),R(z[1],H),b(N,z[1]),u(ae,N,y),E(N,N,z[2]),A(ae,z[2],ae),b(fe,ae),b(xe,fe),u(Fe,xe,fe),u($,Fe,N),u($,$,ae),W($,$),u($,$,N),u($,$,ae),u($,$,ae),u(z[0],$,ae),b(l,z[0]),u(l,l,ae),L(l,N)&&u(z[0],z[0],x),b(l,z[0]),u(l,l,ae),L(l,N)?-1:(q(z[0])===H[31]>>7&&E(z[0],d,z[0]),u(z[3],z[0],z[1]),0)}function be(z,H,$){const l=new Uint8Array(32),N=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if($.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(oe(ae,z))return!1;const fe=new r.SHA512;fe.update($.subarray(0,32)),fe.update(z),fe.update(H);const xe=fe.digest();return re(xe),w(N,ae,xe),P(ae,$.subarray(32)),ne(N,ae),de(l,N),!se($,l)}n.verify=be;function le(z){let H=[o(),o(),o(),o()];if(oe(H,z))throw new Error("Ed25519: invalid public key");let $=o(),l=o(),N=H[1];A($,f,N),E(l,f,N),Y(l,l),u($,$,l);let ae=new Uint8Array(32);return k(ae,$),ae}n.convertPublicKeyToX25519=le;function me(z){const H=(0,r.hash)(z.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const $=new Uint8Array(H.subarray(0,32));return(0,s.wipe)(H),$}n.convertSecretKeyToX25519=me})(Uu);const xI="EdDSA",OI="JWT",sp=".",op="base64url",PI="utf8",TI="utf8",RI=":",NI="did",AI="key",Uf="base58btc",CI="z",DI="K36",LI=32;function Yo(n){return hr(_r(an(n),PI),op)}function ap(n){const e=_r(DI,Uf),r=CI+hr(eu([e,n]),Uf);return[NI,AI,r].join(RI)}function $I(n){return hr(n,op)}function UI(n){return _r([Yo(n.header),Yo(n.payload)].join(sp),TI)}function MI(n){return[Yo(n.header),Yo(n.payload),$I(n.signature)].join(sp)}function Mf(n=qn.randomBytes(LI)){return Uu.generateKeyPairFromSeed(n)}async function jI(n,e,r,s,o=ve.fromMiliseconds(Date.now())){const c={alg:xI,typ:OI},d=ap(s.publicKey),f=o+r,y={iss:d,sub:n,aud:e,iat:o,exp:f},g=UI({header:c,payload:y}),m=Uu.sign(s.secretKey,g);return MI({header:c,payload:y,signature:m})}const qI="PARSE_ERROR",HI="INVALID_REQUEST",zI="METHOD_NOT_FOUND",FI="INVALID_PARAMS",cp="INTERNAL_ERROR",Mu="SERVER_ERROR",BI=[-32700,-32600,-32601,-32602,-32603],ws={[qI]:{code:-32700,message:"Parse error"},[HI]:{code:-32600,message:"Invalid Request"},[zI]:{code:-32601,message:"Method not found"},[FI]:{code:-32602,message:"Invalid params"},[cp]:{code:-32603,message:"Internal error"},[Mu]:{code:-32e3,message:"Server error"}},up=Mu;function KI(n){return BI.includes(n)}function jf(n){return Object.keys(ws).includes(n)?ws[n]:ws[up]}function kI(n){const e=Object.values(ws).find(r=>r.code===n);return e||ws[up]}function hp(n,e,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):n}var lp={},vi={},qf;function VI(){if(qf)return vi;qf=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function n(){return(Gr===null||Gr===void 0?void 0:Gr.crypto)||(Gr===null||Gr===void 0?void 0:Gr.msCrypto)||{}}vi.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=e;function r(){return!!n()&&!!e()}return vi.isBrowserCryptoAvailable=r,vi}var mi={},Hf;function WI(){if(Hf)return mi;Hf=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowser=mi.isNode=mi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mi.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}mi.isNode=e;function r(){return!n()&&!e()}return mi.isBrowser=r,mi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ni;e.__exportStar(VI(),n),e.__exportStar(WI(),n)})(lp);function ju(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function fp(n=6){return BigInt(ju(n))}function jn(n,e,r){return{id:r||ju(),jsonrpc:"2.0",method:n,params:e}}function ia(n,e){return{id:n,jsonrpc:"2.0",result:e}}function na(n,e,r){return{id:n,jsonrpc:"2.0",error:GI(e,r)}}function GI(n,e){return typeof n>"u"?jf(cp):(typeof n=="string"&&(n=Object.assign(Object.assign({},jf(Mu)),{message:n})),typeof e<"u"&&(n.data=e),KI(n.code)&&(n=kI(n.code)),n)}class YI{}class JI extends YI{constructor(){super()}}class QI extends JI{constructor(e){super()}}const XI="^https?:",ZI="^wss?:";function eS(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function dp(n,e){const r=eS(n);return typeof r>"u"?!1:new RegExp(e).test(r)}function zf(n){return dp(n,XI)}function Ff(n){return dp(n,ZI)}function tS(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function pp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function qu(n){return pp(n)&&"method"in n}function sa(n){return pp(n)&&(Ei(n)||Wr(n))}function Ei(n){return"result"in n}function Wr(n){return"error"in n}class Ii extends QI{constructor(e){super(e),this.events=new qr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(jn(e.method,e.params||[],e.id||fp().toString()),r)}async requestStrict(e,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Wr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,r)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),sa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const rS=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),iS=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Bf=n=>n.split("?")[0],Kf=10,nS=rS();let sS=class{constructor(e){if(this.url=e,this.events=new qr.EventEmitter,this.registering=!1,!Ff(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(an(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Ff(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,s)=>{const o=new URLSearchParams(e).get("origin"),c=lp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!tS(e)},d=new nS(e,[],c);iS()?d.onerror=f=>{const y=f;s(this.emitError(y.error))}:d.on("error",f=>{s(this.emitError(f))}),d.onopen=()=>{this.onOpen(d),r(d)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Rs(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),o=s.message||s.toString(),c=na(e,o);this.events.emit("payload",c)}parseError(e,r=this.url){return hp(e,Bf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Kf&&this.events.setMaxListeners(Kf)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Bf(this.url)}`));return this.events.emit("register_error",r),r}};var Jo={exports:{}};Jo.exports;(function(n,e){var r=200,s="__lodash_hash_undefined__",o=1,c=2,d=9007199254740991,f="[object Arguments]",y="[object Array]",g="[object AsyncFunction]",m="[object Boolean]",I="[object Date]",x="[object Error]",T="[object Function]",D="[object GeneratorFunction]",F="[object Map]",k="[object Number]",se="[object Null]",L="[object Object]",q="[object Promise]",R="[object Proxy]",A="[object RegExp]",E="[object Set]",u="[object String]",b="[object Symbol]",Y="[object Undefined]",W="[object WeakMap]",ne="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",w="[object Float64Array]",P="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",K="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",we=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[w]=le[P]=le[ee]=le[Q]=le[K]=le[V]=le[J]=le[re]=!0,le[f]=le[y]=le[ne]=le[m]=le[ue]=le[I]=le[x]=le[T]=le[F]=le[k]=le[L]=le[A]=le[E]=le[u]=le[W]=!1;var me=typeof Gr=="object"&&Gr&&Gr.Object===Object&&Gr,z=typeof self=="object"&&self&&self.Object===Object&&self,H=me||z||Function("return this")(),$=e&&!e.nodeType&&e,l=$&&!0&&n&&!n.nodeType&&n,N=l&&l.exports===$,ae=N&&me.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),xe=fe&&fe.isTypedArray;function Fe(S,U){for(var te=-1,pe=S==null?0:S.length,at=0,Ae=[];++te<pe;){var ft=S[te];U(ft,te,S)&&(Ae[at++]=ft)}return Ae}function ke(S,U){for(var te=-1,pe=U.length,at=S.length;++te<pe;)S[at+te]=U[te];return S}function Me(S,U){for(var te=-1,pe=S==null?0:S.length;++te<pe;)if(U(S[te],te,S))return!0;return!1}function pt(S,U){for(var te=-1,pe=Array(S);++te<S;)pe[te]=U(te);return pe}function gt(S){return function(U){return S(U)}}function qe(S,U){return S.has(U)}function Oe(S,U){return S==null?void 0:S[U]}function De(S){var U=-1,te=Array(S.size);return S.forEach(function(pe,at){te[++U]=[at,pe]}),te}function Le(S,U){return function(te){return S(U(te))}}function He(S){var U=-1,te=Array(S.size);return S.forEach(function(pe){te[++U]=pe}),te}var Te=Array.prototype,$e=Function.prototype,Se=Object.prototype,Re=H["__core-js_shared__"],Be=$e.toString,Pe=Se.hasOwnProperty,Ve=function(){var S=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),Ge=Se.toString,et=RegExp("^"+Be.call(Pe).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=N?H.Buffer:void 0,Qe=H.Symbol,er=H.Uint8Array,lr=Se.propertyIsEnumerable,Yr=Te.splice,tr=Qe?Qe.toStringTag:void 0,si=Object.getOwnPropertySymbols,xi=tt?tt.isBuffer:void 0,zi=Le(Object.keys,Object),It=wr(H,"DataView"),yt=wr(H,"Map"),St=wr(H,"Promise"),xt=wr(H,"Set"),bt=wr(H,"WeakMap"),vt=wr(Object,"create"),$t=ai(It),Ut=ai(yt),Ot=ai(St),Mt=ai(xt),Pt=ai(bt),Nt=Qe?Qe.prototype:void 0,Tt=Nt?Nt.valueOf:void 0;function ht(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function jt(){this.__data__=vt?vt(null):{},this.size=0}function qt(S){var U=this.has(S)&&delete this.__data__[S];return this.size-=U?1:0,U}function ca(S){var U=this.__data__;if(vt){var te=U[S];return te===s?void 0:te}return Pe.call(U,S)?U[S]:void 0}function ua(S){var U=this.__data__;return vt?U[S]!==void 0:Pe.call(U,S)}function ha(S,U){var te=this.__data__;return this.size+=this.has(S)?0:1,te[S]=vt&&U===void 0?s:U,this}ht.prototype.clear=jt,ht.prototype.delete=qt,ht.prototype.get=ca,ht.prototype.has=ua,ht.prototype.set=ha;function Rr(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function la(){this.__data__=[],this.size=0}function fa(S){var U=this.__data__,te=Fi(U,S);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():Yr.call(U,te,1),--this.size,!0}function da(S){var U=this.__data__,te=Fi(U,S);return te<0?void 0:U[te][1]}function pa(S){return Fi(this.__data__,S)>-1}function ga(S,U){var te=this.__data__,pe=Fi(te,S);return pe<0?(++this.size,te.push([S,U])):te[pe][1]=U,this}Rr.prototype.clear=la,Rr.prototype.delete=fa,Rr.prototype.get=da,Rr.prototype.has=pa,Rr.prototype.set=ga;function oi(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function dn(){this.size=0,this.__data__={hash:new ht,map:new(yt||Rr),string:new ht}}function ya(S){var U=Oi(this,S).delete(S);return this.size-=U?1:0,U}function pn(S){return Oi(this,S).get(S)}function va(S){return Oi(this,S).has(S)}function ma(S,U){var te=Oi(this,S),pe=te.size;return te.set(S,U),this.size+=te.size==pe?0:1,this}oi.prototype.clear=dn,oi.prototype.delete=ya,oi.prototype.get=pn,oi.prototype.has=va,oi.prototype.set=ma;function gn(S){var U=-1,te=S==null?0:S.length;for(this.__data__=new oi;++U<te;)this.add(S[U])}function As(S){return this.__data__.set(S,s),this}function Cs(S){return this.__data__.has(S)}gn.prototype.add=gn.prototype.push=As,gn.prototype.has=Cs;function Hr(S){var U=this.__data__=new Rr(S);this.size=U.size}function _a(){this.__data__=new Rr,this.size=0}function wa(S){var U=this.__data__,te=U.delete(S);return this.size=U.size,te}function ba(S){return this.__data__.get(S)}function Ea(S){return this.__data__.has(S)}function Ds(S,U){var te=this.__data__;if(te instanceof Rr){var pe=te.__data__;if(!yt||pe.length<r-1)return pe.push([S,U]),this.size=++te.size,this;te=this.__data__=new oi(pe)}return te.set(S,U),this.size=te.size,this}Hr.prototype.clear=_a,Hr.prototype.delete=wa,Hr.prototype.get=ba,Hr.prototype.has=Ea,Hr.prototype.set=Ds;function Ls(S,U){var te=mn(S),pe=!te&&Vs(S),at=!te&&!pe&&Wn(S),Ae=!te&&!pe&&!at&&Ys(S),ft=te||pe||at||Ae,Ht=ft?pt(S.length,String):[],Xe=Ht.length;for(var ct in S)(U||Pe.call(S,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ae&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||zs(ct,Xe)))&&Ht.push(ct);return Ht}function Fi(S,U){for(var te=S.length;te--;)if(ks(S[te][0],U))return te;return-1}function kn(S,U,te){var pe=U(S);return mn(S)?pe:ke(pe,te(S))}function Bi(S){return S==null?S===void 0?Y:se:tr&&tr in Object(S)?qs(S):xa(S)}function Vn(S){return ki(S)&&Bi(S)==f}function Ki(S,U,te,pe,at){return S===U?!0:S==null||U==null||!ki(S)&&!ki(U)?S!==S&&U!==U:$s(S,U,te,pe,Ki,at)}function $s(S,U,te,pe,at,Ae){var ft=mn(S),Ht=mn(U),Xe=ft?y:Jr(S),ct=Ht?y:Jr(U);Xe=Xe==f?L:Xe,ct=ct==f?L:ct;var At=Xe==L,fr=ct==L,zt=Xe==ct;if(zt&&Wn(S)){if(!Wn(U))return!1;ft=!0,At=!1}if(zt&&!At)return Ae||(Ae=new Hr),ft||Ys(S)?yn(S,U,te,pe,at,Ae):Sa(S,U,Xe,te,pe,at,Ae);if(!(te&o)){var dt=At&&Pe.call(S,"__wrapped__"),rr=fr&&Pe.call(U,"__wrapped__");if(dt||rr){var zr=dt?S.value():S,Nr=rr?U.value():U;return Ae||(Ae=new Hr),at(zr,Nr,te,pe,Ae)}}return zt?(Ae||(Ae=new Hr),js(S,U,te,pe,at,Ae)):!1}function Ia(S){if(!Gs(S)||Bs(S))return!1;var U=_n(S)?et:oe;return U.test(ai(S))}function Us(S){return ki(S)&&Ws(S.length)&&!!le[Bi(S)]}function Ms(S){if(!Ks(S))return zi(S);var U=[];for(var te in Object(S))Pe.call(S,te)&&te!="constructor"&&U.push(te);return U}function yn(S,U,te,pe,at,Ae){var ft=te&o,Ht=S.length,Xe=U.length;if(Ht!=Xe&&!(ft&&Xe>Ht))return!1;var ct=Ae.get(S);if(ct&&Ae.get(U))return ct==U;var At=-1,fr=!0,zt=te&c?new gn:void 0;for(Ae.set(S,U),Ae.set(U,S);++At<Ht;){var dt=S[At],rr=U[At];if(pe)var zr=ft?pe(rr,dt,At,U,S,Ae):pe(dt,rr,At,S,U,Ae);if(zr!==void 0){if(zr)continue;fr=!1;break}if(zt){if(!Me(U,function(Nr,Qr){if(!qe(zt,Qr)&&(dt===Nr||at(dt,Nr,te,pe,Ae)))return zt.push(Qr)})){fr=!1;break}}else if(!(dt===rr||at(dt,rr,te,pe,Ae))){fr=!1;break}}return Ae.delete(S),Ae.delete(U),fr}function Sa(S,U,te,pe,at,Ae,ft){switch(te){case ue:if(S.byteLength!=U.byteLength||S.byteOffset!=U.byteOffset)return!1;S=S.buffer,U=U.buffer;case ne:return!(S.byteLength!=U.byteLength||!Ae(new er(S),new er(U)));case m:case I:case k:return ks(+S,+U);case x:return S.name==U.name&&S.message==U.message;case A:case u:return S==U+"";case F:var Ht=De;case E:var Xe=pe&o;if(Ht||(Ht=He),S.size!=U.size&&!Xe)return!1;var ct=ft.get(S);if(ct)return ct==U;pe|=c,ft.set(S,U);var At=yn(Ht(S),Ht(U),pe,at,Ae,ft);return ft.delete(S),At;case b:if(Tt)return Tt.call(S)==Tt.call(U)}return!1}function js(S,U,te,pe,at,Ae){var ft=te&o,Ht=vn(S),Xe=Ht.length,ct=vn(U),At=ct.length;if(Xe!=At&&!ft)return!1;for(var fr=Xe;fr--;){var zt=Ht[fr];if(!(ft?zt in U:Pe.call(U,zt)))return!1}var dt=Ae.get(S);if(dt&&Ae.get(U))return dt==U;var rr=!0;Ae.set(S,U),Ae.set(U,S);for(var zr=ft;++fr<Xe;){zt=Ht[fr];var Nr=S[zt],Qr=U[zt];if(pe)var Gn=ft?pe(Qr,Nr,zt,U,S,Ae):pe(Nr,Qr,zt,S,U,Ae);if(!(Gn===void 0?Nr===Qr||at(Nr,Qr,te,pe,Ae):Gn)){rr=!1;break}zr||(zr=zt=="constructor")}if(rr&&!zr){var Vi=S.constructor,Kt=U.constructor;Vi!=Kt&&"constructor"in S&&"constructor"in U&&!(typeof Vi=="function"&&Vi instanceof Vi&&typeof Kt=="function"&&Kt instanceof Kt)&&(rr=!1)}return Ae.delete(S),Ae.delete(U),rr}function vn(S){return kn(S,Ta,Hs)}function Oi(S,U){var te=S.__data__;return Fs(U)?te[typeof U=="string"?"string":"hash"]:te.map}function wr(S,U){var te=Oe(S,U);return Ia(te)?te:void 0}function qs(S){var U=Pe.call(S,tr),te=S[tr];try{S[tr]=void 0;var pe=!0}catch{}var at=Ge.call(S);return pe&&(U?S[tr]=te:delete S[tr]),at}var Hs=si?function(S){return S==null?[]:(S=Object(S),Fe(si(S),function(U){return lr.call(S,U)}))}:ot,Jr=Bi;(It&&Jr(new It(new ArrayBuffer(1)))!=ue||yt&&Jr(new yt)!=F||St&&Jr(St.resolve())!=q||xt&&Jr(new xt)!=E||bt&&Jr(new bt)!=W)&&(Jr=function(S){var U=Bi(S),te=U==L?S.constructor:void 0,pe=te?ai(te):"";if(pe)switch(pe){case $t:return ue;case Ut:return F;case Ot:return q;case Mt:return E;case Pt:return W}return U});function zs(S,U){return U=U??d,!!U&&(typeof S=="number"||be.test(S))&&S>-1&&S%1==0&&S<U}function Fs(S){var U=typeof S;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?S!=="__proto__":S===null}function Bs(S){return!!Ve&&Ve in S}function Ks(S){var U=S&&S.constructor,te=typeof U=="function"&&U.prototype||Se;return S===te}function xa(S){return Ge.call(S)}function ai(S){if(S!=null){try{return Be.call(S)}catch{}try{return S+""}catch{}}return""}function ks(S,U){return S===U||S!==S&&U!==U}var Vs=Vn(function(){return arguments}())?Vn:function(S){return ki(S)&&Pe.call(S,"callee")&&!lr.call(S,"callee")},mn=Array.isArray;function Oa(S){return S!=null&&Ws(S.length)&&!_n(S)}var Wn=xi||st;function Pa(S,U){return Ki(S,U)}function _n(S){if(!Gs(S))return!1;var U=Bi(S);return U==T||U==D||U==g||U==R}function Ws(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=d}function Gs(S){var U=typeof S;return S!=null&&(U=="object"||U=="function")}function ki(S){return S!=null&&typeof S=="object"}var Ys=xe?gt(xe):Us;function Ta(S){return Oa(S)?Ls(S):Ms(S)}function ot(){return[]}function st(){return!1}n.exports=Pa})(Jo,Jo.exports);var oS=Jo.exports;const aS=Iu(oS);function cS(n,e){return e=e||{},new Promise(function(r,s){var o=new XMLHttpRequest,c=[],d=[],f={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return d},get:function(m){return f[m.toLowerCase()]},has:function(m){return m.toLowerCase()in f}}}};for(var g in o.open(e.method||"get",n,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(m,I,x){c.push(I=I.toLowerCase()),d.push([I,x]),f[I]=f[I]?f[I]+","+x:x}),r(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(g,e.headers[g]);o.send(e.body||null)})}const uS=Object.freeze(Object.defineProperty({__proto__:null,default:cS},Symbol.toStringTag,{value:"Module"})),kf=Eu(uS);var hS=self.fetch||(self.fetch=kf.default||kf);const lS=Iu(hS);var fS={LINK_API_URL:""};function dS(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),d=c.charCodeAt(0);if(r[d]!==255)throw new TypeError(c+" is ambiguous");r[d]=o}var f=n.length,y=n.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function I(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var F=0,k=0,se=0,L=D.length;se!==L&&D[se]===0;)se++,F++;for(var q=(L-se)*m+1>>>0,R=new Uint8Array(q);se!==L;){for(var A=D[se],E=0,u=q-1;(A!==0||E<k)&&u!==-1;u--,E++)A+=256*R[u]>>>0,R[u]=A%f>>>0,A=A/f>>>0;if(A!==0)throw new Error("Non-zero carry");k=E,se++}for(var b=q-k;b!==q&&R[b]===0;)b++;for(var Y=y.repeat(F);b<q;++b)Y+=n.charAt(R[b]);return Y}function x(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var F=0;if(D[F]!==" "){for(var k=0,se=0;D[F]===y;)k++,F++;for(var L=(D.length-F)*g+1>>>0,q=new Uint8Array(L);D[F];){var R=r[D.charCodeAt(F)];if(R===255)return;for(var A=0,E=L-1;(R!==0||A<se)&&E!==-1;E--,A++)R+=f*q[E]>>>0,q[E]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");se=A,F++}if(D[F]!==" "){for(var u=L-se;u!==L&&q[u]===0;)u++;for(var b=new Uint8Array(k+(L-u)),Y=k;u!==L;)b[Y++]=q[u++];return b}}}function T(D){var F=x(D);if(F)return F;throw new Error(`Non-${e} character`)}return{encode:I,decodeUnsafe:x,decode:T}}var pS=dS,gS=pS;const gp=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},yS=n=>new TextEncoder().encode(n),vS=n=>new TextDecoder().decode(n);class mS{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _S{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return yp(this,e)}}class wS{constructor(e){this.decoders=e}or(e){return yp(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const yp=(n,e)=>new wS({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class bS{constructor(e,r,s,o){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new mS(e,r,s),this.decoder=new _S(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oa=({name:n,prefix:e,encode:r,decode:s})=>new bS(n,e,r,s),Ns=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:o}=gS(r,e);return oa({prefix:n,name:e,encode:s,decode:c=>gp(o(c))})},ES=(n,e,r,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=n.length;for(;n[c-1]==="=";)--c;const d=new Uint8Array(c*r/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const I=o[n[m]];if(I===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<r|I,f+=r,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=r||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},IS=(n,e,r)=>{const s=e[e.length-1]==="=",o=(1<<r)-1;let c="",d=0,f=0;for(let y=0;y<n.length;++y)for(f=f<<8|n[y],d+=8;d>r;)d-=r,c+=e[o&f>>d];if(d&&(c+=e[o&f<<r-d]),s)for(;c.length*r&7;)c+="=";return c},Yt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>oa({prefix:e,name:n,encode(o){return IS(o,s,r)},decode(o){return ES(o,s,r,n)}}),SS=oa({prefix:"\0",name:"identity",encode:n=>vS(n),decode:n=>yS(n)});var xS=Object.freeze({__proto__:null,identity:SS});const OS=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var PS=Object.freeze({__proto__:null,base2:OS});const TS=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var RS=Object.freeze({__proto__:null,base8:TS});const NS=Ns({prefix:"9",name:"base10",alphabet:"0123456789"});var AS=Object.freeze({__proto__:null,base10:NS});const CS=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),DS=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var LS=Object.freeze({__proto__:null,base16:CS,base16upper:DS});const $S=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),US=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),MS=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jS=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qS=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),HS=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zS=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),FS=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),BS=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var KS=Object.freeze({__proto__:null,base32:$S,base32upper:US,base32pad:MS,base32padupper:jS,base32hex:qS,base32hexupper:HS,base32hexpad:zS,base32hexpadupper:FS,base32z:BS});const kS=Ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VS=Ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var WS=Object.freeze({__proto__:null,base36:kS,base36upper:VS});const GS=Ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),YS=Ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var JS=Object.freeze({__proto__:null,base58btc:GS,base58flickr:YS});const QS=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),XS=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ZS=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),e6=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var t6=Object.freeze({__proto__:null,base64:QS,base64pad:XS,base64url:ZS,base64urlpad:e6});const vp=Array.from(""),r6=vp.reduce((n,e,r)=>(n[r]=e,n),[]),i6=vp.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function n6(n){return n.reduce((e,r)=>(e+=r6[r],e),"")}function s6(n){const e=[];for(const r of n){const s=i6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const o6=oa({prefix:"",name:"base256emoji",encode:n6,decode:s6});var a6=Object.freeze({__proto__:null,base256emoji:o6}),c6=mp,Vf=128,u6=127,h6=~u6,l6=Math.pow(2,31);function mp(n,e,r){e=e||[],r=r||0;for(var s=r;n>=l6;)e[r++]=n&255|Vf,n/=128;for(;n&h6;)e[r++]=n&255|Vf,n>>>=7;return e[r]=n|0,mp.bytes=r-s+1,e}var f6=gu,d6=128,Wf=127;function gu(n,s){var r=0,s=s||0,o=0,c=s,d,f=n.length;do{if(c>=f)throw gu.bytes=0,new RangeError("Could not decode varint");d=n[c++],r+=o<28?(d&Wf)<<o:(d&Wf)*Math.pow(2,o),o+=7}while(d>=d6);return gu.bytes=c-s,r}var p6=Math.pow(2,7),g6=Math.pow(2,14),y6=Math.pow(2,21),v6=Math.pow(2,28),m6=Math.pow(2,35),_6=Math.pow(2,42),w6=Math.pow(2,49),b6=Math.pow(2,56),E6=Math.pow(2,63),I6=function(n){return n<p6?1:n<g6?2:n<y6?3:n<v6?4:n<m6?5:n<_6?6:n<w6?7:n<b6?8:n<E6?9:10},S6={encode:c6,decode:f6,encodingLength:I6},_p=S6;const Gf=(n,e,r=0)=>(_p.encode(n,e,r),e),Yf=n=>_p.encodingLength(n),yu=(n,e)=>{const r=e.byteLength,s=Yf(n),o=s+Yf(r),c=new Uint8Array(o+r);return Gf(n,c,0),Gf(r,c,s),c.set(e,o),new x6(n,r,e,c)};class x6{constructor(e,r,s,o){this.code=e,this.size=r,this.digest=s,this.bytes=o}}const wp=({name:n,code:e,encode:r})=>new O6(n,e,r);class O6{constructor(e,r,s){this.name=e,this.code=r,this.encode=s}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?yu(this.code,r):r.then(s=>yu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const bp=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),P6=wp({name:"sha2-256",code:18,encode:bp("SHA-256")}),T6=wp({name:"sha2-512",code:19,encode:bp("SHA-512")});var R6=Object.freeze({__proto__:null,sha256:P6,sha512:T6});const Ep=0,N6="identity",Ip=gp,A6=n=>yu(Ep,Ip(n)),C6={code:Ep,name:N6,encode:Ip,digest:A6};var D6=Object.freeze({__proto__:null,identity:C6});new TextEncoder,new TextDecoder;const Jf={...xS,...PS,...RS,...AS,...LS,...KS,...WS,...JS,...t6,...a6};({...R6,...D6});function Sp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function L6(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function xp(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const Qf=xp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),kc=xp("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=L6(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),$6={utf8:Qf,"utf-8":Qf,hex:Jf.base16,latin1:kc,ascii:kc,binary:kc,...Jf};function U6(n,e="utf8"){const r=$6[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Op="wc",M6=2,Hu="core",Mi=`${Op}@2:${Hu}:`,j6={name:Hu,logger:"error"},q6={database:":memory:"},H6="crypto",Xf="client_ed25519_seed",z6=ve.ONE_DAY,F6="keychain",B6="0.3",K6="messages",k6="0.3",V6=ve.SIX_HOURS,W6="publisher",Pp="irn",G6="error",Tp="wss://relay.walletconnect.com",Zf="wss://relay.walletconnect.org",Y6="relayer",Zt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},J6="_subscription",_i={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Q6=ve.ONE_SECOND,X6="2.11.1",Z6=1e4,e2="0.3",t2="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},r2="subscription",i2="0.3",n2=ve.FIVE_SECONDS*1e3,s2="pairing",o2="0.3",ps={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},ms={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ri={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},a2="history",c2="0.3",u2="expirer",jr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},h2="0.3",Vc="verify-api",Un="https://verify.walletconnect.com",vu="https://verify.walletconnect.org",l2=[Un,vu],f2="echo",d2="https://echo.walletconnect.com";class p2{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=F6,this.version=B6,this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(r,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Wd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Gd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g2{constructor(e,r,s){this.core=e,this.logger=r,this.name=H6,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Mf(o);return ap(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=lb();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),d=Mf(c),f=fu();return await jI(f,o,z6,d)},this.generateSharedKey=(o,c,d)=>{this.isInitialized();const f=this.getPrivateKey(o),y=fb(f,c);return this.setSymKey(y,d)},this.setSymKey=async(o,c)=>{this.isInitialized();const d=c||db(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,d)=>{this.isInitialized();const f=Vd(d),y=an(c);if(lf(f)){const x=f.senderPublicKey,T=f.receiverPublicKey;o=await this.generateSharedKey(x,T)}const g=this.getSymKey(o),{type:m,senderPublicKey:I}=f;return gb({type:m,symKey:g,message:y,senderPublicKey:I})},this.decode=async(o,c,d)=>{this.isInitialized();const f=mb(c,d);if(lf(f)){const y=f.receiverPublicKey,g=f.senderPublicKey;o=await this.generateSharedKey(y,g)}try{const y=this.getSymKey(o),g=yb({symKey:y,encoded:c});return Rs(g)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Wo(o);return Os(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Wo(o);return c.senderPublicKey?hr(c.senderPublicKey,ur):void 0},this.core=e,this.logger=Je.generateChildLogger(r,this.name),this.keychain=s||new p2(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Xf)}catch{e=fu(),await this.keychain.set(Xf,e)}return U6(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class y2 extends gI{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=K6,this.version=k6,this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Mn(o);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=o,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),d=Mn(o);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=r}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Wd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Gd(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class v2 extends yI{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new qr.EventEmitter,this.name=W6,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||V6,y=du(c),g=(c==null?void 0:c.prompt)||!1,m=(c==null?void 0:c.tag)||0,I=(c==null?void 0:c.id)||fp().toString(),x={topic:s,message:o,opts:{ttl:f,relay:y,prompt:g,tag:m,id:I}},T=setTimeout(()=>this.queue.set(I,x),this.publishTimeout);try{await await Is(this.rpcPublish(s,o,f,y,g,m,I),this.publishTimeout,`Failed to publish payload, please try again. id:${I} tag:${m}`),this.removeRequestFromQueue(I),this.relayer.events.emit(Zt.publish,x)}catch(D){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=c==null?void 0:c.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(I),D;return}finally{clearTimeout(T)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,r,s,o,c,d,f){var y,g,m,I;const x={method:Fo(o.protocol).publish,params:{topic:e,message:r,ttl:s,prompt:c,tag:d},id:f};return cr((y=x.params)==null?void 0:y.prompt)&&((g=x.params)==null||delete g.prompt),cr((m=x.params)==null?void 0:m.tag)&&((I=x.params)==null||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:s,opts:o}=e;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Zt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Zt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class m2{constructor(){this.map=new Map,this.set=(e,r)=>{const s=this.get(e);this.exists(e,r)||this.map.set(e,[...s,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,r))return;const o=s.filter(c=>c!==r);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var _2=Object.defineProperty,w2=Object.defineProperties,b2=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,E2=Object.prototype.hasOwnProperty,I2=Object.prototype.propertyIsEnumerable,td=(n,e,r)=>e in n?_2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,gs=(n,e)=>{for(var r in e||(e={}))E2.call(e,r)&&td(n,r,e[r]);if(ed)for(var r of ed(e))I2.call(e,r)&&td(n,r,e[r]);return n},Wc=(n,e)=>w2(n,b2(e));class S2 extends _I{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new m2,this.events=new qr.EventEmitter,this.name=r2,this.version=i2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=du(o),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,d)=>{const f=new ve.Watch;f.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),f.stop(o),c(!0)),f.elapsed(o)>=n2&&(clearInterval(y),f.stop(o),d(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(r,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let s=!1;try{s=this.getSubscription(e).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,r)))}async unsubscribeById(e,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}});try{const o=du(s);await this.rpcUnsubscribe(e,r,o);const c=_t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,r){const s={method:Fo(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}return Mn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,s={method:Fo(r.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}}rpcUnsubscribe(e,r,s){const o={method:Fo(s.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,r){this.setSubscription(e,Wc(gs({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,gs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,gs({},r)),this.topicMap.set(r.topic,e),this.events.emit(Vr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Vr.deleted,Wc(gs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Vr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);ii(r)&&this.onBatchSubscribe(r.map((s,o)=>Wc(gs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Zt.connect,async()=>{await this.onConnect()}),this.relayer.on(Zt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async e=>{const r=Vr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Vr.deleted,async e=>{const r=Vr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var x2=Object.defineProperty,rd=Object.getOwnPropertySymbols,O2=Object.prototype.hasOwnProperty,P2=Object.prototype.propertyIsEnumerable,id=(n,e,r)=>e in n?x2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,T2=(n,e)=>{for(var r in e||(e={}))O2.call(e,r)&&id(n,r,e[r]);if(rd)for(var r of rd(e))P2.call(e,r)&&id(n,r,e[r]);return n};class R2 extends vI{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new qr.EventEmitter,this.name=Y6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async r=>{this.logger.debug("Publishing Request Payload");const s=r.id,o=this.provider.request(r);this.requestsInFlight.set(s,{promise:o,request:r});try{return await this.toEstablishConnection(),await o}catch(c){throw this.logger.debug("Failed to Publish Request"),this.logger.error(c),c}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Zt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Zt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(_i.payload,this.onPayloadHandler),this.provider.on(_i.connect,this.onConnectHandler),this.provider.on(_i.disconnect,this.onDisconnectHandler),this.provider.on(_i.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||G6})),this.messages=new y2(this.logger,e.core),this.subscriber=new S2(this,this.logger),this.publisher=new v2(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Tp,this.projectId=e.projectId,this.bundleId=Sb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Zf}...`),await this.restartTransport(Zf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Z6)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,s){this.isInitialized(),await this.publisher.publish(e,r,s),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const d=f=>{f.topic===e&&(this.subscriber.off(Vr.created,d),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Vr.created,d)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,r),f()})]),o}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Is(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Vr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await Is(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(_i.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ef())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ii(new sS(Nb({sdkVersion:X6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:s}=e;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(e){const{topic:r,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),qu(e)){if(!e.method.endsWith(J6))return;const r=e.params,{topic:s,message:o,publishedAt:c}=r.data,d={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(T2({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(e),await this.onMessageEvent(d)}else sa(e)&&this.events.emit(Zt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Zt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=ia(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(_i.payload,this.onPayloadHandler),this.provider.off(_i.connect,this.onConnectHandler),this.provider.off(_i.disconnect,this.onDisconnectHandler),this.provider.off(_i.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Zt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await Ef();SE(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Zt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(Q6)))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var N2=Object.defineProperty,nd=Object.getOwnPropertySymbols,A2=Object.prototype.hasOwnProperty,C2=Object.prototype.propertyIsEnumerable,sd=(n,e,r)=>e in n?N2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,od=(n,e)=>{for(var r in e||(e={}))A2.call(e,r)&&sd(n,r,e[r]);if(nd)for(var r of nd(e))C2.call(e,r)&&sd(n,r,e[r]);return n};class aa extends mI{constructor(e,r,s,o=Mi,c=void 0){super(e,r,s,o),this.core=e,this.logger=r,this.name=s,this.map=new Map,this.version=e2,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!cr(d)?this.map.set(this.getKey(d),d):tE(d)?this.map.set(d.id,d):rE(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(y=>aS(f[y],d[y]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const y=od(od({},this.getData(d)),f);this.map.set(d,y),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=Je.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class D2{constructor(e,r){this.core=e,this.logger=r,this.name=s2,this.version=o2,this.events=new Su,this.initialized=!1,this.storagePrefix=Mi,this.ignoredPayloadTypes=[un],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=fu(),o=await this.core.crypto.setSymKey(s),c=Or(ve.FIVE_MINUTES),d={protocol:Pp},f={topic:o,expiry:c,relay:d,active:!1},y=Vb({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:d,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:d,expiryTimestamp:f}=vf(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=f||Or(ve.FIVE_MINUTES),m={topic:o,relay:d,expiry:g,active:!1};return await this.pairings.set(o,m),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),this.events.emit(ms.create,m),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:d})),m},this.activate=async({topic:s})=>{this.isInitialized();const o=Or(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:f,reject:y}=$n();this.events.once(Lt("pairing_ping",c),({error:g})=>{g?y(g):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",_t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const d=jn(o,c),f=await this.core.crypto.encode(s,d),y=ps[o].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,y),d.id},this.sendResult=async(s,o,c)=>{const d=ia(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=ps[y.request.method].res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.sendError=async(s,o,c)=>{const d=na(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=ps[y.request.method]?ps[y.request.method].res:ps.unregistered_method.res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,_t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ui(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,d=(await this.core.history.get(o,c.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(ms.ping,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Ei(o)?this.events.emit(Lt("pairing_ping",c),{}):Wr(o)&&this.events.emit(Lt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ms.delete,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:d}=o;try{if(this.registeredMethods.includes(d))return;const f=_t("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(_t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!mr(s)){const{message:d}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(d)}if(!eE(s.uri)){const{message:d}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(d)}const c=vf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:d}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(c!=null&&c.symKey)){const{message:d}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:d}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(d)}},this.isValidPing=async s=>{if(!mr(s)){const{message:c}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!mr(s)){const{message:c}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ui(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(r,this.name),this.pairings=new aa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Zt.message,async e=>{const{topic:r,message:s}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);try{qu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):sa(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(jr.expired,async e=>{const{topic:r}=Jd(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ms.expire,{topic:r}))})}}class L2 extends pI{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new qr.EventEmitter,this.name=a2,this.version=c2,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const d={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Or(ve.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(ri.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ri.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ri.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(r,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:jn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ri.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ri.created,e=>{const r=ri.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ri.updated,e=>{const r=ri.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ri.deleted,e=>{const r=ri.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $2 extends wI{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new qr.EventEmitter,this.name=u2,this.version=h2,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:o};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(jr.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(jr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(r,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Ab(e);if(typeof e=="number")return Cb(e);const{message:r}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(e,r){const{expiry:s}=r;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(jr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(jr.created,e=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.expired,e=>{const r=jr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.deleted,e=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class U2 extends bI{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Vc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||zn()||!Fn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=vu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(d),c=await this.fetchAttestation(s.attestationId,vu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),d=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),d.status===200?await d.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Vc))return c();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=Vc,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=c}),new Promise((c,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Un;return l2.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Un}`),o=Un),o},this.logger=Je.generateChildLogger(r,this.name),this.verifyUrl=Un,this.abortController=new AbortController,this.isDevEnv=Du()&&fS.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class M2 extends EI{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.context=f2,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:d,enableEncrypted:f=!1}=s,y=`${d2}/${this.projectId}/clients`;await lS(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(r,this.context)}}var j2=Object.defineProperty,ad=Object.getOwnPropertySymbols,q2=Object.prototype.hasOwnProperty,H2=Object.prototype.propertyIsEnumerable,cd=(n,e,r)=>e in n?j2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ud=(n,e)=>{for(var r in e||(e={}))q2.call(e,r)&&cd(n,r,e[r]);if(ad)for(var r of ad(e))H2.call(e,r)&&cd(n,r,e[r]);return n};class zu extends dI{constructor(e){super(e),this.protocol=Op,this.version=M6,this.name=Hu,this.events=new qr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Tp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||j6.logger}));this.logger=Je.generateChildLogger(r,this.name),this.heartbeat=new Kn.HeartBeat,this.crypto=new g2(this,this.logger,e==null?void 0:e.keychain),this.history=new L2(this,this.logger),this.expirer=new $2(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new nI(ud(ud({},q6),e==null?void 0:e.storageOptions)),this.relayer=new R2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new D2(this,this.logger),this.verify=new U2(this.projectId||"",this.logger),this.echoClient=new M2(this.projectId||"",this.logger)}static async init(e){const r=new zu(e);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(t2,s),r}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const z2=zu,Rp="wc",Np=2,Ap="client",Fu=`${Rp}@${Np}:${Ap}:`,Gc={name:Ap,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},hd="WALLETCONNECT_DEEPLINK_CHOICE",F2="proposal",Cp="Proposal expired",B2="session",qo=ve.SEVEN_DAYS,K2="engine",wi={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},Yc={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},k2="request",V2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var W2=Object.defineProperty,G2=Object.defineProperties,Y2=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,J2=Object.prototype.hasOwnProperty,Q2=Object.prototype.propertyIsEnumerable,fd=(n,e,r)=>e in n?W2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ar=(n,e)=>{for(var r in e||(e={}))J2.call(e,r)&&fd(n,r,e[r]);if(ld)for(var r of ld(e))Q2.call(e,r)&&fd(n,r,e[r]);return n},Ln=(n,e)=>G2(n,Y2(e));class X2 extends SI{constructor(e){super(e),this.name=K2,this.events=new Su,this.initialized=!1,this.ignoredPayloadTypes=[un],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(wi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=Ln(ar({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:y}=s;let g=o,m,I=!1;if(g&&(I=this.client.core.pairing.pairings.get(g).active),!g||!I){const{topic:R,uri:A}=await this.client.core.pairing.create();g=R,m=A}const x=await this.client.core.crypto.generateKeyPair(),T=wi.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,D=Or(T),F=ar({requiredNamespaces:c,optionalNamespaces:d,relays:y??[{protocol:Pp}],proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:D},f&&{sessionProperties:f}),{reject:k,resolve:se,done:L}=$n(T,Cp);if(this.events.once(Lt("session_connect"),async({error:R,session:A})=>{if(R)k(R);else if(A){A.self.publicKey=x;const E=Ln(ar({},A),{requiredNamespaces:F.requiredNamespaces,optionalNamespaces:F.optionalNamespaces});await this.client.session.set(A.topic,E),await this.setExpiry(A.topic,A.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:A.peer.metadata}),se(E)}}),!g){const{message:R}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(R)}const q=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:F,throwOnFailedPublish:!0});return await this.setProposal(q,ar({id:q},F)),{uri:m,approval:L}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:d}=r,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:g,requiredNamespaces:m,optionalNamespaces:I}=f;y=y||"";const x=await this.client.core.crypto.generateKeyPair(),T=g.publicKey,D=await this.client.core.crypto.generateSharedKey(x,T);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(s,_t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const F=ar({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:x,metadata:this.client.metadata},expiry:Or(qo)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(D);const k=Ln(ar({},F),{topic:D,requiredNamespaces:m,optionalNamespaces:I,pairingTopic:y,acknowledged:!1,self:F.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:x});await this.client.session.set(D,k);try{await this.sendRequest({topic:D,method:"wc_sessionSettle",params:F,throwOnFailedPublish:!0})}catch(se){throw this.client.logger.error(se),this.client.session.delete(D,_t("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(D),se}return await this.setExpiry(D,Or(qo)),{topic:D,acknowledged:()=>new Promise(se=>setTimeout(()=>se(this.client.session.get(D)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,_t("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:f,reject:y}=$n();return this.events.once(Lt("session_update",c),({error:g})=>{g?y(g):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:d,reject:f}=$n();return this.events.once(Lt("session_extend",o),({error:y})=>{y?f(y):d()}),await this.setExpiry(s,Or(qo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:c,expiry:d=wi.wc_sessionRequest.req.ttl}=r,f=ju(),{done:y,resolve:g,reject:m}=$n(d,"Request expired. Please try again.");return this.events.once(Lt("session_request",f),({error:I,result:x})=>{I?m(I):g(x)}),await Promise.all([new Promise(async I=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:Ln(ar({},o),{expiryTimestamp:Or(d)}),chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(x=>m(x)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),I()}),new Promise(async I=>{const x=await Lb(this.client.core.storage,hd);Db({id:f,topic:c,wcDeepLink:x}),I()}),y()]).then(I=>I[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:c}=o;Ei(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Wr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:d,reject:f}=$n();this.events.once(Lt("session_ping",o),({error:y})=>{y?f(y):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:c}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:_t("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Xb(s,r))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async r=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:d=0}=r,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,_t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(hd).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,_t("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:d,topic:s})},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,_t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=bi.idle,this.client.events.emit("session_request_expire",{id:r}))},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,Or(wi.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async r=>{const{id:s,topic:o,params:c,verifyContext:d}=r,f=c.request.expiryTimestamp||Or(wi.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:d}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async r=>{const{topic:s,method:o,params:c,expiry:d,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:g}=r,m=jn(o,c,y);if(Fn()&&V2.includes(o)){const T=Mn(JSON.stringify(m));this.client.core.verify.register({attestationId:T})}const I=await this.client.core.crypto.encode(s,m),x=wi[o].req;return d&&(x.ttl=d),f&&(x.id=f),this.client.core.history.set(s,m),g?(x.internal=Ln(ar({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,I,x)):this.client.core.relayer.publish(s,I,x).catch(T=>this.client.logger.error(T)),m.id},this.sendResult=async r=>{const{id:s,topic:o,result:c,throwOnFailedPublish:d}=r,f=ia(s,c),y=await this.client.core.crypto.encode(o,f),g=await this.client.core.history.get(o,s),m=wi[g.request.method].res;d?(m.internal=Ln(ar({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,m)):this.client.core.relayer.publish(o,y,m).catch(I=>this.client.logger.error(I)),await this.client.core.history.resolve(f)},this.sendError=async(r,s,o)=>{const c=na(r,o),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,r),y=wi[f.request.method].res;this.client.core.relayer.publish(s,d,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Ui(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ui(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=r=>{const{topic:s,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(ar({},s.params));const d=o.expiryTimestamp||Or(wi.wc_sessionPropose.req.ttl),f=ar({id:c,pairingTopic:r,expiryTimestamp:d},o);await this.setProposal(c,f);const y=Mn(JSON.stringify(s)),g=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:g})}catch(d){await this.sendError(c,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(Ei(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const g=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const m=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:r})}else Wr(s)&&(await this.client.proposal.delete(o,_t("USER_DISCONNECTED")),this.events.emit(Lt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:y,namespaces:g,sessionProperties:m,pairingTopic:I}=s.params,x=ar({topic:r,relay:d,expiry:y,namespaces:g,acknowledged:!0,pairingTopic:I,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},m&&{sessionProperties:m});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Lt("session_connect"),{session:x}),this.cleanupDuplicatePairings(x)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;Ei(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Lt("session_approve",o),{})):Wr(s)&&(await this.client.session.delete(r,_t("USER_DISCONNECTED")),this.events.emit(Lt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:c}=s;try{const d=`${r}_session_update`,f=Uo.get(d);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ar({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),Uo.set(d,c)}catch(d){await this.sendError(c,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Lt("session_update",o),{}):Wr(s)&&this.events.emit(Lt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Or(qo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Lt("session_extend",o),{}):Wr(s)&&this.events.emit(Lt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{Ei(s)?this.events.emit(Lt("session_ping",o),{}):Wr(s)&&this.events.emit(Lt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Zt.publish,async()=>{c(await this.deleteSession({topic:r,id:o}))})}),this.sendResult({id:o,topic:r,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:_t("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(ar({topic:r},c));const d=Mn(JSON.stringify(jn("wc_sessionRequest",c,o))),f=this.client.session.get(r),y=await this.getVerifyContext(d,f.peer.metadata),g={id:o,topic:r,params:c,verifyContext:y};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;Ei(s)?this.events.emit(Lt("session_request",o),{result:s.result}):Wr(s)&&this.events.emit(Lt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:c}=s;try{const d=`${r}_session_event_${c.event.name}`,f=Uo.get(d);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ar({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),Uo.set(d,o)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:r,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===r&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Lt("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,jn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!mr(r)){const{message:y}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:d,relays:f}=r;if(cr(s)||await this.isValidPairingTopic(s),!hE(f,!0)){const{message:y}=ce("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!cr(o)&&Ss(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!cr(c)&&Ss(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),cr(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=uE(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!mr(r))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:d}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Mc(o,"approve()");if(y)throw new Error(y.message);const g=wf(f.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Wt(c,!0)){const{message:m}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(m)}cr(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!mr(r)){const{message:c}=ce("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!fE(o)){const{message:c}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!mr(r)){const{message:g}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:d}=r;if(!Xd(s)){const{message:g}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=iE(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Mc(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Ui(d)){const{message:g}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async r=>{if(!mr(r)){const{message:y}=ce("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(y)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=Mc(o,"update()");if(d)throw new Error(d.message);const f=wf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!mr(r)){const{message:o}=ce("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!mr(r)){const{message:y}=ce("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:d}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!_f(f,c)){const{message:y}=ce("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!dE(o)){const{message:y}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!yE(f,c,o.method)){const{message:y}=ce("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(d&&!wE(d,Yc)){const{message:y}=ce("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Yc.min} and ${Yc.max}`);throw new Error(y)}},this.isValidRespond=async r=>{var s;if(!mr(r)){const{message:d}=ce("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(d)}const{topic:o,response:c}=r;try{await this.isValidSessionTopic(o)}catch(d){throw(s=r==null?void 0:r.response)!=null&&s.id&&this.cleanupAfterResponse(r),d}if(!pE(c)){const{message:d}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(d)}},this.isValidPing=async r=>{if(!mr(r)){const{message:o}=ce("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!mr(r)){const{message:f}=ce("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!_f(d,c)){const{message:f}=ce("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!gE(o)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!vE(d,c,o.name)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!mr(r)){const{message:o}=ce("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Un,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Zt.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);try{qu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):sa(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(jr.expired,async e=>{const{topic:r,id:s}=Jd(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ms.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:r}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:r}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=ce("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:r}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!lE(e)){const{message:r}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Z2 extends aa{constructor(e,r){super(e,r,F2,Fu),this.core=e,this.logger=r}}let e5=class extends aa{constructor(e,r){super(e,r,B2,Fu),this.core=e,this.logger=r}};class t5 extends aa{constructor(e,r){super(e,r,k2,Fu,s=>s.id),this.core=e,this.logger=r}}let r5=class Dp extends II{constructor(e){super(e),this.protocol=Rp,this.version=Np,this.name=Gc.name,this.events=new qr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Gc.name,this.metadata=(e==null?void 0:e.metadata)||Ob();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Gc.logger}));this.core=(e==null?void 0:e.core)||new z2(e),this.logger=Je.generateChildLogger(r,this.name),this.session=new e5(this.core,this.logger),this.proposal=new Z2(this.core,this.logger),this.pendingRequest=new t5(this.core,this.logger),this.engine=new X2(this)}static async init(e){const r=new Dp(e);return await r.initialize(),r}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var mu={exports:{}};(function(n,e){var r=typeof self<"u"?self:Gr,s=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(d){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(w){return w&&DataView.prototype.isPrototypeOf(w)}if(f.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(w){return w&&g.indexOf(Object.prototype.toString.call(w))>-1};function I(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function x(w){return typeof w!="string"&&(w=String(w)),w}function T(w){var P={next:function(){var ee=w.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(P[Symbol.iterator]=function(){return P}),P}function D(w){this.map={},w instanceof D?w.forEach(function(P,ee){this.append(ee,P)},this):Array.isArray(w)?w.forEach(function(P){this.append(P[0],P[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(P){this.append(P,w[P])},this)}D.prototype.append=function(w,P){w=I(w),P=x(P);var ee=this.map[w];this.map[w]=ee?ee+", "+P:P},D.prototype.delete=function(w){delete this.map[I(w)]},D.prototype.get=function(w){return w=I(w),this.has(w)?this.map[w]:null},D.prototype.has=function(w){return this.map.hasOwnProperty(I(w))},D.prototype.set=function(w,P){this.map[I(w)]=x(P)},D.prototype.forEach=function(w,P){for(var ee in this.map)this.map.hasOwnProperty(ee)&&w.call(P,this.map[ee],ee,this)},D.prototype.keys=function(){var w=[];return this.forEach(function(P,ee){w.push(ee)}),T(w)},D.prototype.values=function(){var w=[];return this.forEach(function(P){w.push(P)}),T(w)},D.prototype.entries=function(){var w=[];return this.forEach(function(P,ee){w.push([ee,P])}),T(w)},f.iterable&&(D.prototype[Symbol.iterator]=D.prototype.entries);function F(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function k(w){return new Promise(function(P,ee){w.onload=function(){P(w.result)},w.onerror=function(){ee(w.error)}})}function se(w){var P=new FileReader,ee=k(P);return P.readAsArrayBuffer(w),ee}function L(w){var P=new FileReader,ee=k(P);return P.readAsText(w),ee}function q(w){for(var P=new Uint8Array(w),ee=new Array(P.length),Q=0;Q<P.length;Q++)ee[Q]=String.fromCharCode(P[Q]);return ee.join("")}function R(w){if(w.slice)return w.slice(0);var P=new Uint8Array(w.byteLength);return P.set(new Uint8Array(w)),P.buffer}function A(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:f.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:f.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():f.arrayBuffer&&f.blob&&y(w)?(this._bodyArrayBuffer=R(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||m(w))?this._bodyArrayBuffer=R(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var w=F(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?F(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(se)}),this.text=function(){var w=F(this);if(w)return w;if(this._bodyBlob)return L(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(q(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(Y)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(w){var P=w.toUpperCase();return E.indexOf(P)>-1?P:w}function b(w,P){P=P||{};var ee=P.body;if(w instanceof b){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,P.headers||(this.headers=new D(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!ee&&w._bodyInit!=null&&(ee=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new D(P.headers)),this.method=u(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function Y(w){var P=new FormData;return w.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),K=Q.shift().replace(/\+/g," "),V=Q.join("=").replace(/\+/g," ");P.append(decodeURIComponent(K),decodeURIComponent(V))}}),P}function W(w){var P=new D,ee=w.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var K=Q.split(":"),V=K.shift().trim();if(V){var J=K.join(":").trim();P.append(V,J)}}),P}A.call(b.prototype);function ne(w,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new D(P.headers),this.url=P.url||"",this._initBody(w)}A.call(ne.prototype),ne.prototype.clone=function(){return new ne(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new D(this.headers),url:this.url})},ne.error=function(){var w=new ne(null,{status:0,statusText:""});return w.type="error",w};var ue=[301,302,303,307,308];ne.redirect=function(w,P){if(ue.indexOf(P)===-1)throw new RangeError("Invalid status code");return new ne(null,{status:P,headers:{location:w}})},d.DOMException=c.DOMException;try{new d.DOMException}catch{d.DOMException=function(P,ee){this.message=P,this.name=ee;var Q=Error(P);this.stack=Q.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function de(w,P){return new Promise(function(ee,Q){var K=new b(w,P);if(K.signal&&K.signal.aborted)return Q(new d.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:W(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var we="response"in V?V.response:V.responseText;ee(new ne(we,re))},V.onerror=function(){Q(new TypeError("Network request failed"))},V.ontimeout=function(){Q(new TypeError("Network request failed"))},V.onabort=function(){Q(new d.DOMException("Aborted","AbortError"))},V.open(K.method,K.url,!0),K.credentials==="include"?V.withCredentials=!0:K.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),K.headers.forEach(function(re,we){V.setRequestHeader(we,re)}),K.signal&&(K.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&K.signal.removeEventListener("abort",J)}),V.send(typeof K._bodyInit>"u"?null:K._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=D,c.Request=b,c.Response=ne),d.Headers=D,d.Request=b,d.Response=ne,d.fetch=de,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,n.exports=e})(mu,mu.exports);var i5=mu.exports;const dd=Iu(i5),n5={Accept:"application/json","Content-Type":"application/json"},s5="POST",pd={headers:n5,method:s5},gd=10;class Hi{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new qr.EventEmitter,this.isAvailable=!1,this.registering=!1,!zf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const s=an(e),c=await(await dd(this.url,Object.assign(Object.assign({},pd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!zf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=an({id:1,jsonrpc:"2.0",method:"test",params:[]});await dd(e,Object.assign(Object.assign({},pd),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Rs(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),o=s.message||s.toString(),c=na(e,o);this.events.emit("payload",c)}parseError(e,r=this.url){return hp(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>gd&&this.events.setMaxListeners(gd)}}const yd="error",o5="wss://relay.walletconnect.com",a5="wc",c5="universal_provider",vd=`${a5}@2:${c5}:`,u5="https://rpc.walletconnect.com/v1/",Si={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_u={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var r,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",g=500,m="__lodash_placeholder__",I=1,x=2,T=4,D=1,F=2,k=1,se=2,L=4,q=8,R=16,A=32,E=64,u=128,b=256,Y=512,W=30,ne="...",ue=800,de=16,w=1,P=2,ee=3,Q=1/0,K=9007199254740991,V=17976931348623157e292,J=NaN,re=4294967295,we=re-1,oe=re>>>1,be=[["ary",u],["bind",k],["bindKey",se],["curry",q],["curryRight",R],["flip",Y],["partial",A],["partialRight",E],["rearg",b]],le="[object Arguments]",me="[object Array]",z="[object AsyncFunction]",H="[object Boolean]",$="[object Date]",l="[object DOMException]",N="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",xe="[object Map]",Fe="[object Number]",ke="[object Null]",Me="[object Object]",pt="[object Promise]",gt="[object Proxy]",qe="[object RegExp]",Oe="[object Set]",De="[object String]",Le="[object Symbol]",He="[object Undefined]",Te="[object WeakMap]",$e="[object WeakSet]",Se="[object ArrayBuffer]",Re="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",Ve="[object Int8Array]",Ge="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",er="[object Uint16Array]",lr="[object Uint32Array]",Yr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,si=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xi=/&(?:amp|lt|gt|quot|#39);/g,zi=/[&<>"']/g,It=RegExp(xi.source),yt=RegExp(zi.source),St=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(Ot.source),Pt=/^\s+/,Nt=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ca=/[()=,{}\[\]\/\s]/,ua=/\\(\\)?/g,ha=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rr=/\w*$/,la=/^[-+]0x[0-9a-f]+$/i,fa=/^0b[01]+$/i,da=/^\[object .+?Constructor\]$/,pa=/^0o[0-7]+$/i,ga=/^(?:0|[1-9]\d*)$/,oi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dn=/($^)/,ya=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",va="\\u0300-\\u036f",ma="\\ufe20-\\ufe2f",gn="\\u20d0-\\u20ff",As=va+ma+gn,Cs="\\u2700-\\u27bf",Hr="a-z\\xdf-\\xf6\\xf8-\\xff",_a="\\xac\\xb1\\xd7\\xf7",wa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ba="\\u2000-\\u206f",Ea=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ds="A-Z\\xc0-\\xd6\\xd8-\\xde",Ls="\\ufe0e\\ufe0f",Fi=_a+wa+ba+Ea,kn="[']",Bi="["+pn+"]",Vn="["+Fi+"]",Ki="["+As+"]",$s="\\d+",Ia="["+Cs+"]",Us="["+Hr+"]",Ms="[^"+pn+Fi+$s+Cs+Hr+Ds+"]",yn="\\ud83c[\\udffb-\\udfff]",Sa="(?:"+Ki+"|"+yn+")",js="[^"+pn+"]",vn="(?:\\ud83c[\\udde6-\\uddff]){2}",Oi="[\\ud800-\\udbff][\\udc00-\\udfff]",wr="["+Ds+"]",qs="\\u200d",Hs="(?:"+Us+"|"+Ms+")",Jr="(?:"+wr+"|"+Ms+")",zs="(?:"+kn+"(?:d|ll|m|re|s|t|ve))?",Fs="(?:"+kn+"(?:D|LL|M|RE|S|T|VE))?",Bs=Sa+"?",Ks="["+Ls+"]?",xa="(?:"+qs+"(?:"+[js,vn,Oi].join("|")+")"+Ks+Bs+")*",ai="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ks="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Vs=Ks+Bs+xa,mn="(?:"+[Ia,vn,Oi].join("|")+")"+Vs,Oa="(?:"+[js+Ki+"?",Ki,vn,Oi,Bi].join("|")+")",Wn=RegExp(kn,"g"),Pa=RegExp(Ki,"g"),_n=RegExp(yn+"(?="+yn+")|"+Oa+Vs,"g"),Ws=RegExp([wr+"?"+Us+"+"+zs+"(?="+[Vn,wr,"$"].join("|")+")",Jr+"+"+Fs+"(?="+[Vn,wr+Hs,"$"].join("|")+")",wr+"?"+Hs+"+"+zs,wr+"+"+Fs,ks,ai,$s,mn].join("|"),"g"),Gs=RegExp("["+qs+pn+As+Ls+"]"),ki=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ys=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ta=-1,ot={};ot[Be]=ot[Pe]=ot[Ve]=ot[Ge]=ot[et]=ot[tt]=ot[Qe]=ot[er]=ot[lr]=!0,ot[le]=ot[me]=ot[Se]=ot[H]=ot[Re]=ot[$]=ot[N]=ot[ae]=ot[xe]=ot[Fe]=ot[Me]=ot[qe]=ot[Oe]=ot[De]=ot[Te]=!1;var st={};st[le]=st[me]=st[Se]=st[Re]=st[H]=st[$]=st[Be]=st[Pe]=st[Ve]=st[Ge]=st[et]=st[xe]=st[Fe]=st[Me]=st[qe]=st[Oe]=st[De]=st[Le]=st[tt]=st[Qe]=st[er]=st[lr]=!0,st[N]=st[ae]=st[Te]=!1;var S={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ae=parseInt,ft=typeof ys=="object"&&ys&&ys.Object===Object&&ys,Ht=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||Ht||Function("return this")(),ct=e&&!e.nodeType&&e,At=ct&&!0&&n&&!n.nodeType&&n,fr=At&&At.exports===ct,zt=fr&&ft.process,dt=function(){try{var M=At&&At.require&&At.require("util").types;return M||zt&&zt.binding&&zt.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,zr=dt&&dt.isDate,Nr=dt&&dt.isMap,Qr=dt&&dt.isRegExp,Gn=dt&&dt.isSet,Vi=dt&&dt.isTypedArray;function Kt(M,G,B){switch(B.length){case 0:return M.call(G);case 1:return M.call(G,B[0]);case 2:return M.call(G,B[0],B[1]);case 3:return M.call(G,B[0],B[1],B[2])}return M.apply(G,B)}function Up(M,G,B,ge){for(var Ne=-1,rt=M==null?0:M.length;++Ne<rt;){var Ft=M[Ne];G(ge,Ft,B(Ft),M)}return ge}function Ar(M,G){for(var B=-1,ge=M==null?0:M.length;++B<ge&&G(M[B],B,M)!==!1;);return M}function Mp(M,G){for(var B=M==null?0:M.length;B--&&G(M[B],B,M)!==!1;);return M}function ku(M,G){for(var B=-1,ge=M==null?0:M.length;++B<ge;)if(!G(M[B],B,M))return!1;return!0}function Pi(M,G){for(var B=-1,ge=M==null?0:M.length,Ne=0,rt=[];++B<ge;){var Ft=M[B];G(Ft,B,M)&&(rt[Ne++]=Ft)}return rt}function Js(M,G){var B=M==null?0:M.length;return!!B&&wn(M,G,0)>-1}function Ra(M,G,B){for(var ge=-1,Ne=M==null?0:M.length;++ge<Ne;)if(B(G,M[ge]))return!0;return!1}function mt(M,G){for(var B=-1,ge=M==null?0:M.length,Ne=Array(ge);++B<ge;)Ne[B]=G(M[B],B,M);return Ne}function Ti(M,G){for(var B=-1,ge=G.length,Ne=M.length;++B<ge;)M[Ne+B]=G[B];return M}function Na(M,G,B,ge){var Ne=-1,rt=M==null?0:M.length;for(ge&&rt&&(B=M[++Ne]);++Ne<rt;)B=G(B,M[Ne],Ne,M);return B}function jp(M,G,B,ge){var Ne=M==null?0:M.length;for(ge&&Ne&&(B=M[--Ne]);Ne--;)B=G(B,M[Ne],Ne,M);return B}function Aa(M,G){for(var B=-1,ge=M==null?0:M.length;++B<ge;)if(G(M[B],B,M))return!0;return!1}var qp=Ca("length");function Hp(M){return M.split("")}function zp(M){return M.match(qt)||[]}function Vu(M,G,B){var ge;return B(M,function(Ne,rt,Ft){if(G(Ne,rt,Ft))return ge=rt,!1}),ge}function Qs(M,G,B,ge){for(var Ne=M.length,rt=B+(ge?1:-1);ge?rt--:++rt<Ne;)if(G(M[rt],rt,M))return rt;return-1}function wn(M,G,B){return G===G?Zp(M,G,B):Qs(M,Wu,B)}function Fp(M,G,B,ge){for(var Ne=B-1,rt=M.length;++Ne<rt;)if(ge(M[Ne],G))return Ne;return-1}function Wu(M){return M!==M}function Gu(M,G){var B=M==null?0:M.length;return B?La(M,G)/B:J}function Ca(M){return function(G){return G==null?r:G[M]}}function Da(M){return function(G){return M==null?r:M[G]}}function Yu(M,G,B,ge,Ne){return Ne(M,function(rt,Ft,ut){B=ge?(ge=!1,rt):G(B,rt,Ft,ut)}),B}function Bp(M,G){var B=M.length;for(M.sort(G);B--;)M[B]=M[B].value;return M}function La(M,G){for(var B,ge=-1,Ne=M.length;++ge<Ne;){var rt=G(M[ge]);rt!==r&&(B=B===r?rt:B+rt)}return B}function $a(M,G){for(var B=-1,ge=Array(M);++B<M;)ge[B]=G(B);return ge}function Kp(M,G){return mt(G,function(B){return[B,M[B]]})}function Ju(M){return M&&M.slice(0,eh(M)+1).replace(Pt,"")}function br(M){return function(G){return M(G)}}function Ua(M,G){return mt(G,function(B){return M[B]})}function Yn(M,G){return M.has(G)}function Qu(M,G){for(var B=-1,ge=M.length;++B<ge&&wn(G,M[B],0)>-1;);return B}function Xu(M,G){for(var B=M.length;B--&&wn(G,M[B],0)>-1;);return B}function kp(M,G){for(var B=M.length,ge=0;B--;)M[B]===G&&++ge;return ge}var Vp=Da(S),Wp=Da(U);function Gp(M){return"\\"+pe[M]}function Yp(M,G){return M==null?r:M[G]}function bn(M){return Gs.test(M)}function Jp(M){return ki.test(M)}function Qp(M){for(var G,B=[];!(G=M.next()).done;)B.push(G.value);return B}function Ma(M){var G=-1,B=Array(M.size);return M.forEach(function(ge,Ne){B[++G]=[Ne,ge]}),B}function Zu(M,G){return function(B){return M(G(B))}}function Ri(M,G){for(var B=-1,ge=M.length,Ne=0,rt=[];++B<ge;){var Ft=M[B];(Ft===G||Ft===m)&&(M[B]=m,rt[Ne++]=B)}return rt}function Xs(M){var G=-1,B=Array(M.size);return M.forEach(function(ge){B[++G]=ge}),B}function Xp(M){var G=-1,B=Array(M.size);return M.forEach(function(ge){B[++G]=[ge,ge]}),B}function Zp(M,G,B){for(var ge=B-1,Ne=M.length;++ge<Ne;)if(M[ge]===G)return ge;return-1}function eg(M,G,B){for(var ge=B+1;ge--;)if(M[ge]===G)return ge;return ge}function En(M){return bn(M)?rg(M):qp(M)}function Fr(M){return bn(M)?ig(M):Hp(M)}function eh(M){for(var G=M.length;G--&&Nt.test(M.charAt(G)););return G}var tg=Da(te);function rg(M){for(var G=_n.lastIndex=0;_n.test(M);)++G;return G}function ig(M){return M.match(_n)||[]}function ng(M){return M.match(Ws)||[]}var sg=function M(G){G=G==null?Xe:In.defaults(Xe.Object(),G,In.pick(Xe,Ys));var B=G.Array,ge=G.Date,Ne=G.Error,rt=G.Function,Ft=G.Math,ut=G.Object,ja=G.RegExp,og=G.String,Cr=G.TypeError,Zs=B.prototype,ag=rt.prototype,Sn=ut.prototype,eo=G["__core-js_shared__"],to=ag.toString,nt=Sn.hasOwnProperty,cg=0,th=function(){var t=/[^.]+$/.exec(eo&&eo.keys&&eo.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ro=Sn.toString,ug=to.call(ut),hg=Xe._,lg=ja("^"+to.call(nt).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=fr?G.Buffer:r,Ni=G.Symbol,no=G.Uint8Array,rh=io?io.allocUnsafe:r,so=Zu(ut.getPrototypeOf,ut),ih=ut.create,nh=Sn.propertyIsEnumerable,oo=Zs.splice,sh=Ni?Ni.isConcatSpreadable:r,Jn=Ni?Ni.iterator:r,Wi=Ni?Ni.toStringTag:r,ao=function(){try{var t=Xi(ut,"defineProperty");return t({},"",{}),t}catch{}}(),fg=G.clearTimeout!==Xe.clearTimeout&&G.clearTimeout,dg=ge&&ge.now!==Xe.Date.now&&ge.now,pg=G.setTimeout!==Xe.setTimeout&&G.setTimeout,co=Ft.ceil,uo=Ft.floor,qa=ut.getOwnPropertySymbols,gg=io?io.isBuffer:r,oh=G.isFinite,yg=Zs.join,vg=Zu(ut.keys,ut),Bt=Ft.max,Jt=Ft.min,mg=ge.now,_g=G.parseInt,ah=Ft.random,wg=Zs.reverse,Ha=Xi(G,"DataView"),Qn=Xi(G,"Map"),za=Xi(G,"Promise"),xn=Xi(G,"Set"),Xn=Xi(G,"WeakMap"),Zn=Xi(ut,"create"),ho=Xn&&new Xn,On={},bg=Zi(Ha),Eg=Zi(Qn),Ig=Zi(za),Sg=Zi(xn),xg=Zi(Xn),lo=Ni?Ni.prototype:r,es=lo?lo.valueOf:r,ch=lo?lo.toString:r;function v(t){if(Rt(t)&&!Ce(t)&&!(t instanceof Ye)){if(t instanceof Dr)return t;if(nt.call(t,"__wrapped__"))return ul(t)}return new Dr(t)}var Pn=function(){function t(){}return function(i){if(!Et(i))return{};if(ih)return ih(i);t.prototype=i;var a=new t;return t.prototype=r,a}}();function fo(){}function Dr(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}v.templateSettings={escape:St,evaluate:xt,interpolate:bt,variable:"",imports:{_:v}},v.prototype=fo.prototype,v.prototype.constructor=v,Dr.prototype=Pn(fo.prototype),Dr.prototype.constructor=Dr;function Ye(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Og(){var t=new Ye(this.__wrapped__);return t.__actions__=dr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=dr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=dr(this.__views__),t}function Pg(){if(this.__filtered__){var t=new Ye(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Tg(){var t=this.__wrapped__.value(),i=this.__dir__,a=Ce(t),h=i<0,p=a?t.length:0,_=H0(0,p,this.__views__),O=_.start,C=_.end,j=C-O,X=h?C:O-1,Z=this.__iteratees__,ie=Z.length,he=0,ye=Jt(j,this.__takeCount__);if(!a||!h&&p==j&&ye==j)return Ch(t,this.__actions__);var Ee=[];e:for(;j--&&he<ye;){X+=i;for(var ze=-1,Ie=t[X];++ze<ie;){var We=Z[ze],Ze=We.iteratee,Sr=We.type,sr=Ze(Ie);if(Sr==P)Ie=sr;else if(!sr){if(Sr==w)continue e;break e}}Ee[he++]=Ie}return Ee}Ye.prototype=Pn(fo.prototype),Ye.prototype.constructor=Ye;function Gi(t){var i=-1,a=t==null?0:t.length;for(this.clear();++i<a;){var h=t[i];this.set(h[0],h[1])}}function Rg(){this.__data__=Zn?Zn(null):{},this.size=0}function Ng(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function Ag(t){var i=this.__data__;if(Zn){var a=i[t];return a===y?r:a}return nt.call(i,t)?i[t]:r}function Cg(t){var i=this.__data__;return Zn?i[t]!==r:nt.call(i,t)}function Dg(t,i){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=Zn&&i===r?y:i,this}Gi.prototype.clear=Rg,Gi.prototype.delete=Ng,Gi.prototype.get=Ag,Gi.prototype.has=Cg,Gi.prototype.set=Dg;function ci(t){var i=-1,a=t==null?0:t.length;for(this.clear();++i<a;){var h=t[i];this.set(h[0],h[1])}}function Lg(){this.__data__=[],this.size=0}function $g(t){var i=this.__data__,a=po(i,t);if(a<0)return!1;var h=i.length-1;return a==h?i.pop():oo.call(i,a,1),--this.size,!0}function Ug(t){var i=this.__data__,a=po(i,t);return a<0?r:i[a][1]}function Mg(t){return po(this.__data__,t)>-1}function jg(t,i){var a=this.__data__,h=po(a,t);return h<0?(++this.size,a.push([t,i])):a[h][1]=i,this}ci.prototype.clear=Lg,ci.prototype.delete=$g,ci.prototype.get=Ug,ci.prototype.has=Mg,ci.prototype.set=jg;function ui(t){var i=-1,a=t==null?0:t.length;for(this.clear();++i<a;){var h=t[i];this.set(h[0],h[1])}}function qg(){this.size=0,this.__data__={hash:new Gi,map:new(Qn||ci),string:new Gi}}function Hg(t){var i=Oo(this,t).delete(t);return this.size-=i?1:0,i}function zg(t){return Oo(this,t).get(t)}function Fg(t){return Oo(this,t).has(t)}function Bg(t,i){var a=Oo(this,t),h=a.size;return a.set(t,i),this.size+=a.size==h?0:1,this}ui.prototype.clear=qg,ui.prototype.delete=Hg,ui.prototype.get=zg,ui.prototype.has=Fg,ui.prototype.set=Bg;function Yi(t){var i=-1,a=t==null?0:t.length;for(this.__data__=new ui;++i<a;)this.add(t[i])}function Kg(t){return this.__data__.set(t,y),this}function kg(t){return this.__data__.has(t)}Yi.prototype.add=Yi.prototype.push=Kg,Yi.prototype.has=kg;function Br(t){var i=this.__data__=new ci(t);this.size=i.size}function Vg(){this.__data__=new ci,this.size=0}function Wg(t){var i=this.__data__,a=i.delete(t);return this.size=i.size,a}function Gg(t){return this.__data__.get(t)}function Yg(t){return this.__data__.has(t)}function Jg(t,i){var a=this.__data__;if(a instanceof ci){var h=a.__data__;if(!Qn||h.length<o-1)return h.push([t,i]),this.size=++a.size,this;a=this.__data__=new ui(h)}return a.set(t,i),this.size=a.size,this}Br.prototype.clear=Vg,Br.prototype.delete=Wg,Br.prototype.get=Gg,Br.prototype.has=Yg,Br.prototype.set=Jg;function uh(t,i){var a=Ce(t),h=!a&&en(t),p=!a&&!h&&$i(t),_=!a&&!h&&!p&&An(t),O=a||h||p||_,C=O?$a(t.length,og):[],j=C.length;for(var X in t)(i||nt.call(t,X))&&!(O&&(X=="length"||p&&(X=="offset"||X=="parent")||_&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||di(X,j)))&&C.push(X);return C}function hh(t){var i=t.length;return i?t[Xa(0,i-1)]:r}function Qg(t,i){return Po(dr(t),Ji(i,0,t.length))}function Xg(t){return Po(dr(t))}function Fa(t,i,a){(a!==r&&!Kr(t[i],a)||a===r&&!(i in t))&&hi(t,i,a)}function ts(t,i,a){var h=t[i];(!(nt.call(t,i)&&Kr(h,a))||a===r&&!(i in t))&&hi(t,i,a)}function po(t,i){for(var a=t.length;a--;)if(Kr(t[a][0],i))return a;return-1}function Zg(t,i,a,h){return Ai(t,function(p,_,O){i(h,p,a(p),O)}),h}function lh(t,i){return t&&Zr(i,kt(i),t)}function e0(t,i){return t&&Zr(i,gr(i),t)}function hi(t,i,a){i=="__proto__"&&ao?ao(t,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):t[i]=a}function Ba(t,i){for(var a=-1,h=i.length,p=B(h),_=t==null;++a<h;)p[a]=_?r:Ic(t,i[a]);return p}function Ji(t,i,a){return t===t&&(a!==r&&(t=t<=a?t:a),i!==r&&(t=t>=i?t:i)),t}function Lr(t,i,a,h,p,_){var O,C=i&I,j=i&x,X=i&T;if(a&&(O=p?a(t,h,p,_):a(t)),O!==r)return O;if(!Et(t))return t;var Z=Ce(t);if(Z){if(O=F0(t),!C)return dr(t,O)}else{var ie=Qt(t),he=ie==ae||ie==fe;if($i(t))return $h(t,C);if(ie==Me||ie==le||he&&!p){if(O=j||he?{}:el(t),!C)return j?A0(t,e0(O,t)):N0(t,lh(O,t))}else{if(!st[ie])return p?t:{};O=B0(t,ie,C)}}_||(_=new Br);var ye=_.get(t);if(ye)return ye;_.set(t,O),Rl(t)?t.forEach(function(Ie){O.add(Lr(Ie,i,a,Ie,t,_))}):Pl(t)&&t.forEach(function(Ie,We){O.set(We,Lr(Ie,i,a,We,t,_))});var Ee=X?j?uc:cc:j?gr:kt,ze=Z?r:Ee(t);return Ar(ze||t,function(Ie,We){ze&&(We=Ie,Ie=t[We]),ts(O,We,Lr(Ie,i,a,We,t,_))}),O}function t0(t){var i=kt(t);return function(a){return fh(a,t,i)}}function fh(t,i,a){var h=a.length;if(t==null)return!h;for(t=ut(t);h--;){var p=a[h],_=i[p],O=t[p];if(O===r&&!(p in t)||!_(O))return!1}return!0}function dh(t,i,a){if(typeof t!="function")throw new Cr(d);return cs(function(){t.apply(r,a)},i)}function rs(t,i,a,h){var p=-1,_=Js,O=!0,C=t.length,j=[],X=i.length;if(!C)return j;a&&(i=mt(i,br(a))),h?(_=Ra,O=!1):i.length>=o&&(_=Yn,O=!1,i=new Yi(i));e:for(;++p<C;){var Z=t[p],ie=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,O&&ie===ie){for(var he=X;he--;)if(i[he]===ie)continue e;j.push(Z)}else _(i,ie,h)||j.push(Z)}return j}var Ai=Hh(Xr),ph=Hh(ka,!0);function r0(t,i){var a=!0;return Ai(t,function(h,p,_){return a=!!i(h,p,_),a}),a}function go(t,i,a){for(var h=-1,p=t.length;++h<p;){var _=t[h],O=i(_);if(O!=null&&(C===r?O===O&&!Ir(O):a(O,C)))var C=O,j=_}return j}function i0(t,i,a,h){var p=t.length;for(a=je(a),a<0&&(a=-a>p?0:p+a),h=h===r||h>p?p:je(h),h<0&&(h+=p),h=a>h?0:Al(h);a<h;)t[a++]=i;return t}function gh(t,i){var a=[];return Ai(t,function(h,p,_){i(h,p,_)&&a.push(h)}),a}function Gt(t,i,a,h,p){var _=-1,O=t.length;for(a||(a=k0),p||(p=[]);++_<O;){var C=t[_];i>0&&a(C)?i>1?Gt(C,i-1,a,h,p):Ti(p,C):h||(p[p.length]=C)}return p}var Ka=zh(),yh=zh(!0);function Xr(t,i){return t&&Ka(t,i,kt)}function ka(t,i){return t&&yh(t,i,kt)}function yo(t,i){return Pi(i,function(a){return pi(t[a])})}function Qi(t,i){i=Di(i,t);for(var a=0,h=i.length;t!=null&&a<h;)t=t[ei(i[a++])];return a&&a==h?t:r}function vh(t,i,a){var h=i(t);return Ce(t)?h:Ti(h,a(t))}function ir(t){return t==null?t===r?He:ke:Wi&&Wi in ut(t)?q0(t):X0(t)}function Va(t,i){return t>i}function n0(t,i){return t!=null&&nt.call(t,i)}function s0(t,i){return t!=null&&i in ut(t)}function o0(t,i,a){return t>=Jt(i,a)&&t<Bt(i,a)}function Wa(t,i,a){for(var h=a?Ra:Js,p=t[0].length,_=t.length,O=_,C=B(_),j=1/0,X=[];O--;){var Z=t[O];O&&i&&(Z=mt(Z,br(i))),j=Jt(Z.length,j),C[O]=!a&&(i||p>=120&&Z.length>=120)?new Yi(O&&Z):r}Z=t[0];var ie=-1,he=C[0];e:for(;++ie<p&&X.length<j;){var ye=Z[ie],Ee=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Yn(he,Ee):h(X,Ee,a))){for(O=_;--O;){var ze=C[O];if(!(ze?Yn(ze,Ee):h(t[O],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function a0(t,i,a,h){return Xr(t,function(p,_,O){i(h,a(p),_,O)}),h}function is(t,i,a){i=Di(i,t),t=nl(t,i);var h=t==null?t:t[ei(Ur(i))];return h==null?r:Kt(h,t,a)}function mh(t){return Rt(t)&&ir(t)==le}function c0(t){return Rt(t)&&ir(t)==Se}function u0(t){return Rt(t)&&ir(t)==$}function ns(t,i,a,h,p){return t===i?!0:t==null||i==null||!Rt(t)&&!Rt(i)?t!==t&&i!==i:h0(t,i,a,h,ns,p)}function h0(t,i,a,h,p,_){var O=Ce(t),C=Ce(i),j=O?me:Qt(t),X=C?me:Qt(i);j=j==le?Me:j,X=X==le?Me:X;var Z=j==Me,ie=X==Me,he=j==X;if(he&&$i(t)){if(!$i(i))return!1;O=!0,Z=!1}if(he&&!Z)return _||(_=new Br),O||An(t)?Qh(t,i,a,h,p,_):M0(t,i,j,a,h,p,_);if(!(a&D)){var ye=Z&&nt.call(t,"__wrapped__"),Ee=ie&&nt.call(i,"__wrapped__");if(ye||Ee){var ze=ye?t.value():t,Ie=Ee?i.value():i;return _||(_=new Br),p(ze,Ie,a,h,_)}}return he?(_||(_=new Br),j0(t,i,a,h,p,_)):!1}function l0(t){return Rt(t)&&Qt(t)==xe}function Ga(t,i,a,h){var p=a.length,_=p,O=!h;if(t==null)return!_;for(t=ut(t);p--;){var C=a[p];if(O&&C[2]?C[1]!==t[C[0]]:!(C[0]in t))return!1}for(;++p<_;){C=a[p];var j=C[0],X=t[j],Z=C[1];if(O&&C[2]){if(X===r&&!(j in t))return!1}else{var ie=new Br;if(h)var he=h(X,Z,j,t,i,ie);if(!(he===r?ns(Z,X,D|F,h,ie):he))return!1}}return!0}function _h(t){if(!Et(t)||W0(t))return!1;var i=pi(t)?lg:da;return i.test(Zi(t))}function f0(t){return Rt(t)&&ir(t)==qe}function d0(t){return Rt(t)&&Qt(t)==Oe}function p0(t){return Rt(t)&&Do(t.length)&&!!ot[ir(t)]}function wh(t){return typeof t=="function"?t:t==null?yr:typeof t=="object"?Ce(t)?Ih(t[0],t[1]):Eh(t):Fl(t)}function Ya(t){if(!as(t))return vg(t);var i=[];for(var a in ut(t))nt.call(t,a)&&a!="constructor"&&i.push(a);return i}function g0(t){if(!Et(t))return Q0(t);var i=as(t),a=[];for(var h in t)h=="constructor"&&(i||!nt.call(t,h))||a.push(h);return a}function Ja(t,i){return t<i}function bh(t,i){var a=-1,h=pr(t)?B(t.length):[];return Ai(t,function(p,_,O){h[++a]=i(p,_,O)}),h}function Eh(t){var i=lc(t);return i.length==1&&i[0][2]?rl(i[0][0],i[0][1]):function(a){return a===t||Ga(a,t,i)}}function Ih(t,i){return dc(t)&&tl(i)?rl(ei(t),i):function(a){var h=Ic(a,t);return h===r&&h===i?Sc(a,t):ns(i,h,D|F)}}function vo(t,i,a,h,p){t!==i&&Ka(i,function(_,O){if(p||(p=new Br),Et(_))y0(t,i,O,a,vo,h,p);else{var C=h?h(gc(t,O),_,O+"",t,i,p):r;C===r&&(C=_),Fa(t,O,C)}},gr)}function y0(t,i,a,h,p,_,O){var C=gc(t,a),j=gc(i,a),X=O.get(j);if(X){Fa(t,a,X);return}var Z=_?_(C,j,a+"",t,i,O):r,ie=Z===r;if(ie){var he=Ce(j),ye=!he&&$i(j),Ee=!he&&!ye&&An(j);Z=j,he||ye||Ee?Ce(C)?Z=C:Ct(C)?Z=dr(C):ye?(ie=!1,Z=$h(j,!0)):Ee?(ie=!1,Z=Uh(j,!0)):Z=[]:us(j)||en(j)?(Z=C,en(C)?Z=Cl(C):(!Et(C)||pi(C))&&(Z=el(j))):ie=!1}ie&&(O.set(j,Z),p(Z,j,h,_,O),O.delete(j)),Fa(t,a,Z)}function Sh(t,i){var a=t.length;if(a)return i+=i<0?a:0,di(i,a)?t[i]:r}function xh(t,i,a){i.length?i=mt(i,function(_){return Ce(_)?function(O){return Qi(O,_.length===1?_[0]:_)}:_}):i=[yr];var h=-1;i=mt(i,br(_e()));var p=bh(t,function(_,O,C){var j=mt(i,function(X){return X(_)});return{criteria:j,index:++h,value:_}});return Bp(p,function(_,O){return R0(_,O,a)})}function v0(t,i){return Oh(t,i,function(a,h){return Sc(t,h)})}function Oh(t,i,a){for(var h=-1,p=i.length,_={};++h<p;){var O=i[h],C=Qi(t,O);a(C,O)&&ss(_,Di(O,t),C)}return _}function m0(t){return function(i){return Qi(i,t)}}function Qa(t,i,a,h){var p=h?Fp:wn,_=-1,O=i.length,C=t;for(t===i&&(i=dr(i)),a&&(C=mt(t,br(a)));++_<O;)for(var j=0,X=i[_],Z=a?a(X):X;(j=p(C,Z,j,h))>-1;)C!==t&&oo.call(C,j,1),oo.call(t,j,1);return t}function Ph(t,i){for(var a=t?i.length:0,h=a-1;a--;){var p=i[a];if(a==h||p!==_){var _=p;di(p)?oo.call(t,p,1):tc(t,p)}}return t}function Xa(t,i){return t+uo(ah()*(i-t+1))}function _0(t,i,a,h){for(var p=-1,_=Bt(co((i-t)/(a||1)),0),O=B(_);_--;)O[h?_:++p]=t,t+=a;return O}function Za(t,i){var a="";if(!t||i<1||i>K)return a;do i%2&&(a+=t),i=uo(i/2),i&&(t+=t);while(i);return a}function Ke(t,i){return yc(il(t,i,yr),t+"")}function w0(t){return hh(Cn(t))}function b0(t,i){var a=Cn(t);return Po(a,Ji(i,0,a.length))}function ss(t,i,a,h){if(!Et(t))return t;i=Di(i,t);for(var p=-1,_=i.length,O=_-1,C=t;C!=null&&++p<_;){var j=ei(i[p]),X=a;if(j==="__proto__"||j==="constructor"||j==="prototype")return t;if(p!=O){var Z=C[j];X=h?h(Z,j,C):r,X===r&&(X=Et(Z)?Z:di(i[p+1])?[]:{})}ts(C,j,X),C=C[j]}return t}var Th=ho?function(t,i){return ho.set(t,i),t}:yr,E0=ao?function(t,i){return ao(t,"toString",{configurable:!0,enumerable:!1,value:Oc(i),writable:!0})}:yr;function I0(t){return Po(Cn(t))}function $r(t,i,a){var h=-1,p=t.length;i<0&&(i=-i>p?0:p+i),a=a>p?p:a,a<0&&(a+=p),p=i>a?0:a-i>>>0,i>>>=0;for(var _=B(p);++h<p;)_[h]=t[h+i];return _}function S0(t,i){var a;return Ai(t,function(h,p,_){return a=i(h,p,_),!a}),!!a}function mo(t,i,a){var h=0,p=t==null?h:t.length;if(typeof i=="number"&&i===i&&p<=oe){for(;h<p;){var _=h+p>>>1,O=t[_];O!==null&&!Ir(O)&&(a?O<=i:O<i)?h=_+1:p=_}return p}return ec(t,i,yr,a)}function ec(t,i,a,h){var p=0,_=t==null?0:t.length;if(_===0)return 0;i=a(i);for(var O=i!==i,C=i===null,j=Ir(i),X=i===r;p<_;){var Z=uo((p+_)/2),ie=a(t[Z]),he=ie!==r,ye=ie===null,Ee=ie===ie,ze=Ir(ie);if(O)var Ie=h||Ee;else X?Ie=Ee&&(h||he):C?Ie=Ee&&he&&(h||!ye):j?Ie=Ee&&he&&!ye&&(h||!ze):ye||ze?Ie=!1:Ie=h?ie<=i:ie<i;Ie?p=Z+1:_=Z}return Jt(_,we)}function Rh(t,i){for(var a=-1,h=t.length,p=0,_=[];++a<h;){var O=t[a],C=i?i(O):O;if(!a||!Kr(C,j)){var j=C;_[p++]=O===0?0:O}}return _}function Nh(t){return typeof t=="number"?t:Ir(t)?J:+t}function Er(t){if(typeof t=="string")return t;if(Ce(t))return mt(t,Er)+"";if(Ir(t))return ch?ch.call(t):"";var i=t+"";return i=="0"&&1/t==-Q?"-0":i}function Ci(t,i,a){var h=-1,p=Js,_=t.length,O=!0,C=[],j=C;if(a)O=!1,p=Ra;else if(_>=o){var X=i?null:$0(t);if(X)return Xs(X);O=!1,p=Yn,j=new Yi}else j=i?[]:C;e:for(;++h<_;){var Z=t[h],ie=i?i(Z):Z;if(Z=a||Z!==0?Z:0,O&&ie===ie){for(var he=j.length;he--;)if(j[he]===ie)continue e;i&&j.push(ie),C.push(Z)}else p(j,ie,a)||(j!==C&&j.push(ie),C.push(Z))}return C}function tc(t,i){return i=Di(i,t),t=nl(t,i),t==null||delete t[ei(Ur(i))]}function Ah(t,i,a,h){return ss(t,i,a(Qi(t,i)),h)}function _o(t,i,a,h){for(var p=t.length,_=h?p:-1;(h?_--:++_<p)&&i(t[_],_,t););return a?$r(t,h?0:_,h?_+1:p):$r(t,h?_+1:0,h?p:_)}function Ch(t,i){var a=t;return a instanceof Ye&&(a=a.value()),Na(i,function(h,p){return p.func.apply(p.thisArg,Ti([h],p.args))},a)}function rc(t,i,a){var h=t.length;if(h<2)return h?Ci(t[0]):[];for(var p=-1,_=B(h);++p<h;)for(var O=t[p],C=-1;++C<h;)C!=p&&(_[p]=rs(_[p]||O,t[C],i,a));return Ci(Gt(_,1),i,a)}function Dh(t,i,a){for(var h=-1,p=t.length,_=i.length,O={};++h<p;){var C=h<_?i[h]:r;a(O,t[h],C)}return O}function ic(t){return Ct(t)?t:[]}function nc(t){return typeof t=="function"?t:yr}function Di(t,i){return Ce(t)?t:dc(t,i)?[t]:cl(it(t))}var x0=Ke;function Li(t,i,a){var h=t.length;return a=a===r?h:a,!i&&a>=h?t:$r(t,i,a)}var Lh=fg||function(t){return Xe.clearTimeout(t)};function $h(t,i){if(i)return t.slice();var a=t.length,h=rh?rh(a):new t.constructor(a);return t.copy(h),h}function sc(t){var i=new t.constructor(t.byteLength);return new no(i).set(new no(t)),i}function O0(t,i){var a=i?sc(t.buffer):t.buffer;return new t.constructor(a,t.byteOffset,t.byteLength)}function P0(t){var i=new t.constructor(t.source,Rr.exec(t));return i.lastIndex=t.lastIndex,i}function T0(t){return es?ut(es.call(t)):{}}function Uh(t,i){var a=i?sc(t.buffer):t.buffer;return new t.constructor(a,t.byteOffset,t.length)}function Mh(t,i){if(t!==i){var a=t!==r,h=t===null,p=t===t,_=Ir(t),O=i!==r,C=i===null,j=i===i,X=Ir(i);if(!C&&!X&&!_&&t>i||_&&O&&j&&!C&&!X||h&&O&&j||!a&&j||!p)return 1;if(!h&&!_&&!X&&t<i||X&&a&&p&&!h&&!_||C&&a&&p||!O&&p||!j)return-1}return 0}function R0(t,i,a){for(var h=-1,p=t.criteria,_=i.criteria,O=p.length,C=a.length;++h<O;){var j=Mh(p[h],_[h]);if(j){if(h>=C)return j;var X=a[h];return j*(X=="desc"?-1:1)}}return t.index-i.index}function jh(t,i,a,h){for(var p=-1,_=t.length,O=a.length,C=-1,j=i.length,X=Bt(_-O,0),Z=B(j+X),ie=!h;++C<j;)Z[C]=i[C];for(;++p<O;)(ie||p<_)&&(Z[a[p]]=t[p]);for(;X--;)Z[C++]=t[p++];return Z}function qh(t,i,a,h){for(var p=-1,_=t.length,O=-1,C=a.length,j=-1,X=i.length,Z=Bt(_-C,0),ie=B(Z+X),he=!h;++p<Z;)ie[p]=t[p];for(var ye=p;++j<X;)ie[ye+j]=i[j];for(;++O<C;)(he||p<_)&&(ie[ye+a[O]]=t[p++]);return ie}function dr(t,i){var a=-1,h=t.length;for(i||(i=B(h));++a<h;)i[a]=t[a];return i}function Zr(t,i,a,h){var p=!a;a||(a={});for(var _=-1,O=i.length;++_<O;){var C=i[_],j=h?h(a[C],t[C],C,a,t):r;j===r&&(j=t[C]),p?hi(a,C,j):ts(a,C,j)}return a}function N0(t,i){return Zr(t,fc(t),i)}function A0(t,i){return Zr(t,Xh(t),i)}function wo(t,i){return function(a,h){var p=Ce(a)?Up:Zg,_=i?i():{};return p(a,t,_e(h,2),_)}}function Tn(t){return Ke(function(i,a){var h=-1,p=a.length,_=p>1?a[p-1]:r,O=p>2?a[2]:r;for(_=t.length>3&&typeof _=="function"?(p--,_):r,O&&nr(a[0],a[1],O)&&(_=p<3?r:_,p=1),i=ut(i);++h<p;){var C=a[h];C&&t(i,C,h,_)}return i})}function Hh(t,i){return function(a,h){if(a==null)return a;if(!pr(a))return t(a,h);for(var p=a.length,_=i?p:-1,O=ut(a);(i?_--:++_<p)&&h(O[_],_,O)!==!1;);return a}}function zh(t){return function(i,a,h){for(var p=-1,_=ut(i),O=h(i),C=O.length;C--;){var j=O[t?C:++p];if(a(_[j],j,_)===!1)break}return i}}function C0(t,i,a){var h=i&k,p=os(t);function _(){var O=this&&this!==Xe&&this instanceof _?p:t;return O.apply(h?a:this,arguments)}return _}function Fh(t){return function(i){i=it(i);var a=bn(i)?Fr(i):r,h=a?a[0]:i.charAt(0),p=a?Li(a,1).join(""):i.slice(1);return h[t]()+p}}function Rn(t){return function(i){return Na(Hl(ql(i).replace(Wn,"")),t,"")}}function os(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Pn(t.prototype),h=t.apply(a,i);return Et(h)?h:a}}function D0(t,i,a){var h=os(t);function p(){for(var _=arguments.length,O=B(_),C=_,j=Nn(p);C--;)O[C]=arguments[C];var X=_<3&&O[0]!==j&&O[_-1]!==j?[]:Ri(O,j);if(_-=X.length,_<a)return Wh(t,i,bo,p.placeholder,r,O,X,r,r,a-_);var Z=this&&this!==Xe&&this instanceof p?h:t;return Kt(Z,this,O)}return p}function Bh(t){return function(i,a,h){var p=ut(i);if(!pr(i)){var _=_e(a,3);i=kt(i),a=function(C){return _(p[C],C,p)}}var O=t(i,a,h);return O>-1?p[_?i[O]:O]:r}}function Kh(t){return fi(function(i){var a=i.length,h=a,p=Dr.prototype.thru;for(t&&i.reverse();h--;){var _=i[h];if(typeof _!="function")throw new Cr(d);if(p&&!O&&xo(_)=="wrapper")var O=new Dr([],!0)}for(h=O?h:a;++h<a;){_=i[h];var C=xo(_),j=C=="wrapper"?hc(_):r;j&&pc(j[0])&&j[1]==(u|q|A|b)&&!j[4].length&&j[9]==1?O=O[xo(j[0])].apply(O,j[3]):O=_.length==1&&pc(_)?O[C]():O.thru(_)}return function(){var X=arguments,Z=X[0];if(O&&X.length==1&&Ce(Z))return O.plant(Z).value();for(var ie=0,he=a?i[ie].apply(this,X):Z;++ie<a;)he=i[ie].call(this,he);return he}})}function bo(t,i,a,h,p,_,O,C,j,X){var Z=i&u,ie=i&k,he=i&se,ye=i&(q|R),Ee=i&Y,ze=he?r:os(t);function Ie(){for(var We=arguments.length,Ze=B(We),Sr=We;Sr--;)Ze[Sr]=arguments[Sr];if(ye)var sr=Nn(Ie),xr=kp(Ze,sr);if(h&&(Ze=jh(Ze,h,p,ye)),_&&(Ze=qh(Ze,_,O,ye)),We-=xr,ye&&We<X){var Dt=Ri(Ze,sr);return Wh(t,i,bo,Ie.placeholder,a,Ze,Dt,C,j,X-We)}var kr=ie?a:this,yi=he?kr[t]:t;return We=Ze.length,C?Ze=Z0(Ze,C):Ee&&We>1&&Ze.reverse(),Z&&j<We&&(Ze.length=j),this&&this!==Xe&&this instanceof Ie&&(yi=ze||os(yi)),yi.apply(kr,Ze)}return Ie}function kh(t,i){return function(a,h){return a0(a,t,i(h),{})}}function Eo(t,i){return function(a,h){var p;if(a===r&&h===r)return i;if(a!==r&&(p=a),h!==r){if(p===r)return h;typeof a=="string"||typeof h=="string"?(a=Er(a),h=Er(h)):(a=Nh(a),h=Nh(h)),p=t(a,h)}return p}}function oc(t){return fi(function(i){return i=mt(i,br(_e())),Ke(function(a){var h=this;return t(i,function(p){return Kt(p,h,a)})})})}function Io(t,i){i=i===r?" ":Er(i);var a=i.length;if(a<2)return a?Za(i,t):i;var h=Za(i,co(t/En(i)));return bn(i)?Li(Fr(h),0,t).join(""):h.slice(0,t)}function L0(t,i,a,h){var p=i&k,_=os(t);function O(){for(var C=-1,j=arguments.length,X=-1,Z=h.length,ie=B(Z+j),he=this&&this!==Xe&&this instanceof O?_:t;++X<Z;)ie[X]=h[X];for(;j--;)ie[X++]=arguments[++C];return Kt(he,p?a:this,ie)}return O}function Vh(t){return function(i,a,h){return h&&typeof h!="number"&&nr(i,a,h)&&(a=h=r),i=gi(i),a===r?(a=i,i=0):a=gi(a),h=h===r?i<a?1:-1:gi(h),_0(i,a,h,t)}}function So(t){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Mr(i),a=Mr(a)),t(i,a)}}function Wh(t,i,a,h,p,_,O,C,j,X){var Z=i&q,ie=Z?O:r,he=Z?r:O,ye=Z?_:r,Ee=Z?r:_;i|=Z?A:E,i&=~(Z?E:A),i&L||(i&=~(k|se));var ze=[t,i,p,ye,ie,Ee,he,C,j,X],Ie=a.apply(r,ze);return pc(t)&&sl(Ie,ze),Ie.placeholder=h,ol(Ie,t,i)}function ac(t){var i=Ft[t];return function(a,h){if(a=Mr(a),h=h==null?0:Jt(je(h),292),h&&oh(a)){var p=(it(a)+"e").split("e"),_=i(p[0]+"e"+(+p[1]+h));return p=(it(_)+"e").split("e"),+(p[0]+"e"+(+p[1]-h))}return i(a)}}var $0=xn&&1/Xs(new xn([,-0]))[1]==Q?function(t){return new xn(t)}:Rc;function Gh(t){return function(i){var a=Qt(i);return a==xe?Ma(i):a==Oe?Xp(i):Kp(i,t(i))}}function li(t,i,a,h,p,_,O,C){var j=i&se;if(!j&&typeof t!="function")throw new Cr(d);var X=h?h.length:0;if(X||(i&=~(A|E),h=p=r),O=O===r?O:Bt(je(O),0),C=C===r?C:je(C),X-=p?p.length:0,i&E){var Z=h,ie=p;h=p=r}var he=j?r:hc(t),ye=[t,i,a,h,p,Z,ie,_,O,C];if(he&&J0(ye,he),t=ye[0],i=ye[1],a=ye[2],h=ye[3],p=ye[4],C=ye[9]=ye[9]===r?j?0:t.length:Bt(ye[9]-X,0),!C&&i&(q|R)&&(i&=~(q|R)),!i||i==k)var Ee=C0(t,i,a);else i==q||i==R?Ee=D0(t,i,C):(i==A||i==(k|A))&&!p.length?Ee=L0(t,i,a,h):Ee=bo.apply(r,ye);var ze=he?Th:sl;return ol(ze(Ee,ye),t,i)}function Yh(t,i,a,h){return t===r||Kr(t,Sn[a])&&!nt.call(h,a)?i:t}function Jh(t,i,a,h,p,_){return Et(t)&&Et(i)&&(_.set(i,t),vo(t,i,r,Jh,_),_.delete(i)),t}function U0(t){return us(t)?r:t}function Qh(t,i,a,h,p,_){var O=a&D,C=t.length,j=i.length;if(C!=j&&!(O&&j>C))return!1;var X=_.get(t),Z=_.get(i);if(X&&Z)return X==i&&Z==t;var ie=-1,he=!0,ye=a&F?new Yi:r;for(_.set(t,i),_.set(i,t);++ie<C;){var Ee=t[ie],ze=i[ie];if(h)var Ie=O?h(ze,Ee,ie,i,t,_):h(Ee,ze,ie,t,i,_);if(Ie!==r){if(Ie)continue;he=!1;break}if(ye){if(!Aa(i,function(We,Ze){if(!Yn(ye,Ze)&&(Ee===We||p(Ee,We,a,h,_)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===ze||p(Ee,ze,a,h,_))){he=!1;break}}return _.delete(t),_.delete(i),he}function M0(t,i,a,h,p,_,O){switch(a){case Re:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case Se:return!(t.byteLength!=i.byteLength||!_(new no(t),new no(i)));case H:case $:case Fe:return Kr(+t,+i);case N:return t.name==i.name&&t.message==i.message;case qe:case De:return t==i+"";case xe:var C=Ma;case Oe:var j=h&D;if(C||(C=Xs),t.size!=i.size&&!j)return!1;var X=O.get(t);if(X)return X==i;h|=F,O.set(t,i);var Z=Qh(C(t),C(i),h,p,_,O);return O.delete(t),Z;case Le:if(es)return es.call(t)==es.call(i)}return!1}function j0(t,i,a,h,p,_){var O=a&D,C=cc(t),j=C.length,X=cc(i),Z=X.length;if(j!=Z&&!O)return!1;for(var ie=j;ie--;){var he=C[ie];if(!(O?he in i:nt.call(i,he)))return!1}var ye=_.get(t),Ee=_.get(i);if(ye&&Ee)return ye==i&&Ee==t;var ze=!0;_.set(t,i),_.set(i,t);for(var Ie=O;++ie<j;){he=C[ie];var We=t[he],Ze=i[he];if(h)var Sr=O?h(Ze,We,he,i,t,_):h(We,Ze,he,t,i,_);if(!(Sr===r?We===Ze||p(We,Ze,a,h,_):Sr)){ze=!1;break}Ie||(Ie=he=="constructor")}if(ze&&!Ie){var sr=t.constructor,xr=i.constructor;sr!=xr&&"constructor"in t&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return _.delete(t),_.delete(i),ze}function fi(t){return yc(il(t,r,fl),t+"")}function cc(t){return vh(t,kt,fc)}function uc(t){return vh(t,gr,Xh)}var hc=ho?function(t){return ho.get(t)}:Rc;function xo(t){for(var i=t.name+"",a=On[i],h=nt.call(On,i)?a.length:0;h--;){var p=a[h],_=p.func;if(_==null||_==t)return p.name}return i}function Nn(t){var i=nt.call(v,"placeholder")?v:t;return i.placeholder}function _e(){var t=v.iteratee||Pc;return t=t===Pc?wh:t,arguments.length?t(arguments[0],arguments[1]):t}function Oo(t,i){var a=t.__data__;return V0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function lc(t){for(var i=kt(t),a=i.length;a--;){var h=i[a],p=t[h];i[a]=[h,p,tl(p)]}return i}function Xi(t,i){var a=Yp(t,i);return _h(a)?a:r}function q0(t){var i=nt.call(t,Wi),a=t[Wi];try{t[Wi]=r;var h=!0}catch{}var p=ro.call(t);return h&&(i?t[Wi]=a:delete t[Wi]),p}var fc=qa?function(t){return t==null?[]:(t=ut(t),Pi(qa(t),function(i){return nh.call(t,i)}))}:Nc,Xh=qa?function(t){for(var i=[];t;)Ti(i,fc(t)),t=so(t);return i}:Nc,Qt=ir;(Ha&&Qt(new Ha(new ArrayBuffer(1)))!=Re||Qn&&Qt(new Qn)!=xe||za&&Qt(za.resolve())!=pt||xn&&Qt(new xn)!=Oe||Xn&&Qt(new Xn)!=Te)&&(Qt=function(t){var i=ir(t),a=i==Me?t.constructor:r,h=a?Zi(a):"";if(h)switch(h){case bg:return Re;case Eg:return xe;case Ig:return pt;case Sg:return Oe;case xg:return Te}return i});function H0(t,i,a){for(var h=-1,p=a.length;++h<p;){var _=a[h],O=_.size;switch(_.type){case"drop":t+=O;break;case"dropRight":i-=O;break;case"take":i=Jt(i,t+O);break;case"takeRight":t=Bt(t,i-O);break}}return{start:t,end:i}}function z0(t){var i=t.match(ht);return i?i[1].split(jt):[]}function Zh(t,i,a){i=Di(i,t);for(var h=-1,p=i.length,_=!1;++h<p;){var O=ei(i[h]);if(!(_=t!=null&&a(t,O)))break;t=t[O]}return _||++h!=p?_:(p=t==null?0:t.length,!!p&&Do(p)&&di(O,p)&&(Ce(t)||en(t)))}function F0(t){var i=t.length,a=new t.constructor(i);return i&&typeof t[0]=="string"&&nt.call(t,"index")&&(a.index=t.index,a.input=t.input),a}function el(t){return typeof t.constructor=="function"&&!as(t)?Pn(so(t)):{}}function B0(t,i,a){var h=t.constructor;switch(i){case Se:return sc(t);case H:case $:return new h(+t);case Re:return O0(t,a);case Be:case Pe:case Ve:case Ge:case et:case tt:case Qe:case er:case lr:return Uh(t,a);case xe:return new h;case Fe:case De:return new h(t);case qe:return P0(t);case Oe:return new h;case Le:return T0(t)}}function K0(t,i){var a=i.length;if(!a)return t;var h=a-1;return i[h]=(a>1?"& ":"")+i[h],i=i.join(a>2?", ":" "),t.replace(Tt,`{
/* [wrapped with `+i+`] */
`)}function k0(t){return Ce(t)||en(t)||!!(sh&&t&&t[sh])}function di(t,i){var a=typeof t;return i=i??K,!!i&&(a=="number"||a!="symbol"&&ga.test(t))&&t>-1&&t%1==0&&t<i}function nr(t,i,a){if(!Et(a))return!1;var h=typeof i;return(h=="number"?pr(a)&&di(i,a.length):h=="string"&&i in a)?Kr(a[i],t):!1}function dc(t,i){if(Ce(t))return!1;var a=typeof t;return a=="number"||a=="symbol"||a=="boolean"||t==null||Ir(t)?!0:$t.test(t)||!vt.test(t)||i!=null&&t in ut(i)}function V0(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function pc(t){var i=xo(t),a=v[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(t===a)return!0;var h=hc(a);return!!h&&t===h[0]}function W0(t){return!!th&&th in t}var G0=eo?pi:Ac;function as(t){var i=t&&t.constructor,a=typeof i=="function"&&i.prototype||Sn;return t===a}function tl(t){return t===t&&!Et(t)}function rl(t,i){return function(a){return a==null?!1:a[t]===i&&(i!==r||t in ut(a))}}function Y0(t){var i=Ao(t,function(h){return a.size===g&&a.clear(),h}),a=i.cache;return i}function J0(t,i){var a=t[1],h=i[1],p=a|h,_=p<(k|se|u),O=h==u&&a==q||h==u&&a==b&&t[7].length<=i[8]||h==(u|b)&&i[7].length<=i[8]&&a==q;if(!(_||O))return t;h&k&&(t[2]=i[2],p|=a&k?0:L);var C=i[3];if(C){var j=t[3];t[3]=j?jh(j,C,i[4]):C,t[4]=j?Ri(t[3],m):i[4]}return C=i[5],C&&(j=t[5],t[5]=j?qh(j,C,i[6]):C,t[6]=j?Ri(t[5],m):i[6]),C=i[7],C&&(t[7]=C),h&u&&(t[8]=t[8]==null?i[8]:Jt(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=p,t}function Q0(t){var i=[];if(t!=null)for(var a in ut(t))i.push(a);return i}function X0(t){return ro.call(t)}function il(t,i,a){return i=Bt(i===r?t.length-1:i,0),function(){for(var h=arguments,p=-1,_=Bt(h.length-i,0),O=B(_);++p<_;)O[p]=h[i+p];p=-1;for(var C=B(i+1);++p<i;)C[p]=h[p];return C[i]=a(O),Kt(t,this,C)}}function nl(t,i){return i.length<2?t:Qi(t,$r(i,0,-1))}function Z0(t,i){for(var a=t.length,h=Jt(i.length,a),p=dr(t);h--;){var _=i[h];t[h]=di(_,a)?p[_]:r}return t}function gc(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var sl=al(Th),cs=pg||function(t,i){return Xe.setTimeout(t,i)},yc=al(E0);function ol(t,i,a){var h=i+"";return yc(t,K0(h,ey(z0(h),a)))}function al(t){var i=0,a=0;return function(){var h=mg(),p=de-(h-a);if(a=h,p>0){if(++i>=ue)return arguments[0]}else i=0;return t.apply(r,arguments)}}function Po(t,i){var a=-1,h=t.length,p=h-1;for(i=i===r?h:i;++a<i;){var _=Xa(a,p),O=t[_];t[_]=t[a],t[a]=O}return t.length=i,t}var cl=Y0(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(Ut,function(a,h,p,_){i.push(p?_.replace(ua,"$1"):h||a)}),i});function ei(t){if(typeof t=="string"||Ir(t))return t;var i=t+"";return i=="0"&&1/t==-Q?"-0":i}function Zi(t){if(t!=null){try{return to.call(t)}catch{}try{return t+""}catch{}}return""}function ey(t,i){return Ar(be,function(a){var h="_."+a[0];i&a[1]&&!Js(t,h)&&t.push(h)}),t.sort()}function ul(t){if(t instanceof Ye)return t.clone();var i=new Dr(t.__wrapped__,t.__chain__);return i.__actions__=dr(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function ty(t,i,a){(a?nr(t,i,a):i===r)?i=1:i=Bt(je(i),0);var h=t==null?0:t.length;if(!h||i<1)return[];for(var p=0,_=0,O=B(co(h/i));p<h;)O[_++]=$r(t,p,p+=i);return O}function ry(t){for(var i=-1,a=t==null?0:t.length,h=0,p=[];++i<a;){var _=t[i];_&&(p[h++]=_)}return p}function iy(){var t=arguments.length;if(!t)return[];for(var i=B(t-1),a=arguments[0],h=t;h--;)i[h-1]=arguments[h];return Ti(Ce(a)?dr(a):[a],Gt(i,1))}var ny=Ke(function(t,i){return Ct(t)?rs(t,Gt(i,1,Ct,!0)):[]}),sy=Ke(function(t,i){var a=Ur(i);return Ct(a)&&(a=r),Ct(t)?rs(t,Gt(i,1,Ct,!0),_e(a,2)):[]}),oy=Ke(function(t,i){var a=Ur(i);return Ct(a)&&(a=r),Ct(t)?rs(t,Gt(i,1,Ct,!0),r,a):[]});function ay(t,i,a){var h=t==null?0:t.length;return h?(i=a||i===r?1:je(i),$r(t,i<0?0:i,h)):[]}function cy(t,i,a){var h=t==null?0:t.length;return h?(i=a||i===r?1:je(i),i=h-i,$r(t,0,i<0?0:i)):[]}function uy(t,i){return t&&t.length?_o(t,_e(i,3),!0,!0):[]}function hy(t,i){return t&&t.length?_o(t,_e(i,3),!0):[]}function ly(t,i,a,h){var p=t==null?0:t.length;return p?(a&&typeof a!="number"&&nr(t,i,a)&&(a=0,h=p),i0(t,i,a,h)):[]}function hl(t,i,a){var h=t==null?0:t.length;if(!h)return-1;var p=a==null?0:je(a);return p<0&&(p=Bt(h+p,0)),Qs(t,_e(i,3),p)}function ll(t,i,a){var h=t==null?0:t.length;if(!h)return-1;var p=h-1;return a!==r&&(p=je(a),p=a<0?Bt(h+p,0):Jt(p,h-1)),Qs(t,_e(i,3),p,!0)}function fl(t){var i=t==null?0:t.length;return i?Gt(t,1):[]}function fy(t){var i=t==null?0:t.length;return i?Gt(t,Q):[]}function dy(t,i){var a=t==null?0:t.length;return a?(i=i===r?1:je(i),Gt(t,i)):[]}function py(t){for(var i=-1,a=t==null?0:t.length,h={};++i<a;){var p=t[i];h[p[0]]=p[1]}return h}function dl(t){return t&&t.length?t[0]:r}function gy(t,i,a){var h=t==null?0:t.length;if(!h)return-1;var p=a==null?0:je(a);return p<0&&(p=Bt(h+p,0)),wn(t,i,p)}function yy(t){var i=t==null?0:t.length;return i?$r(t,0,-1):[]}var vy=Ke(function(t){var i=mt(t,ic);return i.length&&i[0]===t[0]?Wa(i):[]}),my=Ke(function(t){var i=Ur(t),a=mt(t,ic);return i===Ur(a)?i=r:a.pop(),a.length&&a[0]===t[0]?Wa(a,_e(i,2)):[]}),_y=Ke(function(t){var i=Ur(t),a=mt(t,ic);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===t[0]?Wa(a,r,i):[]});function wy(t,i){return t==null?"":yg.call(t,i)}function Ur(t){var i=t==null?0:t.length;return i?t[i-1]:r}function by(t,i,a){var h=t==null?0:t.length;if(!h)return-1;var p=h;return a!==r&&(p=je(a),p=p<0?Bt(h+p,0):Jt(p,h-1)),i===i?eg(t,i,p):Qs(t,Wu,p,!0)}function Ey(t,i){return t&&t.length?Sh(t,je(i)):r}var Iy=Ke(pl);function pl(t,i){return t&&t.length&&i&&i.length?Qa(t,i):t}function Sy(t,i,a){return t&&t.length&&i&&i.length?Qa(t,i,_e(a,2)):t}function xy(t,i,a){return t&&t.length&&i&&i.length?Qa(t,i,r,a):t}var Oy=fi(function(t,i){var a=t==null?0:t.length,h=Ba(t,i);return Ph(t,mt(i,function(p){return di(p,a)?+p:p}).sort(Mh)),h});function Py(t,i){var a=[];if(!(t&&t.length))return a;var h=-1,p=[],_=t.length;for(i=_e(i,3);++h<_;){var O=t[h];i(O,h,t)&&(a.push(O),p.push(h))}return Ph(t,p),a}function vc(t){return t==null?t:wg.call(t)}function Ty(t,i,a){var h=t==null?0:t.length;return h?(a&&typeof a!="number"&&nr(t,i,a)?(i=0,a=h):(i=i==null?0:je(i),a=a===r?h:je(a)),$r(t,i,a)):[]}function Ry(t,i){return mo(t,i)}function Ny(t,i,a){return ec(t,i,_e(a,2))}function Ay(t,i){var a=t==null?0:t.length;if(a){var h=mo(t,i);if(h<a&&Kr(t[h],i))return h}return-1}function Cy(t,i){return mo(t,i,!0)}function Dy(t,i,a){return ec(t,i,_e(a,2),!0)}function Ly(t,i){var a=t==null?0:t.length;if(a){var h=mo(t,i,!0)-1;if(Kr(t[h],i))return h}return-1}function $y(t){return t&&t.length?Rh(t):[]}function Uy(t,i){return t&&t.length?Rh(t,_e(i,2)):[]}function My(t){var i=t==null?0:t.length;return i?$r(t,1,i):[]}function jy(t,i,a){return t&&t.length?(i=a||i===r?1:je(i),$r(t,0,i<0?0:i)):[]}function qy(t,i,a){var h=t==null?0:t.length;return h?(i=a||i===r?1:je(i),i=h-i,$r(t,i<0?0:i,h)):[]}function Hy(t,i){return t&&t.length?_o(t,_e(i,3),!1,!0):[]}function zy(t,i){return t&&t.length?_o(t,_e(i,3)):[]}var Fy=Ke(function(t){return Ci(Gt(t,1,Ct,!0))}),By=Ke(function(t){var i=Ur(t);return Ct(i)&&(i=r),Ci(Gt(t,1,Ct,!0),_e(i,2))}),Ky=Ke(function(t){var i=Ur(t);return i=typeof i=="function"?i:r,Ci(Gt(t,1,Ct,!0),r,i)});function ky(t){return t&&t.length?Ci(t):[]}function Vy(t,i){return t&&t.length?Ci(t,_e(i,2)):[]}function Wy(t,i){return i=typeof i=="function"?i:r,t&&t.length?Ci(t,r,i):[]}function mc(t){if(!(t&&t.length))return[];var i=0;return t=Pi(t,function(a){if(Ct(a))return i=Bt(a.length,i),!0}),$a(i,function(a){return mt(t,Ca(a))})}function gl(t,i){if(!(t&&t.length))return[];var a=mc(t);return i==null?a:mt(a,function(h){return Kt(i,r,h)})}var Gy=Ke(function(t,i){return Ct(t)?rs(t,i):[]}),Yy=Ke(function(t){return rc(Pi(t,Ct))}),Jy=Ke(function(t){var i=Ur(t);return Ct(i)&&(i=r),rc(Pi(t,Ct),_e(i,2))}),Qy=Ke(function(t){var i=Ur(t);return i=typeof i=="function"?i:r,rc(Pi(t,Ct),r,i)}),Xy=Ke(mc);function Zy(t,i){return Dh(t||[],i||[],ts)}function ev(t,i){return Dh(t||[],i||[],ss)}var tv=Ke(function(t){var i=t.length,a=i>1?t[i-1]:r;return a=typeof a=="function"?(t.pop(),a):r,gl(t,a)});function yl(t){var i=v(t);return i.__chain__=!0,i}function rv(t,i){return i(t),t}function To(t,i){return i(t)}var iv=fi(function(t){var i=t.length,a=i?t[0]:0,h=this.__wrapped__,p=function(_){return Ba(_,t)};return i>1||this.__actions__.length||!(h instanceof Ye)||!di(a)?this.thru(p):(h=h.slice(a,+a+(i?1:0)),h.__actions__.push({func:To,args:[p],thisArg:r}),new Dr(h,this.__chain__).thru(function(_){return i&&!_.length&&_.push(r),_}))});function nv(){return yl(this)}function sv(){return new Dr(this.value(),this.__chain__)}function ov(){this.__values__===r&&(this.__values__=Nl(this.value()));var t=this.__index__>=this.__values__.length,i=t?r:this.__values__[this.__index__++];return{done:t,value:i}}function av(){return this}function cv(t){for(var i,a=this;a instanceof fo;){var h=ul(a);h.__index__=0,h.__values__=r,i?p.__wrapped__=h:i=h;var p=h;a=a.__wrapped__}return p.__wrapped__=t,i}function uv(){var t=this.__wrapped__;if(t instanceof Ye){var i=t;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:To,args:[vc],thisArg:r}),new Dr(i,this.__chain__)}return this.thru(vc)}function hv(){return Ch(this.__wrapped__,this.__actions__)}var lv=wo(function(t,i,a){nt.call(t,a)?++t[a]:hi(t,a,1)});function fv(t,i,a){var h=Ce(t)?ku:r0;return a&&nr(t,i,a)&&(i=r),h(t,_e(i,3))}function dv(t,i){var a=Ce(t)?Pi:gh;return a(t,_e(i,3))}var pv=Bh(hl),gv=Bh(ll);function yv(t,i){return Gt(Ro(t,i),1)}function vv(t,i){return Gt(Ro(t,i),Q)}function mv(t,i,a){return a=a===r?1:je(a),Gt(Ro(t,i),a)}function vl(t,i){var a=Ce(t)?Ar:Ai;return a(t,_e(i,3))}function ml(t,i){var a=Ce(t)?Mp:ph;return a(t,_e(i,3))}var _v=wo(function(t,i,a){nt.call(t,a)?t[a].push(i):hi(t,a,[i])});function wv(t,i,a,h){t=pr(t)?t:Cn(t),a=a&&!h?je(a):0;var p=t.length;return a<0&&(a=Bt(p+a,0)),Lo(t)?a<=p&&t.indexOf(i,a)>-1:!!p&&wn(t,i,a)>-1}var bv=Ke(function(t,i,a){var h=-1,p=typeof i=="function",_=pr(t)?B(t.length):[];return Ai(t,function(O){_[++h]=p?Kt(i,O,a):is(O,i,a)}),_}),Ev=wo(function(t,i,a){hi(t,a,i)});function Ro(t,i){var a=Ce(t)?mt:bh;return a(t,_e(i,3))}function Iv(t,i,a,h){return t==null?[]:(Ce(i)||(i=i==null?[]:[i]),a=h?r:a,Ce(a)||(a=a==null?[]:[a]),xh(t,i,a))}var Sv=wo(function(t,i,a){t[a?0:1].push(i)},function(){return[[],[]]});function xv(t,i,a){var h=Ce(t)?Na:Yu,p=arguments.length<3;return h(t,_e(i,4),a,p,Ai)}function Ov(t,i,a){var h=Ce(t)?jp:Yu,p=arguments.length<3;return h(t,_e(i,4),a,p,ph)}function Pv(t,i){var a=Ce(t)?Pi:gh;return a(t,Co(_e(i,3)))}function Tv(t){var i=Ce(t)?hh:w0;return i(t)}function Rv(t,i,a){(a?nr(t,i,a):i===r)?i=1:i=je(i);var h=Ce(t)?Qg:b0;return h(t,i)}function Nv(t){var i=Ce(t)?Xg:I0;return i(t)}function Av(t){if(t==null)return 0;if(pr(t))return Lo(t)?En(t):t.length;var i=Qt(t);return i==xe||i==Oe?t.size:Ya(t).length}function Cv(t,i,a){var h=Ce(t)?Aa:S0;return a&&nr(t,i,a)&&(i=r),h(t,_e(i,3))}var Dv=Ke(function(t,i){if(t==null)return[];var a=i.length;return a>1&&nr(t,i[0],i[1])?i=[]:a>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),xh(t,Gt(i,1),[])}),No=dg||function(){return Xe.Date.now()};function Lv(t,i){if(typeof i!="function")throw new Cr(d);return t=je(t),function(){if(--t<1)return i.apply(this,arguments)}}function _l(t,i,a){return i=a?r:i,i=t&&i==null?t.length:i,li(t,u,r,r,r,r,i)}function wl(t,i){var a;if(typeof i!="function")throw new Cr(d);return t=je(t),function(){return--t>0&&(a=i.apply(this,arguments)),t<=1&&(i=r),a}}var _c=Ke(function(t,i,a){var h=k;if(a.length){var p=Ri(a,Nn(_c));h|=A}return li(t,h,i,a,p)}),bl=Ke(function(t,i,a){var h=k|se;if(a.length){var p=Ri(a,Nn(bl));h|=A}return li(i,h,t,a,p)});function El(t,i,a){i=a?r:i;var h=li(t,q,r,r,r,r,r,i);return h.placeholder=El.placeholder,h}function Il(t,i,a){i=a?r:i;var h=li(t,R,r,r,r,r,r,i);return h.placeholder=Il.placeholder,h}function Sl(t,i,a){var h,p,_,O,C,j,X=0,Z=!1,ie=!1,he=!0;if(typeof t!="function")throw new Cr(d);i=Mr(i)||0,Et(a)&&(Z=!!a.leading,ie="maxWait"in a,_=ie?Bt(Mr(a.maxWait)||0,i):_,he="trailing"in a?!!a.trailing:he);function ye(Dt){var kr=h,yi=p;return h=p=r,X=Dt,O=t.apply(yi,kr),O}function Ee(Dt){return X=Dt,C=cs(We,i),Z?ye(Dt):O}function ze(Dt){var kr=Dt-j,yi=Dt-X,Bl=i-kr;return ie?Jt(Bl,_-yi):Bl}function Ie(Dt){var kr=Dt-j,yi=Dt-X;return j===r||kr>=i||kr<0||ie&&yi>=_}function We(){var Dt=No();if(Ie(Dt))return Ze(Dt);C=cs(We,ze(Dt))}function Ze(Dt){return C=r,he&&h?ye(Dt):(h=p=r,O)}function Sr(){C!==r&&Lh(C),X=0,h=j=p=C=r}function sr(){return C===r?O:Ze(No())}function xr(){var Dt=No(),kr=Ie(Dt);if(h=arguments,p=this,j=Dt,kr){if(C===r)return Ee(j);if(ie)return Lh(C),C=cs(We,i),ye(j)}return C===r&&(C=cs(We,i)),O}return xr.cancel=Sr,xr.flush=sr,xr}var $v=Ke(function(t,i){return dh(t,1,i)}),Uv=Ke(function(t,i,a){return dh(t,Mr(i)||0,a)});function Mv(t){return li(t,Y)}function Ao(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new Cr(d);var a=function(){var h=arguments,p=i?i.apply(this,h):h[0],_=a.cache;if(_.has(p))return _.get(p);var O=t.apply(this,h);return a.cache=_.set(p,O)||_,O};return a.cache=new(Ao.Cache||ui),a}Ao.Cache=ui;function Co(t){if(typeof t!="function")throw new Cr(d);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function jv(t){return wl(2,t)}var qv=x0(function(t,i){i=i.length==1&&Ce(i[0])?mt(i[0],br(_e())):mt(Gt(i,1),br(_e()));var a=i.length;return Ke(function(h){for(var p=-1,_=Jt(h.length,a);++p<_;)h[p]=i[p].call(this,h[p]);return Kt(t,this,h)})}),wc=Ke(function(t,i){var a=Ri(i,Nn(wc));return li(t,A,r,i,a)}),xl=Ke(function(t,i){var a=Ri(i,Nn(xl));return li(t,E,r,i,a)}),Hv=fi(function(t,i){return li(t,b,r,r,r,i)});function zv(t,i){if(typeof t!="function")throw new Cr(d);return i=i===r?i:je(i),Ke(t,i)}function Fv(t,i){if(typeof t!="function")throw new Cr(d);return i=i==null?0:Bt(je(i),0),Ke(function(a){var h=a[i],p=Li(a,0,i);return h&&Ti(p,h),Kt(t,this,p)})}function Bv(t,i,a){var h=!0,p=!0;if(typeof t!="function")throw new Cr(d);return Et(a)&&(h="leading"in a?!!a.leading:h,p="trailing"in a?!!a.trailing:p),Sl(t,i,{leading:h,maxWait:i,trailing:p})}function Kv(t){return _l(t,1)}function kv(t,i){return wc(nc(i),t)}function Vv(){if(!arguments.length)return[];var t=arguments[0];return Ce(t)?t:[t]}function Wv(t){return Lr(t,T)}function Gv(t,i){return i=typeof i=="function"?i:r,Lr(t,T,i)}function Yv(t){return Lr(t,I|T)}function Jv(t,i){return i=typeof i=="function"?i:r,Lr(t,I|T,i)}function Qv(t,i){return i==null||fh(t,i,kt(i))}function Kr(t,i){return t===i||t!==t&&i!==i}var Xv=So(Va),Zv=So(function(t,i){return t>=i}),en=mh(function(){return arguments}())?mh:function(t){return Rt(t)&&nt.call(t,"callee")&&!nh.call(t,"callee")},Ce=B.isArray,em=rr?br(rr):c0;function pr(t){return t!=null&&Do(t.length)&&!pi(t)}function Ct(t){return Rt(t)&&pr(t)}function tm(t){return t===!0||t===!1||Rt(t)&&ir(t)==H}var $i=gg||Ac,rm=zr?br(zr):u0;function im(t){return Rt(t)&&t.nodeType===1&&!us(t)}function nm(t){if(t==null)return!0;if(pr(t)&&(Ce(t)||typeof t=="string"||typeof t.splice=="function"||$i(t)||An(t)||en(t)))return!t.length;var i=Qt(t);if(i==xe||i==Oe)return!t.size;if(as(t))return!Ya(t).length;for(var a in t)if(nt.call(t,a))return!1;return!0}function sm(t,i){return ns(t,i)}function om(t,i,a){a=typeof a=="function"?a:r;var h=a?a(t,i):r;return h===r?ns(t,i,r,a):!!h}function bc(t){if(!Rt(t))return!1;var i=ir(t);return i==N||i==l||typeof t.message=="string"&&typeof t.name=="string"&&!us(t)}function am(t){return typeof t=="number"&&oh(t)}function pi(t){if(!Et(t))return!1;var i=ir(t);return i==ae||i==fe||i==z||i==gt}function Ol(t){return typeof t=="number"&&t==je(t)}function Do(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=K}function Et(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function Rt(t){return t!=null&&typeof t=="object"}var Pl=Nr?br(Nr):l0;function cm(t,i){return t===i||Ga(t,i,lc(i))}function um(t,i,a){return a=typeof a=="function"?a:r,Ga(t,i,lc(i),a)}function hm(t){return Tl(t)&&t!=+t}function lm(t){if(G0(t))throw new Ne(c);return _h(t)}function fm(t){return t===null}function dm(t){return t==null}function Tl(t){return typeof t=="number"||Rt(t)&&ir(t)==Fe}function us(t){if(!Rt(t)||ir(t)!=Me)return!1;var i=so(t);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&to.call(a)==ug}var Ec=Qr?br(Qr):f0;function pm(t){return Ol(t)&&t>=-K&&t<=K}var Rl=Gn?br(Gn):d0;function Lo(t){return typeof t=="string"||!Ce(t)&&Rt(t)&&ir(t)==De}function Ir(t){return typeof t=="symbol"||Rt(t)&&ir(t)==Le}var An=Vi?br(Vi):p0;function gm(t){return t===r}function ym(t){return Rt(t)&&Qt(t)==Te}function vm(t){return Rt(t)&&ir(t)==$e}var mm=So(Ja),_m=So(function(t,i){return t<=i});function Nl(t){if(!t)return[];if(pr(t))return Lo(t)?Fr(t):dr(t);if(Jn&&t[Jn])return Qp(t[Jn]());var i=Qt(t),a=i==xe?Ma:i==Oe?Xs:Cn;return a(t)}function gi(t){if(!t)return t===0?t:0;if(t=Mr(t),t===Q||t===-Q){var i=t<0?-1:1;return i*V}return t===t?t:0}function je(t){var i=gi(t),a=i%1;return i===i?a?i-a:i:0}function Al(t){return t?Ji(je(t),0,re):0}function Mr(t){if(typeof t=="number")return t;if(Ir(t))return J;if(Et(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=Et(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=Ju(t);var a=fa.test(t);return a||pa.test(t)?Ae(t.slice(2),a?2:8):la.test(t)?J:+t}function Cl(t){return Zr(t,gr(t))}function wm(t){return t?Ji(je(t),-K,K):t===0?t:0}function it(t){return t==null?"":Er(t)}var bm=Tn(function(t,i){if(as(i)||pr(i)){Zr(i,kt(i),t);return}for(var a in i)nt.call(i,a)&&ts(t,a,i[a])}),Dl=Tn(function(t,i){Zr(i,gr(i),t)}),$o=Tn(function(t,i,a,h){Zr(i,gr(i),t,h)}),Em=Tn(function(t,i,a,h){Zr(i,kt(i),t,h)}),Im=fi(Ba);function Sm(t,i){var a=Pn(t);return i==null?a:lh(a,i)}var xm=Ke(function(t,i){t=ut(t);var a=-1,h=i.length,p=h>2?i[2]:r;for(p&&nr(i[0],i[1],p)&&(h=1);++a<h;)for(var _=i[a],O=gr(_),C=-1,j=O.length;++C<j;){var X=O[C],Z=t[X];(Z===r||Kr(Z,Sn[X])&&!nt.call(t,X))&&(t[X]=_[X])}return t}),Om=Ke(function(t){return t.push(r,Jh),Kt(Ll,r,t)});function Pm(t,i){return Vu(t,_e(i,3),Xr)}function Tm(t,i){return Vu(t,_e(i,3),ka)}function Rm(t,i){return t==null?t:Ka(t,_e(i,3),gr)}function Nm(t,i){return t==null?t:yh(t,_e(i,3),gr)}function Am(t,i){return t&&Xr(t,_e(i,3))}function Cm(t,i){return t&&ka(t,_e(i,3))}function Dm(t){return t==null?[]:yo(t,kt(t))}function Lm(t){return t==null?[]:yo(t,gr(t))}function Ic(t,i,a){var h=t==null?r:Qi(t,i);return h===r?a:h}function $m(t,i){return t!=null&&Zh(t,i,n0)}function Sc(t,i){return t!=null&&Zh(t,i,s0)}var Um=kh(function(t,i,a){i!=null&&typeof i.toString!="function"&&(i=ro.call(i)),t[i]=a},Oc(yr)),Mm=kh(function(t,i,a){i!=null&&typeof i.toString!="function"&&(i=ro.call(i)),nt.call(t,i)?t[i].push(a):t[i]=[a]},_e),jm=Ke(is);function kt(t){return pr(t)?uh(t):Ya(t)}function gr(t){return pr(t)?uh(t,!0):g0(t)}function qm(t,i){var a={};return i=_e(i,3),Xr(t,function(h,p,_){hi(a,i(h,p,_),h)}),a}function Hm(t,i){var a={};return i=_e(i,3),Xr(t,function(h,p,_){hi(a,p,i(h,p,_))}),a}var zm=Tn(function(t,i,a){vo(t,i,a)}),Ll=Tn(function(t,i,a,h){vo(t,i,a,h)}),Fm=fi(function(t,i){var a={};if(t==null)return a;var h=!1;i=mt(i,function(_){return _=Di(_,t),h||(h=_.length>1),_}),Zr(t,uc(t),a),h&&(a=Lr(a,I|x|T,U0));for(var p=i.length;p--;)tc(a,i[p]);return a});function Bm(t,i){return $l(t,Co(_e(i)))}var Km=fi(function(t,i){return t==null?{}:v0(t,i)});function $l(t,i){if(t==null)return{};var a=mt(uc(t),function(h){return[h]});return i=_e(i),Oh(t,a,function(h,p){return i(h,p[0])})}function km(t,i,a){i=Di(i,t);var h=-1,p=i.length;for(p||(p=1,t=r);++h<p;){var _=t==null?r:t[ei(i[h])];_===r&&(h=p,_=a),t=pi(_)?_.call(t):_}return t}function Vm(t,i,a){return t==null?t:ss(t,i,a)}function Wm(t,i,a,h){return h=typeof h=="function"?h:r,t==null?t:ss(t,i,a,h)}var Ul=Gh(kt),Ml=Gh(gr);function Gm(t,i,a){var h=Ce(t),p=h||$i(t)||An(t);if(i=_e(i,4),a==null){var _=t&&t.constructor;p?a=h?new _:[]:Et(t)?a=pi(_)?Pn(so(t)):{}:a={}}return(p?Ar:Xr)(t,function(O,C,j){return i(a,O,C,j)}),a}function Ym(t,i){return t==null?!0:tc(t,i)}function Jm(t,i,a){return t==null?t:Ah(t,i,nc(a))}function Qm(t,i,a,h){return h=typeof h=="function"?h:r,t==null?t:Ah(t,i,nc(a),h)}function Cn(t){return t==null?[]:Ua(t,kt(t))}function Xm(t){return t==null?[]:Ua(t,gr(t))}function Zm(t,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Mr(a),a=a===a?a:0),i!==r&&(i=Mr(i),i=i===i?i:0),Ji(Mr(t),i,a)}function e_(t,i,a){return i=gi(i),a===r?(a=i,i=0):a=gi(a),t=Mr(t),o0(t,i,a)}function t_(t,i,a){if(a&&typeof a!="boolean"&&nr(t,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof t=="boolean"&&(a=t,t=r)),t===r&&i===r?(t=0,i=1):(t=gi(t),i===r?(i=t,t=0):i=gi(i)),t>i){var h=t;t=i,i=h}if(a||t%1||i%1){var p=ah();return Jt(t+p*(i-t+at("1e-"+((p+"").length-1))),i)}return Xa(t,i)}var r_=Rn(function(t,i,a){return i=i.toLowerCase(),t+(a?jl(i):i)});function jl(t){return xc(it(t).toLowerCase())}function ql(t){return t=it(t),t&&t.replace(oi,Vp).replace(Pa,"")}function i_(t,i,a){t=it(t),i=Er(i);var h=t.length;a=a===r?h:Ji(je(a),0,h);var p=a;return a-=i.length,a>=0&&t.slice(a,p)==i}function n_(t){return t=it(t),t&&yt.test(t)?t.replace(zi,Wp):t}function s_(t){return t=it(t),t&&Mt.test(t)?t.replace(Ot,"\\$&"):t}var o_=Rn(function(t,i,a){return t+(a?"-":"")+i.toLowerCase()}),a_=Rn(function(t,i,a){return t+(a?" ":"")+i.toLowerCase()}),c_=Fh("toLowerCase");function u_(t,i,a){t=it(t),i=je(i);var h=i?En(t):0;if(!i||h>=i)return t;var p=(i-h)/2;return Io(uo(p),a)+t+Io(co(p),a)}function h_(t,i,a){t=it(t),i=je(i);var h=i?En(t):0;return i&&h<i?t+Io(i-h,a):t}function l_(t,i,a){t=it(t),i=je(i);var h=i?En(t):0;return i&&h<i?Io(i-h,a)+t:t}function f_(t,i,a){return a||i==null?i=0:i&&(i=+i),_g(it(t).replace(Pt,""),i||0)}function d_(t,i,a){return(a?nr(t,i,a):i===r)?i=1:i=je(i),Za(it(t),i)}function p_(){var t=arguments,i=it(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var g_=Rn(function(t,i,a){return t+(a?"_":"")+i.toLowerCase()});function y_(t,i,a){return a&&typeof a!="number"&&nr(t,i,a)&&(i=a=r),a=a===r?re:a>>>0,a?(t=it(t),t&&(typeof i=="string"||i!=null&&!Ec(i))&&(i=Er(i),!i&&bn(t))?Li(Fr(t),0,a):t.split(i,a)):[]}var v_=Rn(function(t,i,a){return t+(a?" ":"")+xc(i)});function m_(t,i,a){return t=it(t),a=a==null?0:Ji(je(a),0,t.length),i=Er(i),t.slice(a,a+i.length)==i}function __(t,i,a){var h=v.templateSettings;a&&nr(t,i,a)&&(i=r),t=it(t),i=$o({},i,h,Yh);var p=$o({},i.imports,h.imports,Yh),_=kt(p),O=Ua(p,_),C,j,X=0,Z=i.interpolate||dn,ie="__p += '",he=ja((i.escape||dn).source+"|"+Z.source+"|"+(Z===bt?ha:dn).source+"|"+(i.evaluate||dn).source+"|$","g"),ye="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ta+"]")+`
`;t.replace(he,function(Ie,We,Ze,Sr,sr,xr){return Ze||(Ze=Sr),ie+=t.slice(X,xr).replace(ya,Gp),We&&(C=!0,ie+=`' +
__e(`+We+`) +
'`),sr&&(j=!0,ie+=`';
`+sr+`;
__p += '`),Ze&&(ie+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=xr+Ie.length,Ie}),ie+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ie=`with (obj) {
`+ie+`
}
`;else if(ca.test(Ee))throw new Ne(f);ie=(j?ie.replace(Yr,""):ie).replace(tr,"$1").replace(si,"$1;"),ie="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var ze=zl(function(){return rt(_,ye+"return "+ie).apply(r,O)});if(ze.source=ie,bc(ze))throw ze;return ze}function w_(t){return it(t).toLowerCase()}function b_(t){return it(t).toUpperCase()}function E_(t,i,a){if(t=it(t),t&&(a||i===r))return Ju(t);if(!t||!(i=Er(i)))return t;var h=Fr(t),p=Fr(i),_=Qu(h,p),O=Xu(h,p)+1;return Li(h,_,O).join("")}function I_(t,i,a){if(t=it(t),t&&(a||i===r))return t.slice(0,eh(t)+1);if(!t||!(i=Er(i)))return t;var h=Fr(t),p=Xu(h,Fr(i))+1;return Li(h,0,p).join("")}function S_(t,i,a){if(t=it(t),t&&(a||i===r))return t.replace(Pt,"");if(!t||!(i=Er(i)))return t;var h=Fr(t),p=Qu(h,Fr(i));return Li(h,p).join("")}function x_(t,i){var a=W,h=ne;if(Et(i)){var p="separator"in i?i.separator:p;a="length"in i?je(i.length):a,h="omission"in i?Er(i.omission):h}t=it(t);var _=t.length;if(bn(t)){var O=Fr(t);_=O.length}if(a>=_)return t;var C=a-En(h);if(C<1)return h;var j=O?Li(O,0,C).join(""):t.slice(0,C);if(p===r)return j+h;if(O&&(C+=j.length-C),Ec(p)){if(t.slice(C).search(p)){var X,Z=j;for(p.global||(p=ja(p.source,it(Rr.exec(p))+"g")),p.lastIndex=0;X=p.exec(Z);)var ie=X.index;j=j.slice(0,ie===r?C:ie)}}else if(t.indexOf(Er(p),C)!=C){var he=j.lastIndexOf(p);he>-1&&(j=j.slice(0,he))}return j+h}function O_(t){return t=it(t),t&&It.test(t)?t.replace(xi,tg):t}var P_=Rn(function(t,i,a){return t+(a?" ":"")+i.toUpperCase()}),xc=Fh("toUpperCase");function Hl(t,i,a){return t=it(t),i=a?r:i,i===r?Jp(t)?ng(t):zp(t):t.match(i)||[]}var zl=Ke(function(t,i){try{return Kt(t,r,i)}catch(a){return bc(a)?a:new Ne(a)}}),T_=fi(function(t,i){return Ar(i,function(a){a=ei(a),hi(t,a,_c(t[a],t))}),t});function R_(t){var i=t==null?0:t.length,a=_e();return t=i?mt(t,function(h){if(typeof h[1]!="function")throw new Cr(d);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var p=-1;++p<i;){var _=t[p];if(Kt(_[0],this,h))return Kt(_[1],this,h)}})}function N_(t){return t0(Lr(t,I))}function Oc(t){return function(){return t}}function A_(t,i){return t==null||t!==t?i:t}var C_=Kh(),D_=Kh(!0);function yr(t){return t}function Pc(t){return wh(typeof t=="function"?t:Lr(t,I))}function L_(t){return Eh(Lr(t,I))}function $_(t,i){return Ih(t,Lr(i,I))}var U_=Ke(function(t,i){return function(a){return is(a,t,i)}}),M_=Ke(function(t,i){return function(a){return is(t,a,i)}});function Tc(t,i,a){var h=kt(i),p=yo(i,h);a==null&&!(Et(i)&&(p.length||!h.length))&&(a=i,i=t,t=this,p=yo(i,kt(i)));var _=!(Et(a)&&"chain"in a)||!!a.chain,O=pi(t);return Ar(p,function(C){var j=i[C];t[C]=j,O&&(t.prototype[C]=function(){var X=this.__chain__;if(_||X){var Z=t(this.__wrapped__),ie=Z.__actions__=dr(this.__actions__);return ie.push({func:j,args:arguments,thisArg:t}),Z.__chain__=X,Z}return j.apply(t,Ti([this.value()],arguments))})}),t}function j_(){return Xe._===this&&(Xe._=hg),this}function Rc(){}function q_(t){return t=je(t),Ke(function(i){return Sh(i,t)})}var H_=oc(mt),z_=oc(ku),F_=oc(Aa);function Fl(t){return dc(t)?Ca(ei(t)):m0(t)}function B_(t){return function(i){return t==null?r:Qi(t,i)}}var K_=Vh(),k_=Vh(!0);function Nc(){return[]}function Ac(){return!1}function V_(){return{}}function W_(){return""}function G_(){return!0}function Y_(t,i){if(t=je(t),t<1||t>K)return[];var a=re,h=Jt(t,re);i=_e(i),t-=re;for(var p=$a(h,i);++a<t;)i(a);return p}function J_(t){return Ce(t)?mt(t,ei):Ir(t)?[t]:dr(cl(it(t)))}function Q_(t){var i=++cg;return it(t)+i}var X_=Eo(function(t,i){return t+i},0),Z_=ac("ceil"),ew=Eo(function(t,i){return t/i},1),tw=ac("floor");function rw(t){return t&&t.length?go(t,yr,Va):r}function iw(t,i){return t&&t.length?go(t,_e(i,2),Va):r}function nw(t){return Gu(t,yr)}function sw(t,i){return Gu(t,_e(i,2))}function ow(t){return t&&t.length?go(t,yr,Ja):r}function aw(t,i){return t&&t.length?go(t,_e(i,2),Ja):r}var cw=Eo(function(t,i){return t*i},1),uw=ac("round"),hw=Eo(function(t,i){return t-i},0);function lw(t){return t&&t.length?La(t,yr):0}function fw(t,i){return t&&t.length?La(t,_e(i,2)):0}return v.after=Lv,v.ary=_l,v.assign=bm,v.assignIn=Dl,v.assignInWith=$o,v.assignWith=Em,v.at=Im,v.before=wl,v.bind=_c,v.bindAll=T_,v.bindKey=bl,v.castArray=Vv,v.chain=yl,v.chunk=ty,v.compact=ry,v.concat=iy,v.cond=R_,v.conforms=N_,v.constant=Oc,v.countBy=lv,v.create=Sm,v.curry=El,v.curryRight=Il,v.debounce=Sl,v.defaults=xm,v.defaultsDeep=Om,v.defer=$v,v.delay=Uv,v.difference=ny,v.differenceBy=sy,v.differenceWith=oy,v.drop=ay,v.dropRight=cy,v.dropRightWhile=uy,v.dropWhile=hy,v.fill=ly,v.filter=dv,v.flatMap=yv,v.flatMapDeep=vv,v.flatMapDepth=mv,v.flatten=fl,v.flattenDeep=fy,v.flattenDepth=dy,v.flip=Mv,v.flow=C_,v.flowRight=D_,v.fromPairs=py,v.functions=Dm,v.functionsIn=Lm,v.groupBy=_v,v.initial=yy,v.intersection=vy,v.intersectionBy=my,v.intersectionWith=_y,v.invert=Um,v.invertBy=Mm,v.invokeMap=bv,v.iteratee=Pc,v.keyBy=Ev,v.keys=kt,v.keysIn=gr,v.map=Ro,v.mapKeys=qm,v.mapValues=Hm,v.matches=L_,v.matchesProperty=$_,v.memoize=Ao,v.merge=zm,v.mergeWith=Ll,v.method=U_,v.methodOf=M_,v.mixin=Tc,v.negate=Co,v.nthArg=q_,v.omit=Fm,v.omitBy=Bm,v.once=jv,v.orderBy=Iv,v.over=H_,v.overArgs=qv,v.overEvery=z_,v.overSome=F_,v.partial=wc,v.partialRight=xl,v.partition=Sv,v.pick=Km,v.pickBy=$l,v.property=Fl,v.propertyOf=B_,v.pull=Iy,v.pullAll=pl,v.pullAllBy=Sy,v.pullAllWith=xy,v.pullAt=Oy,v.range=K_,v.rangeRight=k_,v.rearg=Hv,v.reject=Pv,v.remove=Py,v.rest=zv,v.reverse=vc,v.sampleSize=Rv,v.set=Vm,v.setWith=Wm,v.shuffle=Nv,v.slice=Ty,v.sortBy=Dv,v.sortedUniq=$y,v.sortedUniqBy=Uy,v.split=y_,v.spread=Fv,v.tail=My,v.take=jy,v.takeRight=qy,v.takeRightWhile=Hy,v.takeWhile=zy,v.tap=rv,v.throttle=Bv,v.thru=To,v.toArray=Nl,v.toPairs=Ul,v.toPairsIn=Ml,v.toPath=J_,v.toPlainObject=Cl,v.transform=Gm,v.unary=Kv,v.union=Fy,v.unionBy=By,v.unionWith=Ky,v.uniq=ky,v.uniqBy=Vy,v.uniqWith=Wy,v.unset=Ym,v.unzip=mc,v.unzipWith=gl,v.update=Jm,v.updateWith=Qm,v.values=Cn,v.valuesIn=Xm,v.without=Gy,v.words=Hl,v.wrap=kv,v.xor=Yy,v.xorBy=Jy,v.xorWith=Qy,v.zip=Xy,v.zipObject=Zy,v.zipObjectDeep=ev,v.zipWith=tv,v.entries=Ul,v.entriesIn=Ml,v.extend=Dl,v.extendWith=$o,Tc(v,v),v.add=X_,v.attempt=zl,v.camelCase=r_,v.capitalize=jl,v.ceil=Z_,v.clamp=Zm,v.clone=Wv,v.cloneDeep=Yv,v.cloneDeepWith=Jv,v.cloneWith=Gv,v.conformsTo=Qv,v.deburr=ql,v.defaultTo=A_,v.divide=ew,v.endsWith=i_,v.eq=Kr,v.escape=n_,v.escapeRegExp=s_,v.every=fv,v.find=pv,v.findIndex=hl,v.findKey=Pm,v.findLast=gv,v.findLastIndex=ll,v.findLastKey=Tm,v.floor=tw,v.forEach=vl,v.forEachRight=ml,v.forIn=Rm,v.forInRight=Nm,v.forOwn=Am,v.forOwnRight=Cm,v.get=Ic,v.gt=Xv,v.gte=Zv,v.has=$m,v.hasIn=Sc,v.head=dl,v.identity=yr,v.includes=wv,v.indexOf=gy,v.inRange=e_,v.invoke=jm,v.isArguments=en,v.isArray=Ce,v.isArrayBuffer=em,v.isArrayLike=pr,v.isArrayLikeObject=Ct,v.isBoolean=tm,v.isBuffer=$i,v.isDate=rm,v.isElement=im,v.isEmpty=nm,v.isEqual=sm,v.isEqualWith=om,v.isError=bc,v.isFinite=am,v.isFunction=pi,v.isInteger=Ol,v.isLength=Do,v.isMap=Pl,v.isMatch=cm,v.isMatchWith=um,v.isNaN=hm,v.isNative=lm,v.isNil=dm,v.isNull=fm,v.isNumber=Tl,v.isObject=Et,v.isObjectLike=Rt,v.isPlainObject=us,v.isRegExp=Ec,v.isSafeInteger=pm,v.isSet=Rl,v.isString=Lo,v.isSymbol=Ir,v.isTypedArray=An,v.isUndefined=gm,v.isWeakMap=ym,v.isWeakSet=vm,v.join=wy,v.kebabCase=o_,v.last=Ur,v.lastIndexOf=by,v.lowerCase=a_,v.lowerFirst=c_,v.lt=mm,v.lte=_m,v.max=rw,v.maxBy=iw,v.mean=nw,v.meanBy=sw,v.min=ow,v.minBy=aw,v.stubArray=Nc,v.stubFalse=Ac,v.stubObject=V_,v.stubString=W_,v.stubTrue=G_,v.multiply=cw,v.nth=Ey,v.noConflict=j_,v.noop=Rc,v.now=No,v.pad=u_,v.padEnd=h_,v.padStart=l_,v.parseInt=f_,v.random=t_,v.reduce=xv,v.reduceRight=Ov,v.repeat=d_,v.replace=p_,v.result=km,v.round=uw,v.runInContext=M,v.sample=Tv,v.size=Av,v.snakeCase=g_,v.some=Cv,v.sortedIndex=Ry,v.sortedIndexBy=Ny,v.sortedIndexOf=Ay,v.sortedLastIndex=Cy,v.sortedLastIndexBy=Dy,v.sortedLastIndexOf=Ly,v.startCase=v_,v.startsWith=m_,v.subtract=hw,v.sum=lw,v.sumBy=fw,v.template=__,v.times=Y_,v.toFinite=gi,v.toInteger=je,v.toLength=Al,v.toLower=w_,v.toNumber=Mr,v.toSafeInteger=wm,v.toString=it,v.toUpper=b_,v.trim=E_,v.trimEnd=I_,v.trimStart=S_,v.truncate=x_,v.unescape=O_,v.uniqueId=Q_,v.upperCase=P_,v.upperFirst=xc,v.each=vl,v.eachRight=ml,v.first=dl,Tc(v,function(){var t={};return Xr(v,function(i,a){nt.call(v.prototype,a)||(t[a]=i)}),t}(),{chain:!1}),v.VERSION=s,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){v[t].placeholder=v}),Ar(["drop","take"],function(t,i){Ye.prototype[t]=function(a){a=a===r?1:Bt(je(a),0);var h=this.__filtered__&&!i?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Jt(a,h.__takeCount__):h.__views__.push({size:Jt(a,re),type:t+(h.__dir__<0?"Right":"")}),h},Ye.prototype[t+"Right"]=function(a){return this.reverse()[t](a).reverse()}}),Ar(["filter","map","takeWhile"],function(t,i){var a=i+1,h=a==w||a==ee;Ye.prototype[t]=function(p){var _=this.clone();return _.__iteratees__.push({iteratee:_e(p,3),type:a}),_.__filtered__=_.__filtered__||h,_}}),Ar(["head","last"],function(t,i){var a="take"+(i?"Right":"");Ye.prototype[t]=function(){return this[a](1).value()[0]}}),Ar(["initial","tail"],function(t,i){var a="drop"+(i?"":"Right");Ye.prototype[t]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(yr)},Ye.prototype.find=function(t){return this.filter(t).head()},Ye.prototype.findLast=function(t){return this.reverse().find(t)},Ye.prototype.invokeMap=Ke(function(t,i){return typeof t=="function"?new Ye(this):this.map(function(a){return is(a,t,i)})}),Ye.prototype.reject=function(t){return this.filter(Co(_e(t)))},Ye.prototype.slice=function(t,i){t=je(t);var a=this;return a.__filtered__&&(t>0||i<0)?new Ye(a):(t<0?a=a.takeRight(-t):t&&(a=a.drop(t)),i!==r&&(i=je(i),a=i<0?a.dropRight(-i):a.take(i-t)),a)},Ye.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Xr(Ye.prototype,function(t,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),h=/^(?:head|last)$/.test(i),p=v[h?"take"+(i=="last"?"Right":""):i],_=h||/^find/.test(i);p&&(v.prototype[i]=function(){var O=this.__wrapped__,C=h?[1]:arguments,j=O instanceof Ye,X=C[0],Z=j||Ce(O),ie=function(We){var Ze=p.apply(v,Ti([We],C));return h&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(j=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=_&&!he,ze=j&&!ye;if(!_&&Z){O=ze?O:new Ye(this);var Ie=t.apply(O,C);return Ie.__actions__.push({func:To,args:[ie],thisArg:r}),new Dr(Ie,he)}return Ee&&ze?t.apply(this,C):(Ie=this.thru(ie),Ee?h?Ie.value()[0]:Ie.value():Ie)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(t){var i=Zs[t],a=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",h=/^(?:pop|shift)$/.test(t);v.prototype[t]=function(){var p=arguments;if(h&&!this.__chain__){var _=this.value();return i.apply(Ce(_)?_:[],p)}return this[a](function(O){return i.apply(Ce(O)?O:[],p)})}}),Xr(Ye.prototype,function(t,i){var a=v[i];if(a){var h=a.name+"";nt.call(On,h)||(On[h]=[]),On[h].push({name:i,func:a})}}),On[bo(r,se).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=Og,Ye.prototype.reverse=Pg,Ye.prototype.value=Tg,v.prototype.at=iv,v.prototype.chain=nv,v.prototype.commit=sv,v.prototype.next=ov,v.prototype.plant=cv,v.prototype.reverse=uv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=hv,v.prototype.first=v.prototype.head,Jn&&(v.prototype[Jn]=av),v},In=sg();At?((At.exports=In)._=In,ct._=In):Xe._=In}).call(ys)})(_u,_u.exports);var h5=Object.defineProperty,l5=Object.defineProperties,f5=Object.getOwnPropertyDescriptors,md=Object.getOwnPropertySymbols,d5=Object.prototype.hasOwnProperty,p5=Object.prototype.propertyIsEnumerable,_d=(n,e,r)=>e in n?h5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Ho=(n,e)=>{for(var r in e||(e={}))d5.call(e,r)&&_d(n,r,e[r]);if(md)for(var r of md(e))p5.call(e,r)&&_d(n,r,e[r]);return n},g5=(n,e)=>l5(n,f5(e));function ji(n,e,r){var s;const o=cb(n);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${u5}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function fn(n){return n.includes(":")?n.split(":")[1]:n}function Lp(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function y5(n,e){const r=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function wd(n={},e={}){const r=bd(n),s=bd(e);return _u.exports.merge(r,s)}function bd(n){var e,r,s,o;const c={};if(!Ss(n))return c;for(const[d,f]of Object.entries(n)){const y=Lu(d)?[d]:f.chains,g=f.methods||[],m=f.events||[],I=f.rpcMap||{},x=vs(d);c[x]=g5(Ho(Ho({},c[x]),f),{chains:Uc(y,(e=c[x])==null?void 0:e.chains),methods:Uc(g,(r=c[x])==null?void 0:r.methods),events:Uc(m,(s=c[x])==null?void 0:s.events),rpcMap:Ho(Ho({},I),(o=c[x])==null?void 0:o.rpcMap)})}return c}function v5(n){return n.includes(":")?n.split(":")[2]:n}function m5(n){const e={};for(const[r,s]of Object.entries(n)){const o=s.methods||[],c=s.events||[],d=s.accounts||[],f=Lu(r)?[r]:s.chains?s.chains:Lp(s.accounts);e[r]={chains:f,methods:o,events:c,accounts:d}}return e}function Jc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):(n=n.includes(":")?n.split(":")[1]:n,isNaN(Number(n))?n:Number(n))}const $p={},wt=n=>$p[n],Qc=(n,e)=>{$p[n]=e};class _5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=fn(r);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class w5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const s=r||ji(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=parseInt(fn(r));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,s;let o=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class b5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=fn(r);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class E5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=fn(r);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class I5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),o=fn(r);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class S5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=fn(r);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class x5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const o=fn(r);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Hi(s,wt("disableProviderPing")))}}class O5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||ji(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||ji(e,this.namespace);return typeof s>"u"?void 0:new Ii(new Hi(s,wt("disableProviderPing")))}}var P5=Object.defineProperty,T5=Object.defineProperties,R5=Object.getOwnPropertyDescriptors,Ed=Object.getOwnPropertySymbols,N5=Object.prototype.hasOwnProperty,A5=Object.prototype.propertyIsEnumerable,Id=(n,e,r)=>e in n?P5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,zo=(n,e)=>{for(var r in e||(e={}))N5.call(e,r)&&Id(n,r,e[r]);if(Ed)for(var r of Ed(e))A5.call(e,r)&&Id(n,r,e[r]);return n},Xc=(n,e)=>T5(n,R5(e));class Bu{constructor(e){this.events=new Su,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||yd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new Bu(e);return await r.initialize(),r}async request(e,r,s){const[o,c]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:zo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,r,s,o){const c=new Date().getTime();this.request(e,s,o).then(d=>r(null,ia(c,d))).catch(d=>r(d,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:_t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const d=m5(c.namespaces);this.namespaces=wd(this.namespaces,d),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==Cp)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ii(r)){for(const s of r)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await r5.init({logger:this.providerOpts.logger||yd,relayUrl:this.providerOpts.relayUrl||o5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>vs(r)))];Qc("client",this.client),Qc("events",this.events),Qc("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const s=y5(r,this.session),o=Lp(s),c=wd(this.namespaces,this.optionalNamespaces),d=Xc(zo({},c[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new w5({namespace:d});break;case"solana":this.rpcProviders[r]=new b5({namespace:d});break;case"cosmos":this.rpcProviders[r]=new E5({namespace:d});break;case"polkadot":this.rpcProviders[r]=new _5({namespace:d});break;case"cip34":this.rpcProviders[r]=new I5({namespace:d});break;case"elrond":this.rpcProviders[r]=new S5({namespace:d});break;case"multiversx":this.rpcProviders[r]=new x5({namespace:d});break;case"near":this.rpcProviders[r]=new O5({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&ii(o)&&this.events.emit("accountsChanged",o.map(v5))}else if(s.name==="chainChanged"){const o=r.chainId,c=r.event.data,d=vs(o),f=Jc(o)!==Jc(c)?`${d}:${Jc(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var s;const{namespaces:o}=r,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Xc(zo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Xc(zo({},_t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Si.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=e;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(e){const[r,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(d=>vs(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=vs(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(r||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${vd}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${vd}/${e}`)}}const C5=Bu,D5="wc",L5="ethereum_provider",$5=`${D5}@2:${L5}:`,U5="https://rpc.walletconnect.com/v1/",wu=["eth_sendTransaction","personal_sign"],M5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],bu=["chainChanged","accountsChanged"],j5=["chainChanged","accountsChanged","message","disconnect","connect"];var q5=Object.defineProperty,H5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,Sd=Object.getOwnPropertySymbols,F5=Object.prototype.hasOwnProperty,B5=Object.prototype.propertyIsEnumerable,xd=(n,e,r)=>e in n?q5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,_s=(n,e)=>{for(var r in e||(e={}))F5.call(e,r)&&xd(n,r,e[r]);if(Sd)for(var r of Sd(e))B5.call(e,r)&&xd(n,r,e[r]);return n},Od=(n,e)=>H5(n,z5(e));function Qo(n){return Number(n[0].split(":")[1])}function Zc(n){return`0x${n.toString(16)}`}function K5(n){const{chains:e,optionalChains:r,methods:s,optionalMethods:o,events:c,optionalEvents:d,rpcMap:f}=n;if(!ii(e))throw new Error("Invalid chains");const y={chains:e,methods:s||wu,events:c||bu,rpcMap:_s({},e.length?{[Qo(e)]:f[Qo(e)]}:{})},g=c==null?void 0:c.filter(T=>!bu.includes(T)),m=s==null?void 0:s.filter(T=>!wu.includes(T));if(!r&&!d&&!o&&!(g!=null&&g.length)&&!(m!=null&&m.length))return{required:e.length?y:void 0};const I=(g==null?void 0:g.length)&&(m==null?void 0:m.length)||!r,x={chains:[...new Set(I?y.chains.concat(r||[]):r)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:M5))],events:[...new Set(y.events.concat(d!=null&&d.length?d:j5))],rpcMap:f};return{required:e.length?y:void 0,optional:r.length?x:void 0}}class Ku{constructor(){this.events=new qr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=$5,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new Ku;return await r.initialize(e),r}async request(e,r){return await this.signer.request(e,this.formatChainId(this.chainId),r)}sendAsync(e,r,s){this.signer.sendAsync(e,r,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:s}=K5(this.rpc);try{const o=await new Promise(async(d,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Od(_s({namespaces:_s({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{d(g)}).catch(g=>{f(new Error(g.message))})});if(!o)return;const c=ub(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Zc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Zc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Od(_s({},_t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Zc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,s,o]=e.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,s;const o=(r=e==null?void 0:e.chains)!=null?r:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],d=o.concat(c);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||wu:[],y=o.length?(e==null?void 0:e.events)||bu:[],g=(e==null?void 0:e.optionalMethods)||[],m=(e==null?void 0:e.optionalEvents)||[],I=(e==null?void 0:e.rpcMap)||this.buildRpcMap(d,e.projectId),x=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(T=>this.formatChainId(T)),optionalChains:c.map(T=>this.formatChainId(T)),methods:f,events:y,optionalMethods:g,optionalEvents:m,rpcMap:I,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:x,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Qo(this.rpc.chains):Qo(this.rpc.optionalChains),this.signer=await C5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await dw(()=>import("./chunk-CGd64Cir.js").then(o=>o.i),__vite__mapDeps([0,1,2]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(_s({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:s,rpcMap:o}=e;r&&ii(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ii(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${U5}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const lx=Ku;export{lx as EthereumProvider,j5 as OPTIONAL_EVENTS,M5 as OPTIONAL_METHODS,bu as REQUIRED_EVENTS,wu as REQUIRED_METHODS,Ku as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["js/chunk-CGd64Cir.js","js/chunk-DP0Z30vw.js","css/chunk-Ce0NHh-g.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
